TopElementBehavior={properties:{onDetach:String,onAttach:String},factoryImpl:function(){},created:function(){this.currentData={};this.dataObj={}},ready:function(){if(!this.id){this.id=Top.Util.guid()}if(typeof this.initializeChildRoot==="function")this.childRoot=this.initializeChildRoot();this.updateStyle()},attached:function(){this.__attachedImpl()},__attachedImpl:function(){if(this.__isAttached===true||this.childRoot===null)return;this.__isAttached=true;if(typeof this.__initBoundData==="function")this.__initBoundData();if(typeof this.__widgetAttached==="function")this.__widgetAttached();if(typeof this.__layoutAttached==="function")this.__layoutAttached();if(typeof this.__attached2==="function")this.__attached2();if(this.__redrawChild!==undefined){for(var i=0;i<this.__redrawChild.length;i++){this.__redrawChild[i]()}}if(typeof this.onAttach==="string"){this.onAttach=Top.Util.namespace(this.onAttach,this)}if(typeof this.onAttach==="function"){this.onAttach()}if(Top.events.onWidgetAttach[this.id]){Top.App.__callEvent(Top.events.onWidgetAttach[this.id],Top.Dom.selectById(this.id));delete Top.events.onWidgetAttach[this.id]}if(this.parentNode&&this.parentNode.tagName==="BODY"||this.layoutParent){if(this.layoutParent&&this.layoutParent.addedChildrenParent){var p=this.layoutParent.addedChildrenParent.children;var n=[];for(var i=0;i<p.length;i++){if(TopRuntime.topWidgets[p[i].tagName.toLowerCase()]!==undefined&&p[i].tagName!=="TOP-CONTEXTMENU")n.push(p[i])}if(n[0]!==this)return;var layouts=this.layoutParent.addedChildrenParent.querySelectorAll('top-linearlayout:not([orientation="vertical"])');var splitterlayouts=this.layoutParent.addedChildrenParent.querySelectorAll('top-splitterlayout:not([orientation="vertical"])');var textfields=this.layoutParent.addedChildrenParent.querySelectorAll("top-textfield");var checkboxes=this.layoutParent.addedChildrenParent.querySelectorAll("top-checkbox");var radiobuttons=this.layoutParent.addedChildrenParent.querySelectorAll("top-radiobutton");var breadcrumbs=this.layoutParent.addedChildrenParent.querySelectorAll("top-breadcrumb");this.layoutParent.addedChildrenParent=undefined}else if(this.layoutParent&&this.appendedByTab){this.appendedByTab=false;if(this.layoutParent.parentNode){var layouts=this.layoutParent.parentNode.querySelectorAll('top-linearlayout:not([orientation="vertical"])');var splitterlayouts=this.layoutParent.parentNode.querySelectorAll('top-splitterlayout:not([orientation="vertical"])')}else{if(this.layoutParent.orientation!=="vertical"){var layouts=[this.layoutParent]}else if(this.layoutParent.tagName==="TOP-SPLITTERLAYOUT"&&this.layoutParent.orientation==="horizontal"){var splitterlayouts=[this.layoutParent]}}var textfields=this.layoutParent.querySelectorAll("top-textfield");var checkboxes=this.layoutParent.querySelectorAll("top-checkbox");var radiobuttons=this.layoutParent.querySelectorAll("top-radiobutton");var breadcrumbs=this.layoutParent.querySelectorAll("top-breadcrumb")}else if(this.layoutParent){if(this.layoutParent.tagName==="TOP-PAGE"||this.layoutParent.isCustomType===true){var p=this.layoutParent.children}else{var p=this.layoutParent.childRoot.children}var n=[];for(var i=0;i<p.length;i++){if(TopRuntime.topWidgets[p[i].tagName.toLowerCase()]!==undefined&&p[i].tagName!=="TOP-CONTEXTMENU")n.push(p[i])}if(n[0]!==this)return;if(this.layoutParent.parentNode){var layouts=this.layoutParent.parentNode.querySelectorAll('top-linearlayout:not([orientation="vertical"])');var splitterlayouts=this.layoutParent.parentNode.querySelectorAll('top-splitterlayout:not([orientation="vertical"])')}else{if(this.layoutParent.orientation!=="vertical"){var layouts=[this.layoutParent]}else if(this.layoutParent.tagName==="TOP-SPLITTERLAYOUT"&&this.layoutParent.orientation==="horizontal"){var splitterlayouts=[this.layoutParent]}}var textfields=this.layoutParent.querySelectorAll("top-textfield");var checkboxes=this.layoutParent.querySelectorAll("top-checkbox");var radiobuttons=this.layoutParent.querySelectorAll("top-radiobutton");var breadcrumbs=this.layoutParent.querySelectorAll("top-breadcrumb")}else{var p=this.parentNode.children;var layouts=document.querySelectorAll('top-linearlayout:not([orientation="vertical"])');var splitterlayouts=document.querySelectorAll('top-splitterlayout:not([orientation="vertical"])');var textfields=document.querySelectorAll("top-textfield");var checkboxes=document.querySelectorAll("top-checkbox");var radiobuttons=document.querySelectorAll("top-radiobutton");var breadcrumbs=document.querySelectorAll("top-breadcrumb")}if(layouts){for(var i=0;i<layouts.length;i++){if(layouts[i].__isAttached&&typeof layouts[i].__setLineHeight==="function"&&layouts[i].id){layouts[i].__setLineHeight()}}}if(splitterlayouts){for(var i=0;i<splitterlayouts.length;i++){if(splitterlayouts[i].__isAttached&&typeof splitterlayouts[i].initDefaultWidth==="function"&&splitterlayouts[i].id){splitterlayouts[i].initDefaultWidth()}}}if(textfields){for(var i=0;i<textfields.length;i++){if(textfields[i].__isAttached&&textfields[i].__initialized&&typeof textfields[i].__setVerticalAlignment==="function"){textfields[i].__setVerticalAlignment()}}}if(checkboxes){for(var i=0;i<checkboxes.length;i++){if(checkboxes[i].__isAttached&&checkboxes[i].__initialized&&typeof checkboxes[i].__setVerticalAlignment==="function"){checkboxes[i].__setVerticalAlignment()}}}if(radiobuttons){for(var i=0;i<radiobuttons.length;i++){if(radiobuttons[i].__isAttached&&radiobuttons[i].__initialized&&typeof radiobuttons[i].__setVerticalAlignment==="function"){radiobuttons[i].__setVerticalAlignment()}}}if(breadcrumbs){for(var i=0;i<breadcrumbs.length;i++){if(breadcrumbs[i].__isAttached&&breadcrumbs[i].__initialized&&typeof breadcrumbs[i].__updateVerticalAlignmentForMatchparent==="function"){breadcrumbs[i].__updateVerticalAlignmentForMatchparent()}}}}this.__addUserClass()},detached:function(){if(this.__isDetachable()){this.__detachedImpl();if(typeof this.__detached==="function")this.__detached()}},__detachedImpl:function(){this.__isAttached=false;this.adjusted=undefined;this.__clearEvents();this.__clearBindingInfo();if(typeof this.__clearTimer==="function"){this.__clearTimer()}if(typeof this.onDetach==="string"){this.onDetach=Top.Util.namespace(this.onDetach,this)}if(typeof this.onDetach==="function"){this.onDetach()}if(Top.events.onWidgetDetach[this.id]){Top.App.__callEvent(Top.events.onWidgetDetach[this.id],this.id);delete Top.events.onWidgetDetach[this.id]}if(this.srcLoadListeners!==undefined){delete this.srcLoadListeners}if(this.layoutParent!==undefined||this.layoutParent!==null){this.layoutParent=undefined}if(this.tagName!=="TOP-TABLEVIEW"){this.childRoot=null}Top.i18n.__removeOnUpdate(this.id);this.__boundController=null},__isDetachable:function(){return this.__isAttached===true},__isAccordionChild:function(){return this.parentNode&&this.parentNode.classList.contains("top-accordionlayout-content")},getElement:function(selector){var element;if(selector){return this.querySelectorAll(selector)}else{if(this.__isCustomWidget||this.isCustomType){return undefined}else if(this.tagName==="TOP-TABLEVIEW"){return this.querySelector("div#"+this.id)}else{return this.firstElementChild}}},__addUserClass:function(){if(typeof this.__userClassList==="object"){var names=Object.keys(this.__userClassList);for(var i=0,len=names.length;i<len;i++){var elems=this.getElementsByClassName(names[i]);for(var j=0,len2=elems.length;j<len2;j++){elems[j].classList.add(this.__userClassList[names[i]])}}}}};TopDataBehavior={properties:{data:String,dataModel:Object,__boundData:Object},ready:function(){if(this.parentNode&&(this.parentNode.tagName==="TOP-COLUMNITEM"||this.parentNode.tagName==="TOP-WIDGETITEM"))return;if(Top.App.isLoaded()){this.__initBoundData();if(typeof this.__ready==="function")this.__ready();this.__initialized=true;if(typeof this.__isReadied==="function")this.__isReadied()}else{var _this=this;Top.App.onBeforeLoad(function(){_this.__initBoundData();if(typeof _this.__ready==="function")_this.__ready();this.__initialized=true;if(typeof _this.__isReadied==="function")_this.__isReadied()})}},__initBoundData:function(fromController,widgetId){if(typeof this.data==="string")this.dataModel=JSON.parse(this.data);if(typeof this.dataModel==="string")this.dataModel=JSON.parse(this.dataModel);if(this.dataModel===undefined||this.dataModel==="")return;var resourcePattern=/^@(string|color|dimen|raw|drawable|style|theme)(\/[a-zA-Z0-9]+)+$/gm;this.__boundData={};for(var prop in this.dataModel){var valuePath=this.dataModel[prop];var dataName=Top.Util.getDataName(valuePath,this);var data=Top.Util.namespace(dataName,this);var splitValues=valuePath.split(dataName+".");if(splitValues.length>1){splitValues.shift();valuePath=splitValues.join(dataName+".")}else{valuePath=splitValues[1]}if(data===undefined||!data.hasOwnProperty("id"))return;this.__addBoundData(prop,dataName,valuePath);if(valuePath.includes("+")){var converter=Top.Util.namespace(valuePath.split("+")[1],this);this.__boundData["DataConverter"]=converter}if(prop==="items"){this[prop]=this.dataModel[prop].split("+")[0]}else{var originValue=data.getValue(valuePath.split("+")[0]);originValue=this.__getValueByDataConverter(originValue);if(resourcePattern.test(originValue)){var modifiedValue;var resourceType=originValue.split("/")[0];var resourceId=originValue.substr(originValue.indexOf("/")+1);switch(resourceType){case"@drawable":{modifiedValue=Top.DrawableManager.get(resourceId);break}case"@raw":{modifiedValue=Top.RawManager.get(resourceId);break}default:{resourceId=resourceId.substr(0,resourceId.lastIndexOf("/"));var resourceName=originValue.split("/");resourceName=resourceName[resourceName.length-1];switch(resourceType){case"@string":{modifiedValue=Top.ValuesManager.get("strings",resourceId)[resourceName];break}case"@color":{modifiedValue=Top.ValuesManager.get("colors",resourceId)[resourceName];break}case"@dimen":{modifiedValue=Top.ValuesManager.get("dimen",resourceId)[resourceName];break}}}}this[prop]=modifiedValue}else this[prop]=originValue;var __updateNeeded=true}if(this.__isBoundData===undefined)this.__isBoundData={};if(this.__isBoundData[prop]!==true){data.__addBoundWidget(valuePath,this.id,prop);this.__isBoundData[prop]=true}if(fromController===true||__updateNeeded===true){data.__updateBoundWidgets(valuePath,null,widgetId)}}},__addBoundData:function(prop,dataName,valuePath){var bindingInfo={};bindingInfo.dataName=dataName;bindingInfo.valuePath=valuePath;this.__boundData[prop]=this.__boundData[prop]||[];this.__boundData[prop].push(bindingInfo)},__updateBoundData:function(key,__widgetId){if(typeof key==="object"){for(var i=0,len=key.length;i<len;i++){this.__updateBoundDataImpl(key[i],__widgetId)}}else{this.__updateBoundDataImpl(key,__widgetId)}},__updateBoundDataImpl:function(key,__widgetId){if(this.__boundData&&this.__boundData[key]){var bindingInfoList=this.__boundData[key];for(var i=0,len=bindingInfoList.length;i<len;i++){var data=Top.Util.namespace(bindingInfoList[i].dataName,this);var valuePath=bindingInfoList[i].valuePath;if(valuePath.includes("+")){valuePath=valuePath.split("+")[0]}if(key==="items"){if(typeof this[key]==="string"){data.setValue(valuePath,Top.Util.namespace(this[key],this),__widgetId)}else{data.setValue(valuePath,this[key],__widgetId)}}else{var convertedValue=this[key];if(this.__boundData["DataConverter"]){var fnConvert=typeof this.__boundData["DataConverter"].convertBack==="function"?this.__boundData["DataConverter"].convertBack:this.__boundData["DataConverter"].convert;convertedValue=fnConvert(this[key])}data.setValue(valuePath,convertedValue,__widgetId)}}}},updateData:function(key){if(this.__boundData){if(key){this.__updateBoundData(key,this.id)}else{var keys=Object.keys(this.__boundData);this.__updateBoundData(keys,this.id)}}},__clearBindingInfo:function(){if(typeof this.__boundData==="object"){var keys=Object.keys(this.__boundData);for(var i=0,len=keys.length;i<len;i++){this.__isBoundData[keys[i]]=false;var bindingInfoList=this.__boundData[keys[i]];for(var j=0,len=bindingInfoList.length;j<len;j++){var data=Top.Util.namespace(bindingInfoList[j].dataName,this);var valuePath=bindingInfoList[j].valuePath;if(typeof data==="object"&&typeof data.__clearBindingInfo==="function")data.__clearBindingInfo(valuePath,this.id)}}}},__updateData:function(){if(typeof this.data==="string")this.dataModel=JSON.parse(this.data);if(typeof this.dataModel==="string")this.dataModel=JSON.parse(this.dataModel);if(this.__isBoundData===undefined)this.__isBoundData={};for(var prop in this.dataModel){this.__isBoundData[prop]=undefined}this.__initBoundData(true)},__updateDataModel:function(){if(typeof this.dataModel==="string")this.dataModel=JSON.parse(this.dataModel);if(this.__isBoundData===undefined)this.__isBoundData={};for(var prop in this.dataModel){this.__isBoundData[prop]=undefined}this.__initBoundData(true)}};TopDeviceBehavior={properties:{deviceModel:Object,__boundDevices:Object},ready:function(){if(this.deviceModel){this.__initBoundDevice()}},__initBoundDevice:function(){this.__boundDevices={};for(var prop in this.deviceModel){var valuePath=this.deviceModel[prop];var parts=valuePath.split(".");for(var i=0;i<parts.length;i++){if(Top.Util.namespace(parts[i])instanceof Top.Device){var device=Top.Util.namespace(parts[i]);var valuePath=valuePath.split(parts[i]+".")[1];break}}device.__addBoundWidget(valuePath,this.id,prop);this.__addBoundDevice(prop,device,valuePath);this[prop]=device.getValue(valuePath)}},__addBoundDevice:function(prop,device,valuePath){var bindingInfo={};bindingInfo.device=device;bindingInfo.valuePath=valuePath;this.__boundDevices[prop]=this.__boundDevices[prop]||[];this.__boundDevices[prop].push(bindingInfo)},__updateBoundDevices:function(key){if(typeof key==="object"){for(var i=0,len=key.length;i<len;i++){this.__updateBoundDevicesImpl(key[i])}}else{this.__updateBoundDevicesImpl(key)}},__updateBoundDevicesImpl:function(key){if(this.__boundDevices&&this.__boundDevices[key]){var bindingInfoList=this.__boundDevices[key];for(var i=0,len=bindingInfoList.length;i<len;i++){var device=bindingInfoList[i].device;var valuePath=bindingInfoList[i].valuePath;device.setValue(valuePath,this[key])}}},updateDevice:function(key){if(this.__boundDevices){if(key){this.__updateBoundDevices(key)}else{var keys=Object.keys(this.__boundDevices);this.__updateBoundDevices(keys)}}}};TopControlBehavior={properties:{controller:Object,controllerPath:String,__boundController:Object},ready:function(){if(Top.App.__compatibleWithTOP()){var _this=this;Top.App.onLoadUserLogic(function(){_this.__initController()})}else{this.__initController()}},__initController:function(){if(this.controller){this.__boundController=Top.Controller.get(this.controller);if(this.__boundController===undefined){console.error(this.controller+" is not defined.")}}if(Top.App.isLoaded()){this.__initControllerImpl()}else{var _this=this;Top.App.onLoad(function(){_this.__initControllerImpl()})}},__initControllerImpl:function(){if(this.__boundController&&this.__alreadyBound!==true){var _this=this;Top.App.onWidgetAttach(this.id,function(){if(typeof _this.__boundController.__setBoundWidget==="function")_this.__boundController.__setBoundWidget(_this.id)})}else{var controller=Top.Util.__searchController(this);if(controller!==undefined){this.__boundController=controller;if(controller instanceof Top.Controller===false||controller instanceof Top.Controller===true&&controller.isLoaded()===true){this.__initEvent()}else{var _this=this;Top.Controller.onLoad(controller,function(){_this.__initEvent()})}}this.__alreadyBound=true}},setController:function(controller){this.__boundController=controller},getController:function(){return this.__boundController}};TopI18nBehavior={__initI18n:function(prop){if(prop==="column"){if(Top.i18n.isLoaded()){this.__initI18nColumn(prop)}else{var _this=this;Top.i18n.onLoad(function(){this.__initI18nColumn(prop)})}return}if(typeof this[prop]==="string"){if(this.__i18nProps&&this.__i18nProps.hasOwnProperty(prop)){this[prop]=this.__i18nProps[prop]}var matches=this[prop].match(/\{\{(.*?)\}\}/);if(matches){if(this.__i18nProps===undefined)this.__i18nProps={};if(!this.__i18nProps.hasOwnProperty(prop))this.__i18nProps[prop]=this[prop];if(Top.i18n.isLoaded()){this[prop]=eval(matches[1]);if(typeof this.__updateProperties==="function")this.__updateProperties(prop);Top.i18n.__addBoundWidget(this)}else{var _this=this;Top.i18n.onLoad(function(){_this[prop]=eval(matches[1]);if(typeof _this.__updateProperties==="function")_this.__updateProperties(prop);Top.i18n.__addBoundWidget(_this)})}}}},__i18n:function(str){if(typeof str!=="string"||str==="")return str;var matches=str.match(/\{\{(.*?)\}\}/);if(matches!=null){return eval(matches[1])}else{return str}},__initI18nColumn:function(prop){if(this.__i18nProps&&this.__i18nProps.hasOwnProperty(prop)){this[prop]=this.__i18nProps[prop]}if(this.__i18nProps===undefined)this.__i18nProps={};if(typeof this[prop]==="object"){if(!this.__i18nProps.hasOwnProperty(prop)){this.__i18nProps[prop]=this[prop]}this[prop]=this.__i18nColumn(this[prop]);this.updateData(prop);if(typeof this.__updateProperties==="function")this.__updateProperties(prop);Top.i18n.__addBoundWidget(this)}else if(typeof this[prop]==="string"){if(!this.__i18nProps.hasOwnProperty(prop)){this.__i18nProps[prop]=Top.Util.namespace(this[prop],this)}this[prop]=this.__i18nColumn(Top.Util.namespace(this[prop],this));this.updateData(prop);if(typeof this.__updateProperties==="function")this.__updateProperties(prop);Top.i18n.__addBoundWidget(this)}},__i18nColumn:function(origCols){var keys=Object.keys(origCols);var cols=JSON.parse(JSON.stringify(keys));for(var i=0,len=keys.length;i<len;i++){var matches=keys[i].match(/\{\{(.*?)\}\}/);if(matches){cols[i]=eval(matches[1])}}return this.__renameColumns(JSON.parse(JSON.stringify(origCols)),keys,cols)},__renameColumns:function(colObj,oldCols,newCols){for(var i=0,len=oldCols.length;i<len;i++){if(oldCols[i]!==newCols[i]){Object.defineProperty(colObj,newCols[i],Object.getOwnPropertyDescriptor(colObj,oldCols[i]));delete colObj[oldCols[i]]}}return colObj},__updateI18n:function(){var props=Object.keys(this.__i18nProps);for(var i=0,len=props.length;i<len;i++){this.__initI18n(props[i])}if(props.length===0&&this.tagName==="TOP-TABLEVIEW"&&this.isIDETableview){this.__loadI18nForTable()}}};TopCommonStyleBehavior={properties:{disabled:{value:"false"},__derivedDisabled:String,opacity:String,background:String,backgroundColor:String,backgroundImage:String,tileMode:String,maxWidth:String,minWidth:String,maxHeight:String,minHeight:String,lineHeight:String,padding:String,margin:String,visible:String,display:String,zIndex:String,float:String,position:String,horizontalAlignment:{type:String,reflectToAttribute:true},verticalAlignment:{type:String,reflectToAttribute:true},layoutHorizontalAlignment:{type:String,reflectToAttribute:true},layoutVerticalAlignment:{type:String,reflectToAttribute:true},layoutHeight:{type:String,reflectToAttribute:true},layoutWidth:{type:String,reflectToAttribute:true},layoutAlignParent:{type:String,reflectToAttribute:true},layoutRow:{type:String,reflectToAttribute:true},layoutColumn:{type:String,reflectToAttribute:true},layoutRowSpan:{type:String,reflectToAttribute:true},layoutColumnSpan:{type:String,reflectToAttribute:true},layoutTop:{type:String,reflectToAttribute:true},layoutLeft:{type:String,reflectToAttribute:true},layoutRight:{type:String,reflectToAttribute:true},layoutBottom:{type:String,reflectToAttribute:true},layoutTabName:{type:String,reflectToAttribute:true},layoutTabIcon:{type:String,reflectToAttribute:true},layoutTabDisabled:{type:Boolean,reflectToAttribute:true,value:false},layoutWeight:{type:String,reflectToAttribute:true},layoutSplitLocation:String,borderWidth:{type:String,reflectToAttribute:true},borderBottomWidth:String,borderLeftWidth:String,borderRightWidth:String,borderTopWidth:String,borderStyle:String,borderColor:String,borderTopColor:String,borderRightColor:String,borderBottomColor:String,borderLeftColor:String,borderRadius:String,verticalScroll:String,horizontalScroll:String,topstyle:{type:String},width:String,height:String,top:String,left:String,bottom:String,right:String,marginTop:String,marginRight:String,marginBottom:String,marginLeft:String,resize:String,cursor:String,animation:String,wordWrap:String,wordBreak:String,whiteSpace:String,textDecoration:String,textOverflow:String,textTransform:String,transition:String,letterSpacing:String,wordSpacing:String,fontWeight:String,fontFamily:String,backgroundPosition:String,backgroundRepeat:String,backgroundSize:String,boxShadow:String},ready:function(){this.__initI18n("layoutTabName")},updateStyle:function(keys){var layoutRenderFlag=false;if(keys!=null&&typeof keys==="object"){for(var i=0;i<keys.length;i++){if(!layoutRenderFlag){if(keys[i]==="layoutAlignParent"||keys[i]==="layoutRow"||keys[i]==="layoutColumn"||keys[i]==="layoutRowSpan"||keys[i]==="layoutColumnSpan"||keys[i]==="layoutTop"||keys[i]==="layoutLeft"||keys[i]==="layoutRight"||keys[i]==="layoutBottom"||keys[i]==="layoutTabName"||keys[i]==="layoutTabIcon"||keys[i]==="layoutTabDisabled"||keys[i]==="layoutWeight"||keys[i]==="layoutHorizontalAlignment"||keys[i]==="layoutVerticalAlignment"){layoutRenderFlag=true;break}}}if(layoutRenderFlag){this.layoutParent.renderLayout()}}else if(typeof keys==="string"){stylekey=keys.replace(/[A-Z]/g,function(match){return"-"+match.toLowerCase()});var stylekeyMap=[["b-image","backgroundImage"],["tile-mode","background-repeat"],["text-color","color"],["horizontal-alignment","text-align"],["layout-vertical-alignment","vertical-align"],["horizontal-scroll","overflow-x"],["vertical-scroll","overflow-y"]];for(var j=0;j<stylekeyMap.length;j++){if(stylekey===stylekeyMap[j][0]){stylekey=stylekeyMap[j][1];if(stylekey==="overflow-x"||stylekey==="overflow-y"){if(this[keys]==="true"||this[keys]===true)this[keys]="auto";else if(this[keys]==="false"||this[keys]===false)this[keys]="hidden"}this.removeTopStyle(stylekey);this.setTopStyle(stylekey,this[keys]);return}}this.removeTopStyle(stylekey);this.setTopStyle(stylekey,this[keys]);if((stylekey==="margin"||stylekey==="padding")&&typeof this.__updateHighlightConfig==="function"){this.__updateHighlightConfig()}return}this.topstyle="";this.setAllTopStyle();var bImage=this.backgroundImage;this.updatePositionValue(true);if(this.backgroundImage!=null){if(!this.backgroundImage.includes("url(")){if(this.backgroundImage.includes("@drawable")){bImage=Top.DrawableManager.get(this.backgroundImage.replace("@drawable/",""))}bImage="url('"+bImage+"')"}this.setTopStyle("background-size",this.backgroundSize);this.setTopStyle("background-repeat",this.backgroundRepeat);if(!this.backgroundSize&&!this.backgroundRepeat){if(this.tileMode==null||this.tileMode==="")this.tileMode="stretch";if(this.tileMode==="stretch")this.setTopStyle("background-size","cover");else{this.setTopStyle("background-repeat",this.tileMode)}}}if(this.verticalAlignment==null){this.verticalAlignment="middle"}if(this.verticalScroll==="true"||this.verticalScroll===true)this.verticalScroll="auto";if((this.horizontalScroll==="true"||this.horizontalScroll===true)&&this.tagName!=="TOP-TABLEVIEW")this.horizontalScroll="auto";if(this.verticalScroll==="false"||this.verticalScroll===false)this.verticalScroll="hidden";if(this.horizontalScroll==="false"||this.horizontalScroll===false)this.horizontalScroll="hidden";if(this.borderWidth!=null||this.borderColor!=null){if(this.borderStyle==null){this.borderStyle="solid"}}if(this.textOverflow==="ellipsis"){this.overflow="hidden";this.whiteSpace="nowrap"}this.__updateVisible();this.__updateLayoutWidth();this.__updateLayoutHeight();this.__updateLayoutTop();this.__updateLayoutLeft();this.__updateLayoutRight();this.__updateLayoutBottom();this.__updateTextStyle();this.setTopStyle("max-width",this.maxWidth);this.setTopStyle("min-width",this.minWidth);this.setTopStyle("max-height",this.maxHeight);this.setTopStyle("min-height",this.minHeight);this.setTopStyle("line-height",this.lineHeight);this.setTopStyle("background-color",this.backgroundColor);this.setTopStyle("background-image",bImage);this.setTopStyle("background-repeat",this.tileMode);this.setTopStyle("background",this.background);this.setTopStyle("opacity",this.opacity);this.setTopStyle("margin",this.margin);this.setTopStyle("padding",this.padding);this.setTopStyle("color",this.textColor);this.setTopStyle("font-size",this.textSize);this.setTopStyle("border-width",this.borderWidth);this.setTopStyle("border-bottom-width",this.borderBottomWidth);this.setTopStyle("border-left-width",this.borderLeftWidth);this.setTopStyle("border-right-width",this.borderRightWidth);this.setTopStyle("border-top-width",this.borderTopWidth);this.setTopStyle("border-style",this.borderStyle);this.setTopStyle("border-color",this.borderColor);this.setTopStyle("border-top-color",this.borderTopColor);this.setTopStyle("border-right-color",this.borderRightColor);this.setTopStyle("border-bottom-color",this.borderBottomColor);this.setTopStyle("border-left-color",this.borderLeftColor);this.setTopStyle("border-radius",this.borderRadius);this.setTopStyle("z-index",this.zIndex);this.setTopStyle("position",this.position);this.setTopStyle("float",this.float);if(this.cursor){var root=this.tagName==="TOP-CHECKBOX"||this.tagName==="TOP-RADIOBUTTON"?this.querySelector("."+this.tagName.toLowerCase()+"-text"):this.getElement(),rootChildren=root.querySelectorAll("*");root.style["cursor"]=this.cursor;this.topstyle=root.style.cssText;for(var k=0;k<rootChildren.length;k++){rootChildren[k].style["cursor"]=this.cursor}}this.setTopStyle("text-align",this.horizontalAlignment);this.setTopStyle("vertical-align",this.layoutVerticalAlignment);this.setTopStyle("animation",this.animation);this.setTopStyle("word-wrap",this.wordWrap);this.setTopStyle("word-break",this.wordBreak);this.setTopStyle("white-space",this.whiteSpace);this.setTopStyle("text-decoration",this.textDecoration);this.setTopStyle("text-overflow",this.textOverflow);this.setTopStyle("overflow",this.overflow);this.setTopStyle("text-transform",this.textTransform);this.setTopStyle("transition",this.transition);this.setTopStyle("letter-spacing",this.letterSpacing);this.setTopStyle("word-spacing",this.wordSpacing);this.setTopStyle("font-weight",this.fontWeight);this.setTopStyle("font-family",this.fontFamily);this.setTopStyle("background-position",this.backgroundPosition);this.setTopStyle("background-repeat",this.backgroundRepeat);this.setTopStyle("background-size",this.backgroundSize);this.setTopStyle("box-shadow",this.boxShadow);this.__updateHorizontalScroll();this.__updateVerticalScroll();if(this.tagName==="TOP-TABLEVIEW"&&this.dataTable){this.dataTable.draw(false)}if(this.resize!==undefined){this.setTopStyle("resize",this.resize)}},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}this.setAllTopStyle()},removeTopStyle:function(key){var checkStyle=new RegExp("^("+key+")[ ]*:[-+*/(),.%a-z0-9 ]+;|[ ]+("+key+")[ ]*:[-+*/(),.%a-z0-9 ]+;","g");var checkStyle2=new RegExp(";("+key+")[ ]*:[-+*/(),.%a-z0-9 ]+;","g");this.topstyle=this.getTopStyle().replace(checkStyle,"");this.topstyle=this.topstyle.replace(checkStyle2,";");if(this.topstyle.startsWith(";"))this.topstyle=this.topstyle.replace(";","");this.setAllTopStyle()},getTopStyle:function(){return this.topstyle},updatePositionValue:function(__isfromUpdateStyle){if(__isfromUpdateStyle){this.splitMargin();this.splitPadding();this.splitBorder();this.splitBorderColor()}},splitMargin:function(){if(this.margin){var temp=this.margin.split(" ");if(temp.length==1){this.marginTop=this.marginRight=this.marginBottom=this.marginLeft=temp[0]}else if(temp.length==2){this.marginTop=this.marginBottom=temp[0];this.marginRight=this.marginLeft=temp[1]}else if(temp.length==4){this.marginTop=temp[0];this.marginRight=temp[1];this.marginBottom=temp[2];this.marginLeft=temp[3]}}else{if(!this.marginTop)this.marginTop=0;if(!this.marginRight)this.marginRight=0;if(!this.marginBottom)this.marginBottom=0;if(!this.marginLeft)this.marginLeft=0}},splitPadding:function(){if(this.padding){var temp=this.padding.split(" ");if(temp.length==1){this.paddingTop=this.paddingRight=this.paddingBottom=this.paddingLeft=temp[0]}else if(temp.length==2){this.paddingTop=this.paddingBottom=temp[0];this.paddingRight=this.paddingLeft=temp[1]}else if(temp.length==4){this.paddingTop=temp[0];this.paddingRight=temp[1];this.paddingBottom=temp[2];this.paddingLeft=temp[3]}}else{if(!this.paddingTop)this.paddingTop=0;if(!this.paddingRight)this.paddingRight=0;if(!this.paddingBottom)this.paddingBottom=0;if(!this.paddingLeft)this.paddingLeft=0}},splitBorder:function(){if(this.borderWidth){var tmpBorderWidth=this.borderWidth.split(" ");if(tmpBorderWidth.length==1){this.borderTopWidth=this.borderRightWidth=this.borderBottomWidth=this.borderLeftWidth=tmpBorderWidth[0]}else if(tmpBorderWidth.length==2){this.borderTopWidth=this.borderBottomWidth=tmpBorderWidth[0];this.borderRightWidth=this.borderLeftWidth=tmpBorderWidth[1]}else if(tmpBorderWidth.length==4){this.borderTopWidth=tmpBorderWidth[0];this.borderRightWidth=tmpBorderWidth[1];this.borderBottomWidth=tmpBorderWidth[2];this.borderLeftWidth=tmpBorderWidth[3]}}else{if(!this.borderTopWidth)this.borderTopWidth=0;if(!this.borderRightWidth)this.borderRightWidth=0;if(!this.borderBottomWidth)this.borderBottomWidth=0;if(!this.borderLeftWidth)this.borderLeftWidth=0}},splitBorderColor:function(){if(this.borderColor){var tmpBorderColor=this.borderColor.split(" ");if(tmpBorderColor.length==1){this.borderTopColor=this.borderRightColor=this.borderBottomColor=this.borderLeftColor=tmpBorderColor[0]}else if(tmpBorderColor.length==2){this.borderTopColor=this.borderBottomColor=tmpBorderColor[0];this.borderRightColor=this.borderLeftColor=tmpBorderColor[1]}else if(tmpBorderColor.length==4){this.borderTopColor=tmpBorderColor[0];this.borderRightColor=tmpBorderColor[1];this.borderBottomColor=tmpBorderColor[2];this.borderLeftColor=tmpBorderColor[3]}}},__updateVisible:function(){if(typeof this.__updateVisibleInternal==="function")this.__updateVisibleInternal();this.removeTopStyle("visibility");if(this.visible===true||this.visible==="true")this.visible="visible";if(this.visible===false||this.visible==="false")this.visible="hidden";this.__updateDisplay();this.setTopStyle("visibility",this.visible)},__updateDisplay:function(){if(this.display==="none"||this.visible=="none"){this.style.display="none"}else{this.style.display=""}},__updateLayoutWidth:function(){var borderRightWidth=this.borderRightWidth||0;var borderLeftWidth=this.borderLeftWidth||0;var layoutWidth=this.layoutWidth;if(this.tagName==="TOP-PANEL"||this.tagName==="TOP-TABLEVIEW"){if(this.layoutWidth==null){layoutWidth="calc(100% - "+(parseInt(this.marginRight)+parseInt(this.marginLeft)+parseInt(this.paddingRight)+parseInt(this.paddingLeft)+parseInt(borderRightWidth)+parseInt(borderLeftWidth))+"px)"}}if(this.tagName!=="TOP-CHART"&&this.layoutWidth&&this.layoutWidth.endsWith("%")){layoutWidth="calc("+this.layoutWidth+" - "+(parseInt(this.marginRight)+parseInt(this.marginLeft)+parseInt(this.paddingRight)+parseInt(this.paddingLeft)+parseInt(borderRightWidth)+parseInt(borderLeftWidth))+"px)"}if((this.tagName==="TOP-SWITCH"||this.tagName==="TOP-DATEPICKER")&&this.layoutWidth==="auto")return;if(this.tagName==="TOP-PROGRESSBAR"&&this.layoutWidth==="auto")return;if(this.layoutWidth==="match_parent")return;this.removeTopStyle("width");this.setTopStyle("width",layoutWidth);this.updatePositionValue(false);var _this=this;setTimeout(function(){if(typeof _this.__initTooltip==="function")_this.__initTooltip()})},__updateLayoutHeight:function(){if(this.tagName==="TOP-PANEL"||this.tagName==="TOP-TABLEVIEW"){if(this.tagName==="TOP-PANEL"&&this.layoutHeight==null){this.layoutHeight="auto"}}if(!this.layoutHeight)return;var layoutHeight=this.layoutHeight;if(layoutHeight.indexOf("%")!==-1){if(this.parentNode!==null){var parentlinear=this.parentNode.parentNode;if(parentlinear&&parentlinear.tagName==="TOP-LINEARLAYOUT"&&parentlinear.getAttribute("orientation")==="vertical"){
this.style.height=this.layoutHeight;layoutHeight="100%"}}}if(this.tagName!=="TOP-CHART"&&layoutHeight.endsWith("%")){var boxing=parseInt(this.marginTop)+parseInt(this.marginBottom)+parseInt(this.paddingTop)+parseInt(this.paddingBottom)+parseInt(this.borderTopWidth)+parseInt(this.borderBottomWidth);if(boxing>0){layoutHeight="calc("+layoutHeight+" - "+boxing+"px)"}}if((this.tagName==="TOP-SWITCH"||this.tagName==="TOP-DATEPICKER"||this.tagName==="TOP-PROGRESSBAR")&&this.layoutHeight==="auto")return;if(this.layoutHeight==="match_parent")return;this.removeTopStyle("height");this.setTopStyle("height",layoutHeight);this.updatePositionValue(false)},__updateLayoutTop:function(){if(!this.layoutParent||this.layoutParent&&this.layoutParent.tagName!="TOP-ABSOLUTELAYOUT"){if(this.__isCustomChild!==true){this.removeTopStyle("top");this.setTopStyle("top",this.layoutTop)}}else if(this.layoutParent&&this.layoutParent.tagName==="TOP-ABSOLUTELAYOUT"){var pPaddingTop=parseFloat(this.layoutParent.paddingTop)||0;if(this.layoutTop&&this.layoutTop.includes("%")){var layoutTop="calc("+this.layoutTop+" + "+pPaddingTop+"px)"}else{var layoutTop=parseInt(this.layoutTop)+pPaddingTop+"px"}this.style.top=layoutTop}},__updateLayoutLeft:function(){if(!this.layoutParent||this.layoutParent&&this.layoutParent.tagName!="TOP-ABSOLUTELAYOUT"){if(this.__isCustomChild!==true){this.removeTopStyle("left");this.setTopStyle("left",this.layoutLeft)}}else if(this.layoutParent&&this.layoutParent.tagName==="TOP-ABSOLUTELAYOUT"){var pPaddingLeft=parseFloat(this.layoutParent.paddingLeft)||0;if(this.layoutLeft&&this.layoutLeft.includes("%")){var layoutLeft="calc("+this.layoutLeft+" + "+pPaddingLeft+"px)"}else{var layoutLeft=parseInt(this.layoutLeft)+pPaddingLeft+"px"}this.style.left=layoutLeft}},__updateLayoutRight:function(){if(!this.layoutParent||this.layoutParent&&this.layoutParent.tagName!="TOP-ABSOLUTELAYOUT"){this.removeTopStyle("right");this.setTopStyle("right",this.layoutRight)}},__updateLayoutBottom:function(){if(!this.layoutParent||this.layoutParent&&this.layoutParent.tagName!="TOP-ABSOLUTELAYOUT"){this.removeTopStyle("bottom");this.setTopStyle("bottom",this.layoutBottom)}},__updateTextStyle:function(){if(this.textStyle===undefined)return;if(this.textStyle==="none"||this.textStyle===""){this.removeTopStyle("font-weight");this.removeTopStyle("font-style");this.removeTopStyle("text-decoration");return}var textStyleArray=this.textStyle.split("|");for(var i=0;i<textStyleArray.length;i++){textStyleArray[i]=textStyleArray[i].replace(/ /g,"");if(textStyleArray[i]==="bold"){this.removeTopStyle("font-weight");this.setTopStyle("font-weight","bold")}if(textStyleArray[i]==="italic"){this.removeTopStyle("font-style");this.setTopStyle("font-style","italic")}if(textStyleArray[i]==="underline"){this.removeTopStyle("text-decoration");this.setTopStyle("text-decoration","underline")}}},__updateTextColor:function(){this.removeTopStyle("color");this.setTopStyle("color",this.textColor)},__updateTextSize:function(){this.removeTopStyle("font-size");this.setTopStyle("font-size",this.textSize)},__updateDisabled:function(){},__updateLayoutTabName:function(){if(this.layoutParent&&typeof this.layoutParent.refresh==="function"){this.layoutParent.__updateLayoutTabName()}},__updateHorizontalScroll:function(){this.setTopStyle("overflow-x",this.horizontalScroll)},__updateVerticalScroll:function(){this.setTopStyle("overflow-y",this.verticalScroll)},calculateDerivedDisabled:function(){return this.__derivedDisabled==="true"||this.__derivedDisabled===true?"true":this.disabled},setThisWidgetWidth:function(parentWidth,parentElement){var borderRightWidth=this.borderRightWidth||0;var borderLeftWidth=this.borderLeftWidth||0;var layoutWidth=parseInt(this.marginRight)+parseInt(this.marginLeft);if(layoutWidth>0)layoutWidth="calc("+parentWidth+" - "+layoutWidth+"px)";else if(parentWidth.includes("-"))layoutWidth="calc("+parentWidth+")";else layoutWidth=parentWidth;this.removeTopStyle("width");this.setTopStyle("width",layoutWidth);return layoutWidth},setThisWidgetHeight:function(parentHeight){var checkWeightValue;var borderTopWidth=this.borderTopWidth||0;var borderBottomWidth=this.borderBottomWidth||0;var layoutHeight=parseInt(this.marginTop)+parseInt(this.marginBottom);if(layoutHeight>0)layoutHeight="calc("+parentHeight+" - "+layoutHeight+"px)";else if(parentHeight.includes("-"))layoutHeight="calc("+parentHeight+")";else layoutHeight=parentHeight;this.removeTopStyle("height");this.setTopStyle("height",layoutHeight);if(this.tagName==="TOP-TEXTFIELD"&&this.icon!==null&&this.icon!==""&&this.icon!==undefined)this.setIconPosition();return layoutHeight}};TopEventBehavior={properties:{eventMouseClick:String,eventMouseEnter:String,eventMouseExit:String,eventMouseMove:String,eventMousePressed:String,eventMouseReleased:String,eventMouseDblclick:String,eventKeyPressed:String,eventKeyReleased:String,eventKeyTyped:String,eventFocused:String,eventLostFocused:String,eventChanged:String,eventSecondaryClick:String,eventDrag:String,eventDragend:String,eventDragenter:String,eventDragexit:String,eventDragleave:String,eventDragover:String,eventDragstart:String,eventDrop:String,eventCopy:String,eventPaste:String,__initEventList:Array,__eventMap:Object,__coreEventMap:Object,onKeydown:String,onKeypress:String,onKeyup:String,onMouseenter:String,onMouseover:String,onMousemove:String,onMousedown:String,onMouseup:String,onClick:String,onDblclick:String,onContextmenu:String,onWheel:String,onMouseleave:String,onPointerlockchange:String,onPointerlockerror:String,onDragstart:String,onDrag:String,onDragend:String,onDragenter:String,onDragover:String,onDragleave:String,onDrop:String,onCopy:String,onPaste:String,onFocus:String,onBlur:String,onError:String,widgetDraggable:String},__initEvent:function(){this.__clearEvents();this.__createUserFn("eventMouseClick");this.__createUserFn("eventMouseEnter");this.__createUserFn("eventMouseExit");this.__createUserFn("eventMouseMove");this.__createUserFn("eventMousePressed");this.__createUserFn("eventMouseReleased");this.__createUserFn("eventMouseDblclick");this.__createUserFn("eventKeyPressed");this.__createUserFn("eventKeyReleased");this.__createUserFn("eventKeyTyped");this.__createUserFn("eventFocused");this.__createUserFn("eventLostFocused");this.__createUserFn("eventChanged");this.__createUserFn("eventSecondaryClick");this.__initDragAndDrop();this.__createUserFn("eventCopy");this.__createUserFn("eventPaste");this.__addEventByAttr("keydown");this.__addEventByAttr("keypress");this.__addEventByAttr("keyup");this.__addEventByAttr("mouseenter");this.__addEventByAttr("mouseover");this.__addEventByAttr("mousemove");this.__addEventByAttr("mousedown");this.__addEventByAttr("mouseup");this.__addEventByAttr("click");this.__addEventByAttr("clear");this.__addEventByAttr("dblclick");this.__addEventByAttr("contextmenu");this.__addEventByAttr("wheel");this.__addEventByAttr("mouseleave");this.__addEventByAttr("pointerlockchange");this.__addEventByAttr("pointerlockerror");this.__initDraggable();this.__addEventByAttr("dragstart");this.__addEventByAttr("drag");this.__addEventByAttr("dragend");this.__addEventByAttr("dragenter");this.__addEventByAttr("dragover");this.__addEventByAttr("dragleave");this.__addEventByAttr("drop");this.__addEventByAttr("copy");this.__addEventByAttr("paste");this.__addEventByAttr("focus");this.__addEventByAttr("blur");this.__addEventByAttr("error");if(typeof this.__initEventInternal==="function")this.__initEventInternal()},__createUserFn:function(name,args){if(Top.App.__compatibleWithTOP()){this.__createUserFnWithTOP(name);return}if(typeof this[name]==="string"){var fn=Top.Util.namespace(this[name],this);var controller=this.getController();var _this=this;this.__addEventFn(name,function(event){if(typeof fn==="function"){if(typeof args==="object"){fn.apply(controller,args)}else{fn.call(controller,event,Top.Dom.selectById(_this.id))}}else if(_this[name]!==""){console.warn(_this[name]+" is not defined.")}})}},__createUserFnWithTOP:function(name){if(typeof this[name]==="string"&&this[name]!==""){var fn=Top.Util.namespace(this[name],this);var _this=this;this.__addEventFn(name,function(event){if(typeof fn==="function"){fn(event,Top.Dom.selectById(_this.id))}else if(typeof fn==="object"){if(fn.type==="device"){fn.device[fn.fn]()}else{fn.fn(event,Top.Dom.selectById(_this.id))}}else{console.warn(_this[name]+" is not defined.")}})}},__updateEventFn:function(name){if(this.__eventMap===undefined)this.__eventMap={};if(this.__eventMap[name]===undefined)this.__eventMap[name]=[];if(typeof this.__coreEventMap==="object"&&typeof this.__coreEventMap[name]==="object"){var events=this.__eventMap[name].concat(this.__coreEventMap[name])}else{var events=this.__eventMap[name]}var len=events.length;if(len>0){var _this=this;this["__".concat(name)]=function(event){for(var i=0;i<len;i++){if(typeof events[i]==="function")events[i](event,Top.Dom.selectById(_this.id))}};if(typeof this.__eventBindingList==="function"){var list=this.__eventBindingList();if(typeof list["__".concat(name)]==="function")list["__".concat(name)](this["__".concat(name)])}}},__addEventFn:function(name,fn){if(this.__eventMap===undefined)this.__eventMap={};if(this.__eventMap[name]===undefined)this.__eventMap[name]=[];this.__eventMap[name].push(fn);this.__updateEventFn(name)},__addEventFnByCore:function(name,fn){if(this.__coreEventMap===undefined)this.__coreEventMap={};if(this.__coreEventMap[name]===undefined)this.__coreEventMap[name]=[];this.__coreEventMap[name].push(fn);this.__updateEventFn(name)},__removeEventFn:function(name){if(typeof this.__eventMap==="object"&&typeof this.__eventMap[name]==="object"){delete this.__eventMap[name]}this.__updateEventFn(name)},__clearEvents:function(){if(typeof this.__eventMap==="object"){var keys=Object.keys(this.__eventMap);for(var i=0,len=keys.length;i<len;i++){delete this.__eventMap[keys[i]]}delete this.__eventMap}},__initDragAndDrop:function(){var __fnDrag=Top.Util.namespace(this.eventDrag,this);if(typeof __fnDrag==="function"){this.addEventListener("drag",function(event){__fnDrag(event)})}var __fnDragend=Top.Util.namespace(this.eventDragend,this);if(typeof __fnDragend==="function"){this.addEventListener("dragend",function(event){__fnDragend(event)})}var __fnDragenter=Top.Util.namespace(this.eventDragenter,this);if(typeof __fnDragenter==="function"){this.addEventListener("dragenter",function(event){__fnDragenter(event)})}var __fnDragexit=Top.Util.namespace(this.eventDragexit,this);if(typeof __fnDragexit==="function"){this.addEventListener("dragexit",function(event){__fnDragexit(event)})}var __fnDragleave=Top.Util.namespace(this.eventDragleave,this);if(typeof __fnDragleave==="function"){this.addEventListener("dragleave",function(event){__fnDragleave(event)})}var __fnDragover=Top.Util.namespace(this.eventDragover,this);if(typeof __fnDragover==="function"){this.addEventListener("dragover",function(event){__fnDragover(event)})}var __fnDragstart=Top.Util.namespace(this.eventDragstart,this);if(typeof __fnDragstart==="function"){this.addEventListener("dragstart",function(event){__fnDragstart(event)})}var __fnDrop=Top.Util.namespace(this.eventDrop,this);if(typeof __fnDrop==="function"){this.addEventListener("drop",function(event){__fnDrop(event)})}},__initDraggable:function(){if(this.widgetDraggable===undefined)this.widgetDraggable=true},__updateEventMouseClick:function(){this.__removeEventFn("eventMouseClick");this.__createUserFn("eventMouseClick")},__updateEventMouseEnter:function(){this.__removeEventFn("eventMouseEnter");this.__createUserFn("eventMouseEnter")},__updateEventMouseExit:function(){this.__removeEventFn("eventMouseExit");this.__createUserFn("eventMouseExit")},__updateEventMouseMove:function(){this.__removeEventFn("eventMouseMove");this.__createUserFn("eventMouseMove")},__updateEventMousePressed:function(){this.__removeEventFn("eventMousePressed");this.__createUserFn("eventMousePressed")},__updateEventMouseReleased:function(){this.__removeEventFn("eventMouseReleased");this.__createUserFn("eventMouseReleased")},__updateEventMouseDblclick:function(){this.__removeEventFn("eventMouseDblclick");this.__createUserFn("eventMouseDblclick")},__updateEventKeyPressed:function(){this.__removeEventFn("eventKeyPressed");this.__createUserFn("eventKeyPressed")},__updateEventKeyReleased:function(){this.__removeEventFn("eventKeyReleased");this.__createUserFn("eventKeyReleased")},__updateEventKeyTyped:function(){this.__removeEventFn("eventKeyTyped");this.__createUserFn("eventKeyTyped")},__updateEventFocused:function(){this.__removeEventFn("eventFocused");this.__createUserFn("eventFocused")},__updateEventLostFocused:function(){this.__removeEventFn("eventLostFocused");this.__createUserFn("eventLostFocused")},__updateEventChanged:function(){this.__removeEventFn("eventChanged");this.__createUserFn("eventChanged")},__updateEventSecondaryClick:function(){this.__removeEventFn("eventSecondaryClick");this.__createUserFn("eventSecondaryClick")},__updateEventCopy:function(){this.__removeEventFn("eventCopy");this.__createUserFn("eventCopy")},__updateEvenPaste:function(){this.__removeEventFn("evenPaste");this.__createUserFn("evenPaste")},__addEventByAttr:function(type){var attrName="on".concat(Top.Util.capitalizeFirstLetter(type));if(!this[attrName])return;if(typeof this[attrName]==="string"){var _this=this;var fnName=type.concat("_anonymous");this.__removeEventListener(type,fnName);this[fnName]=function(event){var fn=Top.Util.namespace(_this[attrName],_this);if(typeof fn==="function"){if(typeof event.detail==="object"){event.state=fn.call(_this.getController(),event,Top.Dom.selectById(_this.id),event.detail)}else{event.state=fn.call(_this.getController(),event,Top.Dom.selectById(_this.id))}}else if(typeof fn==="object"){if(fn.type==="device"){event.state=fn.device[fn.fn]()}else{event.state=fn.fn(event,Top.Dom.selectById(_this.id))}}else{console.warn(_this[attrName]+" is not defined.")}};this.__addEventListener(type,this[fnName])}else if(typeof this[attrName]==="function"){var _this=this;var fnName=type.concat("_anonymous");this.__removeEventListener(type,fnName);this[fnName]=function(event){var fn=_this[attrName];if(typeof fn==="function"){if(typeof event.detail==="object"){event.state=fn.call(_this.getController(),event,Top.Dom.selectById(_this.id),event.detail)}else{event.state=fn.call(_this.getController(),event,Top.Dom.selectById(_this.id))}}else if(typeof fn==="object"){if(fn.type==="device"){event.state=fn.device[fn.fn]()}else{event.state=fn.fn(event,Top.Dom.selectById(_this.id))}}else{console.warn(_this[attrName]+" is not defined.")}};this.__addEventListener(type,this[fnName])}},__removeEventByAttr:function(type){var attrName="on".concat(Top.Util.capitalizeFirstLetter(type));if(!this[attrName])return;var _this=this;var fnName=type.concat("_anonymous");this.__removeEventListener(type,fnName)},__addEventListener:function(type,listener,options){if(type==="focus"||type==="blur"||(type==="keydown"||type==="keyup")&&(this.tagName==="TOP-TEXTFIELD"||this.tagName==="TOP-TEXTAREA")){var element=this.__getFocusableElement()}else if(type==="dragstart"||type==="drag"||type==="dragover"||type==="dragenter"||type==="dragend"||type==="dragleave"||type==="drop"){var element=this.__getDragableElement();if(element!=null)element.setAttribute("draggable",this.widgetDraggable)}else if(type==="copy"||type=="paste"){var element=this.__getCopyableElement()}else{var element=this.getEventElement()}if(element!==undefined&&element!==null){if(typeof listener==="string"){element.addEventListener(type,Top.Util.namespace(listener),options)}else if(typeof listener==="function"){element.addEventListener(type,listener,options)}}},__removeEventListener:function(type,listener,options){if(type==="focus"||type==="blur"||(type==="keydown"||type==="keyup")&&(this.tagName==="TOP-TEXTFIELD"||this.tagName==="TOP-TEXTAREA")){var element=this.__getFocusableElement()}else if(type==="dragstart"||type==="drag"||type==="dragover"||type==="dragenter"||type==="dragend"||type==="dragleave"||type==="drop"){var element=this.__getDragableElement();if(element!=null)element.setAttribute("draggable",this.widgetDraggable)}else if(type==="copy"||type=="paste"){var element=this.__getCopyableElement()}else{var element=this.getEventElement()}if(element!=null){if(typeof listener==="string"){element.removeEventListener(type,this[listener],options);element.removeEventListener(type,Top.Util.namespace(listener),options)}else if(typeof listener==="function"){element.removeEventListener(type,listener,options)}}},__dispatchEvent:function(event){if(event.type==="focus"||event.type==="blur"||(event.type==="keydown"||event.type==="keyup")&&(this.tagName==="TOP-TEXTFIELD"||this.tagName==="TOP-TEXTAREA")){var element=this.__getFocusableElement()}else if(event.type==="dragstart"||event.type==="drag"||event.type==="dragover"||event.type==="dragenter"||event.type==="dragend"||event.type==="dragleave"||event.type==="drop"){var element=this.__getDragableElement();element.setAttribute("draggable",this.widgetDraggable)}else if(event.type==="dragstart"||event.type==="drag"||event.type==="dragover"||event.type==="dragenter"||event.type==="dragend"||event.type==="dragleave"||event.type==="drop"){var element=this.__getDragableElement();element.setAttribute("draggable",this.widgetDraggable)}else{var element=this.getEventElement()}if(element!==null){element.dispatchEvent(event)}return event.state},__getFocusableElement:function(){if(this.tagName==="TOP-TEXTFIELD"||this.tagName==="TOP-SPINNER"||this.tagName==="TOP-DATEPICKER"){return this.getEventElement("input")[0]}else if(this.tagName==="TOP-TEXTAREA"){return this.getEventElement("textarea")[0]}else if(this.tagName==="TOP-IMAGEVIEW"||this.tagName==="TOP-SELECTBOX"){return this.firstElementChild}else if(this.tagName==="TOP-CHIP"){return this.getEventElement("input")[0]}else{return null}},__getDragableElement:function(){var element;if(this.tagName==="TOP-TABLEVIEW"){return this.querySelector("div#"+this.id)}else if(this.tagName==="TOP-IMAGESLIDER"){return this}else if(this.tagName==="TOP-RADIOBUTTON"||this.tagName==="TOP-CHECKBOX"){return this.querySelector("label")}else{return this.firstElementChild}},__getCopyableElement:function(){var element;if(this.tagName==="TOP-RADIOBUTTON"||this.tagName==="TOP-CHECKBOX"){return this.querySelector("label")}else{return this.firstElementChild}},getEventElement:function(selector){return this.getElement(selector)}};TopWidgetBehaviorImpl={properties:{id:{type:String,reflectToAttribute:true},name:{type:String,reflectToAttribute:true},class:{type:String,value:""},description:String,value:{type:String,reflectToAttribute:true},tooltip:String,tooltipTop:{type:String,reflectToAttribute:true},tooltipBottom:{type:String,reflectToAttribute:true},tooltipLeft:{type:String,reflectToAttribute:true},tooltipRight:{type:String,reflectToAttribute:true},menu:{type:String,reflectToAttribute:true},popover:{type:String,reflectToAttribute:true},placement:{type:String,reflectToAttribute:true},title:{type:String,reflectToAttribute:true,value:""},layoutParent:{type:String,reflectToAttribute:true},actionParameter:{type:Object,reflectToAttribute:true},index:{type:String,reflectToAttribute:true},popoverId:String,popoverTrigger:{type:String,value:"click"},popoverTarget:String,dialogId:String,dialogTrigger:{type:String,value:"click"},notificationId:String,notificationTrigger:{type:String,value:"click"}},__updateProperties:function(key){if(this.tagName==="TOP-TREEVIEW"&&!this.__needsImpl(key)){this.__reRender();return}if(typeof key==="object"){for(var i=0,len=key.length;i<len;i++){this.__updatePropertiesImpl(key[i])}}else if(typeof key==="string"){this.__updatePropertiesImpl(key)}if(this.tagName==="TOP-TABLEVIEW"&&Top.__isPrivate()===true){if(key=="items"){}return}if(!this.__needsImpl(key)){this.__reRender();return}if(this.__shouldReRender===true){return}},__needsImpl:function(key){var funcName;var ret=true;if(typeof key==="object"){for(var i=0,len=key.length;i<len;i++){funcName="__update"+Top.Util.capitalizeFirstLetter(key[i]);if(this[funcName]===undefined&&typeof this.__reRender==="function"&&!Top.Util.__isStyleProperty(key[i])){ret=false}if(ret===false&&this[funcName]===undefined&&Top.Util.__isStyleProperty(key[i])){this.updateStyle(key[i])}}}else if(typeof key==="string"){funcName="__update"+Top.Util.capitalizeFirstLetter(key);if(this[funcName]===undefined&&typeof this.__reRender==="function"&&!Top.Util.__isStyleProperty(key)){ret=false}if(ret===false&&this[funcName]===undefined&&Top.Util.__isStyleProperty(key)){this.updateStyle(key)}}return ret},__updatePropertiesImpl:function(key){var customFnName=this[key.concat("Changed")];var resourcePattern=/^@(string|color|dimen|raw|drawable|style|theme)(\/[a-zA-Z0-9]+)+$/gm;var isEvent=key.startsWith("on");if(typeof customFnName==="function"&&this.__intialized===true){customFnName.call(Top.Dom.selectById(this.id));return}var funcName="__update"+Top.Util.capitalizeFirstLetter(key);if(this.__initialized===true){var originValue=this[key];if(resourcePattern.test(this[key])){var modifiedValue;var resourceType=originValue.split("/")[0];var resourceId=originValue.substr(originValue.indexOf("/")+1);switch(resourceType){case"@drawable":{modifiedValue=Top.DrawableManager.get(resourceId);break}case"@raw":{modifiedValue=Top.RawManager.get(resourceId);break}default:{resourceId=resourceId.substr(0,resourceId.lastIndexOf("/"));var resourceName=originValue.split("/");resourceName=resourceName[resourceName.length-1];switch(resourceType){case"@string":{modifiedValue=Top.ValuesManager.get("strings",resourceId)[resourceName];break}case"@color":{modifiedValue=Top.ValuesManager.get("colors",resourceId)[resourceName];break}case"@dimen":{modifiedValue=Top.ValuesManager.get("dimen",resourceId)[resourceName];break}}}}this[key]=modifiedValue}this[key]=this.__getValueByDataConverter(this[key]);if(typeof this[funcName]==="function"){this[funcName](true)}else if(Top.Util.__isStyleProperty(key)){this.updateStyle(key)}else if(typeof this.__reRender==="function"){this.__shouldReRender=true}else if(isEvent){this.__addEventByAttr(Top.Util.decapitalizeFirstLetter(key.substring(2,key.length)))}else{}}},__widgetAttached:function(){if(this.tooltip)this.__updateTooltip();else if(this.tooltipTop)this.__updateTooltipTop();else if(this.tooltipBottom)this.__updateTooltipBottom();else if(this.tooltipLeft)this.__updateTooltipLeft();else if(this.tooltipRight)this.__updateTooltipTopRight();if(this.popoverId)this.__updatePopoverId();if(this.dialogId)this.__updateDialogId();if(this.notificationId)this.__updateNotificationId();if(this.menu)this.__updateMenu()},__updateDialogId:function(){this.__initializeDialog()},__initializeDialog:function(){var dialog=Top.Dom.selectById(this.dialogId);dialog.setProperties({trigger:this.dialogTrigger});var dialogTrigger=this.dialogTrigger==="click"?"click":"mouseover";this.children[0].addEventListener(dialogTrigger,function(){dialog.open()})},__updateNotificationId:function(){this.__initializeNotification()},__initializeNotification:function(){var noti=Top.Dom.selectById(this.notificationId);noti.setProperties({trigger:this.notificationTrigger});var notificationTrigger=this.notificationTrigger==="click"?"click":"mouseover";this.children[0].addEventListener(notificationTrigger,function(){noti.open()})},__updatePopoverId:function(){this.__initializePopover()},__initializePopover:function(){var popover=Top.Dom.selectById(this.popoverId);popover.setProperties({parentId:this.id,trigger:this.popoverTrigger});popover.template.IDEpopover=true},__updateTooltip:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;function setTooltipPosition(e){if(!Top.App.isWidgetAttached(_this.id)||!_this.tooltip){document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="none";window.removeEventListener("mousemove",setTooltipPosition);return}var tooltipText=document.querySelector("#"+thisPageId+" .top-tooltip-text");var x=e.clientX+window.pageXOffset+20,y=e.clientY+window.pageYOffset+20;tooltipText.innerHTML=_this.__i18n(_this.tooltip);tooltipText.style.top=y+"px";tooltipText.style.left=x+"px";e.preventDefault()}this.__addEventFnByCore("eventMouseEnter",function(){if(_this.tooltip===""){document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="none";return}window.addEventListener("mousemove",setTooltipPosition);document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="inline-block"});this.__addEventFnByCore("eventMouseExit",function(){document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="none";window.removeEventListener("mousemove",setTooltipPosition)});Top.App.onWidgetDetach(this.id,function(){if(_this.tooltip){document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="none";window.removeEventListener("mousemove",setTooltipPosition)}})},__updateTooltipTop:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;var caller=this.getElement();if(this.tagName==="TOP-RADIOBUTTON"){caller=this.getElement(".top-radiobutton-text")[0]}else if(this.tagName==="TOP-CHECKBOX"){caller=this.getElement(".top-checkbox-text")[0]}this.__addEventFnByCore("eventMouseEnter",function(){var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");var $thispage=top$("#"+thisPageId);$tooltipText.addClass("top");$tooltipArrow.addClass("top");$tooltipText.text(_this.__i18n(_this.tooltipTop));var arrowTop=_this.getOffsetTop(caller)-$tooltipArrow.height()-2;var arrowLeft=_this.getOffsetLeft(caller)+caller.offsetWidth/2-4;var textTop=arrowTop-10-$tooltipText.height();var textWidth=$tooltipText.width();var textLeft=arrowLeft-textWidth/2-4;if(textLeft+textWidth>$thispage.width()){textLeft=$thispage.width()-textWidth}if(textLeft<=0){textLeft=0}if(textTop<=0){textTop=0}$tooltipText.css("top",textTop);$tooltipText.css("left",textLeft);$tooltipArrow.css("top",arrowTop);$tooltipArrow.css("left",arrowLeft);$tooltipText.css("display","inline-block");$tooltipArrow.css("display","inline-block")});this.__addEventFnByCore("eventMouseExit",function(){var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.removeClass("top");$tooltipArrow.removeClass("top");$tooltipText.css("top","auto");$tooltipText.css("left","auto");$tooltipText.css("display","none");$tooltipArrow.css("display","none")})},__updateTooltipBottom:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;var caller=this.getElement();if(this.tagName==="TOP-RADIOBUTTON"){caller=this.getElement(".top-radiobutton-text")[0]}else if(this.tagName==="TOP-CHECKBOX"){caller=this.getElement(".top-checkbox-text")[0]}this.__addEventFnByCore("eventMouseEnter",function(){var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.addClass("bottom");$tooltipArrow.addClass("bottom");$tooltipText.text(_this.__i18n(_this.tooltipBottom));var arrowTop=_this.getOffsetTop(caller)+caller.offsetHeight+$tooltipArrow.height()-4;var arrowLeft=_this.getOffsetLeft(caller)+caller.offsetWidth/2-4;var textTop=arrowTop+3;var textWidth=$tooltipText.width();var textLeft=arrowLeft-textWidth/2;-4;if(textLeft<=0){textLeft=0}if(textTop<=0){textTop=0}$tooltipText.css("top",textTop);$tooltipText.css("left",textLeft);$tooltipArrow.css("top",arrowTop);$tooltipArrow.css("left",arrowLeft);$tooltipText.css("display","inline-block");$tooltipArrow.css("display","inline-block")});this.__addEventFnByCore("eventMouseExit",function(){var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.removeClass("bottom");$tooltipArrow.removeClass("bottom");$tooltipText.css("top","auto");$tooltipText.css("left","auto");$tooltipText.css("display","none");$tooltipArrow.css("display","none")})},__updateTooltipLeft:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;var caller=this.getElement();if(this.tagName==="TOP-RADIOBUTTON"){caller=this.getElement(".top-radiobutton-text")[0]}else if(this.tagName==="TOP-CHECKBOX"){caller=this.getElement(".top-checkbox-text")[0]}this.__addEventFnByCore("eventMouseEnter",function(){var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.addClass("left");$tooltipArrow.addClass("left");$tooltipText.text(_this.__i18n(_this.tooltipLeft));var arrowTop=_this.getOffsetTop(caller)+caller.offsetHeight/2-4;var arrowLeft=_this.getOffsetLeft(caller)-9;var textTop=arrowTop-$tooltipText.height()/2-3;var textWidth=$tooltipText.width();var textLeft=arrowLeft-textWidth-12;if(textLeft<=0){textLeft=0}if(textTop<=0){textTop=0}$tooltipText.css("top",textTop);$tooltipText.css("left",textLeft);$tooltipArrow.css("top",arrowTop);$tooltipArrow.css("left",arrowLeft);$tooltipText.css("display","inline-block");$tooltipArrow.css("display","inline-block")});this.__addEventFnByCore("eventMouseExit",function(){var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.removeClass("left");$tooltipArrow.removeClass("left");$tooltipText.css("top","auto");$tooltipText.css("left","auto");$tooltipText.css("display","none");$tooltipArrow.css("display","none")})},__updateTooltipTopRight:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;var caller=this.getElement();if(this.tagName==="TOP-RADIOBUTTON"){caller=this.getElement(".top-radiobutton-text")[0]}else if(this.tagName==="TOP-CHECKBOX"){caller=this.getElement(".top-checkbox-text")[0]}this.__addEventFnByCore("eventMouseEnter",function(){var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.addClass("right");$tooltipArrow.addClass("right");$tooltipText.text(_this.__i18n(_this.tooltipRight));var arrowTop=_this.getOffsetTop(caller)+caller.offsetHeight/2-4;var arrowLeft=_this.getOffsetLeft(caller)+caller.offsetWidth+4;var textTop=arrowTop-$tooltipText.height()/2-3;var textWidth=$tooltipText.width();var textLeft=arrowLeft+3;if(textLeft<=0){textLeft=0}if(textTop<=0){textTop=0}$tooltipText.css("top",textTop);$tooltipText.css("left",textLeft);$tooltipArrow.css("top",arrowTop);$tooltipArrow.css("left",arrowLeft);$tooltipText.css("display","inline-block");$tooltipArrow.css("display","inline-block")});this.__addEventFnByCore("eventMouseExit",function(){var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.removeClass("right");$tooltipArrow.removeClass("right");$tooltipText.css("top","auto");$tooltipText.css("left","auto");$tooltipText.css("display","none");$tooltipArrow.css("display","none")})},__updateMenu:function(){var _this=this;this.addEventListener("contextmenu",function(e){if(_this.tagName==="TOP-TREEVIEW"&&(e.target.tagName==="TOP-TREEVIEW"||e.target.tagName==="UL"||e.target.tagName==="LI")){Top.ContextMenu.getDom().close();e.preventDefault();e.stopPropagation()}else{var contextMenu=document.querySelectorAll("top-contextmenu .top-contextmenu-container.open");if(contextMenu){for(var i=0;i<contextMenu.length;i++){var menuId=contextMenu[i].parentNode.parentNode.id;if(menuId){Top.Dom.selectById(menuId).close()}}}Top.Dom.selectById(this.menu).open(e);e.preventDefault();e.stopPropagation()}},false)},__initialClassname:function(){var classTest;switch(this.tagName){case"TOP-TABLEVIEW":{classTest=/(table_02)|(table_03)|(table_01)|(white)|(normal)/g;if(!classTest.test(this.class)){top$(this).addClass("table_01")}break}case"TOP-TABLAYOUT":{classTest=/(light)|(dark)|(tab_01)|(tab_02)|(tab_03)|(tab_04)/g;if(!classTest.test(this.class)){top$(this).addClass("tab_01")}break}case"TOP-MENU":{classTest=/(menu_01)|(menu_02)/g;if(this.type==="side"&&!classTest.test(this.class)){top$(this).addClass("menu_01");
}break}case"TOP-ALARMBADGE":{classTest=/(badge_01)|(badge_02)/g;if(!classTest.test(this.class)){top$(this).addClass("badge_01")}break}case"TOP-TEXTFIELD":{classTest=/(in_textfield)|(out_textfield)/g;if(!classTest.test(this.class)){top$(this).addClass("in_textfield")}break}case"TOP-ACCORDION":{classTest=/(accordion_01)|(accordion_02)/g;if(!classTest.test(this.class)){top$(this).addClass("accordion_01")}break}case"TOP-DIALOG":{classTest=/(popup_01)|(popup_02)|(popup_03)/g;if(!classTest.test(this.class)){top$(this).addClass("popup_01")}break}}},getParent:function(){if(this.layoutParent===undefined){var element=this;while(element.parentNode){element=element.parentNode;if(Top.Util.__isTopWidget(element.tagName)===true){return element}}return undefined}else{return this.layoutParent}},getOffsetLeft:function(elem){var offsetLeft=0;do{if(!isNaN(elem.offsetLeft)){offsetLeft+=elem.offsetLeft}}while(elem=elem.offsetParent);return offsetLeft},getOffsetTop:function(elem){var offsetTop=0;do{if(!isNaN(elem.offsetTop)){offsetTop+=elem.offsetTop}}while(elem=elem.offsetParent);return offsetTop},__getValueByDataConverter:function(value,params){if(!this.__boundData||this.__boundData&&!this.__boundData["DataConverter"])return value;return this.__boundData["DataConverter"].convert(value,params)},__setValueByDataConverter:function(value,params){if(!this.__boundData||this.__boundData&&!this.__boundData["DataConverter"])return value;return this.__boundData["DataConverter"].convertBack(value,params)},__updateMenuId:function(){this.menu=this.menuId},__setI18n:function(properties){var widget=Top.Dom.selectById(this.id);widget.setProperties(properties);var keys=Object.keys(properties);for(var i=0;i<keys.length;i++){widget.template.__initI18n(keys[i])}},expectedTemplateClassName:function(){return this.nodeName.toLowerCase()+"-root"},isTemplateAppended:function(){var innerStr=this.innerHTML.trim();if(this.__isCustomWidget||this.isCustomType){if(!this.__isCustomTemplateAppended||innerStr===""||innerStr===undefined){return false}else{return true}}if(!(typeof this.appendTemplate==="function")){return true}if(this.nodeName==="TOP-TABLEVIEW"||this.nodeName==="TOP-MENU"){if(this.firstElementChild&&this.firstElementChild.nodeName==="DIV"){return true}}if(this.firstElementChild&&this.firstElementChild.classList.contains(this.expectedTemplateClassName())){return true}return false},__setDisabled:function(element){this.disabled=this.disabled===undefined?this.getAttribute("disabled"):this.disabled;var disabled=this.calculateDerivedDisabled();if(!element){return}if(disabled==="true"||disabled===true){this.setAttribute("disabled",true);element.setAttribute("disabled",true)}else{this.removeAttribute("disabled");element.removeAttribute("disabled")}}};TopWidgetBehavior=[TopWidgetBehaviorImpl,TopElementBehavior,TopControlBehavior,TopDataBehavior,TopDeviceBehavior,TopI18nBehavior,TopCommonStyleBehavior,TopEventBehavior];Top.Widget=function(){Widget.prototype=Object.create(Top.prototype);Widget.prototype.constructor=Widget;function Widget(){}Widget.create=function(tagName,props,__element){var type=this.getType(tagName);var parentType=this.getParentType(type);if(parentType!==null){var creator=Top.Widget[parentType][type]}else{var creator=Top.Widget[type]}if(typeof creator==="function"){var widget=creator.create(__element);if(!__element){var topWidget=TopRuntime.topWidgets[widget.template.tagName.toLowerCase()];TopRuntime._initProperties(topWidget,widget.template);widget.template=Object.assign(widget.template,props);TopRuntime._prepAllBehaviors(topWidget,widget.template);if(Top.App.isLoaded()){TopRuntime._callCallback(widget.template,"created");TopRuntime._callCallback(widget.template,"ready");TopRuntime.createdNodes.push(widget.template)}}widget.id=widget.template.id}else{var customType=Top.Util.capitalizeFirstLetter(Top.Util.toCamelCase(tagName));if(Top.Widget[customType]!==undefined){var widget=Top.Widget[customType].create(__element)}else{console.error("Type error: "+tagName+" is not defined.");return undefined}}return widget};Widget.getType=function(tagName){if(TopRuntime.topWidgets[tagName]===undefined){return null}else if(tagName==="top-graph-navigator"){return"GraphNavigator"}else if(TopRuntime.topWidgets[tagName].isCustomType){return Top.Util.capitalizeFirstLetter(Top.Util.toCamelCase(tagName))}else if(tagName.startsWith("top-")){return Top.Util.capitalizeFirstLetter(tagName.split("-")[1])}else{return null}};Widget.getParentType=function(type){var layouts=["Absolutelayout","Linearlayout","Framelayout","Docklayout","Gridlayout","Tablayout","Accordionlayout","Scrolllayout","Form","Foldinglayout","Layout","Splitterlayout","Flowlayout"];var containers=["Listview","Tableview","Panel"];var groups=["Imageslider","Selectbox","Treeview","Widgetitem","Accordiontab"];var menu=["Drawermenu","Contextmenu"];if(layouts.includes(type)){return"Layout"}else if(containers.includes(type)){return"Container"}else if(groups.includes(type)){return"Group"}else if(menu.includes(type)){return"Menu"}else{return null}};Widget.prototype.updateData=function(){this.template.updateData()};Widget.prototype.updateDevice=function(){this.template.updateDevice()};Widget.prototype.__initProperties=function(properties){var keys=Object.keys(properties);for(var i=0,len=keys.length;i<len;i++){this.template[keys[i]]=properties[keys[i]]}};Widget.prototype.setProperties=function(properties,__isFromData,__isFromDevice){var keys=Object.keys(properties);for(var i=0,len=keys.length;i<len;i++){if(this.template.__isCustomWidget||this.template.isCustomType){if(TopRuntime.topWidgets[this.template.tagName.toLowerCase()].customProps.indexOf(keys[i])>=0){var customPropChild=this.template.customPropChild[keys[i]];var customPropAttr=this.template.customPropAttr[keys[i]];for(var j=0;j<customPropChild.length;j++){customPropChild[j].setAttribute(customPropAttr[j].name,properties[keys[i]]);customPropChild[j][Top.Util.toCamelCase(customPropAttr[j].name)]=properties[keys[i]]}}}if(keys[i]==="id")this.id=this.template.id;if(keys[i]==="class")this.addClass(properties[keys[i]]);if(keys[i].includes("-")){var attrName=keys[i];keys[i]=keys[i].replace(/-([a-z])/g,function(g){return g[1].toUpperCase()});if(this.template.tagName==="TOP-TABLEVIEW"&&attrName==="scroll-height"){keys[i]="scrollBodyHeight"}if(properties[attrName]==="true")properties[attrName]=true;if(properties[attrName]==="false")properties[attrName]=false;if(TopRuntime.topWidgets[this.template.tagName.toLowerCase()].reflectToAttributeList.indexOf(keys[i])>=0){this.template.setAttribute(Top.Util.toDash(keys[i]),properties[attrName])}this.template[keys[i]]=properties[attrName]}else{if(properties[keys[i]]==="true")properties[keys[i]]=true;if(properties[keys[i]]==="false")properties[keys[i]]=false;if(TopRuntime.topWidgets[this.template.tagName.toLowerCase()].reflectToAttributeList.indexOf(keys[i])>=0){this.template.setAttribute(keys[i],properties[keys[i]])}this.template[keys[i]]=properties[keys[i]]}}if(this.isAttached()||this.template.tagName==="TOP-POPOVER"){this.template.__updateProperties(keys);if(!__isFromData)this.template.updateData(keys);if(!__isFromDevice)this.template.__updateBoundDevices(keys);if(this.template.__isCustomWidget||this.template.isCustomType){for(var i=0,len=keys.length;i<len;i++){var dashedKey=Top.Util.toDash(keys[i]);if(TopRuntime.topWidgets[this.template.tagName.toLowerCase()].customProps.indexOf(dashedKey)>=0){for(var j=0;j<this.template.customPropAttr[dashedKey].length;j++){var camelCaseKey=Top.Util.toCamelCase(this.template.customPropAttr[dashedKey][j].name);if(Top.Util.__isTopWidget(this.template.customPropChild[dashedKey][j].tagName)){this.template.customPropChild[dashedKey][j].__updateProperties(camelCaseKey)}}}}}}else{var _this=this;Top.App.onWidgetAttach(this.template.id,function(){if(typeof _this.template.__updateProperties==="function")_this.template.__updateProperties(keys);if(!__isFromData&&typeof _this.template.updateData==="function")_this.template.updateData(keys);if(!__isFromDevice&&typeof _this.template.__updateBoundDevices==="function")_this.template.__updateBoundDevices(keys);if(_this.template.__isCustomWidget||_this.template.isCustomType){for(var i=0,len=keys.length;i<len;i++){var dashedKey=Top.Util.toDash(keys[i]);if(TopRuntime.topWidgets[_this.template.tagName.toLowerCase()].customProps.indexOf(dashedKey)>=0){for(var j=0;j<_this.template.customPropAttr[dashedKey].length;j++){var camelCaseKey=Top.Util.toCamelCase(_this.template.customPropAttr[dashedKey][j].name);if(Top.Util.__isTopWidget(_this.template.customPropChild[dashedKey][j].tagName)){_this.template.customPropChild[dashedKey][j].__updateProperties(camelCaseKey)}}}}}})}};Widget.prototype.setChecked=function(checked){this.setProperties({checked:checked})};Widget.prototype.trigger=function(event){var _event;if(typeof Event==="function"){_event=new Event(event)}else{_event=document.createEvent("Event");_event.initEvent(event,true,true)}this.template.__dispatchEvent(_event)};Widget.prototype.setText=function(text){this.setProperties({text:text})};Widget.prototype.setDisabled=function(disabled){this.setProperties({disabled:disabled})};Widget.prototype.setVisible=function(visible){this.setProperties({visible:visible})};Widget.prototype.setSrc=function(src){this.setProperties({src:src})};Widget.prototype.setHref=function(href){this.setProperties({href:href})};Widget.prototype.getElement=function(selector){return this.template.getElement(selector)};Widget.prototype.getProperties=function(key){if(key.includes("-")){key=key.replace(/-([a-z])/g,function(g){return g[1].toUpperCase()})}if(key==="data"&&this.template.tagName==="TOP-TABLEVIEW")return this.getItems();if(key==="title"&&(this.template.tagName==="TOP-SELECTBOX"||this.template.tagName==="TOP-TEXTFIELD"))return this.template["originTitle"];if(this.template[key]!==undefined)return this.template[key];else if(this.template.attributes[key])return this.template.attributes[key].value;else return undefined};Widget.prototype.getChecked=function(checked){return this.template["checked"]};Widget.prototype.getText=function(){return this.template["text"]};Widget.prototype.getValue=function(){return this.template["value"]};Widget.prototype.getDisabled=function(){return this.template["disabled"]};Widget.prototype.getVisible=function(){return this.template["visible"]};Widget.prototype.getSrc=function(){return this.template["src"]};Widget.prototype.getHref=function(){return this.template["href"]};Widget.prototype.onEvent=function(type,functionObj){var eventType="event".concat(Top.Util.capitalizeFirstLetter(type));if(typeof this.template.__removeEventFn==="function")this.template.__removeEventFn(eventType);if(functionObj===""){this.template[eventType]=""}else{if(typeof this.template.__addEventFn==="function")this.template.__addEventFn(eventType,functionObj)}};Widget.prototype.offEvent=function(type){var eventType="event".concat(Top.Util.capitalizeFirstLetter(type));this.template.__removeEventFn(eventType)};Widget.prototype.addClass=function(className){this.template.className+=" "+className};Widget.prototype.removeClass=function(className){var classCheck=new RegExp("(\\s|^)"+className+"(\\s|$)");this.template.className=this.template.className.replace(classCheck," ").trim()};Widget.prototype.toggleClass=function(className){var classCheck=new RegExp("(\\s|^)"+className+"(\\s|$)");if(classCheck.test(this.template.className)){this.template.className=this.template.className.replace(classCheck," ").trim()}else{this.template.className+=" "+className}};Widget.prototype.hasClass=function(className){var classLength=this.template.classList.length;for(var i=0;i<classLength;i++){if(className===this.template.classList[i])return true}return false};Widget.prototype.getParent=function(){return Top.Dom.selectById(this.template.getParent().id)};Widget.prototype.getController=function(){return this.template.getController()};Widget.prototype.isAttached=function(){return!!this.template.__isAttached};Widget.prototype.focus=function(){this.template.focus()};Widget.prototype.blur=function(){this.template.blur()};Widget.prototype.style=function(propertyName,value){if(typeof propertyName==="object"){var names=Object.keys(propertyName);for(var i=0,len=names.length;i<len;i++){var value=propertyName[names[i]];this.__getElementForStyle().style[names[i]]=value}}else if(typeof propertyName==="string"){this.__getElementForStyle().style[propertyName]=value}};Widget.prototype.__getElementForStyle=function(){if(this.template.tagName==="TOP-TEXTFIELD"){return this.template.getElement("input")[0]}else if(this.template.tagName==="TOP-TEXTAREA"){return this.template.getElement("textarea")[0]}else{return this.template.getElement()}};Widget.prototype.getWidth=function(){return this.getElement().offsetWidth};Widget.prototype.getHeight=function(){return this.getElement().offsetHeight};Widget.prototype.addEventListener=function(type,listener,options){this.template.__addEventListener(type,listener,options)};Widget.prototype.removeEventListener=function(type,listener,options){this.template.__removeEventByAttr(type);this.template.__removeEventListener(type,listener,options)};Widget.prototype.dispatchEvent=function(event){this.template.__dispatchEvent(event)};Widget.prototype.getIndex=function(){if(this.template.index>-1){return this.template.index}else if(this.template.dataIndex>-1){return this.template.dataIndex}};Widget.prototype.bindData=function(data){this.template.dataModel=data;this.template.__initBoundData(true)};Widget.prototype.setI18n=function(properties){this.template.__setI18n(properties)};return Widget}();Top.CustomWidget=function(){function CustomWidget(){}CustomWidget.propsList={};CustomWidget.templates={};CustomWidget.create=function(name,settings){if(typeof name==="string"&&typeof settings==="object"){this.propsList[name]=settings;this.__createWidgetObject(name)}else{console.error("Type error: Top.CustomWidget.create(string, object)")}};CustomWidget.__createWidgetObject=function(name){var pascalName=Top.Util.capitalizeFirstLetter(Top.Util.toCamelCase(name));Top.Widget[pascalName]=function(){eval(pascalName+".prototype = Object.create(Top.Widget.prototype);"+pascalName+".prototype.constructor = "+pascalName+";"+"function "+pascalName+"(element) { if(element instanceof Element) { this.template = element;}"+'else { this.template = document.createElement("'+name+'");'+'this.template.innerHTML = "<div class='+" 'top-customwidget-root'"+'>" }'+'this.id = this.template.id; var props = Top.CustomWidget.getProps("'+name+'"); '+"var keys = Object.keys(props); for (var i = 0, len = keys.length; i < len; i++) { "+'if (keys[i] !== "template" && keys[i] !== "init") { if(keys[i].endsWith("Changed")) { '+"this.template[keys[i]] = props[keys[i]]; } else { this[keys[i]] = props[keys[i]]; } } } }");eval(pascalName+".create = function(obj) { return new "+pascalName+"(obj); };");eval(pascalName+".prototype.getChildren = function(selector) { var widgets = [];"+' if (typeof selector === "string") { var elements = this.template.querySelectorAll(selector); } '+"else { var elements = this.template.childRoot.childNodes; } "+"for (var i = 0, len = elements.length; i < len; i++) { "+"if(Top.Util.__isTopWidget(elements[i].tagName)) { widgets.push(Top.Dom.__selectImpl(elements[i])); } } return widgets; };");return eval(pascalName)}();TopRuntime.topWidgets[name]={is:name,isCustomType:true,customProps:[],behaviors:[TopWidgetBehavior,TopLayoutBehavior],__ready:function(){if(!this.__initialized){var template=Top.CustomWidget.getProps(name).template;this.__initTemplate(template);TopRuntime._customWidgetAttachedCallback()}this.__initProps();this.renderLayout();this.__isCustomWidget=true},renderLayout:function(){for(var i=0;i<this.childRoot.children.length;i++){var child=this.childRoot.children[i];this.__setWrapperStyle(child)}},__setWrapperStyle:function(child){if(this.orientation=="vertical"){var horizontalAlignment=this.horizontalAlignment||"left";if(child.getAttribute("layout-horizontal-alignment")){horizontalAlignment=child.getAttribute("layout-horizontal-alignment")}var height=child.getAttribute("layout-height");child.classList.remove("linear-child-horizontal");if(!child.classList.contains("linear-child-vertical")){child.classList.add("linear-child-vertical")}if(height&&height.includes("%")){child.style.height=height;child.style.textAlign=horizontalAlignment;if(typeof child.__updateLayoutHeight==="function")child.__updateLayoutHeight()}else{child.style.textAlign=horizontalAlignment}}else{child.classList.remove("linear-child-vertical");if(!child.classList.contains("linear-child-horizontal")){child.classList.add("linear-child-horizontal")}var verticalAlignment=this.verticalAlignment;if(!child.getAttribute("layout-vertical-alignment")){child.setAttribute("layout-vertical-alignment",verticalAlignment);child.layoutVerticalAlignment=verticalAlignment;if(typeof child.setTopStyle==="function")child.setTopStyle("vertical-align",verticalAlignment)}child.style.lineHeight="normal"}},attached:function(){var props=Top.CustomWidget.getProps(name);if(typeof props.init==="function"){var widget=Top.Dom.__selectImpl(this);widget.innerHTML=this.inner;props.init.call(widget)}},appendTemplate:function(){var template=Top.CustomWidget.getProps(name).template;this.innerHTML='<div class="top-customwidget-root">'+this.innerHTML+"</div>";if(Top.Util.getFileExtension(template)==="html"){this.__isHtmlTemplate=true;if(Top.CustomWidget.templates[name]){this.__isHtmlTemplate=false;this.__initTemplate(Top.CustomWidget.templates[name])}else{var _this=this;Top.Ajax.execute(template,{async:true,success:function(data,textStatus,jqXHR){Top.CustomWidget.templates[name]=data;_this.__initTemplate(data)}})}}else{this.__isHtmlTemplate=false;this.__initTemplate(template)}this.__isCustomTemplateAppended=true},__initProps:function(){var _this=this;Array.prototype.slice.call(this.attributes).forEach(function(item){_this[item.name]=item.value})},__initTemplate:function(template){this.customPropChild=[];this.customPropAttr=[];var inner=this.innerHTML.trim();this.inner=inner;var props=Top.CustomWidget.getProps(name);template=template.replace("this.innerHTML",inner);var matches=template.match(/\{\{([a-zA-Z0-9_-]+)\}\}/g);if(matches){for(var i=0,len=matches.length;i<len;i++){var re=new RegExp(matches[i],"gi");var prop=matches[i].replace("{{","").replace("}}","");if(TopRuntime.topWidgets[name].customProps.indexOf(prop)===-1){TopRuntime.topWidgets[name].customProps.push(prop)}}}if(!this.querySelector(".top-customwidget-root")){template='<div class="top-customwidget-root">'+template+"</div>";this.innerHTML=template}else{this.querySelector(".top-customwidget-root").innerHTML=template}this.__convertChildrenId();var keys=Object.keys(props);for(var i=0,len=keys.length;i<len;i++){this[keys[i]]=props[keys[i]]}this.__initChildren();TopRuntime.customNodes.push(this);this.initializeHtmlObjects(this,true);this.__findCustomProps(this);this.__markChildren(this);this.__initialized=true;if(this.__isHtmlTemplate)TopRuntime._customWidgetAttachedCallback()},__convertChildrenId:function(){var allChildren=this.getElementsByTagName("*");for(var i=0;i<allChildren.length;i++){if(Top.Util.__isTopWidget(allChildren[i].tagName)){allChildren[i].id=this.id+"_"+allChildren[i].id;if(allChildren[i].tagName==="TOP-RADIOBUTTON"){var attr=allChildren[i].attributes;attr["group-id"].nodeValue=this.id+"_"+attr["group-id"].nodeValue}if(allChildren[i].tagName==="TOP-DATEPICKER"){var attr=allChildren[i].attributes;if(attr["to-datepicker"])attr["to-datepicker"].nodeValue=this.id+"_"+attr["to-datepicker"].nodeValue;if(attr["from-datepicker"])attr["from-datepicker"].nodeValue=this.id+"_"+attr["from-datepicker"].nodeValue}}}},__findCustomProps:function(child){var children=child.children;if(!children)return;for(var i=0;i<children.length;i++){for(var j=0;j<children[i].attributes.length;j++){for(var k=0;k<TopRuntime.topWidgets[name].customProps.length;k++){var customProp=TopRuntime.topWidgets[name].customProps[k];if(children[i].attributes[j].value.includes("{{"+customProp+"}}")){if(!this.customPropChild[customProp]){this.customPropChild[customProp]=[]}this.customPropChild[customProp].push(children[i]);if(!this.customPropAttr[customProp]){this.customPropAttr[customProp]=[]}this.customPropAttr[customProp].push(children[i].attributes[j]);for(var l=0;l<this.customPropChild[customProp].length;l++){var customPropName=this.customPropChild[customProp][l][Top.Util.toCamelCase(this.customPropAttr[customProp][l].name)]||this.customPropChild[customProp][l].getAttribute(this.customPropAttr[customProp][l].name);var replacedValue=customPropName.replace("{{"+customProp+"}}",this.getAttribute(customProp));this.customPropChild[customProp][l][Top.Util.toCamelCase(this.customPropAttr[customProp][l].name)]=replacedValue;this.customPropChild[customProp][l].setAttribute(this.customPropAttr[customProp][l].name,replacedValue)}}var data=children[i].dataModel||children[i].data;if(data){var dataObj=JSON.parse(data);var keys=Object.keys(dataObj);for(var l=0,len=keys.length;l<len;l++){if(dataObj[keys[l]].includes("{{"+customProp+"}}")){dataObj[keys[l]]=dataObj[keys[l]].replace("{{"+customProp+"}}",this.getAttribute(customProp));children[i].data=JSON.stringify(dataObj)}}}}}this.__findCustomProps(children[i])}},initializeChildRoot:function(){return this.querySelector(".top-customwidget-root")},__initChildren:function(){if(this.childRoot)var root=this.childRoot;else var root=this;for(var i=0,len=root.childNodes.length;i<len;i++){root.childNodes[i].layoutParent=this}},__markChildren:function(node){node.__isCustomChild=true;node.customParent=this;for(var i=0;i<node.children.length;i++){this.__markChildren(node.children[i])}},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-customwidget-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},getTopStyle:function(){this.topstyle=this.querySelector(".top-customwidget-root").style.cssText;return this.topstyle},__updateDisplay:function(){if(this.display==="none"||this.visible=="none"){this.style.display="none"}else{this.style.display=""}if(!this.display){this.display="inline-block"}this.setTopStyle("display",this.display)},setAllTopStyle:function(){var customwidget=this.querySelector(".top-customwidget-root");if(customwidget)customwidget.style.cssText=this.topstyle},__setWidgetSize:function(){if(!this.childRoot)this.childRoot=this.initializeChildRoot();var layoutRoot=this.childRoot;var root=layoutRoot;if(this.layoutWidth==="auto"){layoutRoot.style.width=layoutRoot.scrollWidth}if(this.layoutHeight==="auto"){layoutRoot.style.height=layoutRoot.scrollHeight}for(var i=0,len=root.children.length;i<len;i++){var item=root.children[i];var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto",pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var pPaddingWidth=layoutRoot.style.paddingRight||0+layoutRoot.style.paddingLeft||0,pPaddingHeight=layoutRoot.style.paddingTop||0+layoutRoot.style.paddingBottom||0;if(item.layoutWidth==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{if(!isNaN(parseInt(this.layoutWidth))){item.setThisWidgetWidth(parseInt(this.layoutWidth)-pPaddingWidth+"px")}else{item.setThisWidgetWidth("100% - "+pPaddingWidth+"px")}}}if(item.layoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{if(!isNaN(parseInt(this.layoutHeight))){item.setThisWidgetHeight(parseInt(this.layoutHeight)-pPaddingHeight+"px")}else{item.setThisWidgetHeight("100% - "+pPaddingHeight+"px")}}}if(item.getAttribute("layout-top")!=null){item.removeTopStyle("top")}if(item.getAttribute("layout-left")!=null){item.removeTopStyle("left")}}}};TopRuntime._prepBehaviors(TopRuntime.topWidgets[name])};CustomWidget.getProps=function(name){return this.propsList[name]};return CustomWidget}();TopCheckBehavior={properties:{checked:{type:String,value:false},trueValue:String,falseValue:String,onChange:String,groupId:String},__initTrueFalseValue:function(){if(this.trueValue===undefined)this.trueValue=true;if(this.falseValue===undefined)this.falseValue=false},__initChecked:function(){if(this.checked==="true")this.checked=this.trueValue;else if(this.checked==="false")this.checked=this.falseValue;this.__setChecked()},__setChecked:function(){if(this.checked===this.trueValue)this.checked=this.trueValue;else this.checked=this.falseValue},__isCheckedTrue:function(){if(this.checked===this.trueValue)return true;return false},isChecked:function(){return this.checked===this.trueValue?this.trueValue:this.falseValue},__initEventInternal:function(){this.__addEventByAttr("change")},__updateOnChange:function(){this.__addEventByAttr("change")},__updateVerticalAlignment:function(){if(this.__isAttached!==true)return;var label=this.querySelector("label");var span=label.querySelector("span");if(!(this.layoutHeight==="wrap_content"||this.layoutHeight==="auto"||this.layoutHeight==="match_parent"||this.layoutHeight!==undefined&&this.layoutHeight!==null&&this.layoutHeight.includes("%"))){if(this.verticalAlignment==="top"){label.style.paddingTop=this.paddingTop}else if(this.verticalAlignment==="bottom"){var computedStyle=getComputedStyle(label);var padding=label.offsetHeight-span.offsetHeight-parseFloat(computedStyle.paddingBottom);label.style.paddingTop=padding+"px"}else{var computedStyle=getComputedStyle(label);var height=label.offsetHeight===0?parseFloat(this.layoutHeight):label.offsetHeight;var paddingTop=parseFloat(computedStyle.paddingTop)||0;var paddingBottom=parseFloat(computedStyle.paddingBottom)||0;var padding=height-span.offsetHeight+paddingTop-paddingBottom;label.style.paddingTop=padding/2+"px"}}else{label.style.paddingTop=this.paddingTop}},__setVerticalAlignment:function(){var label=this.querySelector("label");var span=label.querySelector("span");if(this.layoutHeight==="match_parent"||this.layoutHeight!==undefined&&this.layoutHeight!==null&&this.layoutHeight.includes("%")){if(this.verticalAlignment==="top"){label.style.paddingTop=this.paddingTop}else if(this.verticalAlignment==="bottom"){var computedStyle=getComputedStyle(label);var padding=label.offsetHeight-span.offsetHeight-parseFloat(computedStyle.paddingBottom);label.style.paddingTop=padding+"px"}else{var computedStyle=getComputedStyle(label);var padding=label.offsetHeight-span.offsetHeight+parseFloat(computedStyle.paddingTop)-parseFloat(computedStyle.paddingBottom);label.style.paddingTop=padding/2+"px"}}}};TopChecktypeBehavior={properties:{checkPosition:{type:String,value:"left"}},__updateVerticalAlignment:function(){if(this.__isAttached!==true)return;var label=this.querySelector("label");var span=label.querySelector("span");if(!(this.layoutHeight==="wrap_content"||this.layoutHeight==="auto"||this.layoutHeight==="match_parent"||this.layoutHeight!==undefined&&this.layoutHeight!==null&&this.layoutHeight.includes("%"))){if(this.verticalAlignment==="top"){label.style.paddingTop=this.paddingTop}else if(this.verticalAlignment==="bottom"){var computedStyle=getComputedStyle(label);var padding=label.offsetHeight-span.offsetHeight-parseFloat(computedStyle.paddingBottom);label.style.paddingTop=padding+"px"}else{var computedStyle=getComputedStyle(label);var height=label.offsetHeight===0?parseFloat(this.layoutHeight):label.offsetHeight;var paddingTop=parseFloat(computedStyle.paddingTop)||0;var paddingBottom=parseFloat(computedStyle.paddingBottom)||0;var padding=height-span.offsetHeight+paddingTop-paddingBottom;label.style.paddingTop=padding/2-1+"px"}}else{label.style.paddingTop=this.paddingTop}},__setVerticalAlignment:function(){var label=this.querySelector("label");var span=label.querySelector("span");if(this.layoutHeight==="match_parent"||this.layoutHeight!==undefined&&this.layoutHeight!==null&&this.layoutHeight.includes("%")){if(this.verticalAlignment==="top"){label.style.paddingTop=this.paddingTop}else if(this.verticalAlignment==="bottom"){var computedStyle=getComputedStyle(label);var padding=label.offsetHeight-span.offsetHeight-parseFloat(computedStyle.paddingBottom);label.style.paddingTop=padding+"px"}else{var computedStyle=getComputedStyle(label);var padding=label.offsetHeight-span.offsetHeight+parseFloat(computedStyle.paddingTop)-parseFloat(computedStyle.paddingBottom);label.style.paddingTop=padding/2+"px"}}}};TopContainerBehavior={properties:{items:{type:String},itemField:String,itemBinding:String,itemLayout:String,itemLayoutDom:Object,arrModelRef:Object,itemSwitchLogic:String,separatorVisible:String,separatorColor:String,separatorSize:String,itemClicktype:{type:String,value:"click"},__isContainer:{type:Boolean,value:true}},initialLayout:function(){this.itemLayout=top$(this.childRoot).html();this.itemLayoutDom=top$(this.childRoot).children();if(this.itemSwitchLogic){if(this.itemSwitchLogic.startsWith("{")){this.itemSwitchField=this.itemSwitchLogic.substring(1,this.itemSwitchLogic.indexOf("}"))}else this.itemSwitchFunc=Top.Util.namespace(this.itemSwitchLogic,this)}},initialChilds:function(){this.childs=top$(this.childRoot).children();var len=this.childs.length;for(var i=0;i<len;i++){this.childs[i].layoutParent=this}},clearLayout:function(){var myNode=this.childRoot;while(myNode.firstChild){this.clearDeepChilds(myNode.firstChild);myNode.removeChild(myNode.firstChild)}},clearDeepChilds:function(parentNode){while(parentNode.firstChild){while(parentNode.firstChild.firstChild){this.clearDeepChilds(parentNode.firstChild)}parentNode.removeChild(parentNode.firstChild)}},getSwitchedItem:function(){var switchedItem=[];var defaultItem;var regex1=/^.*\>+.*|.*\<+.*|.*\=+.*$/;var regex2=/^[-+.]?[0-9,]*[.]?[0-9]+$/;var bool;if(this.items&&typeof this.items==="string")var items=Top.Util.namespace(this.items,this);else if(typeof this.items==="ob$ect")var items=this.items;if(this.itemSwitchField){for(var i=0;i<items.length;i++){for(var j=0;j<this.itemLayoutDom.length;j++){if(!this.itemLayoutDom[j].attributes["item-switch-case"]){if(defaultItem===undefined)defaultItem=this.itemLayoutDom[j];break}var caseValue=this.itemLayoutDom[j].attributes["item-switch-case"].value;var itemCase;var fieldValue=items[i][this.itemSwitchField];bool=regex2.test(fieldValue);if(bool===true||typeof fieldValue==="number"){if(caseValue.startsWith("lt"))caseValue=caseValue.replace("lt","<");if(caseValue.startsWith("gt"))caseValue=caseValue.replace("gt",">");if(caseValue.startsWith("le"))caseValue=caseValue.replace("le","<=");if(caseValue.startsWith("ge"))caseValue=caseValue.replace("ge",">=");if(caseValue.startsWith("eq"))caseValue=caseValue.replace("eq","==");if(caseValue.startsWith("ne"))caseValue=caseValue.replace("ne","!=");itemCase=fieldValue+caseValue}else if(bool===false){if(caseValue.startsWith("ne")){caseValue=caseValue.replace("ne ","").replace("ne","");itemCase='"'+caseValue+'"';itemCase+=' != "'+fieldValue+'"'}else{caseValue=caseValue.replace("eq ","").replace("eq","");itemCase='"'+caseValue+'"';itemCase+=' == "'+fieldValue+'"'}}if(eval(itemCase)){switchedItem[i]=this.itemLayoutDom[j]}}if(switchedItem[i]===undefined)switchedItem[i]=defaultItem}}else if(this.itemSwitchFunc){for(var i=0;i<items.length;i++){var ret=this.itemSwitchFunc(items[i]);for(var j=0;j<this.itemLayoutDom.length;j++){if(!this.itemLayoutDom[j].attributes["item-switch-case"]){if(defaultItem===undefined)defaultItem=this.itemLayoutDom[j];break}if(this.itemLayoutDom[j].attributes["item-switch-case"].value==ret){switchedItem[i]=this.itemLayoutDom[j]}}if(switchedItem[i]===undefined)switchedItem[i]=defaultItem}}return switchedItem},createHtmlObjects:function(child,addNodes){if(TopRuntime.topWidgets[child.tagName.toLowerCase()]!==undefined){var topWidget=TopRuntime.topWidgets[child.tagName.toLowerCase()];TopRuntime._initProperties(topWidget,child);TopRuntime._prepAllBehaviors(topWidget,child);if(!child.isTemplateAppended())child.appendTemplate();if(Top.App.isLoaded()){
TopRuntime._callCallback(child,"created");TopRuntime._callCallback(child,"ready");if(addNodes!==false)TopRuntime.createdNodes.push(child);if(this.createdItemWidgets===undefined||!Array.isArray(this.createdItemWidgets)){this.createdItemWidgets=[]}this.createdItemWidgets.push(child)}}if(!child.children)return;for(var i=0;i<child.children.length;i++){this.createHtmlObjects(child.children[i],addNodes)}},createdItemWidgetAttachedCallback:function(){if(this.createdItemWidgets){for(var i=this.createdItemWidgets.length-1;i>=0;i--){TopRuntime._callCallback(this.createdItemWidgets[i],"attached")}this.createdItemWidgets=[]}}};Top.Widget.Container=function(){Container.prototype=Object.create(Top.Widget.prototype);Container.prototype.constructor=Container;function Container(){}Container.prototype.complete=function(){this.template.renderLayout()};Container.prototype.setItems=function(items){};Container.prototype.getItems=function(){var items;if(typeof this.template["items"]==="string")items=Top.Util.namespace(this.template["items"],this.template);else items=this.template["items"];return items};return Container}();TopGroupBehavior={properties:{widgetItems:[]},initItems:function(){if(this.tagName==="TOP-TREEVIEW"&&this.childRoot.children.length>0){this.widgetItems=[];for(var i=0;i<this.childRoot.children.length;i++){var tmp=this.childRoot.children[i];if(tmp.tagName.toLowerCase()==="top-widgetitem"){this.widgetItems.push(tmp)}}}else{this.widgetItems=this.querySelectorAll("top-widgetitem")}if(this.tagName==="TOP-LISTVIEW"||this.tagName==="TOP-TREEVIEW"){this.headerItem=this.tagName==="TOP-LISTVIEW"?top$(this.childRoot).children("top-listheader"):top$(this.childRoot).children("top-treeheader")}for(var i=0;i<this.widgetItems.length;i++){this.widgetItems[i].parentWidget=this}},clearItems:function(){var myNode=this.childRoot;while(myNode.firstChild){this.clearDeepChilds(myNode.firstChild);myNode.removeChild(myNode.firstChild)}},clearDeepChilds:function(parentNode){while(parentNode.firstChild){while(parentNode.firstChild.firstChild){this.clearDeepChilds(parentNode.firstChild)}parentNode.removeChild(parentNode.firstChild)}}};Top.Widget.Group=function(){Group.prototype=Object.create(Top.Widget.prototype);Group.prototype.constructor=Group;function Group(){}Group.prototype.is="top-groupbehavior";Group.prototype.template=TopGroupBehavior;Group.prototype.addItem=function(widget){this.template.widgetItems.push(widget.template)};Group.prototype.removeItem=function(widget){var childsArray=this.template.widgetItems;for(var i=0;i<childsArray.length;i++){if(widget.id==childsArray[i].id){this.template.widgetItems.splice(i,1)}}};Group.prototype.complete=function(){if(typeof this.template.__updateNodes==="function"){this.template.__updateNodes()}};return Group}();TopLayoutBehavior={properties:{childs:[],src:String,srcLoad:String,srcLoadListeners:[],__isLayout:{type:String,value:true}},ready:function(){if(this.getElement()){this.getElement().addEventListener("scroll",function(e){top$(".top-selectbox-container.active").click();var dropdownMenu=document.querySelectorAll('top-menu[type="dropdown"] .top-menu_btn.top-menu_open');if(dropdownMenu){for(var i=0;i<dropdownMenu.length;i++){dropdownMenu[i].parentNode.parentNode.parentNode.setDropdownPosition()}}var contextMenu=document.querySelectorAll("top-contextmenu .top-contextmenu-container.open");if(contextMenu){for(var i=0;i<contextMenu.length;i++){var menuId=contextMenu[i].parentNode.id;Top.Dom.selectById(menuId).close()}}top$('[data-toggle="popover"],[data-original-title]').each(function(){if(!top$(this).is(e.target)&&top$(this).has(e.target).length===0&&top$(".top-popover").has(e.target).length===0){((top$(this).popover("hide").data("bs.popover")||{}).inState||{}).click=false}});Top.App.closeAutoCompleteContainers()})}},__detached:function(){this.clearChilds()},initialChilds:function(){if(this.childRoot){for(var i=0,len=this.childRoot.children.length;i<len;i++){this.childRoot.children[i].layoutParent=this}this.childs=top$(this.childRoot).children()}else{for(var i=0,len=this.children.length;i<len;i++){this.children[i].layoutParent=this}this.childs=top$(this).children()}},initialAppendedChilds:function(){this.childs=top$(this).children();for(var i=0,len=this.childs.length;i<len;i++){if(this.childs[i].tagName==="DIV"){this.childs[i]=this.childs[i].childNodes[0]}this.childs[i].layoutParent=this}},clearChilds:function(directDetach){if(this.childRoot)var myNode=this.childRoot;else var myNode=this;while(myNode.firstChild){myNode.firstChild.__initialized=false;this.clearDeepChilds(myNode.firstChild,directDetach);if(directDetach===true&&myNode.firstChild.tagName&&TopRuntime.topWidgets[myNode.firstChild.tagName.toLowerCase()]!==undefined&&myNode.firstChild.behaviors!==undefined)TopRuntime.directDetachedNodes.push(myNode.firstChild);top$(myNode.firstChild).remove()}if(directDetach===true)TopRuntime._directDetachNodesDetachedCallback()},clearDeepChilds:function(parentNode,directDetach){while(parentNode.firstChild){while(parentNode.firstChild.firstChild){this.clearDeepChilds(parentNode.firstChild,directDetach)}if(directDetach===true&&parentNode.firstChild.tagName&&TopRuntime.topWidgets[parentNode.firstChild.tagName.toLowerCase()]!==undefined&&parentNode.firstChild.behaviors!==undefined)TopRuntime.directDetachedNodes.push(parentNode.firstChild);top$(parentNode.firstChild).remove()}},__layoutAttached:function(){this.__initCursor();if(this.tagName!=="TOP-PAGE"){this.__initSrc()}},__initSrc:function(){if(typeof this.src==="string"){var _this=this;this.src=Top.Util.__getRawValue(this.src);Top.Ajax.execute(this.src,{success:function(data){var controllerPaths=Top.Util.__getControllerPaths(data);if(Top.App.__useCommonLogic()===true&&controllerPaths!==undefined){Top.App.__loadControllerFile(controllerPaths,function(_data){_this.__onSuccessSrcLoad(_data);_data=null},data)}else{_this.__onSuccessSrcLoad(data);data=null}}})}},__onSuccessSrcLoad:function(data,callback){this.clearChilds(true);this.appendHtmlString(data);TopRuntime._insertedNodesCallback();this.initialChilds();if(typeof this.srcLoad==="string"){this.srcLoad=Top.Util.namespace(this.srcLoad)}if(typeof this.srcLoad==="function")this.srcLoad();if(typeof callback==="function")callback();if(this.srcLoadListeners!==undefined){for(var i=0,len=this.srcLoadListeners.length;i<len;i++){if(typeof this.srcLoadListeners[i]==="function")this.srcLoadListeners[i]()}this.srcLoadListeners=[]}TopRuntime._srcRootNodesAttachedCallback()},__loadScript:function(url,callback){var script=document.createElement("script");script.src=url;script.onload=callback;document.getElementsByTagName("head")[0].appendChild(script)},updateStyle:function(keys){var layoutRenderFlag=false;if(keys!=null&&typeof keys==="object"){for(var i=0;i<keys.length;i++){if(!layoutRenderFlag){if(keys[i]==="layoutAlignParent"||keys[i]==="layoutRow"||keys[i]==="layoutColumn"||keys[i]==="layoutRowSpan"||keys[i]==="layoutColumnSpan"||keys[i]==="layoutTop"||keys[i]==="layoutLeft"||keys[i]==="layoutRight"||keys[i]==="layoutBottom"||keys[i]==="layoutTabName"||keys[i]==="layoutTabIcon"||keys[i]==="layoutTabDisabled"||keys[i]==="layoutWeight"||keys[i]==="layoutHorizontalAlignment"||keys[i]==="layoutVerticalAlignment"){layoutRenderFlag=true;break}}}if(layoutRenderFlag&&this.layoutParent){this.layoutParent.renderLayout()}}else if(typeof keys==="string"){stylekey=keys.replace(/[A-Z]/g,function(match){return"-"+match.toLowerCase()});var stylekeyMap=[["b-image","backgroundImage"],["tile-mode","background-repeat"],["text-color","color"],["horizontal-alignment","text-align"],["layout-vertical-alignment","vertical-align"],["horizontal-scroll","overflow-x"],["vertical-scroll","overflow-y"]];for(var j=0;j<stylekeyMap.length;j++){if(stylekey===stylekeyMap[j][0]){stylekey=stylekeyMap[j][1];if(stylekey==="overflow-x"||stylekey==="overflow-y"){if(this[keys]==="true"||this[keys]===true)this[keys]="auto";else if(this[keys]==="false"||this[keys]===false)this[keys]="hidden"}this.removeTopStyle(stylekey);this.setTopStyle(stylekey,this[keys]);return}}this.removeTopStyle(stylekey);this.setTopStyle(stylekey,this[keys]);return}if(!((this.isCustomType||this.__isCustomWidget)&&this.topstyle!=="")){this.topstyle=""}this.setAllTopStyle();var bImage=this.backgroundImage;this.updatePositionValue(true);if(this.backgroundImage!=null){if(!this.backgroundImage.includes("url(")){if(this.backgroundImage.includes("@drawable")){bImage=Top.DrawableManager.get(this.backgroundImage.replace("@drawable/",""))}bImage="url('"+bImage+"')";this.setTopStyle("background-size",this.backgroundSize);this.setTopStyle("background-repeat",this.backgroundRepeat);if(!this.backgroundSize&&!this.backgroundRepeat){this.__updateTileMode()}}}if(this.verticalAlignment==null){this.verticalAlignment="middle"}if(this.verticalScroll==="true"||this.verticalScroll===true)this.verticalScroll="auto";if(this.horizontalScroll==="true"||this.horizontalScroll===true)this.horizontalScroll="auto";if(this.verticalScroll==="false"||this.verticalScroll===false)this.verticalScroll="hidden";if(this.horizontalScroll==="false"||this.horizontalScroll===false)this.horizontalScroll="hidden";if(this.borderWidth!=null||this.borderColor!=null){if(this.borderStyle==null){this.borderStyle="solid"}}if(this.layoutVerticalAlignment==null){this.layoutVerticalAlignment="top"}if(!this.horizontalAlignment&&this.getElementsByClassName("top-customwidget-root").length===0){this.horizontalAlignment="left"}this.__updateDisabled();this.__updateVisible();this.__updateLayoutWidth();this.__updateLayoutHeight();this.__updateLayoutTop();this.__updateLayoutLeft();this.__updateLayoutRight();this.__updateLayoutBottom();this.setTopStyle("max-width",this.maxWidth);this.setTopStyle("min-width",this.minWidth);this.setTopStyle("max-height",this.maxHeight);this.setTopStyle("min-height",this.minHeight);this.setTopStyle("line-height",this.lineHeight);this.setTopStyle("background-color",this.backgroundColor);this.setTopStyle("background-image",bImage);this.setTopStyle("background-repeat",this.tileMode);this.setTopStyle("background",this.background);this.setTopStyle("opacity",this.opacity);this.setTopStyle("margin",this.margin);this.setTopStyle("padding",this.padding);this.setTopStyle("color",this.textColor);this.setTopStyle("border-width",this.borderWidth);this.setTopStyle("border-bottom-width",this.borderBottomWidth);this.setTopStyle("border-left-width",this.borderLeftWidth);this.setTopStyle("border-right-width",this.borderRightWidth);this.setTopStyle("border-top-width",this.borderTopWidth);this.setTopStyle("border-style",this.borderStyle);this.setTopStyle("border-color",this.borderColor);this.setTopStyle("border-radius",this.borderRadius);this.setTopStyle("z-index",this.zIndex);this.setTopStyle("position",this.position);this.setTopStyle("float",this.float);this.setTopStyle("cursor",this.cursor);this.setTopStyle("text-align",this.horizontalAlignment);this.setTopStyle("vertical-align",this.layoutVerticalAlignment);this.setTopStyle("animation",this.animation);this.setTopStyle("word-wrap",this.wordWrap);this.setTopStyle("word-break",this.wordBreak);this.setTopStyle("white-space",this.whiteSpace);this.setTopStyle("text-decoration",this.textDecoration);this.setTopStyle("text-overflow",this.textOverflow);this.setTopStyle("text-transform",this.textTransform);this.setTopStyle("transition",this.transition);this.setTopStyle("letter-spacing",this.letterSpacing);this.setTopStyle("word-spacing",this.wordSpacing);this.setTopStyle("font-weight",this.fontWeight);this.setTopStyle("font-family",this.fontFamily);this.setTopStyle("background-position",this.backgroundPosition);this.setTopStyle("background-repeat",this.backgroundRepeat);this.setTopStyle("background-size",this.backgroundSize);this.setTopStyle("box-shadow",this.boxShadow);if(this.boxShadow!==undefined){this.setTopStyle("font-size","medium")}this.__updateHorizontalScroll();this.__updateVerticalScroll();this.__initCursor()},__updateDisabled:function(){if(Top.Util.Browser.isIE()&&this.getAttribute("disabled")){this.disabled=this.getAttribute("disabled")}if(this.childRoot){var children=this.childRoot.children}else{var children=this.children}if(children!==undefined){var disabled=this.__calculateDerivedDisabled();if(this.childRoot){var firstTopChild=findTopTag(this.childRoot)}else{var firstTopChild=findTopTag(this)}if(firstTopChild===null){if(Top.Util.Browser.isIE()&&disabled!==true&&disabled!=="true"){this.removeAttribute("disabled");this.disabled=false}return}for(var i=0,len=firstTopChild.parentNode.children.length;i<len;i++){firstTopChild.parentNode.children[i].__derivedDisabled=disabled;if(typeof firstTopChild.parentNode.children[i].__updateDisabled==="function"){firstTopChild.parentNode.children[i].__updateDisabled()}}if(Top.Util.Browser.isIE()&&disabled!==true&&disabled!=="true"){this.removeAttribute("disabled");this.disabled=false}}function findTopTag(node){for(var i=0;i<node.children.length;i++){if(Top.Util.__isTopWidget(node.children[i].tagName)){return node.children[i]}return findTopTag(node.children[i])}return null}},__calculateDerivedDisabled:function(){return this.__derivedDisabled==="true"||this.__derivedDisabled===true?"true":this.disabled},__updateVisible:function(){this.removeTopStyle("visibility");if(this.visible===true||this.visible==="true")this.visible="visible";if(this.display!=="none")this.prevDisplay=this.display;this.__updateDisplay();this.setTopStyle("visibility",this.visible);if(this.visible==="visible"){var textfields=this.getElementsByTagName("top-textfield");if(Top.App.isLoaded()){Top.App.onWidgetAttach(this.id,function(){for(var i=0,len=textfields.len;i<len;i++){var item=textfields[i];if(item.__isAttached===true){item.setTitlePosition();item.setIconPosition()}}})}else{Top.App.onLoad(function(){for(var i=0,len=textfields.len;i<len;i++){var item=textfields[i];item.setTitlePosition();item.setIconPosition()}})}var tableviews=this.getElementsByTagName("top-tableview");for(var i=0;i<tableviews.length;i++){tableviews[i].__adjustByParentVisible()}if(this.adjustSize)this.adjustSize()}this.__initCursor();if(this.__isAttached===true)this.adjustSize()},__updateLayoutWidth:function(){var borderRightWidth,borderLeftWidth;var layoutWidth=this.layoutWidth;if(this.borderWidth){borderRightWidth=this.borderRightWidth;borderLeftWidth=this.borderLeftWidth}else{borderRightWidth=borderLeftWidth=1}if(this.layoutWidth==null&&this.tagName!=="TOP-FOLDINGLAYOUT"&&!(this.__isCustomWidget||this.isCustomType)){this.layoutWidth="100%"}if(this.layoutWidth&&this.layoutWidth.endsWith("%")){layoutWidth="calc("+this.layoutWidth+" - "+(parseInt(this.marginRight)+parseInt(this.marginLeft)+parseInt(this.paddingRight)+parseInt(this.paddingLeft)+parseInt(borderRightWidth)+parseInt(borderLeftWidth))+"px)"}if(this.layoutWidth==="match_parent")return;this.removeTopStyle("width");this.setTopStyle("width",layoutWidth);this.updatePositionValue(false)},__updateLayoutHeight:function(){if(!this.layoutHeight){return}var layoutHeight=this.layoutHeight;if(layoutHeight.indexOf("%")!==-1){if(this.parentNode&&this.parentNode.parentNode&&this.parentNode.parentNode.nodeName==="TOP-LINEARLAYOUT"&&this.parentNode.parentNode.getAttribute("orientation")==="vertical"){this.style.height=this.layoutHeight;layoutHeight="100%"}}if(layoutHeight.endsWith("%")){var boxing=parseInt(this.marginTop)+parseInt(this.marginBottom)+parseInt(this.paddingTop)+parseInt(this.paddingBottom)+parseInt(this.borderTopWidth)+parseInt(this.borderBottomWidth);layoutHeight="calc("+layoutHeight+" - "+boxing+"px)"}if(this.layoutHeight==="match_parent")return;this.removeTopStyle("height");this.setTopStyle("height",layoutHeight);this.updatePositionValue(false)},setThisWidgetWidth:function(parentWidth,parentElement){var borderRightWidth=this.borderRightWidth||0;var borderLeftWidth=this.borderLeftWidth||0;var layoutWidth=parseInt(this.marginRight)+parseInt(this.marginLeft)+parseInt(this.paddingRight)+parseInt(this.paddingLeft)+parseInt(borderRightWidth)+parseInt(borderLeftWidth);if(layoutWidth>0)layoutWidth="calc("+parentWidth+" - "+layoutWidth+"px)";else if(parentWidth.includes("-"))layoutWidth="calc("+parentWidth+")";else layoutWidth=parentWidth;this.removeTopStyle("width");this.setTopStyle("width",layoutWidth);if(this.childs){if(this.tagName==="TOP-GRIDLAYOUT")this.__setCellSize()}return layoutWidth},setThisWidgetHeight:function(parentHeight){var checkWeightValue;var borderTopWidth=this.borderTopWidth||0;var borderBottomWidth=this.borderBottomWidth||0;var layoutHeight=parseInt(this.marginTop)+parseInt(this.marginBottom)+parseInt(this.paddingTop)+parseInt(this.paddingBottom)+parseInt(borderTopWidth)+parseInt(borderBottomWidth);if(layoutHeight>0)layoutHeight="calc("+parentHeight+" - "+layoutHeight+"px)";else if(parentHeight.includes("-"))layoutHeight="calc("+parentHeight+")";else layoutHeight=parentHeight;this.removeTopStyle("height");this.setTopStyle("height",layoutHeight);if(this.childs){if(this.tagName==="TOP-GRIDLAYOUT")this.__setCellSize()}return layoutHeight},__initCursor:function(){if(this.__eventMouseClick&&typeof this.__eventMouseClick==="function"){if(this.childRoot)this.childRoot.style.cursor="pointer"}},appendHtmlString:function(htmlString){this.adjusted=false;var wrapper=document.createElement("div");wrapper.innerHTML=htmlString;this.initializeHtmlObjects(wrapper);while(wrapper.firstChild){if(wrapper.firstChild.tagName&&TopRuntime.topWidgets[wrapper.firstChild.tagName.toLowerCase()]!==undefined)TopRuntime.srcRootNode.push(wrapper.firstChild);if(this.childRoot)this.childRoot.appendChild(wrapper.firstChild);else this.appendChild(wrapper.firstChild)}},prependHtmlString:function(htmlString){this.adjusted=false;var wrapper=document.createElement("div");wrapper.innerHTML=htmlString;this.initializeHtmlObjects(wrapper);while(wrapper.firstChild){if(wrapper.firstChild.tagName&&TopRuntime.topWidgets[wrapper.firstChild.tagName.toLowerCase()]!==undefined)TopRuntime.srcRootNode.push(wrapper.firstChild);if(this.childRoot)this.childRoot.insertBefore(wrapper.firstChild,this.childRoot.childNodes[0]);else this.insertBefore(wrapper.firstChild,this.childNodes[0])}},initializeHtmlObjects:function(child,isCustomNode){if(!child.children)return;if(child.tagName==="TOP-TABLEVIEW"||child.tagName==="TOP-LISTVIEW"||child.tagName==="TOP-TREEVIEW"||child.tagName==="TOP-GRIDLAYOUT")return;if(child.tagName==="TOP-TABLAYOUT"){child.childString=[];for(var i=0;i<child.children[0].children.length;i++){child.childString.push(child.children[0].children[i].outerHTML)}}for(var i=0;i<child.children.length;i++){if(child.children[i].tagName&&TopRuntime.topWidgets[child.children[i].tagName.toLowerCase()]!==undefined){var topWidget=TopRuntime.topWidgets[child.children[i].tagName.toLowerCase()];TopRuntime._initProperties(topWidget,child.children[i]);TopRuntime._prepAllBehaviors(topWidget,child.children[i]);if(!child.children[i].isTemplateAppended())child.children[i].appendTemplate();if(child.children[i].isCustomType)continue;if(isCustomNode)TopRuntime.customNodes.push(child.children[i]);else TopRuntime.insertedNodes.push(child.children[i])}if(isCustomNode)this.initializeHtmlObjects(child.children[i],true);else this.initializeHtmlObjects(child.children[i])}},createHtmlObjects:function(child,isCustomNode){if(!child.children)return;if(child.tagName==="TOP-TABLEVIEW"||child.tagName==="TOP-LISTVIEW"||child.tagName==="TOP-TREEVIEW"||child.tagName==="TOP-GRIDLAYOUT")return;if(child.tagName==="TOP-TABLAYOUT"){child.childString=[];for(var i=0;i<child.children[0].children.length;i++){child.childString.push(child.children[0].children[i].outerHTML)}}for(var i=0;i<child.children.length;i++){if(child.children[i].tagName&&TopRuntime.topWidgets[child.children[i].tagName.toLowerCase()]!==undefined){var topWidget=TopRuntime.topWidgets[child.children[i].tagName.toLowerCase()];TopRuntime._initProperties(topWidget,child.children[i]);TopRuntime._prepAllBehaviors(topWidget,child.children[i]);if(!child.children[i].isTemplateAppended())child.children[i].appendTemplate();if(child.children[i].isCustomType)continue;if(isCustomNode)this.createdCustomItemWidgets.push(child.children[i]);else this.createdItemWidgets.push(child.children[i])}if(isCustomNode)this.createHtmlObjects(child.children[i],true);else this.createHtmlObjects(child.children[i])}},createdItemWidgetAttachedCallback:function(){var l=this.createdCustomItemWidgets.length;while(l--){TopRuntime._callCallback(this.createdCustomItemWidgets[l],"created");TopRuntime._callCallback(this.createdCustomItemWidgets[l],"ready");TopRuntime._callCallback(this.createdCustomItemWidgets[l],"attached")}this.createdCustomItemWidgets=[];l=this.createdItemWidgets.length;while(l--){this.createdItemWidgets[l]=TopRuntime._setDefaultProperties(this.createdItemWidgets[l]);TopRuntime._callCallback(this.createdItemWidgets[l],"created");TopRuntime._callCallback(this.createdItemWidgets[l],"ready");if(!TopRuntime.srcRootNode.includes(this.createdItemWidgets[l]))TopRuntime._callCallback(this.createdItemWidgets[l],"attached")}this.createdItemWidgets=[]},splitBorder:function(){if(this.borderWidth){var tmpBorderWidth=this.borderWidth.split(" ");if(tmpBorderWidth.length==1){this.borderTopWidth=this.borderRightWidth=this.borderBottomWidth=this.borderLeftWidth=tmpBorderWidth[0]}else if(tmpBorderWidth.length==2){this.borderTopWidth=this.borderBottomWidth=tmpBorderWidth[0];this.borderRightWidth=this.borderLeftWidth=tmpBorderWidth[1]}else if(tmpBorderWidth.length==4){this.borderTopWidth=tmpBorderWidth[0];this.borderRightWidth=tmpBorderWidth[1];this.borderBottomWidth=tmpBorderWidth[2];this.borderLeftWidth=tmpBorderWidth[3]}}else{this.borderTopWidth=this.borderRightWidth=this.borderBottomWidth=this.borderLeftWidth="1px"}},__updateTileMode:function(){if(this.tileMode==null||this.tileMode==="")this.tileMode="stretch";if(this.tileMode==="stretch"){this.setTopStyle("background-size","cover")}else{this.setTopStyle("background-repeat",this.tileMode)}},__updateWidgets:function(){},__adjustWidgets:function(){if(this.tagName==="TOP-GRIDLAYOUT")this.__setCellSize();if(typeof this.__setWidgetSize==="function")this.__setWidgetSize();if(this.tagName==="TOP-LINEARLAYOUT")this.__setWidgetWeight()},__adjustLineHeight:function(){if(this.layoutHeight&&(this.layoutHeight.includes("%")||this.layoutHeight==="match_parent")&&!this.tagName==="TOP-GRIDLAYOUT"){this.childs.forEach(function(child){if(typeof child.__adjustLineHeight==="function")child.__adjustLineHeight()})}else{return}},addWidget:function(widget){this.childs.push(widget.template);this.adjusted=false},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;this.adjusted=false;if(this.childRoot)var root=this.childRoot;else var root=this;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child);break}}this.childs=top$(root).children()},getChildren:function(selector){var topElements=[];if(selector){var elements=this.querySelectorAll(selector)}else{if(this.childs===undefined)this.initialChilds();var elements=this.childs.toArray()}var len=elements.length;for(var i=0;i<len;i++){topElements[i]=Top.Dom.__selectImpl(elements[i])}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}var len=this.template.childs.length;for(var i=0;i<len;i++){if(childId==this.template.childs[i].id){return true}}return false},clear:function(){this.adjusted=false;if(this.childs){this.childs.splice(0,this.template.childs.length);this.complete()}},complete:function(){this.renderLayout(true)},adjustSize:function(){if(this.adjusted===true){if(this.childRoot)var root=this.childRoot;else var root=this;for(var i=0;i<root.children.length;i++){if(typeof root.children[i].adjustSize==="function")root.children[i].adjustSize()}return}if(this.childRoot){var isVisible=!!(this.childRoot.offsetWidth||this.childRoot.offsetHeight||this.childRoot.getClientRects().length)}else{var isVisible=!!(this.offsetWidth||this.offsetHeight||this.getClientRects().length)}if(isVisible===true){this.adjusted=true;if(this.tagName==="TOP-GRIDLAYOUT")this.__setCellSize();if(typeof this.__setWidgetSize==="function")this.__setWidgetSize(true)}}};Top.Widget.Layout=function(){Layout.prototype=Object.create(Top.Widget.prototype);Layout.prototype.constructor=Layout;function Layout(obj){Object.assign(this,obj);if(this.template==null){this.template=new TopLayout;this.template.id=this.id}}Layout.create=function(obj){return new Layout(obj)};Layout.prototype.append=function(htmlString,callback){if(Top.Util.getFileExtension(htmlString)==="html"){var _this=this;Top.Ajax.execute(htmlString,{success:function(data){_this.template.appendHtmlString(data);_this.template.initialChilds();TopRuntime._insertedNodesCallback();if(typeof callback==="function")callback();TopRuntime._srcRootNodesAttachedCallback();data=null}})}else{this.template.appendHtmlString(htmlString);this.template.initialChilds();TopRuntime._insertedNodesCallback();TopRuntime._srcRootNodesAttachedCallback()}};Layout.prototype.prepend=function(htmlString,callback){if(Top.Util.getFileExtension(htmlString)==="html"){var _this=this;Top.Ajax.execute(htmlString,{success:function(data){_this.template.prependHtmlString(data);_this.template.initialChilds();TopRuntime._insertedNodesCallback();if(typeof callback==="function")callback();TopRuntime._srcRootNodesAttachedCallback();data=null}})}else{this.template.prependHtmlString(htmlString);this.template.initialChilds();TopRuntime._insertedNodesCallback();TopRuntime._srcRootNodesAttachedCallback()}};Layout.prototype.html=function(htmlString){this.template.clearChilds();if(!htmlString||htmlString===""){return}this.template.appendHtmlString(htmlString);this.template.initialChilds();TopRuntime._insertedNodesCallback();TopRuntime._srcRootNodesAttachedCallback()};Layout.prototype.load=function(name,callback){if(typeof Top.configs.jsPath==="string"){this.src(name+".html",Top.configs.jsPath+"/"+name+".js",callback)}else{this.src(name+".html",name+".js",callback)}};Layout.prototype.src=function(htmlFile,jsFile,callback){if(Top.Util.getFileExtension(htmlFile)!="html")return;if(typeof jsFile==="function"&&callback===undefined)callback=jsFile;var _this=this;loadHtml=function(){Top.Ajax.execute(htmlFile,{success:function(data,textStatus,jqXHR){var controllerPaths=Top.Util.__getControllerPaths(data);if(Top.App.__useCommonLogic()===true&&controllerPaths!==undefined){Top.App.__loadControllerFile(controllerPaths,function(){_this.template.__onSuccessSrcLoad(data,callback);data=null})}else{_this.template.__onSuccessSrcLoad(data,callback);data=null}_this.template.src=htmlFile},complete:function(){if(_this.template.__redrawChild!==undefined){for(var i=0;i<_this.template.__redrawChild.length;i++){_this.template.__redrawChild[i]()}}}})};if(typeof jsFile==="string"){this.template.__loadScript(jsFile,loadHtml)}else{loadHtml()}};Layout.prototype.addWidget=function(widget){widget.template.layoutParent=this.template;this.template.addWidget(widget)};Layout.prototype.removeWidget=function(widget){this.template.removeWidget(widget)};Layout.prototype.getChildren=function(selector){return this.template.getChildren(selector)};Layout.prototype.hasChild=function(child){if(typeof child==="string"){return this.template.hasChild(child)}else if(typeof child==="object"){var tagName=child.template?child.template.tagName:child.tagName;if(Top.Util.__isTopWidget(tagName)){return this.template.hasChild(child)}else{return this.template.contains(child)}}};Layout.prototype.clear=function(){this.template.clear()};Layout.prototype.complete=function(){this.getChildren().forEach(function(child){if(TopRuntime.createdNodes.includes(child.template)){TopRuntime._callCallback(child.template,"attached")}});this.template.complete()};Layout.prototype.adjustWidgets=function(){this.template.__adjustWidgets()};Layout.prototype.selectById=function(id){var element=this.template.querySelector("#"+id);if(element==null)return null;return Top.Dom.__selectImpl(element)};Layout.prototype.select=function(selector){var element=this.template.querySelectorAll(selector);var len=element.length;var widgets=[];for(var i=0;i<len;i++){var selected=Top.Dom.__selectImpl(element[i]);if(selected)widgets.push(selected)}return widgets};Layout.prototype.onSrcLoad=function(fn){if(this.template.srcLoadListeners===undefined){this.template.srcLoadListeners=[]}this.template.srcLoadListeners.push(fn)};Layout.prototype.scrollTop=function(value){if(this.template.childRoot){this.template.childRoot.scrollTop=value}};return Layout}();TopMenuBehavior={properties:{id:{type:String,reflectToAttribute:true},menuItems:[]},ready:function(){if(!this.id){this.id=Top.Util.guid()}},initMenuItems:function(){this.menuItems=top$(this.childRoot).children("top-menuitem");for(var i=0;i<this.menuItems.length;i++){this.menuItems[i].menuWidget=this}if(this.items&&this.menuItems&&this.menuItems.length===1){this.menuLayout=this.menuItems[0].innerHTML}},clearMenuItems:function(){if(this.tagName==="TOP-MENU")var myNode=this.childRoot.firstElementChild;else var myNode=this.childRoot;while(myNode&&myNode.firstChild){myNode.removeChild(myNode.firstChild)}}};Top.Widget.Menu=function(){Menu.prototype=Object.create(Top.Widget.prototype);Menu.prototype.constructor=Menu;function Menu(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-menu");this.template.innerHTML='<div class="top-menu-root"></div>'}this.id=this.template.id}Menu.create=function(element){return new Menu(element)};Menu.prototype.addMenu=function(widget){this.template.menuItems.push(widget.template)};Menu.prototype.removeMenu=function(widget,destroy){var child_len=this.template.menuItems.length;for(var i=0;i<child_len;i++){if(this.template.menuItems[i].id==widget.id){this.template.menuItems.splice(i,1);break}}};Menu.prototype.complete=function(){this.template.__updateItems()};Menu.prototype.open=function(menuId,animate){this.template.open(menuId,animate)};Menu.prototype.close=function(menuId){this.template.close(menuId)};Menu.prototype.toggle=function(menuId){this.template.toggle(menuId)};Menu.prototype.getSelectedMenuId=function(){return this.template.selectedMenuId};Menu.prototype.getSelectedMenuData=function(){return this.template.__getSelectedMenuDataById(this.template.selectedMenuId)};Menu.prototype.setMenuLayout=function(selector,layout){this.template.setMenuLayout(selector,layout)};Menu.prototype.deSelect=function(){this.template.deSelect()};Menu.prototype.sideOpen=function(){this.template.sideOpen(this.template.selectedNode)};return Menu}();TopRangeBehavior={properties:{progress:{type:Number,value:.5},max:{type:Number,value:100},min:{type:Number,value:0},number:{type:String,value:1},step:{type:Number,value:1}}};TopResourceBehavior={properties:{src:String}};TopTextBehavior={properties:{text:{type:String,reflectToAttribute:true},textSize:String,textColor:String,textStyle:String,textWeight:String,autoComplete:String,autoCompleteOption:String,autoCompleteAlign:{type:String,value:"bl"},autoCompleteMaxHeight:String,chip:String,chipItems:String,supportEmpty:{type:String,value:false},onSelect:String},ready:function(){this.__initI18n("text")},__initEventInternal:function(){this.__addEventByAttr("select")},__attachEventHandler:function(){var _this=this;if(this.tagName==="TOP-TEXTFIELD"){var inputClassName="top-textfield-text"}else if(this.tagName==="TOP-TEXTAREA"){var inputClassName="top-textarea-root"}else{return}var shadowInput=this.querySelector("."+inputClassName);shadowInput.removeEventListener("keydown",openCtrlSpace);shadowInput.addEventListener("keydown",openCtrlSpace);function openCtrlSpace(e){if(e.ctrlKey&&e.keyCode===32){_this.openAutoComplete();e.preventDefault()}}},__updateAutoComplete:function(){var _this=this;Top.App.onWidgetAttach(this.id,function(){_this.__renderAutoComplete()});this.__attachEventHandler()},__updateAutoCompleteOption:function(){var _this=this;
Top.App.onWidgetAttach(this.id,function(){_this.__renderAutoComplete()})},__updateAutoCompleteAlign:function(){var _this=this;Top.App.onWidgetAttach(this.id,function(){_this.__renderAutoComplete()})},__updateChip:function(){},__renderAutoComplete:function(){if(this.tagName==="TOP-TEXTFIELD"){var inputClassName="top-textfield-text"}else if(this.tagName==="TOP-TEXTAREA"){var inputClassName="top-textarea-root"}else if(this.tagName==="TOP-CHIP"){var inputClassName="top-chip-text"}else{return}if(typeof this.autoCompleteOption==="string"){var option=Top.Util.namespace(this.autoCompleteOption,this)}else if(typeof this.autoCompleteOption==="object"){var option=this.autoCompleteOption}if(typeof option==="object"){if(typeof option.result==="function"){var result=option.result;var menuTemplate='<ul class="typeahead dropdown-menu" style="padding:0px; margin:0px; border:0px; box-shadow:none;"></ul>'}if(typeof option.sources==="object"){var sources=option.sources}else if(typeof option.sources==="function"){var sources=option.sources()}}else if(typeof this.autoComplete==="string"){var sources=this.autoComplete.split(",")}else{return}var sourceArray=[];if(sources===undefined)return;for(var i=0;i<sources.length;i++){if(typeof sources[i]==="string"){sourceArray[i]={id:i,name:sources[i]}}else if(typeof sources[i]==="object"){var keys=Object.keys(sources[i]);sourceArray[i]={};for(var j=0,len=keys.length;j<len;j++){if(keys[j]==="text"){sourceArray[i].name=sources[i].text}else{sourceArray[i][keys[j]]=sources[i][keys[j]]}}}}this.supportEmpty=this.supportEmpty==="true"||this.supportEmpty===true?true:false;var shadowInput=this.querySelector("."+inputClassName);var _this=this;this.typeahead=top$(shadowInput).typeahead({items:sourceArray.length,source:sourceArray,result:result,shadowRoot:shadowInput,supportEmpty:this.supportEmpty,menu:menuTemplate,align:_this.autoCompleteAlign,itemSelected:function(selectedItem,value,text){_this.text=text;shadowInput.value=text;_this.updateData("text");_this.updateDevice("text");if(typeof _this.__eventKeyReleased==="function")_this.__eventKeyReleased();if(typeof option==="object"){if(typeof option.onSelect==="string"){option.onSelect=Top.Util.namespace(option.onSelect,_this)}if(typeof option.onSelect==="function"){for(var i=0,len=sources.length;i<len;i++){if(sources[i].id===value){var obj=sources[i];break}}option.onSelect(text,obj)}}else if(_this.onSelect){if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("select"))}else{_this.__dispatchEvent(new Event("select"))}}if(_this.tagName==="TOP-CHIP"){var chipInput=_this.querySelector(".top-chip-root").querySelector(".top-chip-text");if(chipInput.value!==""){var appendChip={text:shadowInput.value,value:null,icon:null};_this.chipItems.push(appendChip);_this.__addChip(appendChip);_this.__resizeInputWidth()}if(typeof _this.onAdd==="function"){_this.onAdd(event,chipInput.value,_this.chipItems)}chipInput.value=""}}});if(typeof this.autoCompleteMaxHeight==="string"){var list=document.querySelector(".typeahead."+this.id);list.style.maxHeight=this.autoCompleteMaxHeight;list.style.overflowY="auto"}Top.App.addAutoCompleteContainer(this.typeahead)},openAutoComplete:function(){this.typeahead.data("open")()},closeAutoComplete:function(){this.typeahead.data("close")()},isOpenAutoComplete:function(){var autoComplete=document.querySelector(".typeahead."+this.id);return autoComplete&&autoComplete.style.display==="block"},__updateText:function(){this.text=this.__i18n(this.text)},__updateOnSelect:function(){this.__addEventByAttr("select")},__setTimer:function(element){if(this.__timerInterval)clearInterval(this.__timerInterval);if(!element)return;element.innerText=this.timer;var pattern=new RegExp(this.__format.replace("mm","([0-9]+)").replace("ss","([0-9]+)"));var _this=this;this.__timerInterval=setInterval(function(){var result=pattern.exec(element.innerText);if(result===null){clearInterval(_this.__timerInterval);return}var time=parseInt(result[1]*60)+parseInt(result[2]);time--;var minutes=_this.__leadingZeros(parseInt(time/60),2);var seconds=_this.__leadingZeros(parseInt(time%60),2);element.innerText=_this.__format.replace("mm",minutes).replace("ss",seconds);if(time<=0){clearInterval(_this.__timerInterval);if(typeof _this.onEndtimer==="string")_this.onEndtimer=Top.Util.namespace(_this.onEndtimer,_this);if(typeof _this.onEndtimer==="function")_this.onEndtimer()}},1e3)},__leadingZeros:function(n,digits){var zero="";n=n.toString();for(var i=0;i<digits-n.length;i++)zero+="0";return zero+n},__stopTimer:function(element){if(this.__timerInterval)clearInterval(this.__timerInterval);element.innerText=this.__format.replace("mm","00").replace("ss","00")},__pauseTimer:function(element){if(this.__timerInterval)clearInterval(this.__timerInterval);this.timer=element.innerText},__clearTimer:function(){if(this.__timerInterval)clearInterval(this.__timerInterval)}};TopMaskBehavior={properties:{preventKey:String,format:String,mask:String,maskOption:String,pattern:Object},ready:function(){this.__initI18n("mask");this.__initI18n("maskOption");this.__initI18n("pattern");this.__initI18n("format");this.__initI18n("preventKey");this.__initFormat()},__initFormat:function(){this.__updatePreventKey()},__updatePreventKey:function(){this.preventKey=this.__i18n(this.preventKey);this.__updateFormat()},__updateFormat:function(){var _this=this;var re=undefined;var mask=undefined;this.format=this.__i18n(this.format);if(!this.pattern){switch(this.format){case"number":mask={mask:"numeric",option:{digits:2}};break;case"en":case"english":re=/^[a-zA-Z\s]*$/;break;case"enNum":re=/^[a-zA-Z0-9\s]*$/;break;case"ko":case"korean":re=/^[\u3131-\uD79D\s]*$/;break;case"enKo":re=/^[\u3131-\uD79Da-zA-Z\s]*$/;break;case"enKoNum":re=/^[\u3131-\uD79Da-zA-Z0-9\s]*$/;break;case"upper":re=/^[A-Z\s]*$/;break;case"lower":re=/^[a-z\s]*$/;break;case"date":mask={mask:"datetime",option:{inputFormat:"yyyy-mm-dd"}};"datetime";break;case"currency":mask={mask:"currency",option:{prefix:"￦ ",digits:2,placeholder:""}};break;case"email":mask={mask:"email",option:{placeholder:"_",showMaskOnHover:false,showMaskOnFocus:false}};break;case"credit":mask={mask:"9999 9999 9999 9999",option:{placeholder:" ",showMaskOnHover:false,showMaskOnFocus:false}};break;case"metric":mask={mask:"numeric",option:{suffix:" kg",numericInput:true,autoGroup:true,groupSeparator:","}};break;case"percentage":mask="percentage";break;case"url":mask="url";break;case"ip":mask="url";break;case"mac":mask="mac";break;default:re=mask=undefined}}this.__updateMaskOption();this.__updateMask(mask);this.__updatePattern(re)},__updateMask:function(mask){this.mask=this.__i18n(this.mask);if(typeof mask==="object"){this.maskData=mask.mask;this._maskOptionData=mask.option}else{this.maskData=mask}if(this.mask){this.maskData=this.mask}if(this.maskOptionData){this._maskOptionData=this.maskOptionData}if(this.mask)this.shadowText().style.removeProperty("text-align");if(this.maskData!==undefined&&this.maskData!==""){top$(this.shadowText()).inputmask(this.maskData,this._maskOptionData);this.removeEventListener("keyup",this.validation);this.shadowText().removeEventListener("keyup",this.validation)}else{if(this.shadowText().inputmask){top$(this.shadowText()).inputmask("remove")}}},__updateMaskOption:function(){this.maskOption=this.__i18n(this.maskOption);if(typeof this.maskOption=="string"){this.maskOptionData=Top.Util.namespace(this.maskOption,this);if(!this.maskOptionData){this.maskOptionData=eval("("+this.maskOption+")")}}else if(typeof this.maskOption=="object"){this.maskOptionData=this.maskOption}else{return}this.__updateMask()},__updatePattern:function(re){var _this=this;if(!this.pattern)this.pattern=re;if(this.pattern){if(this.preventKey===true||this.preventKey==="true"){var shadowText=this.shadowText();if(shadowText.value.length>0){if(typeof this.pattern==="string")var regexForRemove=this.pattern.replace(/\^\[|\$/g,"");else if(typeof this.pattern==="object")var regexForRemove=this.pattern.toString().replace(/\/\^\[|\$\//g,"");regexForRemove="[^"+regexForRemove;regexForRemove=new RegExp(regexForRemove,"g");var modifiedText=shadowText.value.replace(regexForRemove,"");if(modifiedText!==shadowText.value)Top.Dom.selectById(this.id).setText(modifiedText)}top$(shadowText).off("keydown").on("keydown",function(event){var key=event.key;var code=event.keyCode;if(code==32)key=" ";if(code==110){if(!_this.pattern.toString().includes("."))event.preventDefault();return}var regex=new RegExp(_this.pattern);if(regex.test(key)===true)return;if(event.ctrlKey||event.altKey)return;if(code==8||code==9||code==46)return;if(code>=35&&code<=40)return;if(code==229)return;else event.preventDefault()});top$(shadowText).off("keyup").on("keyup",function(event){if(_this.format!=="ko"&&_this.format!=="enKo"&&_this.format!=="enKoNum"){event.target.value=event.target.value.replace(/[\u3131-\uD79D]/g,"");_this.text=event.target.value}});top$(shadowText).on("blur",function(event){if(_this.format!=="ko"&&_this.format!=="enKo"&&_this.format!=="enKoNum"){event.target.value=event.target.value.replace(/[\u3131-\uD79D]/g,"");_this.text=event.target.value}})}else{top$(shadowText).off("keydown")}}this.validation=function(){if(_this.text&&!_this.text.match(this.pattern)){_this.setError();return false}else{_this.removeError();return true}};this.removeEventListener("keyup",this.validation);if(this.pattern&&typeof this.pattern==="string")this.pattern=new RegExp(this.pattern);if(this.pattern){this.addEventListener("keyup",this.validation);this.validation()}},getUnmaskedText:function(){if(this.shadowText().inputmask){return this.shadowText().inputmask.unmaskedvalue()}else{return this.shadowText().value}}};TopAbsolutelayout={is:"top-absolutelayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],__ready:function(){this.initialChilds();this.__updateId();this.renderLayout()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-absolutelayout-root">'+this.innerHTML+"</div>"},__attached2:function(){this.adjustSize()},initializeChildRoot:function(){return this.querySelector(".top-absolutelayout-root")},renderLayout:function(){var layoutRoot=this.childRoot;var pPaddingTop=parseFloat(layoutRoot.style.paddingTop)||0;var pPaddingLeft=parseFloat(layoutRoot.style.paddingLeft)||0;for(var i=0;i<layoutRoot.children.length;i++){var child=layoutRoot.children[i];this.__setWrapperStyle(child,pPaddingTop,pPaddingLeft)}},__setWrapperStyle:function(child,pPaddingTop,pPaddingLeft){var layoutTop="0px";var layoutLeft="0px";var display="inline-block;";if(child.layoutTop){if(child.layoutTop.includes("%")){layoutTop="calc("+child.layoutTop+" + "+pPaddingTop+"px)"}else{layoutTop=parseInt(child.layoutTop)+pPaddingTop+"px"}}else{layoutTop=pPaddingTop+"px"}if(child.layoutLeft){if(child.layoutLeft.includes("%")){layoutLeft="calc("+child.layoutLeft+" + "+pPaddingLeft+"px)"}else{layoutLeft=parseInt(child.layoutLeft)+pPaddingLeft+"px"}}else{layoutLeft=pPaddingLeft+"px"}if(child.visible=="none"){display="none;"}child.style.cssText="position: absolute; display:"+display+"top: "+layoutTop+"; left: "+layoutLeft+"; vertical-align:top;"},initialChilds:function(){this.childs=[];for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-absolutelayout-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__setWidgetSize:function(){var layoutRoot=this.childRoot;var root=layoutRoot;if(this.layoutWidth==="auto"){layoutRoot.style.width=layoutRoot.scrollWidth}if(this.layoutHeight==="auto"){layoutRoot.style.height=layoutRoot.scrollHeight}for(var i=0,len=root.children.length;i<len;i++){var item=root.children[i];if(item.tagName==="DIV")item=item.firstElementChild;var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto",pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var pPaddingWidth=(parseInt(layoutRoot.style.paddingRight)||0)+(parseInt(layoutRoot.style.paddingLeft)||0),pPaddingHeight=(parseInt(layoutRoot.style.paddingTop)||0)+(parseInt(layoutRoot.style.paddingBottom)||0);if(item.layoutWidth==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{item.style.width="calc(100% - "+pPaddingWidth+"px)";item.setThisWidgetWidth("100%")}}else if(item.layoutWidth&&item.layoutWidth.includes("%")){item.style.width="calc("+item.layoutWidth+" - "+pPaddingWidth+"px)";item.setThisWidgetWidth("100%")}if(item.layoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{item.style.height="calc(100% - "+pPaddingHeight+"px)";item.setThisWidgetHeight("100%")}}else if(item.layoutHeight&&item.layoutHeight.includes("%")){item.style.height="calc("+item.layoutHeight+" - "+pPaddingHeight+"px)";item.setThisWidgetHeight("100%")}if(item.getAttribute("layout-top")!=null){item.removeTopStyle("top")}if(item.getAttribute("layout-left")!=null){item.removeTopStyle("left")}}},addWidget:function(widget){var layoutRoot=this.childRoot;var root=layoutRoot;var pPaddingTop=layoutRoot.style.paddingTop||0;var pPaddingLeft=layoutRoot.style.paddingLeft||0;widget.__isRendered=true;this.adjusted=false;root.appendChild(widget.template);this.__setWrapperStyle(widget.template,pPaddingTop,pPaddingLeft)},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;this.adjusted=false;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child);break}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},complete:function(){this.adjustSize()},getTopStyle:function(){this.topstyle=this.childRoot.style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.childRoot.style[key]=value;this.topstyle=this.childRoot.style.cssText}},setAllTopStyle:function(){this.childRoot.style.cssText=this.topstyle}};Top.Widget.Layout.Absolutelayout=function(){Absolutelayout.prototype=Object.create(Top.Widget.Layout.prototype);Absolutelayout.prototype.constructor=Absolutelayout;function Absolutelayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-absolutelayout");this.template.innerHTML='<div class="top-absolutelayout-root"></div>'}this.id=this.template.id}Absolutelayout.create=function(element){return new Absolutelayout(element)};return Absolutelayout}();TopAccordionlayout={is:"top-accordionlayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{tabs:String,items:String,selected:String,onSelect:String,onClose:String,onInit:String,autoClose:{type:String,value:"true"}},__ready:function(){this.initialChilds();this.__initialClassname();if(typeof this.tabs==="string"){this.tabs=Top.Util.namespace(this.tabs)}if(typeof this.items==="string"){this.items=Top.Util.namespace(this.items)}if(typeof this.onSelect=="string"){this.select=Top.Util.namespace(this.onSelect,this)}if(typeof this.onClose=="string"){this.close=Top.Util.namespace(this.onClose,this)}this.__updateId();this.__updateName();this.__onInit()},appendTemplate:function(){this.innerHTML='<div class="top-accordionlayout-root">'+this.innerHTML+"</div>"},__addChildrenLoadEvent:function(fn){Top.App.onWidgetAttach(this.id,fn);var textfields=Array.prototype.slice.call(this.childRoot.querySelectorAll("top-textfield"));textfields.forEach(function(item){item.setIconPosition()})},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.name=this.name}},__attached2:function(){if(this.items){this.tabs=this.items;this.renderLayout()}this.renderTitle();this.__updateSelected();this.attachEventHandler()},initializeChildRoot:function(){return this.querySelector(".top-accordionlayout-root")},renderLayout:function(){var _this=this;if(typeof this.items==="string"){this.items=Top.Util.namespace(this.items)}var items=this.items;this.tabs=items;while(this.childRoot.firstChild){this.childRoot.removeChild(this.childRoot.firstChild)}var accordiontabs=document.createElement("div");var layout="";for(var i=0;i<items.length;i++){layout+="<top-accordiontab id='"+items[i].id+"'>"+items[i].html+"</top-accordiontab>"}accordiontabs.innerHTML=layout;this.createdItemWidgets=[];this.createdCustomItemWidgets=[];this.createHtmlObjects(accordiontabs);while(accordiontabs.firstChild){this.childRoot.appendChild(accordiontabs.firstChild)}var contents=this.childRoot.querySelectorAll(".top-accordionlayout-content");for(var i=0;i<contents.length;i++){contents[i].style.display="none"}this.createdItemWidgetAttachedCallback()},renderTitle:function(){var tabs=this.tabs;if(tabs===undefined){tabs=this.makeTabs();this.tabs=tabs}var len=tabs.length;for(var i=0;i<len;i++){for(var j=0;j<this.childRoot.children.length;j++){if(this.childRoot.children[j].id===tabs[i].id){this.childRoot.children[j].querySelector("div.top-accordionlayout-container").id="top-accordionlayout_"+tabs[i].id;var layout=tabs[i].text||tabs[i].layout;var titleNode=document.createElement("div");titleNode.innerHTML=layout;var title=this.childRoot.children[j].querySelector("a.top-accordionlayout-title");for(var k=0;k<title.childNodes.length;k++){if(!(title.childNodes[k].tagName==="I"&&title.childNodes[k].classList.contains("top-accordionlayout-icon"))){title.removeChild(title.childNodes[k])}}while(titleNode.firstChild){title.appendChild(titleNode.firstChild)}break}}}},makeTabs:function(){var tabs=[];for(var i=0,len=this.childRoot.children.length;i<len;i++){tabs[i]={};tabs[i].id=this.childRoot.children[i].id;tabs[i].text=this.childRoot.children[i].text}return tabs},selectTab:function(tabIdOrIndex){if(typeof tabIdOrIndex==="number"){var tabsLength=this.tabs.length;var index=tabIdOrIndex;if(tabsLength===0||tabsLength<index)return;else{var id=this.tabs[index].id;var selectedTab=this.querySelector("#"+id)}}else{var selectedTab=this.querySelector("#"+tabIdOrIndex)}if(selectedTab){var selectedTitle=selectedTab.querySelector(".top-accordionlayout-title");if(!selectedTitle.classList.contains("active"))selectedTitle.click()}},closeTab:function(){var selectedTab=this.querySelector(".active");if(!selectedTab)return;top$(selectedTab).removeClass("active");top$(selectedTab.nextElementSibling).slideUp();this.selected=undefined;var closed=selectedTab.parentNode.id.substring(20)},addTab:function(tabInfo){if(this.items){this.items.push(tabInfo)}this.createdItemWidgets=[];this.createdCustomItemWidgets=[];var tabId="";if(tabInfo&&tabInfo.id){tabId=tabInfo.id;this.tabs.push(tabInfo)}var layout="<top-accordiontab id='"+tabInfo.id+"'>"+tabInfo.html+"</top-accordiontab>";var accordiontab=document.createElement("div");accordiontab.innerHTML=layout;this.createHtmlObjects(accordiontab);while(accordiontab.firstChild){this.childRoot.appendChild(accordiontab.firstChild)}this.renderTitle();this.createdItemWidgetAttachedCallback()},removeTab:function(tabId){var index;for(var i=0,len=this.tabs.length;i<len;i++){if(this.tabs[i].id===tabId){index=i;break}}this.tabs.splice(index,1);var accordiontabs=this.childRoot.querySelectorAll("top-accordiontab");this.childRoot.removeChild(accordiontabs[index])},attachEventHandler:function(){var _this=this;top$(this).off("click"," .top-accordionlayout-title:not(.active)").on("click"," .top-accordionlayout-title:not(.active)",function(){if(_this.autoClose=="true"){top$(_this.querySelector(" .top-accordionlayout-title.active")).click()}top$(this).addClass("active");top$(this.nextElementSibling).slideDown();_this.selected=this.parentNode.id.substring(20);_this.updateData("selected");_this.__addChildrenLoadEvent(function(){if(typeof _this.select==="function")_this.select(_this.selected)})});top$(this).off("click"," .top-accordionlayout-title.active").on("click"," .top-accordionlayout-title.active",function(){top$(this).removeClass("active");top$(this.nextElementSibling).slideUp();var closed=this.parentNode.id.substring(20);_this.selected=undefined;_this.__addChildrenLoadEvent(function(){if(typeof _this.close==="function")_this.close(closed)})})},__onInit:function(){var _this=this;Top.App.onWidgetAttach(this.id,function(){if(typeof _this.onInit==="function"){_this.onInit()}else if(typeof _this.onInit==="string"){Top.Util.namespace(_this.onInit)()}})},__updateSelected:function(){if(this.selected){var selectedTitle=this.childRoot.querySelector("#top-accordionlayout_"+this.selected+" .top-accordionlayout-title");if(selectedTitle){top$(selectedTitle).addClass("active");top$(selectedTitle.nextElementSibling).slideDown()}this.__addChildrenLoadEvent(function(){if(typeof this.select==="function")this.select(this.selected)})}},__updateTabs:function(){var tabs=this.tabs;var len=tabs.length;for(var i=0;i<len;i++){for(var j=0;j<this.childRoot.children.length;j++){if(this.childRoot.children[j].id===tabs[i].id){var container=this.childRoot.children[j].querySelector("div.top-accordionlayout-container");var layout=tabs[i].text||tabs[i].layout;var titleNode=document.createElement("div");titleNode.innerHTML=layout;var title=this.childRoot.children[j].querySelector("a.top-accordionlayout-title");for(var k=0;k<title.childNodes.length;k++){if(!(title.childNodes[k].tagName==="I"&&title.childNodes[k].classList.contains("top-accordionlayout-icon"))){title.removeChild(title.childNodes[k])}}while(titleNode.firstChild){title.appendChild(titleNode.firstChild)}break}}}},__updateItems:function(){this.tabs=this.items;this.renderLayout();this.renderTitle()},__setContentHtml:function(tabId,htmlString){if(this.childRoot.children.length===0)this.__updateTabs();var tabElement=this.childRoot.querySelector("#top-accordionlayout_"+tabId+" .top-accordionlayout-content");top$(tabElement).empty();top$(tabElement).append(htmlString);var accordionTab=this.childRoot.querySelector("#top-accordionlayout_"+tabId).parentNode;accordionTab.initContent()},__setContentSrc:function(tabId,htmlFile){if(this.childRoot.children.length===0)this.__updateTabs();var tabElement=this.childRoot.querySelector("#top-accordionlayout_"+tabId+" .top-accordionlayout-content");var accordionTab=this.childRoot.querySelector("#top-accordionlayout_"+tabId).parentNode;var htmlString;var _this=this;if(Top.Util.getFileExtension(htmlFile)!="html")return;loadHtml=function(){Top.Ajax.execute(htmlFile,{success:function(data){top$(tabElement).empty();top$(tabElement).append(data);htmlString=data;accordionTab.initContent()}});return htmlString};loadHtml()},getTopStyle:function(){this.topstyle=this.childRoot.style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.childRoot.style[key]=value;this.topstyle=this.childRoot.style.cssText}},setAllTopStyle:function(){this.childRoot.style.cssText=this.topstyle}};Top.Widget.Layout.Accordionlayout=function(){Accordionlayout.prototype=Object.create(Top.Widget.Layout.prototype);Accordionlayout.prototype.constructor=Accordionlayout;function Accordionlayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-accordionlayout");this.template.innerHTML='<div class="top-accordionlayout-root"></div>'}this.id=this.template.id}Accordionlayout.create=function(element){return new Accordionlayout(element)};Accordionlayout.prototype.setContentHtml=function(tabId,htmlString){this.template.__setContentHtml(tabId,htmlString)};Accordionlayout.prototype.setContentSrc=function(tabId,htmlFile){this.template.__setContentSrc(tabId,htmlFile)};Accordionlayout.prototype.removeContent=function(tabId){var childs=this.template.childs;var tabElement=this.template.childRoot.querySelector("#top-accordionlayout_"+tabId+" .top-accordionlayout-content");top$(tabElement.firstChild).remove();for(var i=0;i<childs.length;i++){if(childs[i].tagName==="TOP-ACCORDIONTAB"&&childs[i].id===tabId){childs.splice(i)}}};Accordionlayout.prototype.selectTab=function(tabIdOrIndex){this.template.selectTab(tabIdOrIndex)};Accordionlayout.prototype.closeTab=function(){this.template.closeTab()};Accordionlayout.prototype.getSelectedTab=function(){var selectedId=this.template.selected;var tabs=this.template.tabs;var selectedIndex=0;if(selectedId){for(var i=0;i<tabs.length;i++){if(tabs[i].id===selectedId)selectedIndex=i}return this.template.tabs[selectedIndex]}else{return undefined}};Accordionlayout.prototype.getSelectedId=function(){return this.template.selected};Accordionlayout.prototype.getSelectedIndex=function(){var selectedId=this.template.selected;var tabs=this.template.tabs;var selectedIndex=0;if(selectedId){for(var i=0;i<tabs.length;i++){if(tabs[i].id===selectedId)selectedIndex=i}return selectedIndex}else{return undefined}};Accordionlayout.prototype.getTabs=function(){return this.template.tabs};Accordionlayout.prototype.append=function(htmlString,tabInfo){var _this=this.template;_this.createdItemWidgets=[];_this.createdCustomItemWidgets=[];if(Top.Util.getFileExtension(htmlString)==="html"){Top.Ajax.execute(htmlString,{success:function(data){var tabId="";if(tabInfo&&tabInfo.id){tabId=tabInfo.id;_this.tabs.push(tabInfo)}var layout="<top-accordiontab id='"+tabId+"'>"+data+"</top-accordiontab>";var accordiontab=document.createElement("div");accordiontab.innerHTML=layout;_this.createHtmlObjects(accordiontab);while(accordiontab.firstChild){_this.childRoot.appendChild(accordiontab.firstChild)}_this.renderTitle();_this.createdItemWidgetAttachedCallback();data=null}})}else{var tabId="";if(tabInfo&&tabInfo.id){tabId=tabInfo.id;_this.tabs.push(tabInfo)}var layout="<top-accordiontab id='"+tabId+"'>"+htmlString+"</top-accordiontab>";var accordiontab=document.createElement("div");accordiontab.innerHTML=layout;_this.createHtmlObjects(accordiontab);while(accordiontab.firstChild){_this.childRoot.appendChild(accordiontab.firstChild)}_this.renderTitle();_this.createdItemWidgetAttachedCallback()}};Accordionlayout.prototype.addTab=function(tabInfo){this.template.addTab(tabInfo)};Accordionlayout.prototype.removeTab=function(tabId){this.template.removeTab(tabId)};return Accordionlayout}();TopAccordionTab={is:"top-accordiontab",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{id:String,text:String},__ready:function(){this.initialChilds();this.__initI18n("text");this.renderLayout()},__attached2:function(){top$(this.querySelector("div.top-accordionlayout-content")).hide();this.setWidgetSize(true)},appendTemplate:function(){this.innerHTML='<div class="top-accordionlayout-container"><a class="top-accordionlayout-title"><i class="top-accordionlayout-icon"></i></a><div class="top-accordionlayout-content">'+this.innerHTML+"</div></div>"},expectedTemplateClassName:function(){return"top-accordionlayout-container"},initializeChildRoot:function(){return this.querySelector(".top-accordionlayout-content")},initContent:function(){this.contents=top$(this).children();for(var i=0;i<this.contents.length;i++){this.contents[i].parentWidget=this.parentWidget}},renderLayout:function(){if(this.childs.length===0){if(this.text===undefined||this.text===null){this.querySelector("div.top-accordionlayout-content").innerText=""}else{this.querySelector("div.top-accordionlayout-content").innerText=this.text}}this.initContent()},initContent:function(){this.contents=top$(this.querySelector("div.top-accordionlayout-content")).children()},setWidgetSize:function(adjustment){var container=this.querySelector(".top-accordionlayout-container");var content=container.querySelector(".top-accordionlayout-content");var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto";var pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";for(var i=0,len=content.children.length;i<len;i++){var item=content.children[i];if(adjustment&&typeof item.adjustSize==="function"){item.adjustSize()}if(item.getAttribute("layout-width")==="match_parent"){item.setThisWidgetWidth("100%")}if(item.getAttribute("layout-height")==="match_parent"){item.setThisWidgetHeight("100%")}}},getContent:function(){return this.contents},clearContent:function(){var myNode=this.querySelector("div.top-accordionlayout-content");while(myNode.firstChild){myNode.removeChild(myNode.firstChild)}},updateContent:function(){this.clearContent();for(var i=0;i<this.contents.length;i++){this.querySelector("div.top-accordionlayout-content").appendChild(this.contents[i])}},__updateText:function(){if(this.childs.length===0){if(this.text===undefined||this.text===null){this.querySelector("div.top-accordionlayout-content").innerText=""}else{this.querySelector("div.top-accordionlayout-content").innerText=this.text}}},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}};Top.Widget.Group.Accordiontab=function(){Accordiontab.prototype=Object.create(Top.Widget.prototype);Accordiontab.prototype.constructor=Accordiontab;function Accordiontab(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-accordiontab")}this.id=this.template.id}Accordiontab.create=function(element){return new Accordiontab(element)};Accordiontab.prototype.addItem=function(widget){this.template.contents.push(widget.template)};Accordiontab.prototype.removeItem=function(widget){var childsArray=this.template.contents;for(var i=0;i<childsArray.length;i++){if(widget.id==childsArray[i].id){this.template.childs.splice(i,1)}}};Accordiontab.prototype.complete=function(){this.template.updateContent()};return Accordiontab}();TopAjax={is:"top-ajax",properties:{id:String,url:String,type:String,settings:Object,request:String,response:String,onSuccess:String,onFail:String},execute:function(){if(typeof this.settings==="undefined")this.settings={};this.settings.type=this.type;this.settings.data=this.request;this.settings.response=this.response;this.settings.success=this.onSuccess;this.settings.error=this.onFail;Top.Ajax.execute(this.url,this.settings)}};TopAlarmbadge={is:"top-alarmbadge",behaviors:[TopWidgetBehavior,TopResourceBehavior,TopTextBehavior],properties:{icon:{type:String,value:""},type:{type:String,value:""},iconColor:String},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-alarmbadge-root"><span></span><span class = "top-alarmbadge-text"></span></div>'},__initialize:function(){this.__updateId();this.__initialClassname();this.__updateIcon();this.__updateText();this.__updateType();this.__updateAlt()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-alarmbadge-root");
return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-alarmbadge-root");shadowRoot.id=this.id}},__updateAlt:function(){if(this.description){var shadowRoot=this.querySelector(".top-alarmbadge-root");shadowRoot.alt=this.description}},__updateIcon:function(){var shadowIcon=this.querySelector("div > span");shadowIcon.classList.add("top-alarmbadge-icon");if(this.iconColor){shadowIcon.style.color=this.iconColor}if(this.textColor){shadowIcon.style.color=this.textColor}if(this.icon)shadowIcon.classList.add(this.icon)},__updateText:function(){var shadowText=this.querySelector(".top-alarmbadge-text");this.text=this.__i18n(this.text);if(this.text||this.text===0){shadowText.innerHTML=this.text}},__updateType:function(){var shadowText=this.querySelector(".top-alarmbadge-text");if(this.curType)shadowText.classList.remove(this.curType);if(this.type!==""&&this.type!==undefined&&this.type!==null)shadowText.classList.add(this.type);this.curType=this.type},__updateIconColor:function(){var shadowIcon=this.querySelector("div > span");shadowIcon.style.color=this.iconColor},__updateTextColor:function(){var shadowText=this.querySelector(".top-alarmbadge-text");shadowText.style.color=this.textColor},getTopStyle:function(){this.topstyle=this.querySelector(".top-alarmbadge-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-alarmbadge-root").style[key]=value;this.topstyle=this.querySelector(".top-alarmbadge-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-alarmbadge-root").style.cssText=this.topstyle}};Top.Widget.Alarmbadge=function(){Alarmbadge.prototype=Object.create(Top.Widget.prototype);Alarmbadge.prototype.constructor=Alarmbadge;function Alarmbadge(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-alarmbadge");this.template.innerHTML='<div class="top-alarmbadge-root"><span></span><span class = "top-alarmbadge-text"></span></div>'}this.id=this.template.id}Alarmbadge.create=function(element){return new Alarmbadge(element)};return Alarmbadge}();TopBreadcrumb={is:"top-breadcrumb",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{type:String,nodes:{type:Object},isReady:{type:Boolean,value:false},autoWidth:String,textMaxWidth:String,listLocation:String,listMaxHeight:String,onChange:String},__ready:function(){this.optValue=[];this.behindNodes=[];this.frontNodes=[];this.textMaxWidth=this.textMaxWidth||"";if(this.type==="2line"){this.__initBindingEvent();if(Top.Util.Browser.isIE())this.__updateOnChange()}else{this.type="1line";this.__updateVerticalAlignment()}this.isReady=true},__attached2:function(){var _this=this;if(_this.isReady===true){_this.__initialize();_this.__updateLineHeight()}else{setTimeout(function(){_this.__attached2()},0)}},appendTemplate:function(){this.innerHTML='<div class="top-breadcrumb-root"></div>'},__initialize:function(){this.__updateId();this.__updateNodes()},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-breadcrumb-root");shadowRoot.id=this.id}},__updateNodes:function(){if(typeof this.nodes==="string"){var nodes=Top.Util.namespace(this.nodes,this)}else if(typeof this.nodes==="object"){var nodes=this.nodes}if(nodes===undefined)return;var shadowRoot=this.querySelector(".top-breadcrumb-root");if(!shadowRoot)return;top$(shadowRoot).empty();var len=nodes.length;if(this.type==="2line"){var rootWidth=shadowRoot.getBoundingClientRect().width;var str='<div class="top-breadcrumb-button-container"></div><div class="top-breadcrumb-container doubleLine"';str+=this.textSize===undefined?'">':'style="font-size:'+this.textSize+'"></div>';shadowRoot.innerHTML=str;var container=this.querySelector(".top-breadcrumb-container");var i=0;var listCount=0;while(i<len){var str="";if(i!=0&&nodes[i].text){str+='<div class="top-breadcrumb-divider icon-arrows_right_thin"></div>'}nodes[i].subtext=nodes[i].subtext||"";if(nodes[i].selected){if(nodes[i].selected.startsWith("/")){if(i==len-1){str+='<a class="top-breadcrumb-text-container current index_'+i+'"href=javascript:Top.App.routeTo("'+nodes[i].selected+'")><div class="texts"><div class="top-breadcrumb-current text">'+nodes[i].text+'</div><div class="top-breadcrumb-current subtext">'+nodes[i].subtext+"</div></div></a>"}else{str+='<a class="top-breadcrumb-text-container default index_'+i+'"href=javascript:Top.App.routeTo("'+nodes[i].selected+'")><div class="texts"><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></div></a>"}}else{if(i==len-1){str+='<a class="top-breadcrumb-text-container current index_'+i+'" href='+nodes[i].selected+'><div class="texts"><div class="top-breadcrumb-current text">'+nodes[i].text+'</div><div class="top-breadcrumb-current subtext">'+nodes[i].subtext+"</div></div></a>"}else{str+='<a class="top-breadcrumb-text-container default index_'+i+'" href='+nodes[i].selected+'><div class="texts"><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></div></a>"}}}else{if(i==len-1){str+='<a class="top-breadcrumb-text-container current index_'+i+'"><div class="texts"><div class="top-breadcrumb-current text">'+nodes[i].text+'</div><div class="top-breadcrumb-current subtext">'+nodes[i].subtext+"</div></div></a>"}else{str+='<a class="top-breadcrumb-text-container default index_'+i+'"><div class="texts"><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></div></a>"}}top$(container).append(str);if(this.layoutWidth){var containerWidth=container.getBoundingClientRect().width;var paddingRight=top$(container).css("padding-right");paddingRight=paddingRight.split("px")[0];if(rootWidth-paddingRight<containerWidth){top$(container).children().first().remove();top$(container).children().first().remove();listCount++}}i++}this.updateContainerSize();this.frontNodes=nodes.slice(listCount,len);var behindNodes=[];for(var i=listCount;i>0;i--){behindNodes.push(nodes[i-1])}this.behindNodes=behindNodes;this.__updateTextMaxWidth();this.__updateButton();this.renderList()}else{var str='<div class="top-breadcrumb-container basic"';str+=this.textSize===undefined?'">':'style="font-size:'+this.textSize+'">';for(var i=0;i<len;i++){if(i!=0&&nodes[i].text){str+='<span class="top-breadcrumb-divider">></span>'}if(nodes[i].selected){if(nodes[i].selected.startsWith("/")){if(i==len-1){str+='<a href=javascript:Top.App.routeTo("'+nodes[i].selected+'")><span class="top-breadcrumb-current">'+nodes[i].text+"</span></a>"}else{str+='<a href=javascript:Top.App.routeTo("'+nodes[i].selected+'")><span class="top-breadcrumb-default">'+nodes[i].text+"</span></a>"}}else{if(i==len-1){str+="<a href="+nodes[i].selected+'><span class="top-breadcrumb-current">'+nodes[i].text+"</span></a>"}else{str+="<a href="+nodes[i].selected+'><span class="top-breadcrumb-default">'+nodes[i].text+"</span></a>"}}}else{if(i==len-1){str+='<span class="top-breadcrumb-current">'+nodes[i].text+"</span>"}else{str+='<span class="top-breadcrumb-default">'+nodes[i].text+"</span>"}}}str+="</div>";shadowRoot.innerHTML=str}},__updateButton:function(){var mainContainer=this.querySelector(".top-breadcrumb-container"),buttonContainer=this.querySelector(".top-breadcrumb-button-container"),button=buttonContainer.querySelector(".top-breadcrumb-button");var buttonFlag=true;if(this.behindNodes.length){if(!button){this.__addButton()}}else{if(this.button)this.__removeButton()}},__addButton:function(){var mainContainer=this.querySelector(".top-breadcrumb-container"),buttonContainer=this.querySelector(".top-breadcrumb-button-container");buttonContainer.style.display="";mainContainer.classList.add("withButton");buttonContainer.innerHTML='<ul class="top-breadcrumb-list-container"></ul><div class="top-breadcrumb-button"><span class="top-breadcrumb-button-icon icon-arrow_filled_down"></span></div>'},__removeButton:function(){var mainContainer=this.querySelector(".top-breadcrumb-container"),buttonContainer=this.querySelector(".top-breadcrumb-button-container");mainContainer.classList.remove("withButton");while(buttonContainer.firstChild){buttonContainer.removeChild(buttonContainer.firstChild)}},__updateTextMaxWidth:function(){var texts=this.querySelectorAll(".texts");for(var i=0;i<texts.length;i++){texts[i].style.maxWidth=this.textMaxWidth}},updateContainerSize:function(){var shadowRoot=this.querySelector(".top-breadcrumb-root");var container=shadowRoot.querySelector(".top-breadcrumb-container");var shadowHeight=shadowRoot.style.height.split("px")[0];if(!shadowHeight.includes("%")){container.style.height=shadowHeight-2+"px"}},renderList:function(){var nodes=this.behindNodes;if(typeof this.nodes=="string"){this.nodes=Top.Util.namespace(this.nodes,this)}var listContainer=this.querySelector(".top-breadcrumb-list-container");if(listContainer){while(listContainer.firstChild){listContainer.removeChild(listContainer.firstChild)}}var nodeText=[];var nodeSubText=[];var nodeSelected=[];var buttonContainer=this.querySelector(".top-breadcrumb-button-container");if(!nodes)return;if(typeof nodes[0]==="object"){for(var i=0;i<nodes.length;i++){nodeText[i]=nodes[i]["text"];nodeSubText[i]=nodes[i]["subtext"]!==undefined?nodes[i]["subtext"]:"";nodes[i].subtext=nodes[i].subtext||"";nodeSelected[i]=nodes[i]["selected"]}}for(var i=0;i<nodes.length;i++){var str='<li class="top-breadcrumb-list list_'+i+'">';if(nodes[i].selected){if(nodes[i].selected.startsWith("/")){str+='<a class="top-breadcrumb-text-container'+" index_"+i+'" href=javascript:Top.App.routeTo("'+nodes[i].selected+'")><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></a>"}else{str+='<a class="top-breadcrumb-text-container'+" index_"+i+'" href='+nodes[i].selected+'><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></a>"}}else{str+='<a class="top-breadcrumb-text-container'+" index_"+i+'"><div class="top-breadcrumb-default text">'+nodes[i].text+'</div><div class="top-breadcrumb-default subtext">'+nodes[i].subtext+"</div></a>"}str+="</li>";top$(listContainer).append(str)}this.attachEventHandler();this.__updateLineHeight()},__updateOnChange:function(){this.__addEventByAttr("change")},__updateLineHeight:function(){var buttonContainer=this.querySelector(".top-breadcrumb-button-container");if(!buttonContainer)return;if(buttonContainer.offsetHeight!==0){buttonContainer.style.lineHeight=70+"px"}},__detached:function(){top$(document).off("click","#"+this.id+" .top-breadcrumb-button-container");top$(document).off("click","#"+this.id+" .top-breadcrumb-list-container");top$(this).unbind("keydown")},__initEventInternal:function(){this.__addEventByAttr("change");this.__addEventByAttr("close")},__updateVerticalAlignment:function(){if(!this.lineHeight){var root=this.querySelector(".top-breadcrumb-root");var checkHeightValue=/[0-9]+px/;root.style.display="inline-block";if(checkHeightValue.test(this.layoutHeight))this.setTopStyle("line-height",this.layoutHeight);else if(this.layoutHeight&&(this.layoutHeight==="match_parent"||this.layoutHeight.includes("%"))){this.setTopStyle("line-height",root.offsetHeight+"px");var _this=this;this.__updateVerticalAlignmentForMatchparent=function(){_this.setTopStyle("line-height",root.offsetHeight+"px")}}}},changeSelected:function(){if(typeof this.eventChanged==="string"){this.__eventChanged=Top.Util.namespace(this.eventChanged,this)}if(Top.App.__compatibleWithTOP()===true){if(typeof this.__eventChanged==="function"){this.__eventChanged(event,Top.Dom.selectById(this.id))}else if(typeof this.__eventChanged==="object"){fn.fn(event,Top.Dom.selectById(this.id))}}else if(typeof this.__eventChanged==="function"){var rowInfo={};rowInfo.index=this.dataIndex;this.dataObj[this.columnName]=this.selectedText;rowInfo.data=this.dataObj;this.__eventChanged(this.selectedText,rowInfo,this.value)}if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("change"))}else{this.__dispatchEvent(new Event("change"))}},attachEventHandler:function(){var _this=this;var button=this.querySelector(".top-breadcrumb-button-container");var listContainer=this.querySelector(".top-breadcrumb-list-container");top$(button).off("click").on("click",function(){if(top$(this).hasClass("active")){listContainer.style.display="";top$(this).removeClass("top-breadcrumb-list_open");top$(this).addClass("top-breadcrumb-list_collapsed");top$(this).removeClass("active");listContainer.style.top="";listContainer.style.left="";listContainer.style.width="";listContainer.style.right="";listContainer.style.bottom=""}else{top$(".top-breadcrumb-button-container.active").click();listContainer.style.display="block";if(_this.listLocation){if(_this.listLocation.startsWith("b")){listContainer.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height-1+"px"}else{listContainer.style.bottom=window.innerHeight-this.getBoundingClientRect().bottom+this.offsetHeight-1+"px"}if(_this.listLocation.endsWith("l")){listContainer.style.left=this.getBoundingClientRect().left+"px"}else{var calcedRight=Math.abs(this.getBoundingClientRect().right-top$(document).width());listContainer.style.right=calcedRight+"px"}}listContainer.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height+"px";listContainer.style.left=this.getBoundingClientRect().left+"px";var calcedRight=listContainer.getBoundingClientRect().right-top$(document).width();if(calcedRight>0){calcedRight=Math.abs(this.getBoundingClientRect().right-top$(document).width());listContainer.style.left="";listContainer.style.right=calcedRight+"px"}if(_this.listMaxHeight){_this.querySelector(".top-breadcrumb-list-container").style.maxHeight=_this.listMaxHeight;_this.querySelector(".top-breadcrumb-list-container").style.overflowY="auto"}top$(this).removeClass("top-breadcrumb-list_collapsed");top$(this).addClass("top-breadcrumb-list_open");top$(this).addClass("active")}});top$(this).find(".top-breadcrumb-text-container").off("click").on("click",function(){var containerElement=this.parentNode.nextSibling;var text=this.querySelector(".text").innerText;var subtext=this.querySelector(".subtext").innerText;var selectedText=[];var classList=this.classList;for(var i=0;i<classList.length;i++){var index=classList[i].split("index_");if(index.length===2){_this.selectedIndex=index[1]}}_this.selectedNode=_this.nodes[_this.selectedIndex];_this.selectedId=_this.selectedNode.id;selectedText.push(text);if(subtext!=="")selectedText.push(subtext);_this.selectedText=selectedText;_this.updateData("selectedText");_this.updateData("value");var siblingArray=this.parentNode.childNodes;for(var i=0;i<siblingArray.length;i++){if(top$(siblingArray[i]).hasClass("active"))top$(siblingArray[i]).removeClass("active")}top$(this).addClass("active");top$(_this.querySelector(".top-breadcrumb-button-container.top-breadcrumb-list_open")).click();_this.changeSelected()});top$(this.querySelector(".top-breadcrumb-button-container")).add(this.querySelector(".top-breadcrumb-list-container")).on("mousedown click",function(e){e.stopPropagation()})},close:function(){top$(this).find(" .top-breadcrumb-list_open").click()},__initBindingEvent:function(){var _this=this;top$(this).bind("keydown",function(e){if(!_this.allValues)return;var len=_this.allValues.length;if(top$(_this).attr("disabled")!==undefined){e.preventDefault();return}if(e.keyCode===39||e.keyCode===40){if(_this.selectedIndex===undefined){_this.selectByIndex(0)}else if(_this.selectedIndex>=0&&_this.selectedIndex<len-1){_this.selectByIndex(_this.selectedIndex+1)}e.preventDefault()}else if(e.keyCode===37||e.keyCode===38){if(_this.selectedIndex>0&&_this.selectedIndex<len){_this.selectByIndex(_this.selectedIndex-1)}e.preventDefault()}})},getTopStyle:function(){this.topstyle=this.querySelector(".top-breadcrumb-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-breadcrumb-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-breadcrumb-root").style.cssText=this.topstyle}};Top.Widget.Breadcrumb=function(){Breadcrumb.prototype=Object.create(Top.Widget.prototype);Breadcrumb.prototype.constructor=Breadcrumb;function Breadcrumb(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-breadcrumb");this.template.innerHTML='<div class="top-breadcrumb-root"></div>'}this.id=this.template.id}Breadcrumb.create=function(element){return new Breadcrumb(element)};Breadcrumb.prototype.getSelectedText=function(){return this.template.selectedText};Breadcrumb.prototype.getSelectedNode=function(){return this.template.selectedNode};Breadcrumb.prototype.getSelectedId=function(){return this.template.selectedId};Breadcrumb.prototype.getSelectedIndex=function(){return this.template.selectedIndex};Breadcrumb.prototype.getList=function(){var _this=this.template;if(typeof _this.nodes==="string"){var nodes=Top.Util.namespace(_this.nodes)}else if(typeof _this.nodes==="object"){var nodes=_this.nodes}return nodes};Breadcrumb.prototype.addNodes=function(nodeArray){var _this=this.template;if(typeof _this.nodes==="string"){var nodes=Top.Util.namespace(_this.nodes)}else if(typeof _this.nodes==="object"){var nodes=_this.nodes}var tempNode=nodes.concat(nodeArray);_this.nodes=tempNode;_this.__updateNodes()};Breadcrumb.prototype.removeNode=function(id){var _this=this.template;var nodeId=id;if(typeof _this.nodes==="string"){var nodes=Top.Util.namespace(_this.nodes)}else if(typeof _this.nodes==="object"){var nodes=_this.nodes}_this.nodes=nodes;if(nodeId)for(var i=0;i<_this.nodes.length;i++){if(_this.nodes[i].id===nodeId){_this.nodes.splice(i,1)}}else{_this.nodes.pop()}_this.__updateNodes()};Breadcrumb.prototype.close=function(){var _this=this.template;return _this.close()};return Breadcrumb}();TopButton={is:"top-button",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{icon:String,text:String,image:String,tabIndex:{type:String,value:"0"},iconPosition:{type:String,value:"left"}},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<button class="top-button-root" type="button"><label class="top-button-text"></label>'+this.innerHTML+'<div class="top-button-tooltip-wrapper"></div></button>'},__initialize:function(){this.__updateId();this.__updateText();this.__updateImage();this.__updateIcon();this.__updateDisabled();this.__updateTabIndex();this.__updateMultiLine()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-button-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-button-root");shadowRoot.id=this.id}},__updateDisabled:function(){var shadowInput=this.querySelector("button");var disabled=this.calculateDerivedDisabled();this.__setDisabled(shadowInput)},__updateImage:function(){if(this.image){var shadowText=this.getElementsByTagName("label")[0];var shadowImage=this.getElementsByTagName("span")[0];if(!shadowImage){shadowImage=document.createElement("span");shadowText.insertAdjacentElement(this.iconPosition==="right"?"afterend":"beforebegin",shadowImage)}shadowImage.classList="";shadowImage.classList.add("top-button-image");shadowImage.classList.add(this.iconPosition==="right"?"right":"left");if(this.image.includes("@drawable")){this.image=Top.DrawableManager.get(this.image.replace("@drawable/",""))}shadowImage.style.backgroundImage="url("+this.image+")"}else{var shadowImage=this.getElementsByClassName("top-button-image")[0];if(!shadowImage)return;if(shadowImage)shadowImage.parentNode.removeChild(shadowImage)}},__updateIcon:function(){if(this.icon){var shadowText=this.getElementsByTagName("label")[0];var shadowIcon=this.getElementsByTagName("span")[0];if(!shadowIcon){shadowIcon=document.createElement("span");shadowText.insertAdjacentElement(this.iconPosition==="right"?"afterend":"beforebegin",shadowIcon)}shadowIcon.classList="";shadowIcon.classList.add("top-button-icon");shadowIcon.classList.add(this.__i18n(this.icon));shadowIcon.classList.add("icon-set");shadowIcon.classList.add(this.iconPosition==="right"?"right":"left")}else{var shadowIcon=this.getElementsByClassName("top-button-icon")[0];if(!shadowIcon)return;if(shadowIcon)shadowIcon.parentNode.removeChild(shadowIcon)}},__updateText:function(){if(!this.isTemplateAppended()&&this.getElementsByTagName("label").length===0){var shadowText=document.createElement("label");var shadowIcon=this.querySelector("span");shadowText.classList.add("top-button-text");if(shadowIcon)shadowIcon.insertAdjacentElement(this.iconPosition==="right"?"beforebegin":"afterend",shadowText)}if(this.text||this.text===""||this.text===0){var shadowInput=this.querySelector("button");var shadowText=this.querySelector("label");if(shadowInput){shadowInput.childNodes.forEach(function(child){if(child.nodeName==="#text"){shadowInput.removeChild(child)}})}if(shadowText){shadowText.innerHTML=this.__i18n(this.text)}}},__updateTabIndex:function(){this.querySelector(".top-button-root").tabIndex=this.tabIndex},__updateMultiLine:function(){var label=this.querySelector(".top-button-text");if(this.multiLine==="true"||this.multiLine===true){if(label.classList.contains("multi-line")===false){label.classList.add("multi-line")}}else{label.classList.remove("multi-line")}},focus:function(){this.querySelector(".top-button-root").focus()},blur:function(){this.querySelector(".top-button-root").blur()},getTopStyle:function(){this.topstyle=this.querySelector("button").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("button");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("button").style.cssText=this.topstyle}};Top.Widget.Button=function(){Button.prototype=Object.create(Top.Widget.prototype);Button.prototype.constructor=Button;function Button(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-button");this.template.innerHTML='<button class="top-button-root" type="button"><label class="top-button-text"></label><div class="top-button-tooltip-wrapper"></div></button>'}this.id=this.template.id}Button.create=function(element){return new Button(element)};return Button}();TopButtongroup={is:"top-buttongroup",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{buttons:String,type:{type:String,value:"radiobutton"},orientation:{type:String,value:"horizontal"},unitWidth:String,unitHeight:String,interval:{type:String,value:"10px"},onChange:String},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-buttongroup-root">'+this.innerHTML+"</div>"},__initialize:function(){this.__updateButtons()},__initEventInternal:function(){this.__addEventByAttr("change")},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-buttongroup-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateButtons:function(){if(typeof this.buttons==="string"){this.buttons=Top.Util.namespace(this.buttons,this)}if(typeof this.buttons==="object"){var __buttons=JSON.parse(JSON.stringify(this.buttons))}var root=this.querySelector(".top-buttongroup-root");root.innerHTML="";var layout=Top.Widget.create("top-linearlayout",{orientation:this.orientation,borderWidth:"0px"});var _this=this;for(var i=0,len=__buttons.length;i<len;i++){if(__buttons[i].id===undefined){__buttons[i].id=Top.Util.guid()}var button=Top.Widget.create("top-"+this.type,{groupId:this.id,id:__buttons[i].id,text:__buttons[i].value,checked:__buttons[i].status==="selected",disabled:__buttons[i].status==="disabled",layoutWidth:this.unitWidth,layoutHeight:this.unitHeight,margin:parseInt(this.interval)/2+"px"});button.setProperties({onClick:function(event,widget){_this.selectedId=widget.id;_this.__dispatchEvent(new CustomEvent("change",{detail:{selectedId:_this.selectedId}}))}});button.template.__addEventByAttr("click");layout.addWidget(button)}layout.complete();root.insertBefore(layout.template,null)},getTopStyle:function(){this.topstyle=this.querySelector(".top-buttongroup-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-buttongroup-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-buttongroup-root").style.cssText=this.topstyle},getSelectedId:function(){return this.selectedId}};Top.Widget.Buttongroup=function(){Buttongroup.prototype=Object.create(Top.Widget.prototype);Buttongroup.prototype.constructor=Buttongroup;function Buttongroup(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-buttongroup");this.template.innerHTML='<div class="top-buttongroup-root"></div>'}this.id=this.template.id}Buttongroup.create=function(element){return new Buttongroup(element)};Buttongroup.prototype.getSelectedId=function(){return this.template.getSelectedId()};return Buttongroup}();TopCalendar={is:"top-calendar",behaviors:[TopWidgetBehavior],properties:{date:{type:String,value:""},onSelect:String,tabIndex:{type:String,value:"0"},drawMonth:Number,drawYear:Number,drawDay:String,drawWeeks:Number,range:Array,AllSchedules:Array,dayNames:{type:Array,value:["일","월","화","수","목","금","토"]},scheduleHeight:{type:Number,value:22},weekBlockWidth:{type:Number,value:48},dayBlockWidth:{type:Number,value:121},weekMaxBlockNo:Number,onAddScheduleClick:String,onUpdateDates:String,onScheduleClick:String,onDateClick:String,onFilterItemClick:String,onCalendarDrag:String,calendarType:String,memberList:String,sharedList:String,categoryList:String,POData:Array,dragCount:{type:Number,value:2},isDragging:{type:Boolean,value:false},dragStart:String,dragEnd:String,dragBlockRange:Array,draggingBlock:Object,bodyInnerHTML:String,isTimeDrag:{type:Boolean,value:false},draggingDrawIndex:String,startDrawIndex:String,timeIndexStart:Number,changeTimeL:{type:Boolean,value:false},mouseX1:Number,mouseY1:Number,dialogLeft:Number,dialogTop:Number,focusedDate:String},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-calendar-root"></div>'},__initialize:function(){this.__setFocusedDate(new Date);this.__appendCalendar();this.__updateDrawDate();this.__initEventInternal();this.__updateDates();this.__updateId();this.__updateDisabled();this.__initBindingEvent();this.__updateMemberList();this.__updateSharedList();this.__updateCategoryList();this.__eventBindingList();this.__updateTabIndex()},__changeType:function(selectedFullDate){this.__updateBody();this.__updateDrawDate(undefined,undefined,selectedFullDate);this.__updateDates()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-calendar-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){var thisPicker=this.querySelector(".top-calendar-root");thisPicker.id=this.id}},__appendCalendar:function(){var calendarRoot=this.getElementsByClassName("top-calendar-root")[0];calendarRoot.innerHTML=this.__appendHeader()+'<div class="top-calendar-body"></div>'+this.__appendExtraDialog()+'<div class="top-calendar-filter-background closed"></div>';this.__updateBody()},__appendHeader:function(){var header='<div class="top-calendar-header">'+this.__appendHeaderLeft()+this.__appendHeaderCenter()+this.__appendHeaderRight()+"</div>";return header},__appendHeaderLeft:function(){var headerLeft='<div class="top-calendar-header-left">'+'<button class="top-calendar-today-schedule-btn"></button></div>';return headerLeft},__appendHeaderCenter:function(){var headerCenter='<div class="top-calendar-header-center">'+'<div class="top-calendar-prev-btn"></div>'+'<div class="top-calendar-current"></div>'+'<div class="top-calendar-next-btn"></div>'+'<div class="top-calendar-today"></div>';return headerCenter+"</div>"},__appendHeaderRight:function(){var headerRight='<div class="top-calendar-header-right">'+this.__appendFilter()+'<div class="top-calendar-type">'+'<div class="top-calendar-type-month"></div>'+'<div class="top-calendar-type-week"></div>'+'<div class="top-calendar-type-day"></div></div></div>';return headerRight},__appendExtraDialog:function(){var dialogRoot='<div class="top-calendar-extra-dialog-root">'+"<div class='top-calendar-extra-dialog'>"+"<div class='top-calendar-extra-dialog-header'>"+"<div class='top-calendar-extra-dialog-header-text'>일정 더 보기</div>"+"<div class='top-calendar-extra-dialog-header-close-btn'></div></div>"+"<div class='top-calendar-extra-dialog-body'>"+"<div class='top-calendar-extra-dialog-body-date'></div>"+"<div class='top-calendar-extra-dialog-body-schedules'></div></div>"+"<div class='top-calendar-extra-dialog-footer'>"+"<button class='top-calendar-extra-dialog-footer-close-btn'>닫기</button></div></div></div>";
return dialogRoot},__updateBody:function(){if(!this.calendarType)this.calendarType="month";var body=this.getElementsByClassName("top-calendar-body")[0];if(this.calendarType!=="month"){body.classList.add("not-month");body.classList.remove("month")}else{body.classList.add("month");body.classList.remove("not-month")}body.innerHTML="";if(this.calendarType==="month"){body.innerHTML=this.__appendDays()+'<div class="top-calendar-dates"></div><div class="top-calendar-drag-body"></div>'}else{body.innerHTML='<div class="top-calendar-body-top">'+'<div class="top-calendar-timeline-top">'+'<div class="top-calendar-days"></div>'+'<div class="top-calendar-timeline-top-allday"></div>'+'<div class="top-calendar-timeline-top-open closed">펼치기<span class="top-calendar-timeline-open-icon"></span></div></div>'+this.__appendSchedulesTop()+"</div>"+'<div class="top-calendar-body-bottom">'+this.__appendTimelineBottom()+'<div class="top-calendar-schedules-bottom"></div><div class="top-calendar-drag-body2"></div></div>'}},__appendTimelineBottom:function(){var timelineBottom='<div class="top-calendar-timeline-bottom">',ampm=["오후 ","오후 ","오전 ","오전 "];for(var i=0;i<24;i++){var time=i%12===0?12:i%12;timelineBottom+='<div class="top-calendar-bottom-times">'+(i%6===0?ampm.pop():"")+time+"시"+"</div>"}return timelineBottom+"</div>"},__appendSchedulesTop:function(){var schedulesTop='<div class="top-calendar-schedules-top">'+'<div class="top-calendar-dates"></div></div>';return schedulesTop},__updateSchedulesBottom:function(){var scheduleBottom=this.getElementsByClassName("top-calendar-schedules-bottom")[0],dragBody2=this.getElementsByClassName("top-calendar-drag-body2")[0],innerHTML="",date=new Date(this.range[0]);for(var i=0;i<(this.calendarType==="week"?7:1);i++){var dateStr=this.__getFullDateString(date);innerHTML+='<div class="top-calendar-schedules-bottom-date" data-draw-index="'+i+'" data-full-date="'+dateStr+'" >';for(var j=0;j<48;j++){innerHTML+='<div class="top-calendar-schedules-bottom-date-time" data-time-index="'+j+'" data-number="0" data-extra-number="0"></div>'}innerHTML+="</div>";date.setDate(date.getDate()+1)}scheduleBottom.innerHTML=innerHTML;dragBody2.innerHTML=innerHTML;if(Top.Util.Browser.isIE()){window.getComputedStyle(this.querySelector(".top-calendar-schedules-bottom")).width;this.querySelector(".top-calendar-schedules-bottom").insertAdjacentHTML("afterbegin",'<div class="dummyDom">test</div>');this.querySelector(".dummyDom").remove()}if(this.calendarType==="week"){scheduleBottom.classList.add("week")}else{scheduleBottom.classList.add("day")}},__appendDays:function(){var days="<div class='top-calendar-days'>";var dates=this.calendarType==="day"?1:7;for(var i=0;i<dates;i++){days+="<div class='top-calendar-day'></div>"}days+="</div>";return days},__updateDates:function(){var dates=this.getElementsByClassName("top-calendar-dates")[0];var weeks=this.calendarType==="month"?this.drawWeeks:1;dates.innerHTML="";for(var i=0;i<weeks;i++){dates.innerHTML+=this.__appendRow()}if(this.calendarType!=="month"){this.__updateSchedulesBottom();this.__setTimeline()}this.__initializeValues();var dragBody=dates.parentNode.querySelector(".top-calendar-drag-body");if(dragBody){if(this.calendarType==="month")dragBody.innerHTML=dates.innerHTML;else if(this.calendarType==="week"){var row=this.getElementsByClassName("top-calendar-row")[0];dragBody.innerHTML=row.innerHTML}}this.__drawFocusedDate(true);var body=this.getElementsByClassName("top-calendar-body")[0];this.bodyInnerHTML=body.innerHTML;if(this.onUpdateDates)this.__dispatchEvent(new CustomEvent("updateDates"))},__setFocusedDate:function(dateObj){this.focusedDate=this.__getFullDateString(dateObj)},__drawFocusedDate:function(drawing){var focusedDate=this.focusedDate,dates=this.getElementsByClassName(this.calendarType==="month"?"top-calendar-date":"top-calendar-date-number");for(var i=0,length=dates.length;i<length;i++){if(dates[i].dataset.fullDate===focusedDate){drawing===true?dates[i].classList.add("focused"):dates[i].classList.remove("focused");break}}},__setTimeline:function(){var _this=this,today=new Date,hour=today.getHours(),min=today.getMinutes(),sec=today.getSeconds(),range1=new Date(this.range[0]),range2=new Date(this.range[1]),timeline=this.querySelector(".top-calendar-today-timeline");today.setHours(9);today.setMinutes(0);today.setSeconds(0);today.setMilliseconds(0);if(timeline)timeline.remove();if(today>=range1&&today<=range2){var dateCols=this.getElementsByClassName("top-calendar-schedules-bottom-date"),dateDiff=today.getDay()-range1.getDay(),todayCol=dateCols[dateDiff],leftSec=6e4-sec*1e3,minH=todayCol.scrollHeight/1440;todayCol.insertAdjacentHTML("beforeend",'<div class="top-calendar-today-timeline"></div>');timeline=todayCol.querySelector(".top-calendar-today-timeline");timeline.style.top=minH*(hour*60+min)-1+"px";var interval;setTimeout(function(){moveTimeline();interval=setInterval(function(){moveTimeline()},6e4)},leftSec);function moveTimeline(){if(_this.calendarType==="month"){timeline.remove();clearInterval(interval);return}var nextHeight=parseFloat(timeline.style.top.replace("px",""))+minH;if(nextHeight>=todayCol.clientHeight-1.15){clearInterval(interval);_this.__setTimeline();return}timeline.style.top=nextHeight+"px"}}},__appendRow:function(){var dates=this.calendarType==="day"?1:7;if(this.calendarType!=="month"){var row="<div class='top-calendar-date-numbers'>";for(var i=0;i<dates;i++){row+="<div class='top-calendar-date-number'></div>"}row+="</div><div class='top-calendar-row'>"}else{var row="<div class='top-calendar-row'>"}for(var i=0;i<dates;i++){row+="<div class='top-calendar-date'>"+(this.calendarType==="month"?"<div class='top-calendar-date-number'></div>":"")+"<div class='top-calendar-date-content'></div>"+"<div class='top-calendar-date-extra'></div></div>"}row+="</div>";if(this.calendarType==="week")row+='<div class="top-calendar-drag-body"></div>';return row},__appendFilter:function(){var filter='<div class="top-calendar-filter closed">'+'<div class="top-calendar-filter-popup">'+'<div class="top-calendar-filter-popup-type">'+'<div class="top-calendar-filter-popup-type-title">타입</div>'+this.__appendFilterCheckItem("이벤트","filter-event",true)+this.__appendFilterCheckItem("일감","filter-work",true)+"</div>"+'<div class="top-calendar-filter-popup-category"><span>카테고리</span>'+'<div class="top-calendar-filter-popup-category-list closed"></div></div>'+'<div class="top-calendar-filter-popup-member"><span>유저</span>'+'<div class="top-calendar-filter-popup-member-list closed"></div></div>'+'<div class="top-calendar-filter-popup-shared"><span>공유 받은 일정</span>'+'<div class="top-calendar-filter-popup-shared-list closed"></div></div>'+'<div class="top-calendar-filter-popup-init">필터 초기화</div></div></div>';return filter},__appendFilterCheckItem:function(text,id,checked,color){var checkItem='<div class="top-calendar-filter-popup-check-item" data-id="'+id+(checked===true?'" data-checked="checked">':'" data-checked="unchecked">')+'<span class="top-calendar-filter-popup-check-item-icon '+(checked===true?'checked"></span>':'unchecked"></span>')+(color!==undefined?'<span class="top-calendar-filter-popup-check-item-tag" style="color:'+color+'""></span>':"")+'<label class="top-calendar-filter-popup-check-item-label">'+text+"</label></div>";return checkItem},__updateMemberList:function(){var popupMemberList=this.getElementsByClassName("top-calendar-filter-popup-member-list")[0],memberList=typeof this.memberList==="string"?Top.Util.namespace(this.memberList):this.memberList;popupMemberList.innerHTML=this.__appendFilterCheckItem("전체","filter-all");if(memberList&&memberList instanceof Array&&memberList.length>0){var tempList="";for(var i=0,length=memberList.length;i<length;i++){if(i===0)tempList+=this.__appendFilterCheckItem(memberList[i].text+" (나)",memberList[i].id,true);else tempList+=this.__appendFilterCheckItem(memberList[i].text,memberList[i].id)}popupMemberList.insertAdjacentHTML("beforeend",tempList);this.__attachToggleEvent(popupMemberList.children)}},__updateSharedList:function(){var popupSharedList=this.getElementsByClassName("top-calendar-filter-popup-shared-list")[0],sharedList=typeof this.sharedList==="string"?Top.Util.namespace(this.sharedList):this.sharedList;popupSharedList.innerHTML=this.__appendFilterCheckItem("전체","filter-all");if(sharedList&&sharedList instanceof Array&&sharedList.length>0){var tempList="";for(var i=0,length=sharedList.length;i<length;i++){tempList+=this.__appendFilterCheckItem(sharedList[i].text,sharedList[i].id,false,sharedList[i].color||"#000000")}popupSharedList.insertAdjacentHTML("beforeend",tempList);this.__attachToggleEvent(popupSharedList.children)}},__updateCategoryList:function(){var popupCategoryList=this.getElementsByClassName("top-calendar-filter-popup-category-list")[0],categoryList=typeof this.categoryList==="string"?Top.Util.namespace(this.categoryList):this.categoryList;popupCategoryList.innerHTML=this.__appendFilterCheckItem("전체","filter-all");if(categoryList&&categoryList instanceof Array&&categoryList.length>0){var tempList="";for(var i=0,length=categoryList.length;i<length;i++){tempList+=this.__appendFilterCheckItem(categoryList[i].text,categoryList[i].id)}popupCategoryList.insertAdjacentHTML("beforeend",tempList);this.__attachToggleEvent(popupCategoryList.children)}},__openExtraDialog:function(e){var _this=this,dialogRoot=this.getElementsByClassName("top-calendar-extra-dialog-root")[0];if(this.calendarType==="week"){var dateData=e.target.parentNode.parentNode.dataset,isWeek=true}else{var dateData=e.target.parentNode.dataset,isWeek=false}dialogRoot.querySelector(".top-calendar-extra-dialog").style.top="";dialogRoot.querySelector(".top-calendar-extra-dialog").style.left="";dialogRoot.querySelector(".top-calendar-extra-dialog").style.margin="";dialogRoot.classList.add("visible");dialogRoot.querySelector(".top-calendar-extra-dialog-body-date").textContent=dateData.fullDate.slice(5,10).replace("-","/")+"("+this.dayNames[dateData.drawIndex%7]+")";this.__updateExtraSchedule(dateData.drawIndex,isWeek,e.target.parentNode)},__closeExtraDialog:function(){var dialogRoot=this.getElementsByClassName("top-calendar-extra-dialog-root")[0];dialogRoot.classList.remove("visible")},__initializeValues:function(){var _this=this,today=this.getElementsByClassName("top-calendar-today")[0],current=this.getElementsByClassName("top-calendar-current")[0],todayBtn=this.getElementsByClassName("top-calendar-today-schedule-btn")[0],typeMonth=this.getElementsByClassName("top-calendar-type-month")[0],typeWeek=this.getElementsByClassName("top-calendar-type-week")[0],typeDay=this.getElementsByClassName("top-calendar-type-day")[0],displayMonth=this.drawMonth+1<10?"0"+(this.drawMonth+1):""+(this.drawMonth+1);today.textContent="오늘";todayBtn.textContent="새 이벤트/일감";typeMonth.textContent="월";typeWeek.textContent="주";typeDay.textContent="일";if(this.calendarType==="month"){typeMonth.classList.add("checked");typeWeek.classList.remove("checked");typeDay.classList.remove("checked")}else if(this.calendarType==="week"){typeWeek.classList.add("checked");typeDay.classList.remove("checked");typeMonth.classList.remove("checked")}else if(this.calendarType==="day"){typeDay.classList.add("checked");typeWeek.classList.remove("checked");typeMonth.classList.remove("checked")}if(this.calendarType!=="week"){current.textContent=this.drawYear+"."+displayMonth}else{var firstDay=this.range[0],firstYear=firstDay.slice(0,4),firstMonth=firstDay.slice(5,7),lastDay=this.range[1],lastYear=lastDay.slice(0,4),lastMonth=lastDay.slice(5,7);if(firstYear!==lastYear)current.textContent=firstYear+".12 - "+lastYear+".01";else if(firstDay.slice(5,7)!==lastDay.slice(5,7))current.textContent=firstYear+"."+firstMonth+" - "+lastMonth;else current.textContent=firstYear+"."+firstMonth}if(this.calendarType!=="week")var dateArr=this.querySelector(".top-calendar-dates").getElementsByClassName("top-calendar-date");else var dateArr=this.querySelector(".top-calendar-row").getElementsByClassName("top-calendar-date");if(this.calendarType!=="month")var dateNumbers=this.querySelector(".top-calendar-date-numbers");this.dateScheduleArr=[];this.dateScheduleArr.length=dateArr.length;if(this.calendarType==="month"){var days=this.getElementsByClassName("top-calendar-day");for(var i=0,length=days.length;i<length;i++){days[i].textContent=this.dayNames[i]}}else{var timeTopAllday=this.querySelector(".top-calendar-timeline-top-allday");timeTopAllday.textContent="종일"}var todayDate=new Date;var drawDate=new Date(this.range[0]);for(var i=0,length=dateArr.length;i<length;i++){this.dateScheduleArr[i]={scheduleNumber:0};var drawDateStr=this.__getFullDateString(drawDate).slice(5,10),drawDateMonthStr=drawDateStr.slice(0,2),dateArraI=dateArr[i];drawDateStr=drawDateStr.slice(3,5);if(parseInt(drawDateMonthStr)-1!==this.drawMonth&&this.calendarType==="month")dateArraI.classList.add("near-month");if(this.calendarType==="month"){dateArraI.getElementsByClassName("top-calendar-date-number")[0].textContent=parseInt(drawDateStr)<10?drawDateStr.slice(1):drawDateStr}else{dateNumbers.children[i].textContent=(parseInt(drawDateStr)<10?drawDateStr.slice(1):drawDateStr)+" ("+this.dayNames[drawDate.getDay()]+")";dateNumbers.children[i].dataset.fullDate=this.__getFullDateString(drawDate)}if(this.__getFullDateString(todayDate)===this.__getFullDateString(drawDate)){dateArraI.classList.add("today");if(this.calendarType!=="month"){this.getElementsByClassName("top-calendar-date-number")[i].style.backgroundColor="#BCBCBC";this.getElementsByClassName("top-calendar-schedules-bottom-date")[i].classList.add("today")}}dateArraI.setAttribute("data-draw-index",i);dateArraI.setAttribute("data-full-date",this.__getFullDateString(drawDate));drawDate.setDate(drawDate.getDate()+1)}},__changeDates:function(selectedYear,selectedMonth,selectedFullDate){this.__updateDrawDate(selectedYear,selectedMonth,selectedFullDate);this.__updateDates()},__moveToNearBy:function(offset){var focusedDate=new Date(this.focusedDate);if(this.calendarType==="month"){focusedDate.setMonth(this.drawMonth+offset);focusedDate.setDate(1);this.__setFocusedDate(focusedDate);var selectedMonth=this.drawMonth+1+offset;this.__changeDates(this.drawYear,selectedMonth)}else{focusedDate.setDate(focusedDate.getDate()+(this.calendarType==="week"?7:1)*offset);this.__setFocusedDate(focusedDate);var drawDay=new Date(this.drawDay);drawDay.setDate(drawDay.getDate()+(this.calendarType==="week"?7:1)*offset);this.__changeDates(undefined,undefined,drawDay)}},__goToToday:function(){var today=new Date;this.__setFocusedDate(today);if(this.calendarType==="month"){this.__changeDates(today.getFullYear(),today.getMonth()+1)}else{this.__changeDates(undefined,undefined,today)}},__updateDrawDate:function(selectedYear,selectedMonth,selectedFullDate){if(selectedYear!==undefined&&selectedMonth!==undefined){var drawYear=parseInt(selectedYear),drawMonth=parseInt(selectedMonth)-1;if(isNaN(drawYear)||isNaN(drawMonth)){console.warn("Calendar: There is a problem with the entered value");this.__updateDrawDate();return}}else if(selectedFullDate){var date=new Date(selectedFullDate);if(isNaN(date.getTime())){console.warn("Calendar: There is a problem with the entered value");this.__updateDrawDate();return}}else{var date=new Date}if(date){var drawYear=date.getFullYear(),drawMonth=date.getMonth();this.drawDay=this.__getFullDateString(date)}this.drawYear=drawYear;this.drawMonth=drawMonth;if(this.calendarType==="month"){if(drawMonth===-1||drawMonth===12)this.__adjustYearMonth(drawYear,drawMonth);drawYear=this.drawYear;drawMonth=this.drawMonth;var firstDay=new Date(this.__getFullDateString(drawYear,drawMonth));var lastDay=new Date(firstDay);lastDay.setMonth(drawMonth+1);lastDay.setDate(0);var firstWeek=this.__calculateWeek(firstDay,drawMonth),lastWeek=this.__calculateWeek(lastDay,drawMonth),drawWeeks=lastWeek-firstWeek+1}if(this.calendarType!=="day"){var firstDrawDate=new Date(this.calendarType==="month"?firstDay:date);var lastDrawDate=new Date(this.calendarType==="month"?lastDay:date);firstDrawDate.setDate((this.calendarType==="month"?1:firstDrawDate.getDate())-firstDrawDate.getDay());lastDrawDate.setDate(lastDrawDate.getDate()+(6-lastDrawDate.getDay()));this.range=[this.__getFullDateString(firstDrawDate),this.__getFullDateString(lastDrawDate)]}else{this.range=[this.__getFullDateString(new Date(date)),this.__getFullDateString(new Date(date))]}if(this.calendarType==="month"){this.weekRange=[firstWeek,lastWeek];this.drawWeeks=drawWeeks}},__getFullDateString:function(yearOrDateObj,month,date){if(typeof yearOrDateObj==="number"){month+=1;month=this.__toTwoDigitsString(month);date=date?date:"01";return yearOrDateObj+"-"+month+"-"+date}else{var year=yearOrDateObj.getFullYear(),month=yearOrDateObj.getMonth()+1,date=yearOrDateObj.getDate();return year+"-"+this.__toTwoDigitsString(month)+"-"+this.__toTwoDigitsString(date)}},__toTwoDigitsString:function(int){return int<10?"0"+int:""+int},__adjustYearMonth:function(drawYear,drawMonth){if(drawMonth===-1){this.drawMonth=11;this.drawYear-=1}else if(drawMonth===12){this.drawMonth=0;this.drawYear+=1}},__dateAfterIdx:function(date,idx){date=date instanceof Date?date:new Date(date);idx=parseInt(idx);date.setDate(date.getDate()+idx);return this.__getFullDateString(date)},__dateDiff:function(date1,date2){date1=date1 instanceof Date?date1:new Date(date1);date2=date2 instanceof Date?date2:new Date(date2);var diff=date2-date1;diff=Math.ceil(diff/(1e3*3600*24));return diff},__translatePOData:function(POData){if(this.calendarType!=="week")var dateArr=this.querySelector(".top-calendar-dates").getElementsByClassName("top-calendar-date");else var dateArr=this.querySelector(".top-calendar-row").getElementsByClassName("top-calendar-date");var range=this.range,dateLength=dateArr.length,translatedData=new Array(dateLength);for(var i=0;i<dateLength;i++){translatedData[i]=[]}var colorList=["#8C8E92","#FFD21C","#FF9211","#FC6791","#F34545","#9E0EFA","#0288EC","#07C25B","#68D60F"],backColorList=["#DADADA","#FFF29A","#FFDEB8","#FEC6D6","#FFB4B4","#D698FD","#80DDFF","#C2EFD6","#DBF0B0"];var dtList=POData;for(var i=0;i<dtList.length;i++){var tasktype=dtList[i].taskType,title=dtList[i].title,color=dtList[i].color,backgroundColor="transparent";for(var j=0;j<colorList.length;j++){if(color==colorList[j]){backgroundColor=backColorList[j];break}}var tid=dtList[i].taskID;if(tasktype=="EVENT"){var allday=dtList[i].allday,importance=dtList[i].importance,startDate=dtList[i].startDate,endDate=dtList[i].endDate,startIdx=Math.max(this.__dateDiff(range[0],startDate),0),days,endIdx;var startTime="",endTime="";if(endDate==null){days=1;endIdx=startIdx}else{days=this.__dateDiff(startDate,endDate)+1;endIdx=this.__dateDiff(range[0],this.__dateAfterIdx(range[1],-Math.max(this.__dateDiff(endDate,range[1]),0)))}if(endTime==="0000"){days-=1;dtList[i].endTime="2400"}if(days==1){if(allday==false){if(this.calendarType==="month")backgroundColor="transparent";if(dtList[i].startTime!=null){startTime=dtList[i].startTime.substring(0,2)+":"+dtList[i].startTime.substring(2,4)}else{startTime=""}if(dtList[i].endTime!=null){endTime=dtList[i].endTime.substring(0,2)+":"+dtList[i].endTime.substring(2,4)}else{endTime=""}}var input={id:tid,color:color,text:title,day:days,flag:"event",time:[startTime,endTime]};input.background=backgroundColor;input.allday=allday;input.text=title;input.importance=importance;input.startDate=startDate;translatedData[startIdx].push(input)}else{for(var j=0;j<=endIdx-startIdx;j++){if(allday==false){if(dtList[i].startTime!=null){startTime=dtList[i].startTime.substring(0,2)+":"+dtList[i].startTime.substring(2,4)}else{startTime=""}if(dtList[i].endTime!=null){endTime=dtList[i].endTime.substring(0,2)+":"+dtList[i].endTime.substring(2,4)}else{endTime=""}}var input={id:tid,color:color,text:title,day:days,flag:"event",time:[startTime,endTime]};input.background=backgroundColor;input.allday=allday;input.importance=importance;input.startDate=startDate;input.text=title;if(j==0){input.work="start"}else if(j===endIdx-startIdx){input.work="end"}else{input.work="middle"}translatedData[startIdx+j].push(input)}}}else if(tasktype=="WORK"){var input={};if(dtList[i].startDate!=null&&dtList[i].endDate!=null){var startDate=dtList[i].startDate,endDate=dtList[i].endDate,days=this.__dateDiff(startDate,endDate)+1,idx=this.__dateDiff(range[0],startDate),worktype=""}else if(dtList[i].endDate!=null){var endDate=dtList[i].endDate,days=1,idx=this.__dateDiff(range[0],endDate),worktype="end"}else{var startDate=dtList[i].startDate,days=1,idx=this.__dateDiff(range[0],startDate),worktype="start"}if(days==1){input.id=tid;input.color=color;input.background=backgroundColor;input.day=days;input.flag="work";input.text=title;input.startDate=dtList[i].startDate;input.work=worktype;if(idx>=0&&idx<=this.__dateDiff(range[0],range[1])){translatedData[idx].push(input)}}else if(days>1){var startDate=dtList[i].startDate,endDate=dtList[i].endDate,days=this.__dateDiff(startDate,endDate)+1,startIdx=Math.max(this.__dateDiff(range[0],startDate),0),endIdx=this.__dateDiff(range[0],this.__dateAfterIdx(range[1],-Math.max(this.__dateDiff(endDate,range[1]),0)));for(var j=0;j<endIdx-startIdx+1;j++){var input={};input.id=tid;input.color=color;input.background=backgroundColor;input.text=title;input.day=days;input.startDate=startDate;input.flag="work";if(j==0){input.work="start"}else if(j===endIdx-startIdx){input.work="end"}else{input.work="middle"}translatedData[startIdx+j].push(input)}}}}return translatedData},__initBindingEvent:function(){var _this=this,todayBtn=this.getElementsByClassName("top-calendar-today")[0],prevBtn=this.getElementsByClassName("top-calendar-prev-btn")[0],nextBtn=this.getElementsByClassName("top-calendar-next-btn")[0],monthBtn=this.querySelector(".top-calendar-type-month"),weekBtn=this.querySelector(".top-calendar-type-week"),dayBtn=this.querySelector(".top-calendar-type-day"),todayScheduleBtn=this.getElementsByClassName("top-calendar-today-schedule-btn")[0],dialogRoot=this.getElementsByClassName("top-calendar-extra-dialog-root")[0],filterBtn=this.getElementsByClassName("top-calendar-filter")[0],filterCheckItems=filterBtn.getElementsByClassName("top-calendar-filter-popup-check-item"),filterMember=filterBtn.getElementsByClassName("top-calendar-filter-popup-member")[0],filterShared=filterBtn.getElementsByClassName("top-calendar-filter-popup-shared")[0],filterCategory=filterBtn.getElementsByClassName("top-calendar-filter-popup-category")[0],filterInit=filterBtn.getElementsByClassName("top-calendar-filter-popup-init")[0],filterBackground=this.getElementsByClassName("top-calendar-filter-background")[0],dragBody=this.getElementsByClassName("top-calendar-drag-body")[0];todayBtn.addEventListener("click",function(){_this.__goToToday()});prevBtn.addEventListener("click",function(){_this.__moveToNearBy(-1)});nextBtn.addEventListener("click",function(){_this.__moveToNearBy(1)});monthBtn.addEventListener("click",function(e){if(!this.className.includes("checked"))_this.__typeClickListener(e,_this)});weekBtn.addEventListener("click",function(e){if(!this.className.includes("checked"))_this.__typeClickListener(e,_this)});dayBtn.addEventListener("click",function(e){if(!this.className.includes("checked"))_this.__typeClickListener(e,_this)});todayScheduleBtn.addEventListener("click",function(e){_this.__userEventHandler(e)});dialogRoot.querySelector(".top-calendar-extra-dialog-header-close-btn").addEventListener("click",function(){_this.__closeExtraDialog()});dialogRoot.querySelector(".top-calendar-extra-dialog-footer-close-btn").addEventListener("click",function(){_this.__closeExtraDialog()});dialogRoot.addEventListener("click",function(e){if(e.target.className==="top-calendar-extra-dialog-root visible")_this.__closeExtraDialog()});if(this.__exDialogMove===undefined){this.__exDialogMove=function(e){var dialog=this.querySelector(".top-calendar-extra-dialog");dialog.style.top=_this.__positionCalc(_this.dialogTop,e.screenY,_this.mouseY1,390,_this.clientHeight)+"px";dialog.style.left=_this.__positionCalc(_this.dialogLeft,e.screenX,_this.mouseX1,370,_this.clientWidth)+"px";dialog.style.margin="0px"};this.__positionCalc=function(dialogP,cursor2,cursor1,size,layoutL){var position=dialogP+cursor2-cursor1;if(position<0)return 0;if(position+size>layoutL)return layoutL-size;return position}}dialogRoot.querySelector(".top-calendar-extra-dialog-header").addEventListener("mousedown",function(e){if(!_this.mouseX1){var dialog=dialogRoot.querySelector(".top-calendar-extra-dialog");_this.mouseX1=e.screenX;_this.mouseY1=e.screenY;_this.dialogLeft=dialog.offsetLeft;_this.dialogTop=dialog.offsetTop}document.addEventListener("mousemove",_this.__exDialogMove)});document.addEventListener("mouseup",function(){if(_this.mouseX1){document.removeEventListener("mousemove",_this.__exDialogMove);_this.mouseX1=undefined;_this.mouseY1=undefined;_this.dialogLeft=undefined;_this.dialogTop=undefined}});filterBtn.addEventListener("click",function(){_this.__openFilterPopup()});filterBackground.addEventListener("click",function(){_this.__closeFilterPopup()});filterMember.addEventListener("click",function(e){_this.__toggleMemberList()});filterMember.addEventListener("mouseenter",function(e){_this.__toggleMemberList("open")});filterMember.addEventListener("mouseleave",function(e){_this.__toggleMemberList("close")});filterShared.addEventListener("click",function(e){_this.__toggleSharedList()});filterShared.addEventListener("mouseenter",function(e){_this.__toggleSharedList("open")});filterShared.addEventListener("mouseleave",function(e){_this.__toggleSharedList("close")});filterCategory.addEventListener("click",function(e){_this.__toggleCategoryList()});filterCategory.addEventListener("mouseenter",function(e){_this.__toggleCategoryList("open")});filterCategory.addEventListener("mouseleave",function(e){_this.__toggleCategoryList("close")});filterInit.addEventListener("click",function(e){_this.__initializeFilter(filterCheckItems);_this.__userEventHandler(e,_this)});this.__attachToggleEvent(filterCheckItems)},__initBodyBindingEvent:function(){var _this=this,dragBody=this.getElementsByClassName("top-calendar-drag-body")[0],dates=this.getElementsByClassName(this.calendarType==="month"?"top-calendar-dates":"top-calendar-row")[0],openBtn=this.querySelector(".top-calendar-timeline-top-open"),dragBody2=this.getElementsByClassName("top-calendar-drag-body2")[0],scheduleBottom=this.getElementsByClassName("top-calendar-schedules-bottom")[0];if(this.calendarType!=="month"){openBtn.addEventListener("click",function(){var row=_this.querySelector(".top-calendar-row"),extras=row.getElementsByClassName("top-calendar-date-extra");if(this.className.includes("closed")){this.className="top-calendar-timeline-top-open visible opened";this.innerHTML=this.innerHTML.replace("펼치기","접기");row.style.maxHeight="234px";row.style.overflowY="auto";for(var i=0,length=extras.length;i<length;i++){extras[i].style.display="none"}if(row.clientHeight>228)row.classList.add("over")}else{this.className="top-calendar-timeline-top-open visible closed";this.innerHTML=this.innerHTML.replace("접기","펼치기");row.style.maxHeight="88px";row.style.overflowY="hidden";row.scrollTop=0;for(var i=0,length=extras.length;i<length;i++){extras[i].style.display="block"}row.classList.remove("over")}})}if(this.calendarType!=="week")var dateArr=this.querySelector(".top-calendar-dates").getElementsByClassName("top-calendar-date");else{var dateArr=this.querySelector(".top-calendar-row").getElementsByClassName("top-calendar-date"),dateNo=this.querySelector(".top-calendar-date-numbers")}for(var i=0,length=dateArr.length;i<length;i++){this.dateScheduleArr[i]={scheduleNumber:0};var dateArraI=dateArr[i];dateArraI.addEventListener("click",function(e){_this.__userEventHandler(e,this);_this.__drawFocusedDate(false);_this.focusedDate=this.dataset.fullDate;_this.__drawFocusedDate(true)});dateArraI.querySelector(".top-calendar-date-extra").addEventListener("click",function(e){if(this.className.includes("visible"))_this.__openExtraDialog(e)});if(this.calendarType==="month"){dateArraI.querySelector(".top-calendar-date-number").addEventListener("click",function(e){e.stopPropagation();_this.focusedDate=this.parentNode.dataset.fullDate;_this.calendarType="day";_this.__changeType(e.target.parentNode.dataset.fullDate)})}else if(this.calendarType==="week"){dateNo.children[i].addEventListener("click",function(e){e.stopPropagation();_this.focusedDate=this.dataset.fullDate;_this.calendarType="day";_this.__changeType(e.target.dataset.fullDate)})}else{this.querySelector(".top-calendar-date-number").style.cursor="default"}}if(this.calendarType!=="month"){var dateTime=this.getElementsByClassName("top-calendar-schedules-bottom-date-time");for(var i=0,length=dateTime.length;i<length;i++){dateTime[i].addEventListener("click",function(e){_this.__drawFocusedDate(false);_this.focusedDate=this.parentNode.dataset.fullDate;_this.__drawFocusedDate(true);_this.__userEventHandler(e,this)})}}var dragFn=_this.__dragFn();dates.addEventListener("mousedown",function(e){if(e.which===1)this.addEventListener("mousemove",dragFn.dragOnDates)});dates.addEventListener("click",function(e){this.removeEventListener("mousemove",dragFn.dragOnDates)});document.addEventListener("mouseup",function(){if(!_this.isTimeDrag&&dragBody&&_this.dragCount===0){var dragStart=_this.dragStart,dragEnd=_this.dragEnd;if(!_this.draggingBlock){if(_this.dragStart>_this.dragEnd){dragStart=_this.dragEnd;dragEnd=_this.dragStart}}_this.__dispatchEvent(new CustomEvent("calendarDrag",{detail:{startIndex:dragStart,endIndex:dragEnd,id:_this.draggingBlock?_this.draggingBlock.dataset.id:undefined}}));dragBody.removeEventListener("mousemove",dragFn.dragOnDragBody);_this.isDragging=false;_this.dragCount=2;_this.dragBlockRange=undefined;_this.dragStart=undefined;_this.dragEnd=undefined;_this.draggingBlock=undefined;if(!_this.onCalendarDrag){dragBody.classList.remove("visible");dragFn.removeDragScheduleBlocks()}}if(_this.isTimeDrag&&_this.dragCount===0){var dragStart=_this.dragStart,dragEnd=_this.dragEnd,drawIndex=_this.draggingDrawIndex;if(!_this.draggingBlock){if(_this.dragStart>_this.dragEnd){dragStart=_this.dragEnd;dragEnd=_this.dragStart}}_this.__dispatchEvent(new CustomEvent("calendarDrag",{detail:{startTime:_this.__timeIndexToTime(dragStart),endTime:_this.__timeIndexToTime(dragEnd,true),drawIndex:drawIndex,id:_this.draggingBlock?_this.draggingBlock.dataset.id:undefined}}));dragBody2.removeEventListener("mousemove",dragFn.dragOnDragBody2);_this.isDragging=false;_this.dragCount=2;_this.dragBlockRange=undefined;_this.startDrawIndex=undefined;_this.dragStart=undefined;_this.dragEnd=undefined;_this.draggingBlock=undefined;if(!_this.onCalendarDrag){dragBody2.classList.remove("visible");dragFn.removeDragScheduleBlocks()}_this.isTimeDrag=undefined;_this.changeTimeL=false}});if(scheduleBottom){scheduleBottom.addEventListener("mousedown",function(e){if(e.which===1){_this.isTimeDrag=true;this.addEventListener("mousemove",dragFn.dragOnTimes)}});scheduleBottom.addEventListener("click",function(e){this.removeEventListener("mousemove",dragFn.dragOnTimes)})}},__dragFn:function(){var _this=this,dragBody=this.getElementsByClassName("top-calendar-drag-body")[0],dragBody2=this.getElementsByClassName("top-calendar-drag-body2")[0];if(this.calendarType!=="week")var dateArr=this.querySelector(".top-calendar-dates").getElementsByClassName("top-calendar-date");else var dateArr=this.querySelector(".top-calendar-row").getElementsByClassName("top-calendar-date");function dragOnDates(){_this.dragCount--;if(dragBody&&_this.dragCount<1){dragBody.classList.add("visible");dragBody.addEventListener("mousemove",dragOnDragBody);this.removeEventListener("mousemove",dragOnDates)}}function dragOnTimes(){_this.dragCount--;if(dragBody2&&_this.dragCount<1){dragBody2.classList.add("visible");dragBody2.addEventListener("mousemove",dragOnDragBody2);this.removeEventListener("mousemove",dragOnTimes)}}function dragOnDragBody(e){if(!e.target.parentNode.parentNode)return;
var drawIndex=parseInt(e.target.dataset.drawIndex||e.target.parentNode.dataset.drawIndex||e.target.parentNode.parentNode.parentNode.dataset.drawIndex||e.target.parentNode.parentNode.dataset.drawIndex),parentClass=e.target.parentNode.classList[0];if(_this.draggingBlock){var blockDataset=_this.draggingBlock.dataset,blockStartDate=blockDataset.startDate,blockDates=[];for(var i=0,length=parseInt(blockDataset.day);i<length;i++){var date=new Date(blockStartDate);date.setDate(date.getDate()+i);var blockDate=dragBody.querySelector('[data-full-date="'+_this.__getFullDateString(date)+'"]');if(blockDate)blockDates.push(blockDate)}}if(!_this.isDragging){_this.dragStart=drawIndex;_this.dragEnd=drawIndex;if(!_this.draggingBlock){_this.dragBlockRange=[_this.dragStart,_this.dragEnd]}else{_this.dragBlockRange=[blockDates[0].dataset.drawIndex,blockDates[blockDates.length-1].dataset.drawIndex]}_this.isDragging=true;addDragScheduleBlocks(_this.dragBlockRange,this)}if((parentClass==="top-calendar-date"||parentClass==="top-calendar-schedule")&&_this.dragEnd!==drawIndex){_this.dragEnd=drawIndex;removeDragScheduleBlocks();if(!_this.draggingBlock){if(_this.dragStart<_this.dragEnd)_this.dragBlockRange=[_this.dragStart,_this.dragEnd];else _this.dragBlockRange=[_this.dragEnd,_this.dragStart]}else{var diff=_this.dragEnd-_this.dragStart,dragStart=parseInt(blockDates[0].dataset.drawIndex)+diff,dragEnd=parseInt(blockDates[blockDates.length-1].dataset.drawIndex)+diff,endDrawIndex=dateArr.length-1;if(dragStart<0)dragStart=0;if(dragEnd>endDrawIndex)dragEnd=endDrawIndex;_this.dragBlockRange=[dragStart,dragEnd]}addDragScheduleBlocks(_this.dragBlockRange,this)}}function dragOnDragBody2(e){if(!e.target.parentNode||!e.target.parentNode.parentNode)return;var drawIndex=parseInt(e.target.dataset.drawIndex||e.target.parentNode.dataset.drawIndex||e.target.parentNode.parentNode.parentNode.dataset.drawIndex||e.target.parentNode.parentNode.dataset.drawIndex),timeIndex=parseInt(e.target.dataset.timeIndex||e.target.parentNode.dataset.timeIndex||e.target.parentNode.parentNode.parentNode.dataset.timeIndex||e.target.parentNode.parentNode.dataset.timeIndex);parentClass=e.target.parentNode.classList[0];if(_this.draggingBlock){var blockDataset=_this.draggingBlock.dataset,blockRange=blockDataset.indexRange.split(","),blockRange1=parseInt(blockRange[0]),blockRange2=parseInt(blockRange[1])}if(!_this.isDragging){_this.draggingDrawIndex=drawIndex;_this.startDrawIndex=drawIndex;_this.dragStart=timeIndex;_this.dragEnd=timeIndex;if(!_this.draggingBlock){_this.dragBlockRange=[_this.dragStart,_this.dragEnd]}else{_this.dragBlockRange=[blockRange1,blockRange2];_this.timeIndexStart=timeIndex}_this.isDragging=true;addTimelineDragScheduleBlocks(_this.dragBlockRange,_this.draggingDrawIndex,this)}if((parentClass==="top-calendar-schedules-bottom-date"||parentClass==="top-calendar-schedules-bottom-date-time"||parentClass==="top-calendar-schedule")&&(_this.dragEnd!==timeIndex||_this.draggingDrawIndex!==drawIndex)){_this.dragEnd=timeIndex;_this.draggingDrawIndex=drawIndex;removeDragScheduleBlocks();if(!_this.draggingBlock){if(_this.dragStart<_this.dragEnd)_this.dragBlockRange=[_this.dragStart,_this.dragEnd];else _this.dragBlockRange=[_this.dragEnd,_this.dragStart]}else{var diff=timeIndex-_this.timeIndexStart,dragStart=_this.dragStart=blockRange1+(_this.changeTimeL?0:diff),dragEnd=_this.dragEnd=blockRange2+diff,endDrawIndex=47;if(dragStart<0)dragStart=0;if(dragEnd>endDrawIndex)dragEnd=endDrawIndex;if(_this.changeTimeL&&dragStart>dragEnd)dragEnd=_this.dragEnd=dragStart;_this.dragBlockRange=[dragStart,dragEnd]}if(!_this.draggingBlock||_this.changeTimeL){addTimelineDragScheduleBlocks(_this.dragBlockRange,_this.startDrawIndex,this)}else{addTimelineDragScheduleBlocks(_this.dragBlockRange,drawIndex,this)}}}function removeDragScheduleBlocks(){if(!_this.isTimeDrag)var dragScheduleBlocks=dragBody.querySelectorAll(".top-calendar-schedule");else var dragScheduleBlocks=dragBody2.querySelectorAll(".top-calendar-schedule");for(var i=0,length=dragScheduleBlocks.length;i<length;i++){dragScheduleBlocks[i].remove()}}function addDragScheduleBlocks(indexRange,dragBody){indexRange[0]=parseInt(indexRange[0]);indexRange[1]=parseInt(indexRange[1]);var dateContents=dragBody.getElementsByClassName("top-calendar-date-content");for(var i=indexRange[0];i<indexRange[1]+1;i++){_this.__appendSchedule(undefined,dateContents[i]);if(i===indexRange[0]){if(!_this.draggingBlock){dateContents[i].querySelector(".top-calendar-schedule-text").textContent="제목없음"}else{var drawIndex=_this.draggingBlock.parentNode.parentNode.dataset.drawIndex;for(var j=0,length=_this.AllSchedules[drawIndex].length;j<length;j++){if(_this.AllSchedules[drawIndex][j].id===_this.draggingBlock.dataset.id){var blockText=_this.AllSchedules[drawIndex][j].text;break}}dateContents[i].querySelector(".top-calendar-schedule-text").textContent=blockText}}if(i===indexRange[1]){dateContents[i].querySelector(".top-calendar-schedule").classList.add("end-block")}}}function addTimelineDragScheduleBlocks(indexRange,drawIndex,dragBody2){indexRange[0]=parseInt(indexRange[0]);indexRange[1]=parseInt(indexRange[1]);var dateContents=dragBody2.getElementsByClassName("top-calendar-date-content"),dateCol=dragBody2.children[drawIndex],startTimeIdx=dateCol.children[indexRange[0]];var timeIdx=dateCol.children[indexRange[0]];var innerHTML='<div class="top-calendar-schedule">'+'<div class="top-calendar-schedule-timeline-tag"></div>'+'<div class="top-calendar-schedule-timeline-text"></div></div>';timeIdx.insertAdjacentHTML("beforeend",innerHTML);var scheduleBlock=startTimeIdx.children[0];scheduleBlock.style.zIndex=2;scheduleBlock.style.height=_this.scheduleHeight*(indexRange[1]-indexRange[0]+1)-1+"px";scheduleBlock.style.backgroundColor="#"+"00ff00";if(!_this.draggingBlock){scheduleBlock.querySelector(".top-calendar-schedule-timeline-text").textContent="제목없음"}else{for(var j=0,length=_this.AllSchedules[_this.startDrawIndex].length;j<length;j++){if(_this.AllSchedules[_this.startDrawIndex][j].id===_this.draggingBlock.dataset.id){var blockText=_this.AllSchedules[_this.startDrawIndex][j].text;break}}scheduleBlock.querySelector(".top-calendar-schedule-timeline-text").textContent=blockText;scheduleBlock.querySelector(".top-calendar-schedule-timeline-tag").style.backgroundColor=_this.AllSchedules[_this.startDrawIndex][j].color;scheduleBlock.style.backgroundColor=_this.AllSchedules[_this.startDrawIndex][j].background}}return{dragOnDates:dragOnDates,dragOnDragBody:dragOnDragBody,dragOnDragBody2:dragOnDragBody2,removeDragScheduleBlocks:removeDragScheduleBlocks,dragOnTimes:dragOnTimes}},__attachToggleEvent:function(filterCheckItems){var _this=this;for(var i=0,length=filterCheckItems.length;i<length;i++){filterCheckItems[i].addEventListener("click",function(e){e.stopPropagation();var dataset=this.dataset,siblings=this.parentNode.children;if(dataset.checked==="checked"){dataset.checked="unchecked";this.querySelector(".top-calendar-filter-popup-check-item-icon").className="top-calendar-filter-popup-check-item-icon unchecked"}else{dataset.checked="checked";this.querySelector(".top-calendar-filter-popup-check-item-icon").className="top-calendar-filter-popup-check-item-icon checked"}if(dataset.id==="filter-all"){for(var j=0;j<siblings.length;j++){siblings[j].dataset.checked=dataset.checked;siblings[j].querySelector(".top-calendar-filter-popup-check-item-icon").className="top-calendar-filter-popup-check-item-icon "+dataset.checked}}else if(dataset.id!=="filter-event"&&dataset.id!=="filter-work"){for(var j=1;j<siblings.length;j++){if(siblings[j].dataset.checked==="checked"){if(j<siblings.length-1)continue;siblings[0].dataset.checked="checked";siblings[0].querySelector(".top-calendar-filter-popup-check-item-icon").className="top-calendar-filter-popup-check-item-icon checked"}else{siblings[0].dataset.checked="unchecked";siblings[0].querySelector(".top-calendar-filter-popup-check-item-icon").className="top-calendar-filter-popup-check-item-icon unchecked";break}}}_this.__userEventHandler(e,_this)})}},__initializeFilter:function(filterCheckItems){var memberList=typeof this.memberList==="string"?Top.Util.namespace(this.memberList):this.memberList;for(var i=0,length=filterCheckItems.length;i<length;i++){if(filterCheckItems[i].dataset.id==="filter-event"||filterCheckItems[i].dataset.id==="filter-work"){filterCheckItems[i].dataset.checked="checked";filterCheckItems[i].querySelector(".top-calendar-filter-popup-check-item-icon").className="top-calendar-filter-popup-check-item-icon checked"}else if(memberList&&filterCheckItems[i].dataset.id===memberList[0].id){filterCheckItems[i].dataset.checked="checked";filterCheckItems[i].querySelector(".top-calendar-filter-popup-check-item-icon").className="top-calendar-filter-popup-check-item-icon checked"}else{filterCheckItems[i].dataset.checked="unchecked";filterCheckItems[i].querySelector(".top-calendar-filter-popup-check-item-icon").className="top-calendar-filter-popup-check-item-icon unchecked"}}},__toggleMemberList:function(trigger){var filterMemberList=this.getElementsByClassName("top-calendar-filter-popup-member-list")[0],isOpened=filterMemberList.className.includes("opened");if(!trigger){filterMemberList.className="top-calendar-filter-popup-member-list "+(isOpened?"closed":"opened")}else{if(trigger==="open")filterMemberList.className="top-calendar-filter-popup-member-list opened";else filterMemberList.className="top-calendar-filter-popup-member-list closed"}},__toggleSharedList:function(trigger){var filterSharedList=this.getElementsByClassName("top-calendar-filter-popup-shared-list")[0],isOpened=filterSharedList.className.includes("opened");if(!trigger){filterSharedList.className="top-calendar-filter-popup-shared-list "+(isOpened?"closed":"opened")}else{if(trigger==="open")filterSharedList.className="top-calendar-filter-popup-shared-list opened";else filterSharedList.className="top-calendar-filter-popup-shared-list closed"}},__toggleCategoryList:function(trigger){var filterCategoryList=this.getElementsByClassName("top-calendar-filter-popup-category-list")[0],isOpened=filterCategoryList.className.includes("opened");if(!trigger){filterCategoryList.className="top-calendar-filter-popup-category-list "+(isOpened?"closed":"opened")}else{if(trigger==="open")filterCategoryList.className="top-calendar-filter-popup-category-list opened";else filterCategoryList.className="top-calendar-filter-popup-category-list closed"}},__openFilterPopup:function(){var filterPopup=this.getElementsByClassName("top-calendar-filter")[0],filterBackground=this.getElementsByClassName("top-calendar-filter-background")[0];filterBackground.className="top-calendar-filter-background opened";filterPopup.className="top-calendar-filter opened"},__closeFilterPopup:function(){var filterPopup=this.getElementsByClassName("top-calendar-filter")[0],filterMemberList=this.getElementsByClassName("top-calendar-filter-popup-member-list")[0],filterSharedList=this.getElementsByClassName("top-calendar-filter-popup-shared-list")[0],filterCategoryList=this.getElementsByClassName("top-calendar-filter-popup-category-list")[0],filterBackground=this.getElementsByClassName("top-calendar-filter-background")[0];filterBackground.className="top-calendar-filter-background closed";filterPopup.className="top-calendar-filter closed";filterMemberList.className="top-calendar-filter-popup-member-list closed";filterSharedList.className="top-calendar-filter-popup-shared-list closed";filterCategoryList.className="top-calendar-filter-popup-category-list closed"},__typeClickListener:function(e,_this){var eTarget=e.target;var dateStr=_this.focusedDate;if(eTarget.className.includes("month"))_this.calendarType="month";else if(eTarget.className.includes("week"))_this.calendarType="week";else if(eTarget.className.includes("day"))_this.calendarType="day";_this.__changeType(dateStr);_this.__userEventHandler(e,_this)},__updateDisabled:function(){var calendar=this.querySelector(".top-calendar-root");this.__setDisabled(calendar)},__initEventInternal:function(){this.__addEventByAttr("addScheduleClick");this.__addEventByAttr("updateDates");this.__addEventByAttr("dateClick");this.__addEventByAttr("filterItemClick");this.__addEventByAttr("calendarDrag");this.__addEventByAttr("scheduleClick")},__updateOnAddScheduleClick:function(){this.__addEventByAttr("addScheduleClick")},__updateOnUpdateDates:function(){this.__addEventByAttr("updateDates")},__updateOnDateClick:function(){this.__addEventByAttr("dateClick")},__updateOnFilterItemClick:function(){this.__addEventByAttr("filterItemClick")},__updateOnCalendarDrag:function(){this.__addEventByAttr("calendarDrag")},__updateOnScheduleClick:function(){this.__addEventByAttr("scheduleClick")},__timeIndexToTime:function(idx,isEndTime){idx=isEndTime?idx+1:idx;var hour=this.__toTwoDigitsString(parseInt(idx/2)),min=this.__toTwoDigitsString(idx%2*30);return hour+min},__userEventHandler:function(e,_this){var eTarget=e.target;if(eTarget.className==="top-calendar-today-schedule-btn"){this.__dispatchEvent(new CustomEvent("addScheduleClick"));return}if(eTarget.className.includes("top-calendar-date-extra")){return}if(eTarget.className.includes("top-calendar-date")){this.__dispatchEvent(new CustomEvent("dateClick",{detail:{drawIndex:_this.dataset.drawIndex,date:_this.dataset.fullDate}}));return}if(eTarget.className.includes("top-calendar-schedules-bottom-date-time")){var startTime=this.__timeIndexToTime(_this.dataset.timeIndex);this.__dispatchEvent(new CustomEvent("dateClick",{detail:{startTime:startTime,date:_this.parentNode.dataset.fullDate}}));return}if(eTarget.className.includes("top-calendar-schedule")){var drawIndex=_this.parentNode.dataset.drawIndex?_this.parentNode.dataset.drawIndex:_this.parentNode.parentNode.dataset.drawIndex;e.stopPropagation();e.preventDefault();this.__dispatchEvent(new CustomEvent("scheduleClick",{detail:{drawIndex:drawIndex,id:_this.dataset.id}}));return}if(eTarget.className.includes("top-calendar-filter-popup-check-item")||eTarget.parentNode.className==="top-calendar-type"||eTarget.className==="top-calendar-filter-popup-init"){var filterPopup=_this.querySelector(".top-calendar-filter-popup"),checkedItems=filterPopup.querySelectorAll('[data-checked="checked"]'),checkedIds=[];for(var i=0,length=checkedItems.length;i<length;i++){if(checkedItems[i].dataset.id!=="filter-all")checkedIds.push(checkedItems[i].dataset.id)}this.__dispatchEvent(new CustomEvent("filterItemClick",{detail:{checkedItems:checkedIds}}))}},__updateTabIndex:function(){var calendar=this.querySelector(".top-calendar-root");calendar.setAttribute("tabindex",this.tabIndex)},__calculateWeek:function(date,selectedMonth){var checkDate=new Date(date.getTime());var lastDay=new Date(date.getTime());lastDay.setDate(lastDay.getDate()+(6-lastDay.getDay()));checkDate.setMonth(0);checkDate.setDate(1);checkDate.setDate(7-checkDate.getDay());if(selectedMonth===0&&Math.floor(Math.round((lastDay-checkDate)/864e5)/7)+1>50)return 1;else return Math.floor(Math.round((lastDay-checkDate)/864e5)/7)+1},addSchedule:function(drawIndex,i,dateContent,schedulesBottom){var _this=this,allSchedules=this.AllSchedules;this.dateScheduleArr[drawIndex].scheduleNumber++;if(this.calendarType==="month"){if(dateContent.clientHeight>this.dateScheduleArr[drawIndex].scheduleNumber*this.scheduleHeight){this.__appendSchedule(drawIndex,dateContent)}this.__adjustExtraNumber(drawIndex,dateContent)}else{if(allSchedules[drawIndex][i].flag==="work"||allSchedules[drawIndex][i].day>1||allSchedules[drawIndex][i].allday||allSchedules[drawIndex][i].id===undefined){this.__appendSchedule(drawIndex,dateContent);this.__adjustExtraNumber(drawIndex,dateContent)}else{var idxs=this.__getTimelineIndex(allSchedules[drawIndex][i].time),startIdx=idxs[0],endIdx=idxs[1];this.__appendSchedule(drawIndex,undefined,startIdx,endIdx,schedulesBottom,i)}}},__getTimelineIndex:function(time){var startT=time[0].split(":"),endT=time[1].split(":"),idx1=parseInt(startT[0])*2+parseInt(startT[1])/30,idx2=parseInt(endT[0])*2+parseInt(endT[1])/30-1;return[idx1,idx2]},__appendSchedule:function(drawIndex,dateContent,startIdx,endIdx,schedulesBottom,allScheduleIdx){if(dateContent){dateContent.innerHTML+='<div class="top-calendar-schedule">'+'<div class="top-calendar-schedule-text"></div></div>';if(!this.isDragging)this.__adjustScheduleHeight(drawIndex,dateContent)}else{var _this=this,dateCol=schedulesBottom.children[drawIndex],startTimeIdx=dateCol.children[startIdx],extraIdx1=startIdx%2===1?startIdx:startIdx+1,extraIdx2=endIdx%2===1?endIdx:endIdx+1,extraIdxLen=(extraIdx2-extraIdx1)/2+1;if(startTimeIdx.children.length<this.weekMaxBlockNo||this.calendarType==="day"){var idxes=[];var startChildL=startTimeIdx.children.length;if(this.calendarType==="week"){for(var i=0,length=this.weekMaxBlockNo;i<length;i++){idxes.push(i)}}else{if(startChildL>0){var maxIndex=0;for(var i=0,length=startChildL;i<length;i++){if(maxIndex<startTimeIdx.children[i].dataset.index)maxIndex=startTimeIdx.children[i].dataset.index}for(var i=0,length=maxIndex+2;i<length;i++){idxes.push(i)}}else{idxes.push(0)}}for(var j=0,length=idxes.length;j<length;j++){for(var i=0,length=startChildL;i<length;i++){if(idxes[j]===parseInt(startTimeIdx.children[i].dataset.index))delete idxes[j]}}for(var i=0,length=idxes.length;i<length;i++){if(idxes[i]!==undefined){var scheduleIdx=idxes[i];break}}var blockWidth=this.calendarType==="week"?this.weekBlockWidth:this.dayBlockWidth;for(var i=0,length=endIdx-startIdx+1;i<length;i++){var timeIdx=dateCol.children[i+startIdx];var innerHTML='<div class="top-calendar-schedule" data-index="'+scheduleIdx+'">'+(i===0?'<div class="top-calendar-schedule-timeline-text"></div>'+'<div class="top-calendar-schedule-timeline-drag"></div></div>':"</div>");timeIdx.insertAdjacentHTML("beforeend",innerHTML);timeIdx.querySelector('[data-index = "'+scheduleIdx+'"').style.left=blockWidth*scheduleIdx+"px";timeIdx.dataset.number++}var schedule=this.AllSchedules[drawIndex][allScheduleIdx],dragFn=_this.__dragFn(),scheduleBlock=startTimeIdx.querySelector('[data-index = "'+scheduleIdx+'"'),blockText=scheduleBlock.querySelector(".top-calendar-schedule-timeline-text"),blockDrag=scheduleBlock.querySelector(".top-calendar-schedule-timeline-drag");scheduleBlock.style.zIndex=1;scheduleBlock.style.height=this.scheduleHeight*(endIdx-startIdx+1)-1+"px";blockDrag.style.top=this.scheduleHeight*(endIdx-startIdx+1)-10+"px";scheduleBlock.style.backgroundColor=schedule.background;blockText.textContent=schedule.flag==="event"&&(!schedule.allday||schedule.allday==="false")?schedule.text+"\t"+schedule.time[0]+"\t"+"~ "+schedule.time[1]:schedule.text;if(Top.Util.Browser.isIE()){blockText.style.height=11*(endIdx-startIdx+1)*2+"px"}else{blockText.style.WebkitLineClamp=(endIdx-startIdx+1)*2}scheduleBlock.setAttribute("data-id",schedule.id);scheduleBlock.dataset.indexRange=[startIdx,endIdx];scheduleBlock.addEventListener("click",function scheduleClickEvent(e){_this.__userEventHandler(e,this);this.removeEventListener("mousemove",dragFn.dragOnTimes)});scheduleBlock.addEventListener("mousedown",function(e){if(e.which===1){e.stopPropagation();_this.isTimeDrag=true;this.addEventListener("mousemove",dragFn.dragOnTimes);_this.draggingBlock=this}});blockDrag.addEventListener("mousedown",function(e){if(e.which===1){e.stopPropagation();_this.isTimeDrag=true;_this.changeTimeL=true;this.addEventListener("mousemove",dragFn.dragOnTimes);_this.draggingBlock=this.parentNode}});if(this.calendarType==="day")return}else{for(var i=0;i<extraIdxLen;i++){var timeBlock=dateCol.children[extraIdx1+2*i];timeBlock.dataset.extraNumber++;if(!timeBlock.querySelector(".top-calendar-timeline-extra-number")){timeBlock.insertAdjacentHTML("afterbegin",'<div class="top-calendar-timeline-extra-number"></div>');timeBlock.querySelector(".top-calendar-timeline-extra-number").addEventListener("click",function(e){_this.__openExtraDialog(e)})}timeBlock.querySelector(".top-calendar-timeline-extra-number").textContent="+"+timeBlock.dataset.extraNumber}}for(var i=0;i<extraIdxLen;i++){var timeBlock=dateCol.children[extraIdx1+2*i];if(!timeBlock.dataset.scheduleIndex)timeBlock.dataset.scheduleIndex=allScheduleIdx;else timeBlock.dataset.scheduleIndex+=","+allScheduleIdx}}},__adjustScheduleHeight:function(drawIndex,dateContent){var scheduleBlocks=dateContent.children;for(var i=0,length=scheduleBlocks.length;i<length;i++){scheduleBlocks[i].style.top=this.scheduleHeight*i+"px"}},removeSchedule:function(taskId){var POData=this.POData;for(var i=0,length=POData.length;i<length;i++){if(POData[i].taskID===taskId){var POData1=POData.slice(0,i+1),POData2=POData.slice(i+1);POData1.pop();this.POData=POData1.concat(POData2);break}}this.__setSchedules(this.POData)},__adjustExtraNumber:function(drawIndex,dateContent){if(this.calendarType==="month"){var maxLength=parseInt(dateContent.clientHeight/this.scheduleHeight),totalLength=this.dateScheduleArr[drawIndex].scheduleNumber,extraBlock=dateContent.parentNode.getElementsByClassName("top-calendar-date-extra")[0];if(totalLength>maxLength){var extraNumber=0,schedules=this.AllSchedules[drawIndex];for(var i=maxLength;i<totalLength;i++){if(schedules[i].id!==undefined)extraNumber++}extraBlock.textContent="+"+extraNumber;extraBlock.classList.add("visible");extraBlock.classList.remove("hidden")}else{extraBlock.classList.add("hidden");extraBlock.classList.remove("visible")}}else{var length=dateContent.children.length,extraBlock=dateContent.parentNode.querySelector(".top-calendar-date-extra"),exCount=length-3;if(exCount>0)extraBlock.textContent="+"+(length-3);else extraBlock.textContent=""}},__updateExtraSchedule:function(drawIndex,isWeek,dateTime){var dateContent=this.getElementsByClassName("top-calendar-extra-dialog-body-schedules")[0],allSchedules=this.AllSchedules[drawIndex],extraSchedules=[];dateContent.innerHTML="";dateContent.setAttribute("data-draw-index",drawIndex);if(isWeek){if(dateTime)dateContent.setAttribute("data-time-index",dateTime.dataset.timeIndex);else dateTime=this.getElementsByClassName("top-calendar-schedules-bottom-date-time")[dateContent.dataset.timeIndex];var scheduleIdxs=dateTime.dataset.scheduleIndex.split(",");for(var i=0,length=scheduleIdxs.length;i<length;i++){this.__appendSchedule(drawIndex,dateContent);extraSchedules[i]=allSchedules[scheduleIdxs[i]]}}else{for(var i=0,length=allSchedules.length;i<length;i++){if(allSchedules[i].id!==undefined){this.__appendSchedule(drawIndex,dateContent);extraSchedules.push(allSchedules[i])}}}this.__updateScheduleInfo(drawIndex,dateContent,extraSchedules)},__setSchedules:function(array,drawIndex){var body=this.getElementsByClassName("top-calendar-body")[0];body.innerHTML=this.bodyInnerHTML;if(Top.Util.Browser.isIE()){window.getComputedStyle(this.querySelector(".top-calendar-schedules-bottom")).width;this.querySelector(".top-calendar-schedules-bottom").insertAdjacentHTML("afterbegin",'<div class="dummyDom">test</div>');this.querySelector(".dummyDom").remove()}this.__initBodyBindingEvent();if(array instanceof Array&&!(array[0]instanceof Array)){this.POData=array.slice();array=this.__translatePOData(array)}if(drawIndex===undefined){this.AllSchedules=array;for(var drawIndex=0,dateLength=array.length;drawIndex<dateLength;drawIndex++){this.__updateSchedule(array[drawIndex],drawIndex)}}else{drawIndex=parseInt(drawIndex);this.AllSchedules[drawIndex]=array;this.__updateSchedule(array,drawIndex)}if(this.calendarType!=="month"){var openBtn=this.querySelector(".top-calendar-timeline-top-open"),dates=this.getElementsByClassName("top-calendar-date"),isOver=false;openBtn.classList.remove("visible");for(var i=0,length=dates.length;i<length;i++){if(dates[i].querySelector(".top-calendar-date-content").children.length>3){openBtn.classList.add("visible");isOver=true;break}}if(isOver){var _this=this,row=this.querySelector(".top-calendar-row"),extras=row.getElementsByClassName("top-calendar-date-extra");for(var j=0,length=extras.length;j<length;j++){extras[j].style.display="block"}}}var extraSchedules=this.querySelector(".top-calendar-extra-dialog-body-schedules");if(extraSchedules.children.length>0){var drawIndex=parseInt(extraSchedules.getAttribute("data-draw-index"));var isWeek=this.calendarType==="week"?true:false;this.__updateExtraSchedule(drawIndex,isWeek)}if(this.calendarType==="week"){var scrollH=this.querySelector(".top-calendar-row").scrollHeight;for(var i=0,length=dates.length;i<length;i++){dates[i].style.height=scrollH+"px"}}if(this.calendarType==="day"){var dateTime=this.getElementsByClassName("top-calendar-schedules-bottom-date-time"),scheBottomWrap=this.querySelector(".top-calendar-schedules-bottom"),dayMaxBlockNo=0;for(var i=0,length=dateTime.length;i<length;i++){if(dayMaxBlockNo<parseInt(dateTime[i].dataset.number))dayMaxBlockNo=parseInt(dateTime[i].dataset.number)}var maxWidth=dayMaxBlockNo*121+10;if(scheBottomWrap.clientWidth<maxWidth){for(var i=0;i<length;i++){dateTime[i].style.width=maxWidth+"px"}var timeline=this.querySelector(".top-calendar-today-timeline");if(timeline)timeline.style.width=maxWidth+"px"}}},__updateSchedule:function(array,drawIndex){if(this.calendarType!=="week")var dateArr=this.querySelector(".top-calendar-dates").getElementsByClassName("top-calendar-date");else var dateArr=this.querySelector(".top-calendar-row").getElementsByClassName("top-calendar-date");var dateContent=dateArr[drawIndex].getElementsByClassName("top-calendar-date-content")[0];var allSchedules=this.AllSchedules;var schedulesBottom=this.querySelector(".top-calendar-schedules-bottom");dateContent.innerHTML="";this.dateScheduleArr[drawIndex].scheduleNumber=0;if(this.calendarType==="week")this.weekMaxBlockNo=parseInt((schedulesBottom.clientWidth/7-27)/this.weekBlockWidth);this.__sortSchedule(drawIndex);for(var i=0,scheduleLength=allSchedules[drawIndex].length;i<scheduleLength;i++){this.addSchedule(drawIndex,i,dateContent,schedulesBottom)}this.__updateScheduleInfo(drawIndex,dateContent)},__undefinedToBack:function(arr){var newArr=[];for(var i=0,length=arr.length;i<length;i++){if(arr[i]!==undefined)newArr.push(arr[i])}newArr.length=length;return newArr},__sortSchedule:function(drawIndex){if(drawIndex===0){this.AllSchedules[drawIndex]=this.__undefinedToBack(this.AllSchedules[drawIndex])}else{var prevSchedules=this.AllSchedules[drawIndex-1],curSchedules=this.AllSchedules[drawIndex],sortedArray=[];for(var i=0,iLength=curSchedules.length;i<iLength;i++){if(curSchedules[i].work&&curSchedules[i].work!=="start"&&curSchedules[i].day>1){for(var j=0,jLength=prevSchedules.length;j<jLength;j++){if(prevSchedules[j].id===curSchedules[i].id){sortedArray[prevSchedules.indexOf(prevSchedules[j])]=curSchedules[i]}}delete curSchedules[i]}}curSchedules=this.__undefinedToBack(curSchedules);if(this.calendarType==="month"){var kLength=curSchedules.length>sortedArray.length?curSchedules.length:sortedArray.length;for(var k=0;k<kLength;k++){if(sortedArray[k]===undefined)sortedArray[k]=curSchedules[0]!==undefined?curSchedules.shift():{id:undefined,color:"",background:"",text:"",day:0,work:"",flag:"work"}}}else{for(var i=0,iLength=sortedArray.length;i<iLength;i++){if(!sortedArray[i]&&curSchedules[0]&&(curSchedules[0].day>1||curSchedules[0].allday===true)){sortedArray[i]=curSchedules.shift()}else if(!sortedArray[i]){sortedArray[i]={id:undefined,color:"",background:"",text:"",day:0,work:"",flag:"work"}}}sortedArray=sortedArray.concat(curSchedules);var length=sortedArray.length;while(length--){if(sortedArray[length]===undefined)sortedArray.length--;else break}}this.AllSchedules[drawIndex]=sortedArray}},__updateScheduleInfo:function(drawIndex,dateContent,extraSchedules){var _this=this,dragFn=_this.__dragFn(),scheduleBlocks=dateContent.children;for(var i=0,scheduleLength=scheduleBlocks.length;i<scheduleLength;i++){var schedule=extraSchedules?extraSchedules[i]:this.AllSchedules[drawIndex][i];if(schedule.day>0)scheduleBlocks[i].style.backgroundColor=schedule.background;if(schedule.flag==="event"&&schedule.day===1&&!schedule.allday){scheduleBlocks[i].insertAdjacentHTML("afterbegin",'<div class="top-calendar-schedule-tag"></div>');scheduleBlocks[i].querySelector(".top-calendar-schedule-tag").style.backgroundColor=schedule.color}if(!extraSchedules)if(schedule.work===undefined||schedule.work===""||schedule.work==="end")scheduleBlocks[i].classList.add("end-block");if(schedule.flag==="work"&&(schedule.day==="1"||schedule.day===1)){if(schedule.work==="start"){scheduleBlocks[i].classList.add("start-schedule");scheduleBlocks[i].insertAdjacentHTML("beforeend",'<div class="top-calendar-schedule-start-arrow"></div>');scheduleBlocks[i].querySelector(".top-calendar-schedule-start-arrow").style.borderLeftColor=schedule.background}if(schedule.work==="end"){scheduleBlocks[i].classList.add("end-schedule");scheduleBlocks[i].insertAdjacentHTML("afterbegin",'<div class="top-calendar-schedule-end-arrow"></div>');scheduleBlocks[i].querySelector(".top-calendar-schedule-end-arrow").style.borderRightColor=schedule.background}}if(schedule.flag==="event"&&Top.Util.__isBooleanTrue(schedule.importance)&&(schedule.day<2||schedule.work==="start")){var importanceTag='<span class="top-calendar-schedule-importance">!</span>';scheduleBlocks[i].querySelector(".top-calendar-schedule-text").insertAdjacentHTML("beforebegin",importanceTag)}if(schedule.day<2||schedule.work==="start"||extraSchedules){scheduleBlocks[i].querySelector(".top-calendar-schedule-text").textContent=schedule.flag==="event"&&(!schedule.allday||schedule.allday==="false")?schedule.time[0]+"\t"+schedule.text:schedule.text}if(schedule.id===undefined)scheduleBlocks[i].classList.add("dummy");scheduleBlocks[i].setAttribute("data-start-date",schedule.startDate);scheduleBlocks[i].setAttribute("data-id",schedule.id);scheduleBlocks[i].setAttribute("data-day",schedule.day);scheduleBlocks[i].setAttribute("data-work",schedule.work);scheduleBlocks[i].addEventListener("click",function scheduleClickEvent(e){_this.__userEventHandler(e,this)});scheduleBlocks[i].addEventListener("click",function(e){this.removeEventListener("mousemove",dragFn.dragOnDates)});scheduleBlocks[i].addEventListener("mousedown",function(e){if(e.which===1){e.stopPropagation();this.addEventListener("mousemove",dragFn.dragOnDates);_this.draggingBlock=this}})}},getTopStyle:function(){this.topstyle=this.querySelector(".top-calendar-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-calendar-root");if(key==="width"&&value==="auto")styleNode.style[key]="625px";else if(key==="height"&&value==="auto")styleNode.style[key]="365px";else styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-calendar-root").style.cssText=this.topstyle}};Top.Widget.Calendar=function(){Calendar.prototype=Object.create(Top.Widget.prototype);Calendar.prototype.constructor=Calendar;function Calendar(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-calendar");this.template.innerHTML='<div class="top-calendar-root"></div>'}this.id=this.template.id}Calendar.create=function(element){return new Calendar(element)};Calendar.prototype.updateCalendar=function(selectedYear,selectedMonth,selectedFullDate){this.template.__changeDates(selectedYear,selectedMonth,selectedFullDate)};Calendar.prototype.getRange=function(){return this.template.range};Calendar.prototype.addSchedule=function(drawIndex){this.template.addSchedule(drawIndex)};Calendar.prototype.removeSchedule=function(taskId){this.template.removeSchedule(taskId)};Calendar.prototype.setSchedules=function(array,drawIndex){this.template.__setSchedules(array,drawIndex)};Calendar.prototype.getSchedules=function(){return this.template.AllSchedules};Calendar.prototype.setMemberList=function(array){this.template.memberList=array;this.template.__updateMemberList()};Calendar.prototype.setSharedList=function(array){this.template.sharedList=array;this.template.__updateSharedList()};Calendar.prototype.setCategoryList=function(array){
this.template.categoryList=array;this.template.__updateCategoryList()};Calendar.prototype.endDrag=function(array){var dragBody=this.template.getElementsByClassName("top-calendar-drag-body")[0],dragBody2=this.template.getElementsByClassName("top-calendar-drag-body2")[0];if(dragBody)dragBody.classList.remove("visible");if(dragBody2)dragBody2.classList.remove("visible");this.template.__dragFn().removeDragScheduleBlocks()};Calendar.prototype.getCalendarType=function(array){return this.template.calendarType};return Calendar}();TopChart={is:"top-chart",behaviors:[TopWidgetBehavior],properties:{type:{type:String,value:"line"},title:String,series:Object,option:{type:String,value:null},curSeries:Object,priorData:Array,tickAmount:{type:Number,value:1}},appendTemplate:function(){this.innerHTML='<div class="top-chart"></div>'},expectedTemplateClassName:function(){return"top-chart"},__attached2:function(){this.__initialize();var _this=this;if(Top.App.isLoaded()){if(this.layoutParent===undefined){var p=this.getNotInitializedParentRoot();if(p.__redrawChild===undefined)p.__redrawChild=[];var f=function(){_this.renderChart()};p.__redrawChild.push(f)}else{this.renderChart()}}else{Top.App.onBeforeLoad(function(){if(_this.layoutParent===undefined){var p=_this.getNotInitializedParentRoot();if(p.__redrawChild===undefined)p.__redrawChild=[];var f=function(){_this.renderChart()};p.__redrawChild.push(f)}else{_this.renderChart()}})}},getNotInitializedParentRoot:function(){var parent=this.getParent();while(parent.getParent().__initialized===undefined){parent=parent.getParent()}return parent},__detached:function(){},__initialize:function(){this.chart=null;if(this.layoutWidth==null){this.layoutWidth="100%";this.setTopStyle("width",this.layoutWidth)}if(this.layoutHeight==null){this.layoutHeight="100%";this.setTopStyle("height",this.layoutHeight)}var chartRoot=document.createElement("div");chartRoot.classList.add("top-chart-root");chartRoot.setAttribute("id",this.id);chartRoot.style.height="100%";chartRoot.style.width="100%";this.querySelector(".top-chart").appendChild(chartRoot)},renderChart:function(){var styleScope=this.querySelector(".top-chart-root");var width=styleScope.offsetWidth;var height=styleScope.offsetHeight;if(typeof this.series==="object"&&this.dataModel){this.series=[this.series]}if(typeof this.option==="string"){this.option=Top.Util.namespace(this.option,this)}if(typeof this.series==="string"){this.series=Top.Util.namespace(this.series,this)}if(typeof this.series==="object"){var series=top$.extend(true,[],this.series)}if(!series||series.length<1){}else{this.curSeries=series.slice();this.priorData=[];for(var i=0;i<this.curSeries.length;i++){this.priorData[i]=[];for(var j=0;j<this.tickAmount;j++){this.priorData[i][j]=null}if(this.curSeries[i].data.constructor===Array){if(this.curSeries[i].data.length<this.tickAmount){var arrayIndex=0;for(var e=this.tickAmount-this.curSeries[i].data.length;e<this.tickAmount;e++){this.priorData[i][e]=this.curSeries[i].data[arrayIndex];arrayIndex++}this.curSeries[i].data=this.priorData[i]}else{this.priorData[i]=this.curSeries[i].data}}}}var default_option={chart:{type:this.type,width:width,height:height},title:{text:this.title},series:series};if(this.option!=null){this.__mergeOption(default_option,this.option)}if(!this.querySelector("#"+this.id+".top-chart-root"))this.__initialize();this.chart=top$(this.querySelector("#"+this.id+".top-chart-root")).topcharts(default_option)},__mergeOption:function(base,extend){for(var key in extend){if(typeof extend[key]==="object"&&!Array.isArray(extend[key])){if(!base[key]){base[key]={}}this.__mergeOption(base[key],extend[key])}else{base[key]=extend[key]}}},__updateSeries:function(){if(this.chart&&this.series&&this.curSeries){if(typeof this.series=="string"){var newSeries=Top.Util.namespace(this.series,this)}else if(typeof this.series=="object"){var newSeries=this.series}var chart=this.chart;var seriesLen=this.curSeries.length;var newSeriesLen=newSeries.length;if(seriesLen>0&&seriesLen==newSeriesLen){for(var i=0;i<seriesLen;i++){var dataLen=0;var newDataLen=newSeries[i].data.length;if(this.priorData[i].constructor===Array){dataLen=this.priorData[i].length}chart.updateSeries(i,newSeries[i],true);this.curSeries[i]=Object.assign(newSeries[i]);this.priorData[i]=this.curSeries[i].data}}else if(seriesLen<newSeriesLen){var isRedraw=false;for(var i=seriesLen;i<newSeriesLen;i++){if(i===newSeriesLen-1){isRedraw=true}chart.addSeries(newSeries[i],isRedraw)}}else if(seriesLen>newSeriesLen){}}else if(this.series&&!this.curSeries){var chart=this.chart,newSeries=this.series,newSeriesLen=newSeries.length,isRedraw=false;this.priorData=[];for(var i=0;i<newSeriesLen;i++){if(i===newSeriesLen-1){isRedraw=true}chart.addSeries(newSeries[i],isRedraw);this.priorData.push(newSeries[i].data)}this.curSeries=Object.assign(newSeries)}else{this.renderChart()}},__updateOption:function(){if(typeof this.option==="string"){this.option=Top.Util.namespace(this.option,this)}if(this.chart)this.chart.setOption(this.option)},__updateVisible:function(){if(this.chart)this.chart.flush()},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("div");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle}};Top.Widget.Chart=function(){Chart.prototype=Object.create(Top.Widget.prototype);Chart.prototype.constructor=Chart;function Chart(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-chart");this.template.innerHTML='<div class="top-chart"></div>'}this.id=this.template.id}Chart.create=function(element){return new Chart(element)};Chart.prototype.topcharts=function(){return this.template.chart};return Chart}();TopCheckbox={is:"top-checkbox",behaviors:[TopWidgetBehavior,TopCheckBehavior,TopChecktypeBehavior],properties:{text:{type:String,reflectToAttribute:true},tabIndex:{type:String,value:"0"}},getEventElement:function(){return this.querySelector("label")},__ready:function(){this.__initI18n("text");this.__initialize()},appendTemplate:function(){this.innerHTML='<input class="top-checkbox-check" type="checkbox" id="checkbox" size="width:300px;"><label class="top-checkbox-text" for="checkbox"><span></span></label>'},expectedTemplateClassName:function(){return"top-checkbox-check"},__initialize:function(){this.__initTrueFalseValue();this.__initChecked();this.__updateDisabled();this.__updateText();this.__updateGroupId();this.__updateChecked();this.__updateCheckPosition();this.__initBindingEvent();this.__updateTabIndex()},__updateTabIndex:function(){this.querySelector("input").setAttribute("tabindex",this.tabIndex)},__attached2:function(){this.__updateVerticalAlignment()},__eventBindingList:function(){var shadowInput=this.querySelector("input");var shadowLabel=this.querySelector("label");return{__eventMouseClick:function(func){shadowInput.onclick=func},__eventMousePressed:function(func){shadowInput.onmousedown=func},__eventMouseReleased:function(func){shadowInput.onmouseup=func},__eventMouseDblclick:function(func){shadowInput.ondblclick=func},__eventKeyPressed:function(func){shadowInput.onkeydown=func},__eventKeyTyped:function(func){shadowInput.onkeypress=func},__eventKeyReleased:function(func){shadowInput.onkeyup=func},__eventFocused:function(func){shadowInput.onfocus=func},__eventLostFocused:function(func){shadowInput.onblur=func},__eventMouseEnter:function(func){shadowLabel.onmouseenter=func},__eventMouseExit:function(func){shadowLabel.onmouseleave=func},__eventMouseMove:function(func){shadowLabel.onmousemove=func},__eventSecondaryClick:function(func){shadowLabel.oncontextmenu=func}}},__updateDisabled:function(){var shadowInput=this.querySelector("input");var shadowLabel=this.querySelector("label");var disabled=this.calculateDerivedDisabled();var dataFieldRegExp=new RegExp("({[\\w.]+})","g");if(String(disabled).match(dataFieldRegExp)){return}this.__setDisabled(shadowInput);this.__setDisabled(shadowLabel);if(disabled==="true"||disabled===true){shadowLabel.classList.add("disabled");this.__detachBindingEvent()}else if(disabled==="false"||disabled===false){shadowLabel.classList.remove("disabled");this.__initBindingEvent()}},__updateText:function(){var shadowText=this.querySelector("label");var shadowInput=this.querySelector("input");this.text=this.__i18n(this.text);if(this.text||this.text===""||this.text===0){if(shadowText&&shadowInput){if(shadowText.getElementsByTagName("span")[0]){shadowText.getElementsByTagName("span")[0].innerHTML=this.text;shadowInput.value=this.text}else{var span=document.createElement("span");shadowText.appendChild(span);shadowText.getElementsByTagName("span")[0].innerHTML=this.text;shadowInput.value=this.text}}}},__updateGroupId:function(){if(this.groupId){var shadowInput=this.querySelector("input");shadowInput.name=this.groupId}},__initBindingEvent:function(){var _this=this;var shadowLabel=this.querySelector("label");if(this.labelClickEvent===undefined){this.labelClickEvent=function(e){_this.toggle()}}shadowLabel.removeEventListener("click",this.labelClickEvent);shadowLabel.addEventListener("click",this.labelClickEvent)},__detachBindingEvent:function(){var shadowLabel=this.querySelector("label");shadowLabel.removeEventListener("click",this.labelClickEvent)},__updateCheckPosition:function(){var shadowLabel=this.querySelector(".top-checkbox-text");if(this.checkPosition==="right"){shadowLabel.classList.remove("left");shadowLabel.classList.add("right");if(!shadowLabel.innerHTML.includes("<i class="))shadowLabel.insertAdjacentHTML("beforeend",'<i class="top-checkbox-icon"></i>')}else{shadowLabel.classList.remove("right");shadowLabel.classList.add("left");if(!shadowLabel.innerHTML.includes("<i class="))shadowLabel.insertAdjacentHTML("afterbegin",'<i class="top-checkbox-icon"></i>')}if(this.layoutWidth=="auto"||this.layoutWidth==""||this.layoutWidth=="wrap_content"){if(!this.paddingRight)shadowLabel.style.paddingRight=shadowLabel.querySelector("span").offsetWidth/5+"px"}},toggle:function(){if(this.__isCheckedTrue()){this.checked=this.falseValue}else{this.checked=this.trueValue}this.__updateChecked()},__updateChecked:function(dataBound){var shadowInput=this.querySelector("input");var shadowLabel=this.querySelector("label");if(this.__isCheckedTrue()){shadowInput.checked=true;shadowLabel.classList.add("checked")}else{shadowInput.checked=false;shadowLabel.classList.remove("checked")}if(dataBound!==true){this.updateData("checked");this.updateDevice("checked")}if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("change"),this.checked)}else{this.__dispatchEvent(new Event("change"),this.checked)}},__updateVisibleInternal:function(){var shadowInput=this.querySelector("input");if(this.visible=="none"){shadowInput.style.display="none"}else{shadowInput.style.display="inline-block"}},focus:function(){this.querySelector(".top-checkbox-text").classList.add("focus");this.querySelector(".top-checkbox-check").focus()},blur:function(){this.querySelector(".top-checkbox-text").classList.remove("focus");this.querySelector(".top-checkbox-check").blur()},getTopStyle:function(){this.topstyle=this.querySelector(".top-checkbox-text").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var text=this.querySelector(".top-checkbox-text");if(value==="bold"||value==="italic"||value==="underline"){if(!text.getElementsByTagName("span")[0])this.__updateText();text=text.getElementsByTagName("span")[0]}text.style[key]=value;this.topstyle=text.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-checkbox-text").style.cssText=this.topstyle}};Top.Widget.Checkbox=function(){Checkbox.prototype=Object.create(Top.Widget.prototype);Checkbox.prototype.constructor=Checkbox;function Checkbox(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-checkbox");this.template.innerHTML='<input class="top-checkbox-check" type="checkbox" id="checkbox" size="width:300px;"><label class="top-checkbox-text" for="checkbox"><span></span></label>'}this.id=this.template.id}Checkbox.create=function(element){return new Checkbox(element)};Checkbox.prototype.isChecked=function(){return this.template.isChecked()};Checkbox.prototype.getWidth=function(){return this.template.querySelector(".top-checkbox-text").offsetWidth};Checkbox.prototype.getHeight=function(){return this.template.querySelector(".top-checkbox-text").offsetHeight};Checkbox.prototype.trigger=function(event){var _event;if(typeof Event==="function"){_event=new Event(event)}else{_event=document.createEvent("Event");_event.initEvent(event,true,true)}if(event=="click")this.template.labelClickEvent(_event);else this.template.__dispatchEvent(_event)};Checkbox.prototype.getState=function(){return this.template.checked};return Checkbox}();TopChip={is:"top-chip",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{visible:String,maxLength:Number,readonly:String,icon:String,onIconclick:String,clear:String,chipItems:String,onAdd:String,keyCode:String,emptyMessage:String,onClose:String},__ready:function(){this.__updateAttribute();this.__updateId();this.__updateAutoComplete();this.__updateDisabled();this.__updateMaxLength();this.__updateVisible();this.__updateIcon();this.__updateClear();this.__updateReadonly();this.__initBindingEvent();this.__initialClassname();this.__initI18n("hint");this.__updateChip();this.__updateEmptyMessage()},appendTemplate:function(){this.innerHTML='<div class="top-chip-root"><form autocomplete="off" onsubmit="return false;"><div class="empty-message-container"></div><input class="top-chip-text" type="text"><span class="top-chip-icon"></span></form></div>'},__attached2:function(){},__updateId:function(){if(this.id){var input=this.querySelector("input");input.id=this.id}},__updateChip:function(){var _this=this;Top.App.onWidgetAttach(this.id,function(){_this.__createChip();_this.__renderChip()})},__updateChipItems:function(){if(this.__initialized===true){this.__clearChip();this.__renderChip()}},__updateAttribute:function(){this.onClose=this.onClose&&typeof this.onClose==="string"?Top.Util.namespace(this.onClose,this):this.onClose;this.onAdd=this.onAdd&&typeof this.onAdd==="string"?Top.Util.namespace(this.onAdd,this):this.onAdd;this.chipItems=this.chipItems&&typeof this.chipItems==="string"?Top.Util.namespace(this.chipItems,this):this.chipItems;this.chipItems=this.chipItems||[];this.onIconclick=this.onIconclick&&typeof this.onIconclick==="string"?Top.Util.namespace(this.onIconclick,this):this.onIconclick;this.emptyMessage=this.emptyMessage||""},__findIndexChip:function(text){this.chipItems=this.chipItems&&typeof this.chipItems==="string"?Top.Util.namespace(this.chipItems,this):this.chipItems;if(!this.chipItems){return-1}for(var i=0;i<this.chipItems.length;i++){if(this.chipItems[i].text==text){return i}}return-1},__updateOnClose:function(){var _this=this;var closeBtn=_this.querySelectorAll(".top-chip-close");top$(this).find(".top-chip-close").off("click").on("click",function(e){var data;var parentText=this.parentNode.innerText;var chipIdx=_this.__findIndexChip(parentText);if(chipIdx<0){return}data=_this.chipItems[chipIdx];_this.chipItems.splice(chipIdx,1);_this.onClose(e.originalEvent,_this,data);this.parentNode.parentNode.remove()})},__createChip:function(){if(this.keyCode!==undefined)this.keyCode=this.keyCode.replace("{","").replace("[","").replace("}","").replace("]","").replace(" ","").split(",");var inputClassName="";var _this=this;var shadowInput=this.querySelector(".top-chip-root").querySelector(".top-chip-text");if((_this.isOpenAutoComplete()===false||_this.isOpenAutoComplete()===null)&&!this.keyCode){this.keyCode=[13,32]}top$(shadowInput).on("keydown",function(e){if(!_this.keyCode.includes(e.which)){return}var chipIdx=_this.__findIndexChip(shadowInput.value);if(chipIdx>=0){return}if(_this.isOpenAutoComplete()&&!isSelectedAutoCompleteItem()){return false}var detail=_this.__refineAddItem(e,shadowInput);if(shadowInput.value!="")_this.__addChip(detail);_this.chipItems.push(detail);shadowInput.value="";_this.__displayEmptyMessage()});top$(shadowInput).on("keyup",function(){_this.__resizeInputWidth()});if(this.backspace==="true"||this.backspace===true)top$(shadowInput).off("keydown",__setOnBackspace).on("keydown",__setOnBackspace);return inputClassName;function __setOnBackspace(){if(event.keyCode==8&&this.value==""){var data;var lastChip=_this.chipItems[_this.chipItems.length-1];var chipIdx=_this.__findIndexChip(lastChip.text);if(chipIdx<0){return}data=_this.chipItems[chipIdx];_this.chipItems.splice(chipIdx,1);if(typeof _this.onClose==="function"){_this.onClose(e.originalEvent,_this,data)}this.previousSibling.remove()}}function isSelectedAutoCompleteItem(){var menu=document.querySelector(".dropdown-menu."+_this.id);if(!menu){return false}var childrenList=menu.children;for(var i=0;i<childrenList.length;i++){if(childrenList[i].classList.contains("active")){return false}}return true}},__refineAddItem:function(event,shadowInput){var detail=null;if(typeof this.onAdd==="function"){detail=this.onAdd(event,shadowInput.value,this.chipItems)}detail=detail||{text:shadowInput.value,value:null,icon:null};return detail},__resizeInputWidth:function(){var input=this.querySelector(".top-chip-text");if(input.value!==""&&input.getAttribute("size")<input.value.length){input.setAttribute("size",input.value.length)}},__addChip:function(chipItem){var _this=this;var chip;var dragStr=this.draggable==="true"||this.draggable===true?"draggable='true'":"";var iconStr=chipItem.icon?"<i class='top-chip-icon "+chipItem.icon+"'></i>":"";var textStr=chipItem.text?chipItem.text:chipItem.value;var shadowInput=this.querySelector(".top-chip-root").querySelector(".top-chip-text");chip=document.createElement("div");chip.classList.add("top-chip-box");if(this.draggable==="true"||this.draggable===true){chip.setAttribute("draggable","true")}var chipContent=document.createElement("div");chipContent.classList.add("top-chip-content");if(chipItem.icon){var chipIcon=document.createElement("i");chipIcon.classList.add("top-chip-icon");chipIcon.classList.add(chipItem.icon);chipContent.appendChild(chipIcon)}var chipText=document.createElement("span");chipText.innerText=chipItem.text?chipItem.text:chipItem.value;chipContent.appendChild(chipText);var chipClose=document.createElement("i");chipClose.classList.add("top-chip-close");chipContent.appendChild(chipClose);chip.appendChild(chipContent);__setOnClickDetail(chip);__setOnClose(chip);if(chipItem.edit||chipItem.edit!=="false"){__setOnEditItem(chip)}if(this.draggable==="true"||this.draggable===true){__setOnDragItem(chip)}shadowInput.insertAdjacentElement("beforebegin",chip);function __setOnClickDetail(chipBox){top$(chipBox).on("click",function(e){_this.removeEventListener("chipclick",__clickCallback,true);__clickCallback(e,chipBox)});function __clickCallback(e,chipBox){var text=chipBox.querySelector(".top-chip-content").textContent;var chipIdx=_this.__findIndexChip(text);_this.__dispatchEvent(new CustomEvent("chipclick",{detail:_this.chipItems[chipIdx]}))}}function __setOnClose(chip){var closeBtn=chip.querySelectorAll(".top-chip-close");top$(closeBtn).off("click").on("click",function(e){var data;var parentText=this.parentNode.innerText;var chipIdx=_this.__findIndexChip(parentText);if(chipIdx<0){return}data=_this.chipItems[chipIdx];_this.chipItems.splice(chipIdx,1);if(typeof _this.onClose==="function"){_this.onClose(e.originalEvent,_this,data)}this.parentNode.parentNode.remove();_this.__displayEmptyMessage()})}function __setOnEditItem(chipBox){var chipProp=_this.editProperties||undefined;var editTag=chipBox.edit||"textfield";top$(chipBox).on("dblclick",function(e){var newEditWidget;var thisText=chipBox.innerText;switch(editTag){case"selectbox":{newEditWidget=Top.Widget.create("top-selectbox");top$(chipBox).after(newEditWidget.template);newEditWidget.setProperties({"selected-text":thisText});break}case"textfield":{newEditWidget=Top.Widget.create("top-textfield");top$(chipBox).after(newEditWidget.template);newEditWidget.setText(thisText);break}default:{newEditWidget=eval("Top.Widget.create('top-"+editType+"')");top$(chipBox).after(newEditWidget.template)}}newEditWidget.template.childNodes[0].style.width=chipBox.offsetWidth+"px";newEditWidget.template.childNodes[0].style.height=chipBox.offsetHeight+"px";newEditWidget.template.childNodes[0].style.float="left";if(chipProp){newEditWidget.setProperties(chipProp)}top$(chipBox).hide();top$(newEditWidget).focus();if(editTag==="selectbox")newEditWidget.open();top$(newEditWidget).on("blur close change select",function(e){var textContentValue="";if(this.template.tagName==="TOP-TEXTFIELD"){if(!(e.type==="blur"||e.keyCode===13))return;textContentValue=this.template.text}else if(this.template.tagName==="TOP-TEXTAREA"){if(!(e.type==="blur"))return;textContentValue=this.template.text}else if(this.template.tagName==="TOP-SELECTBOX"){if(!(e.type==="change"||e.type==="close"))return;textContentValue=this.template.selectedText}else if(this.template.tagName==="TOP-DATEPICKER"){if(e.type!=="select")return;textContentValue=this.template.date}if(this.tagName==="TOP-TEXTFIELD"){if(typeof this.validation==="function"){if(!this.validation())return}}for(var k=0;k<_this.chipItems.length;k++){if(chipText.innerText===_this.chipItems[k].text){_this.chipItems[k].text=textContentValue;break}}chipText.innerText=textContentValue;top$("#"+e.target.id).remove();top$(chipBox).show()})})}function __setOnDragItem(chip){var lock=false;top$(chip).on("dragstart",function(e){lock=false;this.ondragend=_destroy;this.ondrag=top$.throttle(300,_renderghost);selected=this;function _renderghost(e){if(lock===true)return;if(document.querySelector(".top-chip-dropline")!==null){var dropLines=document.querySelectorAll(".top-chip-dropline");for(var j=0;j<dropLines.length;j++){top$(dropLines[j]).remove()}}var right=document.querySelector(".over_right");var left=document.querySelector(".over_left");if(right!==null){right.insertAdjacentElement("afterend",_createDropline())}else if(left!==null){left.insertAdjacentElement("beforebegin",_createDropline())}else{shadowInput.insertAdjacentElement("beforebegin",_createDropline())}}function _destroy(e){var dropLine=document.querySelector(".top-chip-dropline");dropLine.insertAdjacentElement("afterend",this);top$(dropLine).remove();lock=true}});top$(chip).on("dragover",function(e){if(e.originalEvent.preventDefault){e.originalEvent.preventDefault()}e.originalEvent.dataTransfer.dropEffect="move";var targetNode=changeTarget(e.target);if(e.originalEvent.offsetX<top$(targetNode).width()/2){targetNode.classList.remove("over_right");targetNode.classList.add("over_left")}else{targetNode.classList.remove("over_left");targetNode.classList.add("over_right")}e.stopPropagation()});top$(chip).on("dragleave",function(e){e.stopPropagation();var targetNode=changeTarget(e.target);targetNode.classList.remove("over_left");targetNode.classList.remove("over_right")});function changeTarget(widget){if(widget.tagName!=="DIV"){return widget.parentNode.parentNode}else if(widget.classList.value==="top-chip-content"){return widget.parentNode}else{return widget}}function _createDropline(){var tmp_dropline=document.createElement("span");tmp_dropline.classList.add("top-chip-dropline");return tmp_dropline}}},__renderChip:function(){if(!this.chipItems){return}this.querySelector(".top-chip-root").querySelector(".top-chip-text").style.display=this.disabled===true||this.disabled==="true"?"none":"";for(var i=0;i<this.chipItems.length;i++){this.__addChip(this.chipItems[i])}this.__displayEmptyMessage()},__clearChip:function(){var chips=this.querySelectorAll(".top-chip-box");for(var i=0,len=chips.length;i<len;i++){chips[i].remove()}this.__displayEmptyMessage()},__initBindingEvent:function(){var _this=this;this.__addEventFnByCore("eventKeyReleased",function(){_this.updateData("text");_this.updateDevice("text")});this.__addEventFnByCore("eventLostFocused",function(){_this.updateData("text");_this.updateDevice("text")})},__updateDisabled:function(){var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");var disabled=this.calculateDerivedDisabled();this.__setDisabled(shadowInput);if(disabled==="true"||disabled===true){this.classList.add("disabled")}else if(disabled==="false"||disabled===false){this.classList.remove("disabled")}},__updateMaxLength:function(){var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");if(this.maxLength!=null)top$(shadowInput).attr("maxlength",this.maxLength)},__updateReadonly:function(){var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");if(this.readonly=="true"||this.readonly==true){shadowInput.setAttribute("readonly","")}else{shadowInput.removeAttribute("readonly")}},__updateVisible:function(){if(this.visible!=="none"){if(this.title)this.setTitlePosition()}var checkVisibility=/visibility:[a-z]+;/g;var checkDisplay=/display:[a-z-]+;/g;var temp=this.topstyle;temp=temp.replace(checkVisibility,"");temp=temp.replace(checkDisplay,"");this.topstyle=temp;if(this.display!=="none")this.prevDisplay=this.display;if(this.visible=="none"){this.display="none"}else if(this.visible==="visible"&&this.display==="none"){this.display=this.prevDisplay}if(this.display==null){this.display="inline-block"}this.setTopStyle("visibility",this.visible);this.setTopStyle("display",this.display);if(this.borderWidth!==undefined){var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");shadowInput.style.borderWidth=this.borderWidth}},__updateIcon:function(){var _this=this;var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");var shadowIcon=this.querySelector(".top-chip-root").querySelector("div span");if(this.icon!==null&&this.icon!==""&&this.icon!==undefined){shadowIcon.classList.add(this.icon);Top.App.onWidgetAttach(this.id,function(){var fontSize=top$(shadowInput).css("font-size");var inputHeight=shadowInput.offsetHeight;shadowIcon.style.lineHeight=inputHeight+"px";shadowIcon.style.display="inline"});if(this.onIconclick){shadowIcon.style.cursor="pointer";top$(shadowIcon).off("click").on("click",function(e){_this.onIconclick(e,Top.Dom.selectById(_this.id))})}}},__updateClear:function(){var shadowForm=this.querySelector(".top-chip-root").querySelector("div form");var shadowInput=this.querySelector(".top-chip-root").querySelector("div input");var shadowIcon=this.querySelector(".top-chip-root").querySelector("div .top-chip-icon");var _this=this;if(this.clear===true||this.clear==="true"){top$(shadowForm).append('<button class="top-chip-clear" type="reset"></button>');Top.App.onWidgetAttach(this.id,function(){var inputHeight=shadowInput.offsetHeight;var shadowClear=shadowForm.querySelector(".top-chip-clear");shadowClear.style.lineHeight=inputHeight+"px";if(shadowIcon&&shadowIcon.style.display!=="none"){shadowClear.style.right="30px"}})}},__displayEmptyMessage:function(){var emptyContainer=this.querySelector(".empty-message-container");var display=this.chipItems.length==0?"inline-block":"none";emptyContainer.style.display=display},__updateEmptyMessage:function(){var emptyContainer=this.querySelector(".empty-message-container");emptyContainer.innerHTML=this.emptyMessage},focus:function(){this.querySelector(".top-chip-root").querySelector(".top-chip-text").focus()},blur:function(){this.querySelector(".top-chip-root").querySelector(".top-chip-text").blur()},getTopStyle:function(){this.topstyle=this.querySelector(".top-chip-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-chip-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-chip-root").style.cssText=this.topstyle}};Top.Widget.Chip=function(){Chip.prototype=Object.create(Top.Widget.prototype);Chip.prototype.constructor=Chip;function Chip(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-chip");this.template.innerHTML='<div class="top-chip-root"><form autocomplete="off" onsubmit="return false;"><input class="top-chip-text" type="text"><span class="top-chip-icon"></span></form></div>'}this.id=this.template.id}Chip.create=function(obj){return new Chip(obj)};Chip.prototype.template=null;Chip.prototype.is="top-chip";Chip.prototype.openAutoComplete=function(){this.template.openAutoComplete()};Chip.prototype.closeAutoComplete=function(){this.template.closeAutoComplete()};Chip.prototype.sync=function(){this.template.__clearChip();this.template.__updateChip()};Chip.prototype.addChip=function(value){var shadowInput=this.template.querySelector(".top-chip-root").querySelector(".top-chip-text");if(!value||!value.text||value.text.length===0){return}if(typeof value==="string"){value={text:value}}this.template.__refineAddItem(value.event,shadowInput);this.template.__addChip(value);this.template.chipItems.push(value);this.template.querySelector(".top-chip-root").querySelector(".top-chip-text").value="";this.template.__displayEmptyMessage()};return Chip}();TopCodeEditor={is:"top-codeeditor",behaviors:[TopWidgetBehavior],properties:{text:String,lineNumber:{type:Boolean,value:false},firstLineNumber:{type:Number,value:1},lineWrapping:{type:Boolean,value:false},mode:{type:String,value:"javascript"},customizedMode:String,autocomplete:{type:Boolean,value:false},readOnly:{type:Boolean,value:false},onChange:String,tabIndex:{type:String,value:"0"},theme:{type:String,value:"default"}},__ready:function(){this.__updateId();this.renderLayout();this.__initBindingEvent();this.__updateText();this.__updateTabIndex();this.__updateLineNumber()},appendTemplate:function(){this.innerHTML='<div class="top-codeeditor-root"></div>'},__attached2:function(){},initializeChildRoot:function(){return this.querySelector(".top-codeeditor-root")},renderLayout:function(){this.customizedMode=typeof this.customizedMode==="string"?Top.Util.namespace(this.customizedMode,this):this.customizedMode;this.lineNumber=Top.Util.__isBooleanTrue(this.lineNumber);this.lineWrapping=Top.Util.__isBooleanTrue(this.lineWrapping);this.readOnly=Top.Util.__isBooleanTrue(this.readOnly);var extraKeyMap=this.autocomplete===true||this.autocomplete==="true"?{"Ctrl-Space":"autocomplete"}:null;var mode=typeof this.customizedMode==="object"||typeof this.customizedMode==="string"&&this.customizedMode!==""?this.customizedMode:this.mode;this.codemirror=CodeMirror(this.childRoot,{mode:mode,lineNumbers:this.lineNumber,firstLineNumber:this.firstLineNumber,lineWrapping:this.lineWrapping,extraKeys:extraKeyMap,readOnly:this.readOnly,theme:this.theme})},__initBindingEvent:function(){var _this=this;this.codemirror.doc.on("change",function(Doc,changedInfo){_this.text=Doc.getValue();_this.setAttribute("text",_this.text);_this.updateData("text");_this.updateDevice("text");if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("change"),changedInfo)}else{_this.__dispatchEvent(new Event("change"),changedInfo)}})},__initEventInternal:function(){this.__addEventByAttr("change")},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-codeeditor-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){
shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateText:function(){this.__initI18n("text");if(typeof this.text==="string"){this.codemirror.setValue(this.text)}},__updateLineNumber:function(){this.codemirror.setOption("lineNumbers",this.lineNumber);if(this.lineNumber=="true"||this.lineNumber==true){this.querySelector(".CodeMirror-sizer").classList.add("lineNumber")}else{this.querySelector(".CodeMirror-sizer").classList.remove("lineNumber")}},__updateFirstLineNumber:function(){this.codemirror.setOption("firstLineNumber",this.firstLineNumber)},__updateLineWrapping:function(){this.codemirror.setOption("lineWrapping",this.lineWrapping)},__updateMode:function(){this.codemirror.setOption("mode",this.mode)},__updateCustomizedMode:function(){this.codemirror.setOption("mode",this.customizedMode)},__updateAutocomplete:function(){var extraKeyMap=this.autocomplete===true||this.autocomplete==="true"?{"Ctrl-Space":"autocomplete"}:null;this.codemirror.setOption("extraKeys",extraKeyMap)},__updateReadOnly:function(){this.codemirror.setOption("readOnly",this.readOnly)},__updateOnChange:function(){this.__addEventByAttr("change")},__updateTabIndex:function(){if(this.querySelector("textarea"))this.querySelector("textarea").setAttribute("tabindex",this.tabIndex)},__updateTheme:function(){this.codemirror.setOption("theme",this.theme)},getTopStyle:function(){this.topstyle=this.childRoot.style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.childRoot.style[key]=value;this.topstyle=this.childRoot.style.cssText}},setAllTopStyle:function(){this.childRoot.style.cssText=this.topstyle}};Top.Widget.Codeeditor=function(){Codeeditor.prototype=Object.create(Top.Widget.prototype);Codeeditor.prototype.constructor=Codeeditor;function Codeeditor(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-codeeditor");this.template.innerHTML='<div class="top-codeeditor-root"></div>'}this.id=this.template.id}Codeeditor.create=function(element){return new Codeeditor(element)};Codeeditor.prototype.jumpToLine=function(lineNumber){var cursorTop=15.33*(lineNumber-this.template.firstLineNumber);this.template.codemirror.display.scroller.scrollTop=cursorTop};return Codeeditor}();TopColorpicker={is:"top-colorpicker",behaviors:[TopWidgetBehavior],properties:{hex:{type:String,reflectToAttribute:true},rgb:{r:String,g:String,b:String},rgba:{r:String,g:String,b:String,a:1},hsv:{h:String,s:String,v:String},onSelect:String},__ready:function(){this.__shadowingChildren();this.__initialize()},appendTemplate:function(){this.innerHTML='<button class="top-colorpicker-button" type="button"></button><div class = "top-colorpicker-popup"><canvas class = "top-colorpicker-canvas" width = "480" height = "320"></canvas><div class = "top-colorpicker-aim"></div><div><div class="top-colorpicker-container"><div class = "top-colorpicker-preview"></div><span>R: </span><input type = "text" class = "top-colorpicker-r"></input><span>G: </span><input type = "text" class = "top-colorpicker-g"></input><span>B: </span><input type = "text" class = "top-colorpicker-b"></input><span>H: </span><input type = "text" class = "top-colorpicker-h"></input><span>S: </span><input type = "text" class = "top-colorpicker-s"></input><span>V: </span><input type = "text" class = "top-colorpicker-v"></input><span>#: </span><input type = "text" class = "top-colorpicker-hex"></input></div><div class="top-colorpicker-container"><button class = "top-colorpicker-ok" type = "button"> OK </button><button class = "top-colorpicker-cancel" type = "button"> Cancel </button><div class="top-colorpicker-container-trans"><span class="top-colorpicker-span top-colorpicker-t">T:</span><div class="top-colorpicker-transparency"></div><span class="top-colorpicker-span top-colorpicker-t">A:</span><input class="top-colorpicker-a"></div></div></div></div>'},expectedTemplateClassName:function(){return"top-colorpicker-button"},__initEventInternal:function(){this.__addEventByAttr("select")},__updateId:function(){if(this.id){this.shadowBtn.id=this.id}},__initialize:function(){if(!this.rgb&&!this.hsv&&!this.hex&&!this.rgba)this.rgb={r:255,g:255,b:255};if(!this.isColorUpdated&&this.rgb)this.__updateRgb();if(!this.isColorUpdated&&this.hsv)this.__updateHsv();if(!this.isColorUpdated&&this.hex)this.__updateHex();if(!this.isColorUpdated&&this.rgba)this.__updateRgba();if(this.alpha)this.__updateAlpha();this.__loadImage();this.__addTransparency();this.__addCanvasEvent();this.__addRgbEvent();this.__addHsvEvent();this.__addHexEvent();this.__addBtnEvent();this.__addAEvent();this.__updateId();this.__updateDisabled()},__convertColorStringToObject:function(){if(typeof this.rgb==="string"||typeof this.hsv==="string"||typeof this.rgba==="string"){var colorObject=typeof this.rgb==="string"?this.rgb:typeof this.hsv==="string"?this.hsv:this.rgba;if(colorObject.includes("(")&&colorObject.includes(")")){var arr=colorObject.split(",");arr[0]=arr[0].replace(/[a-z(]/g,"");arr[3]=arr[3].replace(/[)]/g,"");colorObject={r:arr[0],g:arr[1],b:arr[2],a:arr[3]}}else{colorObject=Top.Util.namespace(colorObject)}if(!colorObject){var colorTexts=typeof this.rgb==="string"?this.rgb.split(","):typeof this.hsv==="string"?this.hsv.split(","):this.rgba.split(",");var rgb_hsv_rgba=[],numbers=[];var beforeObject="{";colorTexts.forEach(function(value){rgb_hsv_rgba.push(value.match(/r|g|b|h|s|v|a/i)[0]);numbers.push(value.match(/0?\.?\d+/i)[0])});for(var i=0;i<rgb_hsv_rgba.length;i++){beforeObject+='"'+rgb_hsv_rgba[i]+'":"'+numbers[i]+'",'}beforeObject=beforeObject.slice(0,-1);beforeObject+="}";colorObject=JSON.parse(beforeObject)}typeof this.rgb==="string"?this.rgb=colorObject:typeof this.hsv==="string"?this.hsv=colorObject:this.rgba=colorObject}},__loadImage:function(){var img=new Image;var canvasContext=this.canvasContext;img.src=Top.libsPath+"css/images/colorpicker.png";top$(img).load(function(){canvasContext.drawImage(img,0,0)})},__updateColorValues:function(){if(!Top.Util.__isBooleanTrue(this.disabled))this.shadowBtn.style.backgroundColor=this.__getRgbaString();this.__updateHexValue();this.__updateHSVValue();this.__updateRGBValue();this.__updateAValue();this.__updatePreview()},__updateAValue:function(){this.rgba.a=Math.max(0,Math.min(1,this.rgba.a));this.shadowA.value=this.rgba.a},__updateHexValue:function(){this.shadowHex.value=this.hex},__updateHSVValue:function(){var i,j=0;var keys=Object.keys(this.hsv);for(i=0;i<3;i++){this.hsvArray[j].value=this.hsv?this.hsv[keys[i]]:0;j++}},__updateRGBValue:function(){var i,j=0;var keys=Object.keys(this.rgb);for(i=0;i<3;i++){this.rgbArray[j].value=this.rgb?this.rgb[keys[i]]:0;j++}},__updatePreview:function(){var rgba=this.__getRgbaString();this.shadowPreview.style.backgroundColor=rgba},__getRgbaString:function(){return"rgba("+this.rgba.r+","+this.rgba.g+","+this.rgba.b+","+this.rgba.a+")"},__shadowingChildren:function(){this.shadowBtn=this.querySelector(".top-colorpicker-button");this.shadowCanvas=this.querySelector(".top-colorpicker-canvas");this.canvasContext=this.shadowCanvas.getContext("2d");this.shadowR=this.querySelector(".top-colorpicker-r");this.shadowG=this.querySelector(".top-colorpicker-g");this.shadowB=this.querySelector(".top-colorpicker-b");this.shadowH=this.querySelector(".top-colorpicker-h");this.shadowS=this.querySelector(".top-colorpicker-s");this.shadowV=this.querySelector(".top-colorpicker-v");this.shadowHex=this.querySelector(".top-colorpicker-hex");this.shadowAim=this.querySelector(".top-colorpicker-aim");this.shadowPreview=this.querySelector(".top-colorpicker-preview");this.shadowA=this.querySelector(".top-colorpicker-a");if(!this.shadowA){this.__appendTransContainer()}this.isColorUpdated=false;this.rgbArray=[this.shadowR,this.shadowG,this.shadowB];this.hsvArray=[this.shadowH,this.shadowS,this.shadowV]},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-colorpicker-button");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateDisabled:function(){var shadowInput=this.getElementsByTagName("button")[0];this.__setDisabled(shadowInput)},__appendTransContainer:function(){var cancelBtn=this.querySelector(".top-colorpicker-cancel");var transContainerHTML='<div class="top-colorpicker-container-trans"><span class="top-colorpicker-span top-colorpicker-t">T:</span>'+'<div class="top-colorpicker-transparency"></div><span class="top-colorpicker-span top-colorpicker-t">A:</span>'+'<input class="top-colorpicker-a"></div>';cancelBtn.insertAdjacentHTML("afterend",transContainerHTML);this.shadowA=this.querySelector(".top-colorpicker-a")},__addBtnEvent:function(){var _this=this;var shadowPopup=this.querySelector(".top-colorpicker-popup");var shadowOk=this.querySelector(".top-colorpicker-ok");var shadowCancel=this.querySelector(".top-colorpicker-cancel");top$(_this.shadowBtn).off("click").on("click",function(){shadowPopup.style.display="block";_this.tempR=_this.rgba.r=_this.rgb.r;_this.tempG=_this.rgba.g=_this.rgb.g;_this.tempB=_this.rgba.b=_this.rgb.b;_this.tempH=_this.hsv.h;_this.tempS=_this.hsv.s;_this.tempV=_this.hsv.v;_this.tempA=_this.rgba.a;_this.tempHex=_this.hex;_this.__updateRGBValue();_this.__updateHSVValue();_this.__updateHexValue();_this.__updateAValue();_this.__updatePreview()});if(_this.onSelect&&typeof _this.onSelect==="string"){var fnSelect=Top.Util.namespace(_this.onSelect,_this)}else if(typeof _this.onSelect==="function"){var fnSelect=_this.onSelect}top$(shadowOk).click(function(event){_this.shadowBtn.style.backgroundColor=_this.__getRgbaString();shadowPopup.style.display="none";var settingValues=["rgb","hsv","hex"];settingValues.forEach(function(value){_this.updateData(value);_this.updateDevice(value)});if(typeof fnSelect==="function"){fnSelect(event.originalEvent,Top.Dom.selectById(_this.id))}_this.__dispatchEvent(new CustomEvent("select"))});top$(shadowCancel).click(function(event){shadowPopup.style.display="none";_this.rgba.r=_this.rgb.r=_this.tempR;_this.rgba.g=_this.rgb.g=_this.tempG;_this.rgba.b=_this.rgb.b=_this.tempB;_this.hsv.h=_this.tempH;_this.hsv.s=_this.tempS;_this.hsv.v=_this.tempV;_this.rgba.a=_this.tempA;_this.hex=_this.tempHex;_this.shadowAim.style.display="none"})},__addCanvasEvent:function(){var _this=this;top$(_this.shadowCanvas).off("click").on("click",function(event){var rect=_this.shadowCanvas.getBoundingClientRect();var x=event.clientX-rect.left;var y=event.clientY-rect.top;var offsetLeft=_this.shadowCanvas.offsetLeft;var offsetTop=_this.shadowCanvas.offsetTop;var imgData=_this.canvasContext.getImageData(x,y,1,1).data;_this.rgb={r:imgData[0],g:imgData[1],b:imgData[2]};_this.hex=_this.__rgbToHex(_this.rgb.r,_this.rgb.g,_this.rgb.b);_this.hsv=_this.__rgbToHsv(_this.rgb.r,_this.rgb.g,_this.rgb.b);_this.rgba.r=_this.rgb.r;_this.rgba.g=_this.rgb.g;_this.rgba.b=_this.rgb.b;for(var i=0;i<3;i++){_this.rgbArray[i].value=imgData[i]}_this.__updateHSVValue();_this.__updateHexValue();_this.__updatePreview();_this.shadowAim.style.display="block";_this.shadowAim.style.left=x-10+offsetLeft+"px";_this.shadowAim.style.top=y-10+offsetTop+"px"})},__addAEvent:function(){var _this=this;top$(_this.shadowA).change(function(event){_this.rgba.a=_this.shadowA.value;_this.__updateAValue();_this.__updatePreview()})},__addRgbEvent:function(){var _this=this;for(var k=0;k<_this.rgbArray.length;k++){top$(_this.rgbArray[k]).change(function(event){_this.rgb={r:_this.rgbArray[0].value,g:_this.rgbArray[1].value,b:_this.rgbArray[2].value};_this.rgba={r:_this.rgb.r,g:_this.rgb.g,b:_this.rgb.b,a:_this.rgba.a};_this.hex=_this.__rgbToHex(_this.rgb.r,_this.rgb.g,_this.rgb.b);_this.hsv=_this.__rgbToHsv(_this.rgb.r,_this.rgb.g,_this.rgb.b);_this.__updateHexValue();_this.__updateHSVValue();_this.__updatePreview();_this.__changeAim()})}},__addHsvEvent:function(){var _this=this;for(var k=0;k<_this.hsvArray.length;k++){top$(_this.hsvArray[k]).change(function(event){_this.hsv={h:_this.hsvArray[0].value,s:_this.hsvArray[1].value,v:_this.hsvArray[2].value};_this.rgb=_this.__hsvToRgb(_this.hsv.h,_this.hsv.s,_this.hsv.v);_this.rgba={r:_this.rgb.r,g:_this.rgb.g,b:_this.rgb.b,a:_this.rgba.a};_this.hex=_this.__rgbToHex(_this.rgb.r,_this.rgb.g,_this.rgb.b);_this.__updateRGBValue();_this.__updateHexValue();_this.__updatePreview();_this.__changeAim()})}},__addHexEvent:function(){var _this=this;top$(_this.shadowHex).change(function(event){_this.hex=_this.shadowHex.value;_this.rgb=_this.__hexToRgb(_this.shadowHex.value);_this.rgba={r:_this.rgb.r,g:_this.rgb.g,b:_this.rgb.b,a:_this.rgba.a};_this.hsv=_this.__rgbToHsv(_this.rgb.r,_this.rgb.g,_this.rgb.b);_this.__updateRGBValue();_this.__updateHSVValue();_this.__updateHexValue();_this.__updatePreview();_this.__changeAim()})},__addTransparency:function(){var _this=this;var transBackground=this.getElementsByClassName("top-colorpicker-transparency")[0];top$(transBackground).click(function(event){_this.rgba.a=0;_this.__updatePreview();_this.__updateAValue()})},__changeAim:function(){this.shadowAim.style.display="none"},__rgbToHex:function(R,G,B){return this.__toHex(R)+this.__toHex(G)+this.__toHex(B)},__toHex:function(n){n=parseInt(n,10);if(isNaN(n))return"00";n=Math.max(0,Math.min(n,255));return"0123456789ABCDEF".charAt((n-n%16)/16)+"0123456789ABCDEF".charAt(n%16)},__hexToRgb:function(hex){hex=hex.replace("#","");var value=hex.match(/[a-f\d]/gi);if(value.length==3)hex=value[0]+value[0]+value[1]+value[1]+value[2]+value[2];value=hex.match(/[a-f\d]{2}/gi);if(value===null){return{r:0,g:0,b:0}}var r=parseInt(value[0],16);var g=parseInt(value[1],16);var b=parseInt(value[2],16);return{r:r,g:g,b:b}},__rgbToHsv:function(R,G,B){var rr,gg,bb,r=R/255,g=G/255,b=B/255,h,s,v=Math.max(r,g,b),diff=v-Math.min(r,g,b),diffc=function(c){return(v-c)/6/diff+1/2};if(diff==0){h=s=0}else{s=diff/v;rr=diffc(r);gg=diffc(g);bb=diffc(b);if(r===v){h=bb-gg}else if(g===v){h=1/3+rr-bb}else if(b===v){h=2/3+gg-rr}if(h<0){h+=1}else if(h>1){h-=1}}return{h:Math.round(h*360),s:Math.round(s*100),v:Math.round(v*100)}},__hsvToRgb:function(h,s,v){var r,g,b;var i;var f,p,q,t;h=Math.max(0,Math.min(359,h));s=Math.max(0,Math.min(100,s));v=Math.max(0,Math.min(100,v));s/=100;v/=100;if(s===0){r=g=b=v;return{r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)}}if(v===0){return{r:0,g:0,b:0}}h/=60;i=Math.floor(h);f=h-i;p=v*(1-s);q=v*(1-s*f);t=v*(1-s*(1-f));switch(i){case 0:r=v;g=t;b=p;break;case 1:r=q;g=v;b=p;break;case 2:r=p;g=v;b=t;break;case 3:r=p;g=q;b=v;break;case 4:r=t;g=p;b=v;break;default:r=v;g=p;b=q}return{r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)}},__rgbToRgba:function(r,g,b){var a=this.rgba?this.rgba.a:1;return{r:r,g:g,b:b,a:a}},__updateHsv:function(){this.__convertColorStringToObject();this.rgb=this.__hsvToRgb(this.hsv.h,this.hsv.s,this.hsv.v);this.hex=this.__rgbToHex(this.rgb.r,this.rgb.g,this.rgb.b);this.rgba=this.__rgbToRgba(this.rgb.r,this.rgb.g,this.rgb.b);this.isColorUpdated=true;this.__updateColorValues()},__updateRgb:function(){this.__convertColorStringToObject();this.hsv=this.__rgbToHsv(this.rgb.r,this.rgb.g,this.rgb.b);this.hex=this.__rgbToHex(this.rgb.r,this.rgb.g,this.rgb.b);this.rgba=this.__rgbToRgba(this.rgb.r,this.rgb.g,this.rgb.b);this.isColorUpdated=true;this.__updateColorValues()},__updateRgba:function(){this.__convertColorStringToObject();this.rgb={r:this.rgba.r,g:this.rgba.g,b:this.rgba.b};this.hsv=this.__rgbToHsv(this.rgb.r,this.rgb.g,this.rgb.b);this.hex=this.__rgbToHex(this.rgb.r,this.rgb.g,this.rgb.b);this.isColorUpdated=true;this.__updateColorValues()},__updateAlpha:function(){this.rgba.a=this.alpha;this.isColorUpdated=true;this.__updateColorValues()},__updateHex:function(){var hexString=Top.Util.namespace(this.hex);if(hexString){hexString=hexString.replace(/#/,"");var isHexNumber=hexString.match(/[A-Fa-f0-9]{6}/g);this.hex=isHexNumber?hexString:"ffffff"}else{this.hex=this.hex.replace(/#/,"");var isHexNumber=this.hex.match(/[A-Fa-f0-9]{6}/g);this.hex=isHexNumber?this.hex:"ffffff"}this.rgb=this.__hexToRgb(this.hex);this.rgba=this.__rgbToRgba(this.rgb.r,this.rgb.g,this.rgb.b);this.hsv=this.__rgbToHsv(this.rgb.r,this.rgb.g,this.rgb.b);this.isColorUpdated=true;this.__updateColorValues()},getTopStyle:function(){this.topstyle=this.querySelector(".top-colorpicker-button").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-colorpicker-button");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-colorpicker-button").style.cssText=this.topstyle}};Top.Widget.Colorpicker=function(){Colorpicker.prototype=Object.create(Top.Widget.prototype);Colorpicker.prototype.constructor=Colorpicker;function Colorpicker(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-colorpicker");this.template.innerHTML='<button class="top-colorpicker-button" type="button"></button><div class = "top-colorpicker-popup"><canvas class = "top-colorpicker-canvas" width = "480" height = "320"></canvas><div class = "top-colorpicker-aim"></div><div><div class = "top-colorpicker-preview"></div><span> R: </span><input type = "text" class = "top-colorpicker-r"></input><span> G: </span><input type = "text" class = "top-colorpicker-g"></input><span> B: </span><input type = "text" class = "top-colorpicker-b"></input><span> H: </span><input type = "text" class = "top-colorpicker-h"></input><span> S: </span><input type = "text" class = "top-colorpicker-s"></input><span> V: </span><input type = "text" class = "top-colorpicker-v"></input><span> #: </span><input type = "text" class = "top-colorpicker-hex"></input><button class = "top-colorpicker-ok" type = "button"> OK </button><button class = "top-colorpicker-cancel" type = "button"> Cancel </button><div class="top-colorpicker-container-trans"><span class="top-colorpicker-span top-colorpicker-t">T:</span><div class="top-colorpicker-transparency"></div><span class="top-colorpicker-span top-colorpicker-t">A:</span><input class="top-colorpicker-a"></div></div></div>'}this.id=this.template.id}Colorpicker.create=function(obj){return new Colorpicker(obj)};Colorpicker.prototype.getHex=function(){return this.template.hex};Colorpicker.prototype.getRgb=function(){return this.template.rgb};Colorpicker.prototype.getRgba=function(){return this.template.rgba};Colorpicker.prototype.getAlpha=function(){return this.template.rgba.a};Colorpicker.prototype.getHsv=function(){return this.template.hsv};Colorpicker.prototype.setHex=function(hex){this.template.hex=hex.replace("#","");this.template.isColorUpdated=false;this.template.__updateHex();this.template.__changeAim()};Colorpicker.prototype.setRgb=function(rgb){this.template.rgb=rgb;this.template.isColorUpdated=false;this.template.__updateRgb();this.template.__changeAim()};Colorpicker.prototype.setRgba=function(rgba){this.template.rgba=rgba;this.template.isColorUpdated=false;this.template.__updateRgba();this.template.__changeAim()};Colorpicker.prototype.setHsv=function(hsv){this.template.hsv=hsv;this.template.isColorUpdated=false;this.template.__updateHsv();this.template.__changeAim()};Colorpicker.prototype.setAlpha=function(alpha){this.template.alpha=alpha;this.template.isColorUpdated=false;this.template.__updateAlpha()};return Colorpicker}();TopContextmenu={is:"top-contextmenu",behaviors:[TopMenuBehavior,TopWidgetBehavior],properties:{items:String,onOpen:String,onClose:String,onItemclick:String},__ready:function(){this.initMenuItems();this.renderMenu()},appendTemplate:function(){this.innerHTML='<div class="top-contextmenu-root"> '+this.innerHTML+"</div>"},__attached2:function(){if(this.tooltip)this.__updateTooltip()},attached:function(){this.attachEventHandler()},renderMenu:function(){this.clearMenuItems();this.menuArray=[];if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.objItems=items;var str="<div class='top-contextmenu-container close'><ul class='top-contextmenu_nav'>";str+=this.makeMenu(items);str+="</ul></div>";this.childRoot.innerHTML=str;var li=this.childRoot.querySelectorAll(".top-contextmenu_nav li");for(var i=0;i<li.length;i++){if(li[i].lastChild.tagName=="UL"){li[i].classList.add("top-contextmenu_parent");li[i].classList.add("top-contextmenu_collapsed");var item=document.createElement("i");item.classList.add("top-contextmenu_arrow");item.classList.add("icon-arrow_filled_left");li[i].insertBefore(item,li[i].querySelector("ul"))}}this.childRoot.style.border=null;if(this.borderWidth){this.border=this.borderStyle?this.borderStyle+" ":"solid ";this.border+=this.borderWidth.includes("px")?this.borderWidth:this.borderWidth+"px";this.border+=this.borderColor?" "+this.borderColor:""}this.attachEventHandler()},initializeChildRoot:function(){return this.querySelector(".top-contextmenu-root")},makeItems:function(parent){var len=parent.length;var item=[];for(var i=0;i<len;i++){var obj={};obj["text"]=parent[i].getAttribute("text");obj["selected"]=parent[i].getAttribute("selected");obj["divider"]=parent[i].getAttribute("divider");obj["id"]=parent[i].getAttribute("id");obj["icon"]=parent[i].getAttribute("icon");obj["image"]=parent[i].getAttribute("image");obj["onClick"]=parent[i].getAttribute("onClick");if(parent[i].children.length>0){obj["children"]=this.makeItems(parent[i].children)}item[i]=obj}return item},makeMenu:function(item){var str="",id="";var len=item.length;for(var i=0;i<len;i++){if(item[i].children){str+="<li class='top-contextmenu_item"+(item[i].divider===true||item[i].divider==="true"?" divider":"")+"'>"+this.getAnchor(item[i])+"<ul>";str+=this.makeMenu(item[i].children);str+="</ul></li>"}else{var disabledClass=Top.Util.__isBooleanTrue(item[i].disabled)?" disabled":"";str+="<li class='top-contextmenu_item"+disabledClass+(item[i].divider===true||item[i].divider==="true"?" divider":"")+"'>"+this.getAnchor(item[i])+"</li>"}if(item[i].onClick){if(typeof item[i].onClick==="function")var fnOnClick=item[i].onClick;else if(typeof item[i].onClick==="string")var fnOnClick=Top.Util.namespace(item[i].onClick,this);if(typeof fnOnClick==="function"){if(this.itemOnClick===undefined)this.itemOnClick={};this.itemOnClick[item[i].id]=fnOnClick}}}return str},getAnchor:function(item){var a="<a class='top-contextmenu_item_inner";var id="";var selected="";var icon="";var text="";var img="";if(item.id)id=item.selected?" top-contextmenu_"+this.id+"_"+item.id:" top-contextmenu_"+this.id+"_"+item.id+"'>";if(item.selected)selected=item.selected.startsWith("/")?selected="' href = 'javascript:Top.App.routeTo(\""+item.selected+"\")'>":"' href='"+item.selected+"'>";if(!item.id&&!item.selected)a+="'>";if(item.icon)icon="<i class='top-contextmenu_icon "+item.icon+"'></i>";else if(item.image)img="<img class='top-contextmenu_image' src='"+item.image+"'/>";else icon="<i class='top-contextmenu_icon'></i>";if(item.text)text="<span class='top-contextmenu_text'>"+this.__i18n(item.text)+"</span>";a=a+id+selected+icon+img+text+"</a>";return a},__valueToText:function(value){var pattern=/^@(string)\/([a-zA-Z0-9]+)\/([a-zA-Z0-9]+)$/;if(pattern.test(value)){var result=pattern.exec(value);return Object.keys(Top.i18n.__settings).length>0?Top.i18n.t(result[2]+"."+result[3]):Top.ValuesManager.get("strings",result[2])[result[3]]}return value},attachEventHandler:function(){var _this=this;var shadowRoot=this.childRoot;var timer;var checkReg=new RegExp("^top-contextmenu_"+this.id+"_");if(this.onItemclick&&typeof this.onItemclick==="string"){var fnSelect=Top.Util.namespace(this.onItemclick,this)}else if(typeof this.onItemclick==="function"){var fnSelect=this.onItemclick}function closeMenuItem(menuElem){if(!menuElem)return;var childMenu_ul=menuElem.querySelector("ul");var arrowElem=menuElem.querySelector(".top-contextmenu_arrow");menuElem.classList.remove("selected");menuElem.classList.remove("top-contextmenu_open");menuElem.classList.add("top-contextmenu_collapsed");childMenu_ul.style.display="none";var childMenuItem_li=top$(childMenu_ul).find("> .selected");if(childMenuItem_li.length>0&&childMenuItem_li.hasClass("top-contextmenu_parent")){for(var i=0;i<childMenuItem_li.length;i++)closeMenuItem(childMenuItem_li[i])}arrowElem.classList.remove("icon-arrow_filled_right");arrowElem.classList.add("icon-arrow_filled_left")}function openMenuItem(menuElem){if(!menuElem)return;var childMenu_ul=menuElem.querySelector("ul");var arrowElem=menuElem.querySelector(".top-contextmenu_arrow");menuElem.classList.add("selected");menuElem.classList.add("top-contextmenu_open");menuElem.classList.remove("top-contextmenu_collapsed");childMenu_ul.style.display="block";if(_this.border)childMenu_ul.style.border=_this.border;childMenu_ul.style.top=(shadowRoot.clientHeight-shadowRoot.offsetHeight)/2-childMenu_ul.clientTop+"px";childMenu_ul.style.left=menuElem.offsetLeft+menuElem.offsetWidth+childMenu_ul.clientLeft+"px";arrowElem.classList.remove("icon-arrow_filled_left");arrowElem.classList.add("icon-arrow_filled_right")}var root=this.childRoot;top$(root).find(" .top-contextmenu_item.top-contextmenu_collapsed").off("click").on("click",function(e){var parent_ul=this.parentNode;var prevSelectedItem=top$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-contextmenu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}openMenuItem(this);e.stopPropagation()}).on("mousedown",function(e){e.stopPropagation()});top$(root).find(" .top-contextmenu_item.top-contextmenu_collapsed").off("mouseenter").on("mouseenter",function(e){var thisItem=this;var parent_ul=this.parentNode;timer=setTimeout(function(){var prevSelectedItem=top$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-contextmenu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}openMenuItem(thisItem)},200);e.stopPropagation()});top$(root).find(" .top-contextmenu_item:not(.top-contextmenu_parent)").off("click").on("click",function(e){var innerItem=this.querySelector(".top-contextmenu_item_inner");for(var i=0;i<innerItem.classList.length;i++){if(checkReg.test(innerItem.classList[i])){_this.selectedMenuId=innerItem.classList[i].replace("top-contextmenu_"+_this.id+"_","");break}}if(fnSelect){var selectedItem=_this.__findItemById(_this.objItems,_this.selectedMenuId);fnSelect(e.originalEvent,Top.Dom.selectById(_this.id),{selectedItem:selectedItem})}if(_this.itemOnClick&&_this.selectedMenuId in _this.itemOnClick){var selectedItem=_this.__findItemById(_this.objItems,_this.selectedMenuId);if(!Top.Util.__isBooleanTrue(selectedItem.disabled)){_this.itemOnClick[_this.selectedMenuId](e.originalEvent,Top.Dom.selectById(_this.id),{selectedItem:selectedItem})}}var parent_ul=this.parentNode;var prevSelectedItem=top$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-contextmenu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}this.classList.add("selected");var selectedItem=_this.__findItemById(_this.objItems,_this.selectedMenuId);if(!Top.Util.__isBooleanTrue(selectedItem.disabled)){_this.close()}e.stopPropagation()}).on("mousedown",function(e){e.stopPropagation()});top$(root).find(" .top-contextmenu_item:not(.top-contextmenu_parent)").off("mouseenter").on("mouseenter",function(e){var thisItem=this;var parent_ul=this.parentNode;timer=setTimeout(function(){var prevSelectedItem=top$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-contextmenu_parent"))closeMenuItem(prevSelectedItem[0])}},200);e.stopPropagation()})},open:function(e){if(this.disabled===true||this.disabled==="true")return;if(this.display==="none"||this.display==="hidden")return;var shadowRoot=this.childRoot;var contextContainer=this.childRoot.querySelector(".top-contextmenu-container");if(this.onOpen&&typeof this.onOpen==="string"){var fnOpen=Top.Util.namespace(this.onOpen,this)}if(e){shadowRoot.style.top=e.clientY+"px";shadowRoot.style.left=e.clientX+"px"}contextContainer.style.display="inline-block";if(this.border)this.childRoot.querySelector("ul").style.border=this.border;contextContainer.querySelector(".top-contextmenu_nav").style.display="block";contextContainer.classList.add("open");contextContainer.classList.remove("close");if(fnOpen)fnOpen(event,Top.Dom.selectById(this.id))},close:function(){var contextContainer=this.childRoot.querySelector(".top-contextmenu-container");if(this.onClose&&typeof this.onClose==="string"){var fnClose=Top.Util.namespace(this.onClose,this)}if(contextContainer===null){if(fnClose)fnClose(event,Top.Dom.selectById(this.id));return}contextContainer.style.display="none";contextContainer.classList.add("close");contextContainer.classList.remove("open");var ul=contextContainer.querySelectorAll("ul");for(var i=0;i<ul.length;i++){ul[i].style.display="none"}var cp=contextContainer.querySelectorAll(".top-contextmenu_parent");for(var i=0;i<cp.length;i++){cp[i].classList.remove("top-contextmenu_open");cp[i].classList.add("top-contextmenu_collapsed")}var sel=contextContainer.querySelectorAll(".selected");for(var i=0;i<sel.length;i++){sel[i].classList.remove("selected")}var arrow=contextContainer.querySelectorAll(".top-contextmenu_arrow.icon-arrow_filled_right");for(var i=0;i<arrow.length;i++){arrow[i].classList.remove("icon-arrow_filled_right");arrow[i].classList.add("icon-arrow_filled_left")}if(fnClose)fnClose(event,Top.Dom.selectById(this.id))},__updateItems:function(){this.renderMenu();if(this.items)Top.i18n.__onUpdate(this.id,"__updateItems")},__findItemById:function(items,id){if(!items||!id)return;var selectedItem;for(var i=0,len=items.length;i<len;i++){if(items[i].id===id){return items[i]}if(typeof items[i].children==="object"&&items[i].children.length>0){selectedItem=this.__findItemById(items[i].children,id);if(selectedItem){return selectedItem}}}return selectedItem},__updateTooltip:function(){var root=this.childRoot;if(!root.querySelector("ul"))return;var thisPageId=Top.App.getCurrentPage()?Top.App.getCurrentPage().id:undefined;var _this=this;function setTooltipPosition(e){var x=e.clientX,y=e.clientY;var tooltipText=document.querySelector("#"+thisPageId+" .top-tooltip-text");tooltipText.style.top=y+20+"px";tooltipText.style.left=x+20+"px";e.preventDefault()}root.querySelector("ul").addEventListener("mouseover",function(e){window.addEventListener("mousemove",setTooltipPosition);if(!thisPageId)thisPageId=Top.App.getCurrentPage().id;var tooltipText=document.querySelector("#"+thisPageId+" .top-tooltip-text");tooltipText.textContent=_this.__i18n(_this.tooltip);tooltipText.style.display="inline-block"});root.querySelector("ul").addEventListener("mouseout",function(e){var tooltipText=document.querySelector("#"+thisPageId+" .top-tooltip-text");tooltipText.style.display="none";window.removeEventListener("mousemove",setTooltipPosition)})},__updateBorderWidth:function(){this.border="solid ";this.border+=this.borderWidth.includes("px")?this.borderWidth:this.borderWidth+"px";this.border+=this.borderColor?" "+this.borderColor:"";
},__updateBorderColor:function(){this.border="solid ";this.border+=this.borderWidth.includes("px")?this.borderWidth:this.borderWidth+"px";this.border+=this.borderColor?" "+this.borderColor:""},getTopStyle:function(){this.topstyle=this.querySelector(".top-contextmenu-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-contextmenu-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-contextmenu-root").style.cssText=this.topstyle}};Top.Widget.Menu.Contextmenu=function(){Contextmenu.prototype=Object.create(Top.Widget.Menu.prototype);Contextmenu.prototype.constructor=Contextmenu;function Contextmenu(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-contextmenu");this.template.innerHTML='<div class="top-contextmenu-root"></div>'}this.id=this.template.id}Contextmenu.create=function(element){return new Contextmenu(element)};Contextmenu.prototype.open=function(e){this.template.open(e)};Contextmenu.prototype.close=function(){this.template.close()};return Contextmenu}();TopDashboard={is:"top-dashboard",behaviors:[TopWidgetBehavior],properties:{headerTitle:{type:String},gridSize:{type:Number,value:12},gridColor:{type:Object,value:{verticalGrid:"#e1e1e1",verticalPointGrid:"#6ec8ed",horizontalGrid:"#e1e1e1",horizontalPointGrid:"#6ec8ed"}},cardList:{type:Object},showList:{type:Object},customizeEditmode:{type:Boolean,value:false},customizeOption:{type:Object},editType:{type:String,reflectToAttribute:true,value:"brick"},defaultCardSize:{type:Object,value:{width:4,height:4}},dupcardAllowed:{type:Boolean,value:false},editButtonText:{type:String,value:"edit Dashboard"},addButtonText:{type:String,value:"Add Card"},dashboardSaveButtonText:{type:String,value:"Save"},dashboardCancelButtonText:{type:String,value:"Cancel"},dialogSaveButtonText:{type:String,value:"Add"},dialogCancelButtonText:{type:String,value:"Cancel"},deletePopupOkButtonText:{type:String,value:"OK"},deletePopupCancelButtonText:{type:String,value:"Cancel"},deletePopupContentText:{type:String,value:"Are you sure you want to delete?"},deletePopupContentHtml:String,customEmptyLayout:String,customCardListDialog:{type:Boolean,value:false},onSelect:String,onAddbuttonclick:String,onSavebuttonclick:String,onCancelbuttonclick:String,onSave:String,onCancel:String,customCardContextMenu:Object,editingButtonPosition:{type:String,value:"footer"},gridClickType:{type:String,value:"none"},gridMargin:{type:Number,value:16}},appendTemplate:function(){this.innerHTML='<div class="top-dashboard-root">'+this.innerHTML+'<div class="top-dashboard-content-layout"><div class="top-dashboard-content"></div><div class="top-dashboard-content-layout-custom"></div></div></div>'},__ready:function(){this.__updateId();if(typeof this.gridColor==="string"){this.gridColor=Top.Util.namespace(this.gridColor,this)}if(this.editType==="tile"){this.gridSize={width:300,height:200};this.defaultCardSize={width:1,height:1}}if(typeof this.defaultCardSize==="string"){this.defaultCardSize=Top.Util.namespace(this.defaultCardSize,this)}if(typeof this.cardList==="string"){this.cardList=Top.Util.namespace(this.cardList,this)}if(this.cardList===undefined)this.cardList=[];this.cardMap=new Map;for(var i=0;i<this.cardList.length;i++){this.cardMap.set(this.cardList[i].id,this.cardList[i])}if(typeof this.showList==="string"){this.showList=Top.Util.namespace(this.showList,this)}if(this.showList===undefined)this.showList=[];this.showMap=new Map;for(var i=0;i<this.showList.length;i++){this.showMap.set(this.showList[i].id,this.showList[i])}if(typeof this.customizeOption==="string"){this.customizeOption=Top.Util.namespace(this.customizeOption,this)}if(typeof this.customCardContextMenu==="string"){this.customCardContextMenu=Top.Util.namespace(this.customCardContextMenu,this)}this.renderLayout()},__attached2:function(){var _this=this;var contentLayout=this.querySelector("div.top-dashboard-content-layout");if(Top.Util.__isBooleanTrue(this.customizeEditmode)===false){var p=this.getParent();if(p&&p.__redrawChild===undefined)p.__redrawChild=[];var f=function(){var titleAreaHeight=_this.querySelector("div.top-dashboard-edit-mode-header").offsetHeight;if(titleAreaHeight===0)titleAreaHeight=40;contentLayout.style.height="calc(100% - "+titleAreaHeight+"px)"};p.__redrawChild.push(f)}},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-dashboard-root");shadowRoot.id=this.id}},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-dashboard-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__initEventInternal:function(){this.__addEventByAttr("addbuttonclick");this.__addEventByAttr("savebuttonclick");this.__addEventByAttr("cancelbuttonclick");this.__addEventByAttr("save");this.__addEventByAttr("cancel");this.__addEventByAttr("select")},initializeChildRoot:function(){return this.querySelector(".top-dashboard-content-layout-custom")},renderLayout:function(){var _this=this;this.__createEditMode();var contentLayout=this.querySelector("div.top-dashboard-content-layout");contentLayout.style.width="100%";contentLayout.classList.add(this.editType+"-edit-type");if(Top.Util.__isBooleanTrue(this.customizeEditmode)===true){contentLayout.style.height="100%"}this.querySelector("div.top-dashboard-content").style.width="100%";this.querySelector("div.top-dashboard-content").style.height="100%";this.__updateCustomEmptyLayout();this.__renderCards(false)},__createEditMode:function(){var _this=this;if(Top.Util.__isBooleanTrue(this.customizeEditmode)===false){var root=this.querySelector(".top-dashboard-root");var content=root.querySelector(".top-dashboard-content-layout");var header=document.createElement("div");header.className="top-dashboard-edit-mode-header";header.innerHTML='<input type="text" read-only="true" class="top-dashboard-title"></input><button class="top-dashboard-edit-mode-button edit-button" type="button">'+this.editButtonText+'</button><button class="top-dashboard-edit-mode-button add-button" type="button">'+this.addButtonText+"</button>";_this.editButton=header.querySelector("button.edit-button");_this.addButton=header.querySelector("button.add-button");root.insertBefore(header,content);this.titleTag=this.querySelector("input.top-dashboard-title");this.titleTag.addEventListener("change",function(){if(_this.titleTag.value.length>20){_this.titleTag.size=_this.titleTag.value.length}else{_this.titleTag.size=20}});this.__updateHeaderTitle();this.querySelector("button.top-dashboard-edit-mode-button.edit-button").addEventListener("click",function(){_this.__setEditModeOn()});this.querySelector("button.top-dashboard-edit-mode-button.add-button").addEventListener("click",function(){_this.__openCardListDialog()});this.dashboardSaveButton=document.createElement("button");this.dashboardSaveButton.className="top-dashboard-edit-mode-footer-button save-button";this.dashboardSaveButton.innerText=this.dashboardSaveButtonText;this.dashboardSaveButton.addEventListener("click",function(){if(Top.Util.Browser.isIE()){var state=_this.__dispatchEvent(new CustomEvent("savebuttonclick"))}else{var state=_this.__dispatchEvent(new Event("savebuttonclick"))}if(state===false)return;_this.__save()});this.dashboardCancelButton=document.createElement("button");this.dashboardCancelButton.className="top-dashboard-edit-mode-footer-button cancel-button";this.dashboardCancelButton.innerText=this.dashboardCancelButtonText;this.dashboardCancelButton.addEventListener("click",function(){if(Top.Util.Browser.isIE()){var state=_this.__dispatchEvent(new CustomEvent("cancelbuttonclick"))}else{var state=_this.__dispatchEvent(new Event("cancelbuttonclick"))}if(state===false)return;_this.__cancel()});if(this.editingButtonPosition==="footer"){this.footer=document.createElement("div");this.footer.className="top-dashboard-edit-mode-footer";root.appendChild(this.footer);this.footer.appendChild(this.dashboardCancelButton);this.footer.appendChild(this.dashboardSaveButton)}else if(this.editingButtonPosition==="header"){header.appendChild(this.dashboardCancelButton);header.appendChild(this.dashboardSaveButton)}}this.resizeFunc=function(){_this.__drawGrid()};window.addEventListener("resize",this.resizeFunc);this.__editModeOn(false)},__save:function(){this.unSelectAllCards();if(this.editModeIsOn){this.__editModeOn(false)}this.currentShowList=top$.extend(true,[],this.showList);this.currentShowMap=new Map(this.showMap);this.headerTitle=this.titleTag.value;if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("save"))}else{this.__dispatchEvent(new Event("save"))}},__cancel:function(){this.unSelectAllCards();this.__editCancel();if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("cancel"))}else{this.__dispatchEvent(new Event("cancel"))}},__editCancel:function(){this.showList=top$.extend(true,[],this.currentShowList);this.showMap=new Map(this.currentShowMap);this.__updateHeaderTitle();if(this.editModeIsOn)this.__editModeOn(false);this.__renderCards(true)},__setEditModeOn:function(){this.currentShowList=top$.extend(true,[],this.showList);this.currentShowMap=new Map(this.showMap);this.__editModeOn(true)},__editModeOn:function(isOn){var _this=this;this.editModeIsOn=isOn;document.removeEventListener("mouseup",this.removeCardsEvent);document.removeEventListener("click",this.unSelectAllCards);if(isOn){document.addEventListener("mouseup",this.removeCardsEvent);document.addEventListener("click",this.unSelectAllCards)}if(isOn){if(Top.Util.__isBooleanTrue(this.customizeEditmode)===false){this.titleTag.readOnly=false;this.titleTag.classList.add("edit");this.querySelector("button.top-dashboard-edit-mode-button.edit-button").style.display="none";this.querySelector("button.top-dashboard-edit-mode-button.add-button").style.display="inline-block";if(this.editingButtonPosition==="footer"){this.footer.style.display="block"}else if(this.editingButtonPosition==="header"){this.dashboardSaveButton.style.display="inline-block";this.dashboardCancelButton.style.display="inline-block"}}this.querySelector("div.top-dashboard-content").classList.add("edit-mode-on");this.__drawGrid()}else{if(Top.Util.__isBooleanTrue(this.customizeEditmode)===false){this.titleTag.readOnly=true;this.titleTag.classList.remove("edit");this.querySelector("button.top-dashboard-edit-mode-button.edit-button").style.display="inline-block";this.querySelector("button.top-dashboard-edit-mode-button.add-button").style.display="none";if(this.editingButtonPosition==="footer"){this.footer.style.display="none"}else if(this.editingButtonPosition==="header"){this.dashboardSaveButton.style.display="none";this.dashboardCancelButton.style.display="none"}}this.querySelector("div.top-dashboard-content").classList.remove("edit-mode-on");top$(this.querySelector(".top-dashboard-content-grid")).remove()}this.__showCustomEmptyLayout()},__drawGrid:function(addRow){var _this=this;if(!this.editModeIsOn)return;if(this.editType==="top-align"){var table=this.querySelector("table.top-dashboard-content-grid");if(table){var trs=this.querySelectorAll("table.top-dashboard-content-grid tr");if(trs.length>this.renderTable.length){for(var i=this.renderTable.length;i<trs.length;i++){table.removeChild(trs[i])}}else if(trs.length<this.renderTable.length){for(var i=trs.length;i<this.renderTable.length;i++){var tr=document.createElement("tr");tr.className="top-dashboard-content-grid-row row_"+i;for(var j=0;j<this.gridSize;j++){var td=createTD();tr.appendChild(td)}table.appendChild(tr)}}}else{table=document.createElement("table");table.className="top-dashboard-content-grid";for(var i=0;i<this.renderTable.length;i++){var tr=document.createElement("tr");tr.className="top-dashboard-content-grid-row row_"+i;for(var j=0;j<this.gridSize;j++){var td=createTD();tr.appendChild(td)}table.appendChild(tr)}this.querySelector("div.top-dashboard-content").appendChild(table)}table.style.width="100%";table.style.height=this.renderTable.length/this.gridSize*100+"%"}else if(this.editType==="tile"){var table=this.querySelector("table.top-dashboard-content-grid");var contentArea=this.querySelector("div.top-dashboard-content");if(table){var new_x_length=Math.ceil(contentArea.offsetWidth/(this.gridSize.width+this.gridMargin));var new_y_length=Math.ceil(contentArea.offsetHeight/(this.gridSize.height+this.gridMargin));if(this.showList.length>0){var max=this.__getMaxPositionInShowList();if(max.x+1>new_x_length)new_x_length=max.x+1;if(max.y+1>new_y_length)new_y_length=max.y+1}if(addRow===true){new_y_length=this.renderTable.length;new_x_length=this.renderTable[0].length}if(this.y_length<new_y_length){for(var i=this.y_length;i<new_y_length;i++){var tr=document.createElement("tr");tr.className="top-dashboard-content-grid-row row_"+i;tr.style.borderWidth=this.gridMargin/2+"px";for(var j=0;j<this.x_length;j++){var td=createTD();tr.appendChild(td)}table.appendChild(tr)}}else if(this.y_length>new_y_length){var trs=this.querySelectorAll("table.top-dashboard-content-grid tr");for(var i=new_y_length;i<this.y_length;i++){table.removeChild(trs[i])}}if(this.x_length<new_x_length){var trs=this.querySelectorAll("table.top-dashboard-content-grid tr");for(var i=0;i<trs.length;i++){for(var j=this.x_length;j<new_x_length;j++){var td=createTD();trs[i].appendChild(td)}}}else if(this.x_length>new_x_length){var trs=this.querySelectorAll("table.top-dashboard-content-grid tr");for(var i=0;i<trs.length;i++){var tds=trs[i].querySelectorAll("td.top-dashboard-content-grid-cell");for(var j=new_x_length;j<this.x_length;j++){trs[i].removeChild(tds[j])}}}this.x_length=new_x_length;this.y_length=new_y_length}else{table=document.createElement("table");table.className="top-dashboard-content-grid";this.x_length=Math.ceil(contentArea.offsetWidth/(this.gridSize.width+this.gridMargin));this.y_length=Math.ceil(contentArea.offsetHeight/(this.gridSize.height+this.gridMargin));for(var i=0;i<this.y_length;i++){var tr=document.createElement("tr");tr.className="top-dashboard-content-grid-row row_"+i;tr.style.borderWidth=this.gridMargin/2+"px";for(var j=0;j<this.x_length;j++){var td=createTD();tr.appendChild(td)}table.appendChild(tr)}contentArea.appendChild(table)}}else{if(this.querySelector("canvas.top-dashboard-content-grid")){var canvas=this.querySelector("canvas.top-dashboard-content-grid")}else{var canvas=document.createElement("canvas");canvas.className="top-dashboard-content-grid";this.querySelector("div.top-dashboard-content").appendChild(canvas)}canvas.style.width="100%";canvas.style.height=this.renderTable.length/this.gridSize*100+"%";canvas.width=this.querySelector("div.top-dashboard-content").offsetWidth;canvas.height=this.querySelector("div.top-dashboard-content").offsetHeight;var context=canvas.getContext("2d");var width=canvas.width;var height=canvas.height;var cellWidth=width/this.gridSize;var cellHeight=height/this.renderTable.length;context.clearRect(0,0,width,height);for(var x=1;x<this.gridSize;x++){if(x%(this.gridSize/3)!==0){context.stroke();context.beginPath();context.moveTo(x*cellWidth,0);context.lineTo(x*cellWidth,height);context.strokeStyle=this.gridColor.verticalGrid}else{context.stroke();context.beginPath();context.moveTo(x*cellWidth,0);context.lineTo(x*cellWidth,height);context.strokeStyle=this.gridColor.verticalPointGrid}}for(var x=1;x<this.renderTable.length;x++){if(x%(this.gridSize/3)!==0){context.stroke();context.beginPath();context.moveTo(0,x*cellHeight);context.lineTo(width,x*cellHeight);context.strokeStyle=this.gridColor.horizontalGrid}else{context.stroke();context.beginPath();context.moveTo(0,x*cellHeight);context.lineTo(width,x*cellHeight);context.strokeStyle=this.gridColor.horizontalPointGrid}}context.stroke()}function createTD(){var td=document.createElement("td");td.className="top-dashboard-content-grid-cell cell_"+j;td.style.borderWidth=_this.gridMargin/2+"px";var tile=document.createElement("div");tile.className="top-dashboard-content-grid-tile";tile.style.width=_this.gridSize.width+"px";tile.style.height=_this.gridSize.height+"px";if(_this.gridClickType==="add"){var icon=document.createElement("div");icon.className="add-icon";tile.appendChild(icon);tile.position_x=j;tile.position_y=i;tile.addEventListener("mouseenter",function(){_this.hoverTile=this;this.classList.add("hover-empty-tile")});tile.addEventListener("mouseleave",function(){_this.hoverTile=undefined;this.classList.remove("hover-empty-tile")});tile.addEventListener("click",function(){if(_this.hoverTile!==this)return;_this.addedPosition={x:this.position_x,y:this.position_y};_this.__openCardListDialog()})}td.appendChild(tile);return td}},__openCardListDialog:function(){var _this=this;var curruntShowList=top$.extend(true,[],this.showList);var currentShowMap=new Map(this.showMap);if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("addbuttonclick"))}else{this.__dispatchEvent(new Event("addbuttonclick"))}if(Top.Util.__isBooleanTrue(this.customCardListDialog)===true)return;var pageId=Top.App.getCurrentPage().id;var dialogOverlay=document.createElement("div");dialogOverlay.id="top-dialog-overlay_"+this.id;dialogOverlay.className="top-dialog-overlay";document.querySelector("#"+pageId).appendChild(dialogOverlay);var dialogRoot=document.createElement("div");dialogRoot.id="top-dashboard-dialog_"+this.id;dialogRoot.className="top-dashboard-dialog card-list-dialog";var dialogTitleLayout=document.createElement("div");dialogTitleLayout.className="top-dashboard-dialog-title-layout";var dialogTitle=document.createElement("span");dialogTitle.className="top-dashboard-dialog-title";dialogTitle.textContent="Card List";dialogTitleLayout.appendChild(dialogTitle);var dialogClose=document.createElement("button");dialogClose.className="top-dashboard-dialog-close";dialogClose.addEventListener("click",function(){Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog()});dialogTitleLayout.appendChild(dialogClose);dialogRoot.appendChild(dialogTitleLayout);var dialogTab=document.createElement("table");dialogTab.className="top-dashboard-dialog-tab-layout";dialogTab.innerHTML="<tbody><tr><td class='top-dashboard-dialog-tab general-tab active'><div class='top-dashboard-dialog-tab general-tab active'><span>General</span></div></td><td class='top-dashboard-dialog-tab customize-tab'><div class='top-dashboard-dialog-tab customize-tab'><span>Customize</span></div></td><td style='width:100%'><div class='top-dashboard-dialog-tab last-tab'></div></td></tr></tbody>";dialogRoot.appendChild(dialogTab);if(this.customizeOption){dialogTab.rows[0].cells[0].firstElementChild.addEventListener("click",function(){this.parentNode.parentNode.cells[1].classList.remove("active");this.parentNode.parentNode.cells[1].firstElementChild.classList.remove("active");this.parentNode.classList.add("active");this.classList.add("active");dialogContent.removeChild(dialogContent.firstElementChild);setGeneralTabContents()});dialogTab.rows[0].cells[1].firstElementChild.addEventListener("click",function(){this.parentNode.parentNode.cells[0].classList.remove("active");this.parentNode.parentNode.cells[0].firstElementChild.classList.remove("active");this.parentNode.classList.add("active");this.classList.add("active");dialogContent.removeChild(dialogContent.firstElementChild);if(Top.Util.getFileExtension(_this.customizeOption.html)==="html"){Top.Ajax.execute(_this.customizeOption.html,{success:function(data){dialogContent.innerHTML=data}})}else if(_this.customizeOption.html!==undefined){dialogContent.innerHTML=_this.customizeOption.html}});if(typeof this.customizeOption.onTabChange==="string")this.customizeOption.onTabChange=Top.Util.namespace(this.customizeOption.onTabChange,this);if(typeof this.customizeOption.onTabChange==="function"){dialogTab.rows[0].cells[0].firstElementChild.addEventListener("click",this.customizeOption.onTabChange);dialogTab.rows[0].cells[1].firstElementChild.addEventListener("click",this.customizeOption.onTabChange)}}var dialogContent=document.createElement("div");dialogContent.className="top-dashboard-dialog-content";setGeneralTabContents();function setGeneralTabContents(){var dialogContentTable=document.createElement("table");dialogContentTable.className="top-dashboard-dialog-content-table";var dialogContentTableBody=document.createElement("tbody");var length=_this.cardList.length;var row=Math.ceil(length/6);var lastRow=length%6;for(var i=0;i<row;i++){var dialogContentTableTr=document.createElement("tr");for(var j=0;j<6;j++){var index=6*i+j;var dialogContentTableTd=document.createElement("td");dialogContentTableTr.appendChild(dialogContentTableTd);if(index<length){var card=document.createElement("div");card.className="top-dashboard-content-card";var checkbox=document.createElement("label");checkbox.className="top-dashboard-content-check";checkbox.index=index;checkbox.addEventListener("click",function(){if(this.checked===true){this.classList.remove("checked");this.checked=false}else{this.classList.add("checked");this.checked=true}cardListCheckboxChange.call(this,currentShowMap)});card.appendChild(checkbox);if(_this.showMap.has(_this.cardList[index].id)){card.classList.add("select");checkbox.checked=true;checkbox.classList.add("checked")}else{card.classList.add("unselect");checkbox.checked=false;checkbox.classList.remove("checked")}var nameTag=document.createElement("div");nameTag.className="top-dashboard-content-card-name";nameTag.innerHTML="<span>"+_this.cardList[index].name+"</span>";dialogContentTableTd.appendChild(card);dialogContentTableTd.appendChild(nameTag);if(j===5){card.classList.add("last-card");nameTag.classList.add("last-card")}}}dialogContentTableBody.appendChild(dialogContentTableTr)}dialogContentTable.appendChild(dialogContentTableBody);dialogContent.appendChild(dialogContentTable)}dialogRoot.appendChild(dialogContent);var dialogBottom=document.createElement("div");dialogBottom.className="top-dashboard-dialog-footer";var dialogCancelButton=document.createElement("button");dialogCancelButton.className="top-dashboard-dialog-footer-button cancel-button";dialogCancelButton.innerText=this.dialogCancelButtonText;dialogCancelButton.addEventListener("click",function(){Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog();_this.showList=top$.extend(true,[],curruntShowList);_this.showMap=new Map(currentShowMap)});dialogBottom.appendChild(dialogCancelButton);var dialogAddButton=document.createElement("button");dialogAddButton.className="top-dashboard-dialog-footer-button add-button";dialogAddButton.innerText=this.dialogSaveButtonText;dialogAddButton.addEventListener("click",function(event){if(_this.editType==="grid"||_this.editType==="tile"){if(_this.addedPosition){_this.showList.every(function(item){if(!item.position){item.position=_this.addedPosition;return false}return true})}}Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog();_this.__renderCards(true)});dialogBottom.appendChild(dialogAddButton);dialogRoot.appendChild(dialogBottom);document.querySelector("#"+pageId).appendChild(dialogRoot);this.__setDialogPosition(dialogRoot);function cardListCheckboxChange(currentShowMap){if(this.checked){this.parentNode.classList.remove("unselect");this.parentNode.classList.add("select");var item={id:_this.cardList[this.index].id};if(_this.editType==="grid"||_this.editType==="tile"){if(currentShowMap.has(_this.cardList[this.index].id)){item.size=currentShowMap.get(_this.cardList[this.index].id).size;item.position=currentShowMap.get(_this.cardList[this.index].id).position}}_this.showList.push(item);_this.showMap.set(_this.cardList[this.index].id,item)}else{this.parentNode.classList.remove("select");this.parentNode.classList.add("unselect");var id=_this.cardList[this.index].id;_this.showList=_this.showList.filter(function(v){if(v.id===id)return false;return true});_this.showMap.delete(_this.cardList[this.index].id)}}},__closeCardListDialog:function(){top$(document.querySelector("#top-dialog-overlay_"+this.id)).remove();top$(document.querySelector("#top-dashboard-dialog_"+this.id)).remove()},__setDialogPosition:function(dialogRoot){var top=window.pageYOffset+window.innerHeight/2-dialogRoot.offsetHeight/2;var left=(window.innerWidth-dialogRoot.offsetWidth)/2;dialogRoot.style.left=left+"px";dialogRoot.style.top=top+"px"},__initRenderTable:function(){if(this.editType==="brick"){this.nextCell={x:0,y:0}}else if(this.editType==="top-align"){this.nextCell=[];for(var x=0;x<this.gridSize;x++){this.nextCell.push(0)}}else if(this.editType==="tile"){this.nextCell={x:0,y:0};if(this.editModeIsOn){this.renderTable=[];for(var i=0;i<this.y_length;i++){this.renderTable.push([]);for(var j=0;j<this.x_length;j++){this.renderTable[i].push([true,undefined])}}}else{this.renderTable=[];if(this.y_length===undefined&&this.x_length===undefined){if(this.showList.length>0){var max=this.__getMaxPositionInShowList();if(max.x!==-1&&max.y!==-1){for(var i=0;i<=max.y;i++){this.renderTable.push([]);for(var j=0;j<=max.x;j++){this.renderTable[i].push([true,undefined])}}}}}else{for(var i=0;i<this.y_length;i++){this.renderTable.push([]);for(var j=0;j<this.x_length;j++){this.renderTable[i].push([true,undefined])}}}}return}this.renderTable=[];for(var i=0;i<this.gridSize;i++){this.renderTable.push([]);for(var j=0;j<this.gridSize;j++){this.renderTable[i].push([true,undefined])}}},__getMaxPositionInShowList:function(){var maxX=-1;var maxY=-1;for(var i=0;i<this.showList.length;i++){if(this.showList[i].position){var position_x=this.showList[i].position.x+this.showList[i].size.width-1;var position_y=this.showList[i].position.y+this.showList[i].size.height-1;if(position_x>maxX)maxX=position_x;if(position_y>maxY)maxY=position_y}}return{x:maxX,y:maxY}},__renderCards:function(reRender){var _this=this;var ajaxMap=[];var noPosition=[];this.isResize=false;this.addedPosition=undefined;this.__initRenderTable();if(reRender){var appendedCards=this.querySelectorAll(".top-dashboard-card-bound");for(var i=0;i<appendedCards.length;i++){if(!this.showMap.has(appendedCards[i].id)){if(this.editType==="grid")_emptyRenderTable(_getXCellPosition(appendedCards[i].offsetLeft),_getYCellPosition(appendedCards[i].offsetTop),_adjustWidth(appendedCards[i].offsetWidth),_adjustHeight(appendedCards[i].offsetHeight));appendedCards[i].parentNode.removeChild(appendedCards[i])}else if(Top.Util.__isBooleanTrue(this.dupcardAllowed)){if(appendedCards[i].index>=this.showList.length){appendedCards[i].parentNode.removeChild(appendedCards[i])}else{if(this.showList[appendedCards[i].index].id!==appendedCards[i].id){appendedCards[i].parentNode.removeChild(appendedCards[i])}}}}}for(var i=0;i<this.showList.length;i++){var id=this.showList[i].id;var cardInfo=this.cardMap.get(id);var cardBound;if(reRender){if(Top.Util.__isBooleanTrue(this.dupcardAllowed)){cardBound=this.querySelector("#"+id+".top-dashboard-card-bound.card_"+i)}else{cardBound=this.querySelector("#"+id+".top-dashboard-card-bound")}if(cardBound){cardBound.className=this.editType+" top-dashboard-card-bound card_"+i;if(this.selected===cardBound)cardBound.classList.add("select");cardBound.index=i;if(cardBound.titleText!==cardInfo.title)this.__setCardTitle(cardBound,cardInfo.title);if(cardBound.html!==cardInfo.html){if(cardInfo.html!==undefined){if(Top.Util.getFileExtension(cardInfo.html)==="html"){ajaxMap.push({url:cardInfo.html,node:cardBound});top$.ajax(cardInfo.html,{success:function(data){var i=0;var url=this.url;ajaxMap.forEach(function(e){if(e.url===url){appendCardContents(data,e.node);ajaxMap.splice(i,1);return}i++})}})}else{appendCardContents(cardInfo.html,cardBound)}}}_setCardSize(cardBound,i,id)}else{cardBound=createCard(i);var childId=_this.showList[i].childId;if(cardInfo.html!==undefined){if(Top.Util.getFileExtension(cardInfo.html)==="html"){ajaxMap.push({url:cardInfo.html,node:cardBound});top$.ajax(cardInfo.html,{success:function(data){var i=0;var url=this.url;ajaxMap.forEach(function(e){if(e.url===url){appendCardContents(data,e.node,childId);ajaxMap.splice(i,1);return}i++})}})}else{appendCardContents(cardInfo.html,cardBound,childId)}}}}else{cardBound=createCard(i);if(cardInfo.html!==undefined){if(Top.Util.getFileExtension(cardInfo.html)==="html"){ajaxMap.push({url:cardInfo.html,node:cardBound});top$.ajax(cardInfo.html,{success:function(data){var i=0;var url=this.url;ajaxMap.forEach(function(e){if(e.url===url){appendCardContents(data,e.node);ajaxMap.splice(i,1);return}i++})}})}else{appendCardContents(cardInfo.html,cardBound)}}}_setCardPosition(cardBound,i)}this.__showCustomEmptyLayout();if(this.editType==="grid"||_this.editType==="tile"){noPosition.forEach(function(node){_setEmptyPosition(node)})}if(this.editType==="top-align"){_adjustIndex()}if(reRender){document.removeEventListener("mouseup",this.removeCardsEvent);document.removeEventListener("click",this.unSelectAllCards)}if(this.editModeIsOn){document.addEventListener("mouseup",this.removeCardsEvent);document.addEventListener("click",this.unSelectAllCards)}if(this.removeCardsEvent===undefined){this.removeCardsEvent=function(e){_this._resizeEnd();_this.removeEventListener("mousemove",_this._resizeMove);_this.removeEventListener("mouseup",_this._resizeEnd);_this._moveEnd();_this.removeEventListener("mousemove",_this._cardMove);_this.removeEventListener("mouseup",_this._moveEnd);_this._addedEnd();_this.removeEventListener("mousemove",_this._cardMove);_this.removeEventListener("mouseup",_this._addedEnd);e.preventDefault()}}if(this.unSelectAllCards===undefined){this.unSelectAllCards=function(){_this.selected=undefined;document.querySelectorAll("top-dashboard .top-dashboard-card-bound.select").forEach(function(card){card.classList.remove("select");card.querySelectorAll(".top-dashboard-card-resize").forEach(function(node){node.parentNode.removeChild(node)});top$(card.querySelector(".top-dashboard-card-option")).remove();top$(card.querySelector(".top-dashboard-card-option-contextMenu")).remove();card.removeEventListener("mousedown",_moveStart)})}}function createCard(index){var id=_this.showList[index].id;var childId=_this.showList[index].childId;var cardInfo=_this.cardMap.get(id);var cardBound=document.createElement("div");cardBound.className=_this.editType+" top-dashboard-card-bound card_"+index;cardBound.index=index;cardBound.id=id;cardBound.childId=childId;cardBound.name=cardInfo.name;if(typeof cardInfo.title==="string")cardBound.titleText=cardInfo.title;cardBound.html=cardInfo.html;cardBound.cardArea=document.createElement("div");cardBound.cardArea.className="top-dashboard-card";cardBound.appendChild(cardBound.cardArea);if(_this.editType==="brick"){var cardPositionGuide_bef=document.createElement("div");cardPositionGuide_bef.className="top-dashboard-card-position-guide before";var cardPositionGuide_aft=document.createElement("div");cardPositionGuide_aft.className="top-dashboard-card-position-guide after";cardBound.appendChild(cardPositionGuide_bef);cardBound.appendChild(cardPositionGuide_aft)}else if(_this.editType==="grid"){var cardPositionGuide_top=document.createElement("div");cardPositionGuide_top.className="top-dashboard-card-position-guide top";var cardPositionGuide_left=document.createElement("div");cardPositionGuide_left.className="top-dashboard-card-position-guide left";var cardPositionGuide_right=document.createElement("div");
cardPositionGuide_right.className="top-dashboard-card-position-guide right";var cardPositionGuide_bottom=document.createElement("div");cardPositionGuide_bottom.className="top-dashboard-card-position-guide bottom";cardBound.appendChild(cardPositionGuide_top);cardBound.appendChild(cardPositionGuide_left);cardBound.appendChild(cardPositionGuide_right);cardBound.appendChild(cardPositionGuide_bottom)}else if(_this.editType==="tile"){cardBound.overlapFeedback=document.createElement("div");cardBound.overlapFeedback.className="top-dashboard-card-overlap-feedback";cardBound.appendChild(cardBound.overlapFeedback)}if(cardInfo.title){cardBound.titleArea=document.createElement("div");cardBound.titleArea.className="top-dashboard-card-title";cardBound.titleArea.innerHTML="<span>"+cardInfo.title+"</span>";cardBound.cardArea.appendChild(cardBound.titleArea)}cardBound.contentArea=document.createElement("div");cardBound.contentArea.className="top-dashboard-card-content";cardBound.cardArea.appendChild(cardBound.contentArea);_this.querySelector(".top-dashboard-content").appendChild(cardBound);_setCardSize(cardBound,index,id);cardBound.addEventListener("click",function(event){if(_this.editModeIsOn){document.querySelectorAll("top-dashboard .top-dashboard-card-option-contextMenu").forEach(function(menu){top$(menu).remove()});if(_this.selected!==this){_this.unSelectAllCards();_this.selected=this;this.classList.add("select");var detail={detail:{id:this.id,index:this.index,childId:this.childId}};if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("select",detail))}else{_this.__dispatchEvent(new CustomEvent("select",detail))}var resize_right=document.createElement("div");resize_right.className="top-dashboard-card-resize resize-right";var resize_bottom=document.createElement("div");resize_bottom.className="top-dashboard-card-resize resize-bottom";var resize_right_bottom=document.createElement("div");resize_right_bottom.className="top-dashboard-card-resize resize-right-bottom";resize_right_bottom.innerHTML='<i class="top-dashboard-card-resize-icon"><img class="dashboard-svg resize-icon" src="'+Top.libsPath+'css/images/size-que.svg"><img/></i>';this.appendChild(resize_right);this.appendChild(resize_bottom);this.appendChild(resize_right_bottom);resize_right.addEventListener("mousedown",_resizeStart);resize_bottom.addEventListener("mousedown",_resizeStart);resize_right_bottom.addEventListener("mousedown",_resizeStart);this.addEventListener("mousedown",_moveStart);var option=document.createElement("button");option.className="top-dashboard-card-option";option.innerHTML='<i class="top-dashboard-card-option-icon"><img class="dashboard-svg option-icon" src="'+Top.libsPath+'css/images/option.svg"><img/></i>';this.appendChild(option);top$(this).find("img.dashboard-svg").each(function(){var $img=topjQuery(this);var imgID=$img.attr("id");var imgClass=$img.attr("class");var imgURL=$img.attr("src");topjQuery.get(imgURL,function(data){var $svg=topjQuery(data).find("svg");if(typeof imgID!=="undefined"){$svg=$svg.attr("id",imgID)}if(typeof imgClass!=="undefined"){$svg=$svg.attr("class",imgClass+" replaced-svg")}$svg=$svg.removeAttr("xmlns:a");$img.replaceWith($svg)},"xml")});option.addEventListener("click",function(e){if(cardBound.querySelector("div.top-dashboard-card-option-contextMenu")===null){var contextMenu=document.createElement("div");contextMenu.className="top-dashboard-card-option-contextMenu";var contextMenu_ul=document.createElement("ul");contextMenu_ul.className="top-dashboard-contextMenu-container";if(_this.customCardContextMenu){if(typeof _this.customCardContextMenu==="function"){var customCardContextMenuList=_this.customCardContextMenu(_this.showList[_this.selected.index])}else if(typeof _this.customCardContextMenu==="object"){var customCardContextMenuList=_this.customCardContextMenu}else{return}for(var i=0;i<customCardContextMenuList.length;i++){if(customCardContextMenuList[i].type==="delete"){var title="Delete from Dashboard";if(customCardContextMenuList[i].title)title=customCardContextMenuList[i].title;_createDeleteCardContextMenu(contextMenu_ul,title)}else if(customCardContextMenuList[i].type==="size"){if(customCardContextMenuList[i].title){_createChangeSizeContextMenu(customCardContextMenuList[i].width,customCardContextMenuList[i].height,contextMenu_ul,customCardContextMenu[i].title)}else{_createChangeSizeContextMenu(customCardContextMenuList[i].width,customCardContextMenuList[i].height,contextMenu_ul)}}else if(customCardContextMenuList[i].type==="custom"){_createContextMenu(contextMenu_ul,customCardContextMenuList[i].title,customCardContextMenuList[i].onClick)}}}else{_createDeleteCardContextMenu(contextMenu_ul,"Delete from Dashboard");if(_this.showList[_this.selected.index].size.width!==2||_this.showList[_this.selected.index].size.height!==2){_createChangeSizeContextMenu(2,2,contextMenu_ul)}if(_this.showList[_this.selected.index].size.width!==3||_this.showList[_this.selected.index].size.height!==3){_createChangeSizeContextMenu(3,3,contextMenu_ul)}if(_this.showList[_this.selected.index].size.width!==4||_this.showList[_this.selected.index].size.height!==4){_createChangeSizeContextMenu(4,4,contextMenu_ul)}}contextMenu.appendChild(contextMenu_ul);cardBound.appendChild(contextMenu)}else{top$(cardBound.querySelector(".top-dashboard-card-option-contextMenu")).remove()}e.stopPropagation()});option.addEventListener("mousedown",function(e){e.stopPropagation()});option.addEventListener("mouseup",function(e){e.stopPropagation()})}event.stopPropagation()}});return cardBound}function _createDeleteCardContextMenu(contextMenu_ul,title){_createContextMenu(contextMenu_ul,title,function(e){var card=this.parentNode.parentNode.parentNode;var i=card.index;var pageId=Top.App.getCurrentPage().id;var dialogOverlay=document.createElement("div");dialogOverlay.id="top-dialog-overlay_"+_this.id;dialogOverlay.className="top-dialog-overlay";document.querySelector("#"+pageId).appendChild(dialogOverlay);var dialogRoot=document.createElement("div");dialogRoot.id="top-dashboard-dialog_"+_this.id;dialogRoot.className="top-dashboard-dialog card-delete-dialog";var dialogTitleLayout=document.createElement("div");dialogTitleLayout.className="top-dashboard-dialog-title-layout";var dialogTitle=document.createElement("span");dialogTitle.className="top-dashboard-dialog-title";dialogTitle.textContent="Delete";dialogTitleLayout.appendChild(dialogTitle);var dialogClose=document.createElement("button");dialogClose.className="top-dashboard-dialog-close";dialogClose.addEventListener("click",function(){Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog()});dialogTitleLayout.appendChild(dialogClose);dialogRoot.appendChild(dialogTitleLayout);var dialogContentLayout=document.createElement("div");dialogContentLayout.className="top-dashboard-dialog-content";if(_this.deletePopupContentHtml){dialogContentLayout.innerHTML=_this.deletePopupContentHtml}else{var dialogContent=document.createElement("span");dialogContent.textContent=_this.deletePopupContentText;dialogContentLayout.appendChild(dialogContent)}dialogRoot.appendChild(dialogContentLayout);var dialogBottom=document.createElement("div");dialogBottom.className="top-dashboard-dialog-footer";var dialogCancelButton=document.createElement("button");dialogCancelButton.className="top-dashboard-dialog-footer-button cancel-button";dialogCancelButton.innerText=_this.deletePopupCancelButtonText;dialogCancelButton.addEventListener("click",function(){Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog()});dialogBottom.appendChild(dialogCancelButton);var dialogOkButton=document.createElement("button");dialogOkButton.className="top-dashboard-dialog-footer-button add-button";dialogOkButton.innerText=_this.deletePopupOkButtonText;dialogOkButton.addEventListener("click",function(event){_this.unSelectAllCards();card.parentNode.removeChild(card);if(_this.editType==="tile")_reSetRenderTable(_this.showList[i].position.x,_this.showList[i].position.y,_this.showList[i].size.width,_this.showList[i].size.height);_this.showList.splice(i,1);if(Top.Util.__isBooleanTrue(_this.dupcardAllowed)){if(_this.querySelector("#"+card.id+".top-dashboard-card-bound")===undefined){_this.showMap.delete(card.id)}}else{_this.showMap.delete(card.id)}for(var j=0;j<_this.showList.length;j++){var beforeIndex=j;if(i<=j)beforeIndex++;var id=_this.showList[j].id;var cardInfo=_this.cardMap.get(id);var cardBound=_this.querySelector("#"+id+".top-dashboard-card-bound.card_"+beforeIndex);cardBound.className=_this.editType+" top-dashboard-card-bound card_"+j;cardBound.index=j}if(_this.editType!=="tile"){_renderWhileResize()}Top.App.closeAutoCompleteContainers();_this.__closeCardListDialog();event.stopPropagation()});dialogBottom.appendChild(dialogOkButton);dialogRoot.appendChild(dialogBottom);document.querySelector("#"+pageId).appendChild(dialogRoot);_this.__setDialogPosition(dialogRoot)})}function _createChangeSizeContextMenu(width,height,contextMenu_ul,title){var titleText=width+" X "+height;if(title)titleText=title;var card_position=_this.showMap.get(_this.selected.id).position;var disabled=false;if(_this.editType==="tile"&&!_isValidCardPosition(card_position.x,card_position.y,width,height))disabled=true;_createContextMenu(contextMenu_ul,titleText,function(){if(_this.editType==="top-align"){if(_this.showList[_this.selected.index].position.x+width<=_this.gridSize){_this.selected.style.width=_getWidth(width,_this.selected)}else{var i=width;while(_this.showList[_this.selected.index].position.x+i>_this.gridSize&&i>1){i--}_this.selected.style.width=_getWidth(i,_this.selected)}}else{_this.selected.style.width=_getWidth(width,_this.selected)}_this.selected.style.height=_getHeight(height,_this.selected);if(!_isValidY(_this.selected)||!_isValidX(_this.selected)){_this.selected.style.height=_this.selected.bfmHeight;_this.selected.ratioHeight=_this.selected.bfmRatioH;_this.selected.style.width=_this.selected.bfmWidth;_this.selected.ratioWidth=_this.selected.bfmRatioW}var onCardSizeChange=_this.cardMap.get(_this.selected.id).onSizeChange;if(typeof onCardSizeChange==="string"){onCardSizeChange=Top.Util.namespace(onCardSizeChange,_this)}if(typeof onCardSizeChange==="function"){onCardSizeChange(_this,_this.selected)}_this.showList[_this.selected.index].size.width=_adjustWidth(_this.selected.offsetWidth);_this.showList[_this.selected.index].size.height=_adjustHeight(_this.selected.offsetHeight);_drawPostCard(false);if(_this.editType==="grid"){}else if(_this.editType==="brick"||_this.editType==="top-align"){_renderWhileResize()}},disabled)}function _createContextMenu(contextMenu_ul,titleText,clickFunc,disabled){var contextMenu_li=document.createElement("li");contextMenu_li.className="top-dashboard-contextMenu-item";contextMenu_li.innerHTML="<span class='top-dashboard-contextMenu-text'>"+titleText+"</span>";if(disabled===true){contextMenu_li.classList.add("disabled")}else{contextMenu_li.addEventListener("click",clickFunc)}contextMenu_ul.appendChild(contextMenu_li)}function _setCardSize(cardBound,i,id){if(_this.showList[i].size===undefined){_this.showList[i].size={width:_this.defaultCardSize.width,height:_this.defaultCardSize.height}}cardBound.style.width=_getWidth(_this.showList[i].size.width,cardBound);cardBound.style.height=_getHeight(_this.showList[i].size.height,cardBound)}function _setCardPosition(cardBound,i){var cardWidth=_this.showList[i].size.width;var cardHeight=_this.showList[i].size.height;if(_this.editType==="grid"||_this.editType==="tile"){if(_this.showList[i].position===undefined||_this.showList[i].position.x===undefined||_this.showList[i].position.y===undefined){noPosition.push(cardBound)}else{cardBound.style.top=_getYPosition(_this.showList[i].position.y,cardBound);cardBound.style.left=_getXPosition(_this.showList[i].position.x,cardBound);_setRenderTable(_this.showList[i].position.x,_this.showList[i].position.y,cardWidth,cardHeight,i)}if(i===_this.showList.length-1&&_this.__getMaxPositionInShowList().y<_this.renderTable.length){removeRow()}}else if(_this.editType==="brick"){while(!_validCardPosition(_this.nextCell.x,_this.nextCell.y,cardWidth,cardHeight)){if(_this.nextCell.x+cardWidth>_this.gridSize){for(var x=_this.nextCell.x;x<_this.gridSize;x++){_this.renderTable[_this.nextCell.y][x]=[true,i-1]}_this.nextCell.x=0;_this.nextCell.y++}else{_this.nextCell.x++}}cardBound.style.top=_getYPosition(_this.nextCell.y,cardBound);cardBound.style.left=_getXPosition(_this.nextCell.x,cardBound);_setRenderTable(_this.nextCell.x,_this.nextCell.y,cardWidth,cardHeight,i);if(i===_this.showList.length-1&&_this.nextCell.y+cardHeight<=_this.renderTable.length){removeRow()}}else if(_this.editType==="top-align"){if(_this.showList[i].position===undefined||_this.showList[i].position.x===undefined){_this.showList[i].position={x:0}}var x=_this.showList[i].position.x;while(!_validCardPosition(x,_this.nextCell[x],cardWidth,cardHeight)){_this.nextCell[x]++}cardBound.style.top=_getYPosition(_this.nextCell[x],cardBound);cardBound.style.left=_getXPosition(x,cardBound);_setRenderTable(x,_this.nextCell[x],cardWidth,cardHeight,i);if(i===_this.showList.length-1&&_this.nextCell[x]<=_this.renderTable.length){removeRow()}}}function _setEmptyPosition(cardBound){var cardWidth=_this.showList[cardBound.index].size.width;var cardHeight=_this.showList[cardBound.index].size.height;var nextCellX=0;var nextCellY=0;if(_this.editType==="tile")var maxX=_this.renderTable[0].length;else var maxX=_this.gridSize;while(!_validCardPosition(nextCellX,nextCellY,cardWidth,cardHeight)){if(nextCellX+cardWidth>maxX){for(var x=nextCellX;x<_this.gridSize;x++){_this.renderTable[nextCellY][x]=[true,i-1]}nextCellX=0;nextCellY++}else{nextCellX++}}cardBound.style.top=_getYPosition(nextCellY,cardBound);cardBound.style.left=_getXPosition(nextCellX,cardBound);if(_this.showList[cardBound.index].position===undefined){_this.showList[cardBound.index].position={x:0,y:0}}_this.showList[cardBound.index].position.x=nextCellX;_this.showList[cardBound.index].position.y=nextCellY;_setRenderTable(nextCellX,nextCellY,cardWidth,cardHeight,cardBound.index);if(cardBound.index===_this.showList.length-1&&nextCellY+cardHeight<_this.renderTable.length){removeRow()}}function _validCardPosition(startX,startY,width,height){for(var y=startY;y<startY+height;y++){if(_this.renderTable.length<=y)addRow();if(startX+width>_this.renderTable[y].length)return false;for(var x=startX;x<startX+width;x++){if(_this.renderTable[y][x][0]===false)return false}}return true}function _isValidCardPosition(startX,startY,width,height){for(var y=startY;y<startY+height;y++){for(var x=startX;x<startX+width;x++){if(_this.renderTable[y][x][0]===false)return false}}return true}function addRow(){_this.renderTable.push([]);if(_this.editType==="tile"){var maxX=_this.renderTable[0].length;for(var j=0;j<maxX;j++){_this.renderTable[_this.renderTable.length-1].push([true,undefined])}_this.__drawGrid(true)}else{var maxX=_this.gridSize;for(var j=0;j<maxX;j++){_this.renderTable[_this.renderTable.length-1].push([true,undefined])}_this.__drawGrid()}}function addColumn(){for(var i=0;i<_this.renderTable.length;i++){_this.renderTable[i].push([true,undefined])}if(_this.editType==="tile"){_this.__drawGrid(true)}else{_this.__drawGrid()}}function removeRow(){if(_this.editType==="tile"){var contentArea=_this.querySelector("div.top-dashboard-content");var maxY=Math.ceil(contentArea.offsetHeight/(_this.gridSize.height+_this.gridMargin));var maxX=_this.renderTable[0].length}else{var maxX=_this.gridSize;var maxY=_this.gridSize}for(var i=_this.renderTable.length-1;i>=maxY;i--){for(var j=0;j<_this.renderTable[i].length;j++){if(_this.renderTable[i][j][0]===false){_this.__drawGrid();return}}if(j===maxX)_this.renderTable.splice(i,1)}_this.__drawGrid()}function removeColumn(){if(_this.editType==="tile"){var contentArea=_this.querySelector("div.top-dashboard-content");var maxY=Math.ceil(contentArea.offsetHeight/(_this.gridSize.height+_this.gridMargin));var maxX=_this.renderTable[0].length}else{var maxX=_this.gridSize;var maxY=_this.gridSize}for(var i=0;i<_this.renderTable.length;i++){for(var j=_this.renderTable[i].length-1;j>=maxX;j--){if(_this.renderTable[i][j][0]===false){_this.__drawGrid();return}}if(j===maxY){for(var k=0,length=_this.renderTable[i].length;k<length;k++){_this.renderTable[k].splice(_this.renderTable[k].length-1,1)}}}_this.__drawGrid()}function _setRenderTable(startX,startY,width,height,i){for(var y=startY;y<startY+height;y++){for(var x=startX;x<startX+width;x++){_this.renderTable[y][x]=[false,i]}}if(_this.editType==="brick"||_this.editType==="tile"){_this.nextCell.x=x}else if(_this.editType==="top-align"){for(var i=startX;i<startX+width;i++){_this.nextCell[i]=startY+height}}}function _reSetRenderTable(startX,startY,width,height){for(var y=startY;y<startY+height;y++){for(var x=startX;x<startX+width;x++){_this.renderTable[y][x]=[true,undefined]}}}function _emptyRenderTable(startX,startY,width,height){for(var y=startY;y<startY+height;y++){for(var x=startX;x<startX+width;x++){_this.renderTable[y][x]=[true,undefined]}}}function appendCardContents(data,cardBound,childId){var cardContent=cardBound.querySelector(".top-dashboard-card-content");_this.clearChilds(cardContent,true);_this.appendHtmlString(cardContent,data);if(childId&&cardContent.children[0]){cardContent.children[0].id=childId}else if(cardContent.children[0]&&cardContent.children[0].id){cardBound.childId=cardContent.children[0].id}for(var i=0;i<cardContent.children.length;i++){cardContent.children[i].layoutParent=_this}_this.addedChildrenParent=cardContent;TopRuntime._insertedNodesCallback();TopRuntime._srcRootNodesAttachedCallback()}function _resizeStart(e){_this.isResize=true;_this.selected.bfmWidth=_this.selected.style.width;_this.selected.bfmHeight=_this.selected.style.height;_this.selected.bfmRatioW=_this.selected.ratioWidth;_this.selected.bfmRatioH=_this.selected.ratioHeight;_this.selected.prevX=e.pageX;_this.selected.prevY=e.pageY;_this.selected.prevWidth=parseFloat(e.currentTarget.parentNode.offsetWidth);_this.selected.prevHeight=parseFloat(e.currentTarget.parentNode.offsetHeight);_this.isRight=true;_this.isBottom=true;if(this.classList.contains("resize-right")){_this.isBottom=false}else if(this.classList.contains("resize-bottom")){_this.isRight=false}_this.addEventListener("mousemove",_this._resizeMove);_this.addEventListener("mouseup",_this._resizeEnd)}if(this._resizeMove===undefined){this._resizeMove=function(e){if(_this.scrollH===undefined)_this.scrollH=_this.querySelector(".top-dashboard-content-layout").scrollTop;if(_this.scrollW===undefined)_this.scrollW=_this.querySelector(".top-dashboard-content-layout").scrollLeft;var scrollChangeY=_this.querySelector(".top-dashboard-content-layout").scrollTop-_this.scrollH;var scrollChangeX=_this.querySelector(".top-dashboard-content-layout").scrollLeft-_this.scrollW;if(_this.isRight){var movingValue=e.pageX-_this.selected.prevX;_this.selected.prevWidth+=movingValue;_this.selected.style.width=_this.selected.prevWidth+scrollChangeX+"px"}if(_this.isBottom){var movingValue=e.pageY-_this.selected.prevY;_this.selected.prevHeight+=movingValue;_this.selected.style.height=_this.selected.prevHeight+scrollChangeY+"px"}_this.selected.prevY=e.pageY;_this.selected.prevX=e.pageX;_drawPostCard(true);if(_this.editType==="tile"){var x=_this.showList[_this.selected.index].position.x;var y=_this.showList[_this.selected.index].position.y;var width=_adjustWidth(_this.selected.offsetWidth);var height=_adjustHeight(_this.selected.offsetHeight);if(width<=0)width=1;if(height<=0)height=1;for(var i=y;i<=y+height;i++){if(_this.renderTable.length<=i){addRow()}}for(var j=x;j<=x+width;j++){if(_this.renderTable[0].length<=j)addColumn()}}else{_this.showList[_this.selected.index].size.width=_adjustWidth(_this.selected.offsetWidth);_this.showList[_this.selected.index].size.height=_adjustHeight(_this.selected.offsetHeight);if(_this.editType==="brick"||_this.editType==="top-align"){_renderWhileResize()}}e.preventDefault()}}function _renderWhileResize(){_this.__initRenderTable();for(var i=0;i<_this.showList.length;i++){_setCardPosition(_this.querySelector("#"+_this.showList[i].id+".top-dashboard-card-bound.card_"+i),i)}if(_this.editType==="top-align"){_adjustIndex()}}function _renderWhileMove(){_this.__initRenderTable();for(var i=0;i<_this.showList.length;i++){if(_this.selected.index===i){var cardWidth=_this.showList[i].size.width;var cardHeight=_this.showList[i].size.height;if(_this.showList[i].position===undefined||_this.showList[i].position.x===undefined){_this.showList[i].position={x:0}}var x=_this.showList[i].position.x;while(!_validCardPosition(x,_this.nextCell[x],cardWidth,cardHeight)){_this.nextCell[x]++}_this.selected.postY=_this.nextCell[x];_setRenderTable(x,_this.nextCell[x],cardWidth,cardHeight,i);if(i===_this.showList.length-1&&_this.nextCell[x]+cardHeight<=_this.renderTable.length){removeRow()}}else{_setCardPosition(_this.querySelector("#"+_this.showList[i].id+".top-dashboard-card-bound.card_"+i),i)}}_adjustIndex()}function _adjustIndex(){var currentShowList=top$.extend(true,[],_this.showList);var currentShowMap=new Map;for(var i=0;i<currentShowList.length;i++){currentShowMap.set(i,currentShowList[i])}_this.showList=[];for(var i=0;i<_this.renderTable.length;i++){for(var j=0;j<_this.gridSize;j++){if(_this.renderTable[i][j][0]===false){var currentIndex=_this.renderTable[i][j][1];if(currentShowMap.has(currentIndex)){_this.showList.push(currentShowMap.get(currentIndex));var cardBound=_this.querySelector("#"+currentShowMap.get(currentIndex).id+".top-dashboard-card-bound.card_"+currentIndex);cardBound.classList.remove("card_"+currentIndex);cardBound.classList.add("card_"+_this.showList.indexOf(currentShowMap.get(currentIndex)));cardBound.index=_this.showList.indexOf(currentShowMap.get(currentIndex));currentShowMap.delete(currentIndex)}}}}}if(this._resizeEnd===undefined){this._resizeEnd=function(e){_this.isResize=false;_this.scrollH=undefined;_this.scrollW=undefined;if(_this.selected===undefined||_this.selected.classList.contains("top-dashboard-card-bound-ghost")){return}var width=_adjustWidth(_this.selected.offsetWidth);var height=_adjustHeight(_this.selected.offsetHeight);if(width<=0)width=1;if(height<=0)height=1;if(_this.isRight){_this.isRight=false;_this.selected.style.width=_getWidth(width,_this.selected)}if(_this.isBottom){_this.isBottom=false;_this.selected.style.height=_getHeight(height,_this.selected)}if(!_isValidY(_this.selected)||!_isValidX(_this.selected)||_this.querySelector("div.top-dashboard-card-overlap-feedback.overlaped")){_this.selected.style.height=_this.selected.bfmHeight;_this.selected.ratioHeight=_this.selected.bfmRatioH;_this.selected.style.width=_this.selected.bfmWidth;_this.selected.ratioWidth=_this.selected.bfmRatioW}var onCardSizeChange=_this.cardMap.get(_this.selected.id).onSizeChange;if(typeof onCardSizeChange==="string"){onCardSizeChange=Top.Util.namespace(onCardSizeChange,_this)}if(typeof onCardSizeChange==="function"){onCardSizeChange(_this,_this.selected)}if(_this.editType==="tile")_reSetRenderTable(_this.showList[_this.selected.index].position.x,_this.showList[_this.selected.index].position.y,_this.showList[_this.selected.index].size.width,_this.showList[_this.selected.index].size.height);_this.showList[_this.selected.index].size.width=_adjustWidth(_this.selected.offsetWidth);_this.showList[_this.selected.index].size.height=_adjustHeight(_this.selected.offsetHeight);_drawPostCard(false);if(_this.editType==="grid"){}else if(_this.editType==="brick"||_this.editType==="top-align"){_renderWhileResize()}else if(_this.editType==="tile"){_setRenderTable(_this.showList[_this.selected.index].position.x,_this.showList[_this.selected.index].position.y,_this.showList[_this.selected.index].size.width,_this.showList[_this.selected.index].size.height,_this.selected.index);removeRow();removeColumn()}}}function _adjustWidth(width){var _width=parseFloat(width);if(_this.editType==="tile"){var cellN=Math.round(_width/_this.gridSize.width)}else{var gridW=_this.querySelector(".top-dashboard-content").clientWidth;var cellW=gridW/_this.gridSize;var cellN=Math.round(_width/cellW)}return cellN}function _getWidth(cellN,card){if(_this.editType==="tile"){var _width=cellN*_this.gridSize.width+(cellN-1)*_this.gridMargin+"px"}else{var _width=cellN/_this.gridSize*100+"%";card.ratioWidth=cellN/_this.gridSize*100}return _width}function _adjustHeight(height){var _height=parseFloat(height);if(_this.editType==="tile"){var cellN=Math.round(_height/_this.gridSize.height)}else{var gridH=_this.querySelector(".top-dashboard-content").clientHeight;var cellH=gridH/_this.gridSize;var cellN=Math.round(_height/cellH)}return cellN}function _getHeight(cellN,card){if(_this.editType==="tile"){var _height=cellN*_this.gridSize.height+(cellN-1)*_this.gridMargin+"px"}else{var _height=cellN/_this.gridSize*100+"%";card.ratioHeight=cellN/_this.gridSize*100}return _height}function _moveStart(e){if(_this.selected===undefined||_this.isResize===true||e.currentTarget!==_this.selected)return;_this.selected.bfmTop=_this.selected.style.top;_this.selected.bfmLeft=_this.selected.style.left;_this.selected.bfmWidth=_this.selected.style.width;_this.selected.bfmHeight=_this.selected.style.height;_this.selected.prevX=e.pageX;_this.selected.prevY=e.pageY;_this.selected.prevTop=parseFloat(e.currentTarget.offsetTop);_this.selected.prevLeft=parseFloat(e.currentTarget.offsetLeft);_this.addEventListener("mousemove",_this._cardMove);_this.addEventListener("mouseup",_this._moveEnd);_drawGhostCard(true)}function _drawGhostCard(draw){if(_this.editType==="top-align"||_this.editType==="tile")return;var contentArea=_this.querySelector(".top-dashboard-content");var copy;if(draw){copy=document.createElement("div");copy.className=_this.editType+" top-dashboard-card-bound-ghost card_"+_this.selected.index+"-ghost";copy.innerHTML='<div class="top-dashboard-card"></div>';copy.style.top=_this.selected.style.top;copy.style.left=_this.selected.style.left;copy.style.width=_this.selected.style.width;copy.style.height=_this.selected.style.height;contentArea.appendChild(copy)}else{copy=_this.querySelector(".top-dashboard-card-bound-ghost.card_"+_this.selected.index+"-ghost");if(copy!==null)contentArea.removeChild(copy)}}function _drawPostCard(draw){var contentArea=_this.querySelector(".top-dashboard-content");if(_this.editType==="top-align"){if(draw){var left=_adjustXPosition(_this.selected.offsetLeft);if(_this.isResize===true)var top=_adjustYPosition(_this.selected.offsetTop);else var top=_this.selected.postY;var width=_adjustWidth(_this.selected.offsetWidth);var height=_adjustHeight(_this.selected.offsetHeight);if(left<0)left=0;if(left+width>_this.gridSize){if(_this.isResize===true)width=_this.gridSize-left;else left=_this.gridSize-width}if(top<0)top=0;contentArea.querySelectorAll("div.top-dashboard-content-grid-tile.hover").forEach(function(tile){tile.classList.remove("hover")});for(var i=top;i<top+height;i++){if(contentArea.querySelector("tr.top-dashboard-content-grid-row.row_"+i)){var row_childs=contentArea.querySelector("tr.top-dashboard-content-grid-row.row_"+i).children;for(var j=left;j<left+width;j++){row_childs[j].firstElementChild.classList.add("hover")}}}}else{contentArea.querySelectorAll("div.top-dashboard-content-grid-tile.hover").forEach(function(tile){tile.classList.remove("hover")})}}else if(_this.editType==="tile"){if(draw){var left=_adjustXPosition(_this.selected.offsetLeft);var top=_adjustYPosition(_this.selected.offsetTop);var width=_adjustWidth(_this.selected.offsetWidth);var height=_adjustHeight(_this.selected.offsetHeight);if(left<0)left=0;if(top<0)top=0;contentArea.querySelectorAll("div.top-dashboard-content-grid-tile.hover").forEach(function(tile){tile.classList.remove("hover")});_this.querySelectorAll(".top-dashboard-card-bound").forEach(function(card){if(card.overlapFeedback)card.overlapFeedback.classList.remove("overlaped")});for(var i=top;i<top+height;i++){if(contentArea.querySelector("tr.top-dashboard-content-grid-row.row_"+i)){var row_childs=contentArea.querySelector("tr.top-dashboard-content-grid-row.row_"+i).children;for(var j=left;j<left+width;j++){row_childs[j].firstElementChild.classList.add("hover");if(_this.renderTable[i][j][0]===false&&_this.renderTable[i][j][1]!==_this.selected.index){_this.querySelector("div.top-dashboard-card-bound.card_"+_this.renderTable[i][j][1]).overlapFeedback.classList.add("overlaped")}}}}}else{contentArea.querySelectorAll("div.top-dashboard-content-grid-tile.hover").forEach(function(tile){tile.classList.remove("hover")});_this.querySelectorAll(".top-dashboard-card-bound").forEach(function(card){card.overlapFeedback.classList.remove("overlaped")})}}else{var copy=_this.querySelector(".top-dashboard-card-bound-post");if(draw){if(copy===null){copy=document.createElement("div");copy.className=_this.editType+" top-dashboard-card-bound-post";copy.innerHTML='<div class="top-dashboard-card"></div>';copy.style.top=_this.selected.style.top;copy.style.left=_this.selected.style.left;copy.style.width=_this.selected.style.width;copy.style.height=_this.selected.style.height;copy.ratioWidth=_this.selected.ratioWidth;copy.ratioHeight=_this.selected.ratioHeight;copy.ratioX=_this.selected.ratioX;copy.ratioY=_this.selected.ratioY;contentArea.appendChild(copy)}if(_this.editType==="brick"){if(_this.isResize){copy.style.width=_getWidth(_adjustWidth(_this.selected.offsetWidth),copy);copy.style.height=_getHeight(_adjustHeight(_this.selected.offsetHeight),copy);if(!_isValidX(copy)||!_isValidY(copy)){copy.style.width=_this.selected.bfmWidth;copy.style.height=_this.selected.bfmHeight}}else{if(_this.selected.movingIndex>=_this.showList.length){if(_this.selected.movingIndex===0){copy.style.left=_getXPosition(0,copy);copy.style.top=_getYPosition(0,copy)}else if(_this.selected.index===undefined){var cardWidth=_this.defaultCardSize.width;var cardHeight=_this.defaultCardSize.height;var nextX=_this.nextCell.x;var nextY=_this.nextCell.y;while(!_validCardPosition(nextX,nextY,cardWidth,cardHeight)){if(nextX+cardWidth>_this.gridSize){nextX=0;nextY++}else{nextX++}}copy.style.left=_getXPosition(nextX,copy);copy.style.top=_getYPosition(nextY,copy)}else{contentArea.removeChild(copy)}}else{contentArea.removeChild(copy)}}}else if(_this.editType==="grid"){copy.style.left=_getXPosition(_adjustXPosition(_this.selected.offsetLeft),copy);copy.style.top=_getYPosition(_adjustYPosition(_this.selected.offsetTop),copy);copy.style.width=_getWidth(_adjustWidth(_this.selected.offsetWidth),copy);copy.style.height=_getHeight(_adjustHeight(_this.selected.offsetHeight),copy);if(!_isValidX(copy)||!_isValidY(copy)){copy.style.left=_this.selected.bfmLeft;copy.style.top=_this.selected.bfmTop;copy.style.width=_this.selected.bfmWidth;copy.style.height=_this.selected.bfmHeight}}}else{if(copy===null)return;contentArea.removeChild(copy)}}}if(this._addedCardMoveStart===undefined){this._addedCardMoveStart=function(){var addedGhostCard=document.createElement("div");addedGhostCard.className=_this.editType+" top-dashboard-card-bound-ghost added-card";addedGhostCard.innerHTML='<div class="top-dashboard-card"></div>';addedGhostCard.style.width=_getWidth(_this.defaultCardSize.width,addedGhostCard);addedGhostCard.style.height=_getHeight(_this.defaultCardSize.height,addedGhostCard);this.selected=addedGhostCard}}if(this._cardMove===undefined){this._cardMove=function(e){if(_this.selected===undefined||_this.isResize===true)return;if(_this.selected.classList.contains("top-dashboard-card-bound-ghost")&&!_this.selected.classList.contains("top-dashboard-card-bound")&&_this.selected.prevX===undefined&&_this.selected.prevY===undefined){_this.querySelector(".top-dashboard-content").appendChild(_this.selected);if(_this.scrollH===undefined)_this.scrollH=_this.querySelector(".top-dashboard-content-layout").scrollTop;if(_this.scrollW===undefined)_this.scrollW=_this.querySelector(".top-dashboard-content-layout").scrollLeft;_this.selected.prevX=e.pageX;_this.selected.prevY=e.pageY;
_this.selected.style.top=e.offsetY-_this.selected.offsetHeight/2+_this.scrollH+"px";_this.selected.style.left=e.offsetX-_this.selected.offsetWidth/2+_this.scrollW+"px";_this.selected.prevTop=e.offsetY-_this.selected.offsetHeight/2+_this.scrollH;_this.selected.prevLeft=e.offsetX-_this.selected.offsetWidth/2+_this.scrollW;if(_this.editType==="top-align"){var newItem={id:_this.addedCardId,size:_this.defaultCardSize,position:{}};var x=_adjustXPosition(_this.selected.prevLeft);var y=_adjustYPosition(_this.selected.prevTop);if(x<0)x=0;if(x+_this.defaultCardSize.width>_this.gridSize){x=_this.gridSize-_this.defaultCardSize.width}if(y<0)y=0;if(_this.renderTable[y][x]!==undefined&&_this.renderTable[y][x][0]===false){for(var i=_this.renderTable[y][x][1];i<_this.showList.length;i++){var id=_this.showList[i].id;var cardBound=_this.querySelector("#"+id+".top-dashboard-card-bound.card_"+i);cardBound.index=i+1;cardBound.className=_this.editType+" top-dashboard-card-bound card_"+cardBound.index}_this.showList.splice(_this.renderTable[y][x][1],0,newItem);_this.selected.index=_this.renderTable[y][x][1];_this.selected.classList.add("card_"+_this.selected.index)}else{_this.showList.push(newItem);_this.selected.index=_this.showList.length-1;_this.selected.classList.add("card_"+_this.selected.index)}_this.showMap.set(_this.addedCardId,newItem);_this.selected.id=_this.addedCardId;_this.selected.classList.add("top-dashboard-card-bound")}else if(_this.editType==="tile"){if(_this.renderTable.length!==_this.y_length){_this.__initRenderTable();for(var i=0;i<_this.showList.length;i++){_setRenderTable(_this.showList[i].position.x,_this.showList[i].position.y,_this.showList[i].size.width,_this.showList[i].size.height,i)}}var newItem={id:_this.addedCardId,size:_this.defaultCardSize,position:{}};var x=_adjustXPosition(_this.selected.prevLeft);var y=_adjustYPosition(_this.selected.prevTop);if(x<0)x=0;if(y<0)y=0;_this.showList.push(newItem);_this.selected.index=_this.showList.length-1;_this.selected.classList.add("card_"+_this.selected.index);_this.showMap.set(_this.addedCardId,newItem);_this.selected.id=_this.addedCardId;_this.selected.classList.add("top-dashboard-card-bound");return}_renderWhileMove()}else{var movingXValue=e.pageX-_this.selected.prevX;var movingYValue=e.pageY-_this.selected.prevY;if(_this.scrollH===undefined)_this.scrollH=_this.querySelector(".top-dashboard-content-layout").scrollTop;if(_this.scrollW===undefined)_this.scrollW=_this.querySelector(".top-dashboard-content-layout").scrollLeft;var scrollChangeY=_this.querySelector(".top-dashboard-content-layout").scrollTop-_this.scrollH;var scrollChangeX=_this.querySelector(".top-dashboard-content-layout").scrollLeft-_this.scrollW;_this.selected.prevTop+=movingYValue;_this.selected.prevLeft+=movingXValue;_this.selected.style.top=_this.selected.prevTop+scrollChangeY+"px";_this.selected.style.left=_this.selected.prevLeft+scrollChangeX+"px";_this.selected.prevY=e.pageY;_this.selected.prevX=e.pageX;if(this.editType==="brick"){var x=_adjustXPosition(e.clientX-_this.querySelector(".top-dashboard-content").getBoundingClientRect().left+_this.scrollW);var y=_adjustYPosition(e.clientY-_this.querySelector(".top-dashboard-content").getBoundingClientRect().top+_this.scrollH);_this.selected.movingIndex=_this.selected.index;if(y<0||x<0||x>=12||_this.renderTable[y]===undefined||_this.renderTable[y][x]===undefined)return;if(_this.renderTable[y][x][0]===true){if(_this.renderTable[y][x][1]===undefined){_this.selected.movingIndex=_this.showList.length}else{_this.selected.movingIndex=_this.renderTable[y][x][1]+1}_turnOnGuide(_this.selected.movingIndex-1,"after")}else{if(_this.renderTable[y][x][1]===_this.selected.index){_this.selected.movingIndex=_this.renderTable[y][x][1]}else{var under=_this.querySelector(".top-dashboard-card-bound.card_"+_this.renderTable[y][x][1]).getBoundingClientRect();var over=_this.selected.getBoundingClientRect();if(under.width/2+under.left>over.width/2+over.left){_this.selected.movingIndex=_this.renderTable[y][x][1];_turnOnGuide(_this.renderTable[y][x][1],"before")}else{_this.selected.movingIndex=_this.renderTable[y][x][1]+1;_turnOnGuide(_this.renderTable[y][x][1],"after")}}}_drawPostCard(true)}else if(_this.editType==="top-align"){var left=_getXCellPosition(_this.selected.offsetLeft);var top=_getYCellPosition(_this.selected.offsetTop);var width=_this.showList[_this.selected.index].size.width;var height=_this.showList[_this.selected.index].size.height;if(left<0)left=0;if(left+width>_this.gridSize){if(_this.isResize===true)width=_this.gridSize-left;else left=_this.gridSize-width}if(top<0)top=0;_this.showList[_this.selected.index].position.x=left;var x=_adjustXPosition(e.clientX-_this.querySelector(".top-dashboard-content").getBoundingClientRect().left+_this.scrollW);var y=_adjustYPosition(e.clientY-_this.querySelector(".top-dashboard-content").getBoundingClientRect().top+_this.scrollH);if(_this.renderTable[y][x]!==undefined&&_this.renderTable[y][x][0]===false){var selectedIndex=_this.selected.index;if(selectedIndex!==_this.renderTable[y][x][1]){for(var i=0;i<_this.showList.length;i++){var id=_this.showList[i].id;var cardBound=_this.querySelector("#"+id+".top-dashboard-card-bound.card_"+i);if(_this.renderTable[y][x][1]<selectedIndex){if(i<_this.renderTable[y][x][1]){continue}else if(i>=_this.renderTable[y][x][1]&&i<selectedIndex){var index=i+1}else if(i==selectedIndex){var index=_this.renderTable[y][x][1]}else{continue}}else if(_this.renderTable[y][x][1]>selectedIndex){if(i<selectedIndex){continue}else if(i==selectedIndex){var index=_this.renderTable[y][x][1]}else if(i<=_this.renderTable[y][x][1]&&i>selectedIndex){var index=i-1}else{continue}}else{break}if(cardBound.classList.contains("top-dashboard-card-bound-ghost")){cardBound.className=_this.editType+" top-dashboard-card-bound-ghost added-card top-dashboard-card-bound card_"+index}else{cardBound.className=_this.editType+" top-dashboard-card-bound card_"+index}if(_this.selected===cardBound){cardBound.classList.add("select")}cardBound.index=index}var copy=_this.showList[selectedIndex];_this.showList.splice(selectedIndex,1);_this.showList.splice(_this.renderTable[y][x][1],0,copy)}}_renderWhileMove();_drawPostCard(true)}else if(_this.editType==="tile"){var left=_getXCellPosition(_this.selected.offsetLeft);var top=_getYCellPosition(_this.selected.offsetTop);var width=_this.showList[_this.selected.index].size.width;var height=_this.showList[_this.selected.index].size.height;if(left<0)left=0;if(top<0)top=0;var x=_adjustXPosition(e.clientX-_this.querySelector(".top-dashboard-content").getBoundingClientRect().left+_this.scrollW);var y=_adjustYPosition(e.clientY-_this.querySelector(".top-dashboard-content").getBoundingClientRect().top+_this.scrollH);for(var i=y;i<y+height;i++){if(_this.renderTable.length<=i){addRow()}}for(var j=x;j<x+width;j++){if(_this.renderTable[0].length<=j)addColumn()}_drawPostCard(true)}else if(_this.editType==="grid"){var x=_getXCellPosition(_this.selected.offsetLeft);var y=_getYCellPosition(_this.selected.offsetTop);var width=_this.showList[_this.selected.index].size.width;var height=_this.showList[_this.selected.index].size.height;for(var i=y;i<y+height;i++){if(_this.renderTable.length<=i)addRow()}var overlapedIndex=_getNearestCard();if(overlapedIndex[0]<0){_drawPostCard(true);_this.querySelectorAll(".top-dashboard-card-position-guide").forEach(function(card){card.classList.remove("on")})}else{_drawPostCard(false);_turnOnGuide(overlapedIndex[0],overlapedIndex[1].direction)}}}e.preventDefault()}}function _getNearestCard(){var overlapedCards=new Map;var nearestIndex=-1;var selectedX=_this.selected.offsetLeft;var selectedY=_this.selected.offsetTop;var selectedW=_this.selected.offsetWidth;var selectedH=_this.selected.offsetHeight;var selectedCenterX=selectedX+selectedW/2;var selectedCenterY=selectedY+selectedH/2;var x=_getXCellPosition(selectedX);var y=_getYCellPosition(selectedY);if(x<0)x=0;if(y<0)y=0;for(var i=y;i<=_getYCellPosition(selectedY+selectedH);i++){for(var j=x;j<_getXCellPosition(selectedX+selectedW);j++){if(j===12||_this.renderTable[i]===undefined)break;if(_this.renderTable[i][j][0]===false&&_this.renderTable[i][j][1]!==_this.selected.index&&!overlapedCards.has(_this.renderTable[i][j][1])){var card=_this.querySelector(".top-dashboard-card-bound.card_"+_this.renderTable[i][j][1]);var cardCenterX=card.offsetLeft+card.offsetWidth/2;var cardCenterY=card.offsetTop+card.offsetHeight/2;var distance=Math.pow(Math.abs(cardCenterX-selectedCenterX),2)+Math.pow(Math.abs(cardCenterY-selectedCenterY),2);var slop=Math.abs((cardCenterY-card.offsetTop)/(cardCenterX-card.offsetLeft));var slopBtwCards=Math.abs((cardCenterY-selectedCenterY)/(cardCenterX-selectedCenterX));if(slop<slopBtwCards){if(cardCenterY>selectedCenterY){var direction="top"}else{var direction="bottom"}}else{if(cardCenterX>selectedCenterX){var direction="left"}else{var direction="right"}}overlapedCards.set(_this.renderTable[i][j][1],{distance:distance,direction:direction})}}}var minDisatnce;overlapedCards.forEach(function(value,key){if(minDisatnce===undefined||minDisatnce>value.distance){minDisatnce=value.distance;nearestIndex=key}});return[nearestIndex,overlapedCards.get(nearestIndex)]}function _turnOnGuide(index,position){_this.querySelectorAll(".top-dashboard-card-position-guide").forEach(function(card){card.classList.remove("on")});if(_this.selected.index===index||index<0)return;if(_this.querySelector(".top-dashboard-card-bound.card_"+index+" .top-dashboard-card-position-guide."+position))_this.querySelector(".top-dashboard-card-bound.card_"+index+" .top-dashboard-card-position-guide."+position).classList.add("on")}if(this._addedEnd===undefined){this._addedEnd=function(e){if(this.addedCardId===undefined){return}_this.querySelectorAll(".top-dashboard-card-position-guide").forEach(function(card){card.classList.remove("on")});var left=_adjustXPosition(_this.selected.offsetLeft);var top=_adjustYPosition(_this.selected.offsetTop);if(left<0)left=0;if(top<0)top=0;var addedGhostCard=Top.App.getCurrentPage().template.querySelector("div.top-dashboard-card-bound-ghost.added-card");if(addedGhostCard){addedGhostCard.parentNode.removeChild(addedGhostCard)}_drawPostCard(false);if(_this.editType==="brick"){if(_this.selected===undefined||_this.selected.movingIndex===undefined||_this.selected.movingIndex<0||!_this.selected.classList.contains("top-dashboard-card-bound-ghost"))return;var i=_this.selected.movingIndex;var item={id:_this.addedCardId};_this.showList.splice(i,0,item);_this.showMap.set(_this.addedCardId,item);_this.querySelectorAll(".top-dashboard-card-bound").forEach(function(card){if(card.index>=i){card.classList.remove("card_"+card.index);card.index=card.index+1;card.classList.add("card_"+card.index)}});var cardInfo=_this.cardMap.get(_this.addedCardId);var cardBound=createCard(i);if(cardInfo.html!==undefined){if(Top.Util.getFileExtension(cardInfo.html)==="html"){top$.ajax(cardInfo.html,{success:function(data){appendCardContents(data,cardBound)}})}else{appendCardContents(cardInfo.html,cardBound)}}_this.querySelector(".top-dashboard-content").appendChild(cardBound);_renderWhileResize()}else if(_this.editType==="top-align"){if(_this.selected===undefined||!_this.selected.classList.contains("top-dashboard-card-bound-ghost")&&_this.selected.classList.contains("top-dashboard-card-bound"))return;var i=_this.selected.index;var cardInfo=_this.cardMap.get(_this.addedCardId);var cardBound=createCard(i);if(cardInfo.html!==undefined){if(Top.Util.getFileExtension(cardInfo.html)==="html"){top$.ajax(cardInfo.html,{success:function(data){appendCardContents(data,cardBound)}})}else{appendCardContents(cardInfo.html,cardBound)}}_this.querySelector(".top-dashboard-content").appendChild(cardBound);_renderWhileResize()}else if(_this.editType==="tile"){if(_this.selected===undefined||!_this.selected.classList.contains("top-dashboard-card-bound-ghost")&&_this.selected.classList.contains("top-dashboard-card-bound"))return;var i=_this.selected.index;var cardInfo=_this.cardMap.get(_this.addedCardId);var cardBound=createCard(i);if(cardInfo.html!==undefined){if(Top.Util.getFileExtension(cardInfo.html)==="html"){top$.ajax(cardInfo.html,{success:function(data){appendCardContents(data,cardBound)}})}else{appendCardContents(cardInfo.html,cardBound)}}_this.querySelector(".top-dashboard-content").appendChild(cardBound);cardBound.style.left=_getXPosition(left,_this.selected);cardBound.style.top=_getYPosition(top,_this.selected);if(_this.renderTable[top][left][0]===false&&_this.renderTable[top][left][1]!==_this.selected.index){_setEmptyPosition(cardBound)}_this.showList[_this.selected.index].position.x=_getXCellPosition(cardBound.offsetLeft);_this.showList[_this.selected.index].position.y=_getYCellPosition(cardBound.offsetTop);_setRenderTable(_this.showList[_this.selected.index].position.x,_this.showList[_this.selected.index].position.y,_this.showList[_this.selected.index].size.width,_this.showList[_this.selected.index].size.height,_this.selected.index);removeRow();removeColumn()}_this.selected=undefined;_this.addedCardId=undefined}}if(this._moveEnd===undefined){this._moveEnd=function(e){if(_this.selected===undefined||_this.isResize===true){_this.isResize=false;return}_this.querySelectorAll(".top-dashboard-card-position-guide").forEach(function(card){card.classList.remove("on")});_this.scrollH=undefined;_this.scrollW=undefined;_drawGhostCard(false);if(_this.editType==="brick"){_drawPostCard(false);if(!Top.Util.__isBooleanTrue(this.dupcardAllowed)){if(_this.selected.movingIndex<_this.selected.index){var copy=_this.showList[_this.selected.index];_this.showList.splice(_this.selected.index,1);_this.showList.splice(_this.selected.movingIndex,0,copy)}else if(_this.selected.movingIndex>_this.selected.index){var copy=_this.showList[_this.selected.index];_this.showList.splice(_this.selected.index,1);_this.showList.splice(_this.selected.movingIndex-1,0,copy)}for(var i=0;i<_this.showList.length;i++){var id=_this.showList[i].id;var cardInfo=_this.cardMap.get(id);var cardBound=_this.querySelector("#"+id+".top-dashboard-card-bound");cardBound.className=_this.editType+" top-dashboard-card-bound card_"+i;if(_this.selected===cardBound){cardBound.classList.add("select")}cardBound.index=i}}else{var selectedIndex=_this.selected.index;for(var i=0;i<_this.showList.length;i++){var id=_this.showList[i].id;var cardBound=_this.querySelector("#"+id+".top-dashboard-card-bound.card_"+i);if(_this.selected.movingIndex<selectedIndex){if(i<_this.selected.movingIndex){continue}else if(i>=_this.selected.movingIndex&&i<selectedIndex){var index=i+1}else if(i==selectedIndex){var index=_this.selected.movingIndex}else{continue}}else if(_this.selected.movingIndex>selectedIndex){if(i<selectedIndex){continue}else if(i==selectedIndex){var index=_this.selected.movingIndex-1}else if(i<_this.selected.movingIndex&&i>selectedIndex){var index=i-1}else{continue}}else{break}cardBound.className=_this.editType+" top-dashboard-card-bound card_"+index;if(_this.selected===cardBound){cardBound.classList.add("select")}cardBound.index=index}if(_this.selected.movingIndex<selectedIndex){var copy=_this.showList[selectedIndex];_this.showList.splice(selectedIndex,1);_this.showList.splice(_this.selected.movingIndex,0,copy)}else if(_this.selected.movingIndex>selectedIndex){var copy=_this.showList[selectedIndex];_this.showList.splice(selectedIndex,1);_this.showList.splice(_this.selected.movingIndex-1,0,copy)}}_renderWhileResize()}else if(_this.editType==="top-align"){_drawPostCard(false)}else if(_this.editType==="tile"){_drawPostCard(false);var left=_adjustXPosition(_this.selected.offsetLeft);var top=_adjustYPosition(_this.selected.offsetTop);if(left<0)left=0;if(top<0)top=0;_this.selected.style.left=_getXPosition(left,_this.selected);_this.selected.style.top=_getYPosition(top,_this.selected);if(_this.renderTable[top][left][0]===false&&_this.renderTable[top][left][1]!==_this.selected.index){_this.selected.style.left=_this.selected.bfmLeft;_this.selected.style.top=_this.selected.bfmTop}_emptyRenderTable(_this.showList[_this.selected.index].position.x,_this.showList[_this.selected.index].position.y,_this.showList[_this.selected.index].size.width,_this.showList[_this.selected.index].size.height);_this.showList[_this.selected.index].position.x=_getXCellPosition(_this.selected.offsetLeft);_this.showList[_this.selected.index].position.y=_getYCellPosition(_this.selected.offsetTop);_setRenderTable(_this.showList[_this.selected.index].position.x,_this.showList[_this.selected.index].position.y,_this.showList[_this.selected.index].size.width,_this.showList[_this.selected.index].size.height,_this.selected.index);removeRow();removeColumn()}else if(_this.editType==="grid"){_drawPostCard(false);_this.selected.style.left=_getXPosition(_adjustXPosition(_this.selected.offsetLeft),_this.selected);_this.selected.style.top=_getYPosition(_adjustYPosition(_this.selected.offsetTop),_this.selected);if(!_isValidX(_this.selected)||!_isValidY(_this.selected)){_this.selected.style.left=_this.selected.bfmLeft;_this.selected.ratioX=_this.selected.bfmRatioX;_this.selected.style.top=_this.selected.bfmTop;_this.selected.ratioY=_this.selected.bfmRatioY}for(var y=_adjustYPosition(_this.selected.offsetTop);y<_adjustYPosition(_this.selected.offsetTop)+_this.showList[_this.selected.index].size.height;y++){if(_this.renderTable.length<=y)addRow()}_emptyRenderTable(_this.showList[_this.selected.index].position.x,_this.showList[_this.selected.index].position.y,_this.showList[_this.selected.index].size.width,_this.showList[_this.selected.index].size.height);_this.showList[_this.selected.index].position.x=_getXCellPosition(_this.selected.offsetLeft);_this.showList[_this.selected.index].position.y=_getYCellPosition(_this.selected.offsetTop);_setRenderTable(_this.showList[_this.selected.index].position.x,_this.showList[_this.selected.index].position.y,_this.showList[_this.selected.index].size.width,_this.showList[_this.selected.index].size.height,_this.selected.index);if(_this.renderTable.length>_this.gridSize)removeRow()}}}function _getXCellPosition(x){var _x=parseFloat(x);var gridW=_this.querySelector(".top-dashboard-content").clientWidth;if(_this.editType==="tile"){var cellW=_this.gridSize.width+_this.gridMargin;var cardX=Math.round(_x/cellW)}else{var cellW=gridW/_this.gridSize;var cardX=Math.floor(_x/cellW)}return cardX}function _adjustXPosition(x){var _x=parseFloat(x);var gridW=_this.querySelector(".top-dashboard-content").clientWidth;if(_this.editType==="tile")var cellW=_this.gridSize.width+_this.gridMargin;else var cellW=gridW/_this.gridSize;if(_this.editType==="grid"||_this.editType==="top-align"||_this.editType==="tile"){var cardX=Math.round(_x/cellW)}else{var cardX=Math.floor(_x/cellW)}return cardX}function _getXPosition(cardX,card){if(_this.editType==="tile"){var _x=cardX*(_this.gridSize.width+_this.gridMargin)+"px"}else{var _x=cardX/_this.gridSize*100+"%";card.ratioX=cardX/_this.gridSize*100}return _x}function _getYCellPosition(y){var _y=parseFloat(y);var gridH=_this.querySelector(".top-dashboard-content").clientHeight;if(_this.editType==="tile"){var cellH=_this.gridSize.height+_this.gridMargin;var cardY=Math.round(_y/cellH)}else{var cellH=gridH/_this.gridSize;var cardY=Math.floor(_y/cellH)}return cardY}function _adjustYPosition(y){var _y=parseFloat(y);var gridH=_this.querySelector(".top-dashboard-content").clientHeight;if(_this.editType==="tile")var cellH=_this.gridSize.height+_this.gridMargin;else var cellH=gridH/_this.gridSize;if(_this.editType==="grid"||_this.editType==="top-align"||_this.editType==="tile"){var cardY=Math.round(_y/cellH)}else{var cardY=Math.floor(_y/cellH)}return cardY}function _getYPosition(cardY,card){if(_this.editType==="tile"){var _y=cardY*(_this.gridSize.height+_this.gridMargin)+"px"}else{var _y=cardY/_this.gridSize*100+"%";card.ratioY=cardY/_this.gridSize*100}return _y}function _isValidX(card){if(card.ratioX<0)return false;if(card.ratioWidth<0||card.ratioWidth>100)return false;if(_this.editType==="grid"){if(card.ratioX+card.ratioWidth>100)return false}return true}function _isValidY(card){if(card.ratioY<0)return false;if(card.ratioHeight<0)return false;return true}},initializeHtmlObjects:function(child){if(!child.children)return;if(child.tagName==="TOP-TABLEVIEW"||child.tagName==="TOP-LISTVIEW"||child.tagName==="TOP-TREEVIEW"||child.tagName==="TOP-TABLAYOUT")return;for(var i=0;i<child.children.length;i++){if(child.children[i].tagName&&TopRuntime.topWidgets[child.children[i].tagName.toLowerCase()]!==undefined){var topWidget=TopRuntime.topWidgets[child.children[i].tagName.toLowerCase()];TopRuntime._initProperties(topWidget,child.children[i]);TopRuntime._prepAllBehaviors(topWidget,child.children[i]);if(!child.children[i].isTemplateAppended())child.children[i].appendTemplate();TopRuntime.insertedNodes.push(child.children[i])}this.initializeHtmlObjects(child.children[i])}},clearChilds:function(content,directDetach){if(content.childRoot)var myNode=content.childRoot;else var myNode=content;while(myNode.firstChild){this.clearDeepChilds(myNode.firstChild,directDetach);if(directDetach===true&&myNode.firstChild.tagName&&TopRuntime.topWidgets[myNode.firstChild.tagName.toLowerCase()]!==undefined){TopRuntime.directDetachedNodes.push(myNode.firstChild)}top$(myNode.firstChild).remove()}if(directDetach===true)TopRuntime._directDetachNodesDetachedCallback()},clearDeepChilds:function(parentNode,directDetach){while(parentNode.firstChild){while(parentNode.firstChild.firstChild){this.clearDeepChilds(parentNode.firstChild)}if(directDetach===true&&parentNode.firstChild.tagName&&TopRuntime.topWidgets[parentNode.firstChild.tagName.toLowerCase()]!==undefined){TopRuntime.directDetachedNodes.push(parentNode.firstChild)}top$(parentNode.firstChild).remove()}},appendHtmlString:function(cardContent,data){var wrapper=document.createElement("div");wrapper.innerHTML=data;this.initializeHtmlObjects(wrapper);while(wrapper.firstChild){if(wrapper.firstChild.tagName&&TopRuntime.topWidgets[wrapper.firstChild.tagName.toLowerCase()]!==undefined)TopRuntime.srcRootNode.push(wrapper.firstChild);if(cardContent.childRoot)cardContent.childRoot.appendChild(wrapper.firstChild);else cardContent.appendChild(wrapper.firstChild)}},__getNewDupcardId:function(id){var count=0;for(var i=0;i<this.showList.length;i++){if(this.showList[i].id===id){count++}}var newId=id+"_"+count;return newId},__addCardToShowList:function(id,childId){if(!Top.Util.__isBooleanTrue(this.dupcardAllowed)&&this.showMap.has(id))return;if(Top.Util.__isBooleanTrue(this.dupcardAllowed))var childId=childId?childId:this.__getNewDupcardId(id);var item={id:id,childId:childId};this.showList.splice(0,0,item);this.showMap.set(id,item);var appendedCards=this.querySelectorAll(".top-dashboard-card-bound");for(var i=0;i<appendedCards.length;i++){var index=appendedCards[i].index+1;appendedCards[i].className=this.editType+" top-dashboard-card-bound card_"+index;appendedCards[i].index=index}this.__renderCards(true)},__startDragToAddCard:function(id){this.addedCardId=id;this.unSelectAllCards();this._addedCardMoveStart();this.addEventListener("mousemove",this._cardMove);this.addEventListener("mouseup",this._addedEnd)},__updateHeaderTitle:function(){if(this.headerTitle!==undefined)this.titleTag.value=this.headerTitle},__updateCardList:function(){this.cardMap=new Map;for(var i=0;i<this.cardList.length;i++){this.cardMap.set(this.cardList[i].id,this.cardList[i])}},__updateShowList:function(){this.showMap=new Map;for(var i=0;i<this.showList.length;i++){this.showMap.set(this.showList[i].id,this.showList[i])}this.__renderCards(true)},__updateCustomEmptyLayout:function(){var _this=this;if(this.customEmptyLayout!==undefined){if(Top.Util.getFileExtension(this.customEmptyLayout)==="html"){var customLayout=this.querySelector("div.top-dashboard-content-layout-custom");customLayout.style.display="block";top$.ajax(this.customEmptyLayout,{success:function(data){_this.clearChilds(customLayout,true);_this.appendHtmlString(customLayout,data);for(var i=0;i<customLayout.children.length;i++){customLayout.children[i].layoutParent=_this}TopRuntime._insertedNodesCallback();TopRuntime._srcRootNodesAttachedCallback()}})}}},__updateCustomizeEditmode:function(){var contentLayout=this.querySelector("div.top-dashboard-content-layout");var header=this.querySelector(".top-dashboard-edit-mode-header");var footer=this.querySelector(".top-dashboard-edit-mode-footer");if(Top.Util.__isBooleanTrue(this.customizeEditmode)){if(header)this.querySelector(".top-dashboard-edit-mode-header").remove();if(footer)this.querySelector(".top-dashboard-edit-mode-footer").remove();contentLayout.style.height="calc(100%)"}else{if(!header&&!footer)this.__createEditMode();var titleAreaHeight=this.querySelector("div.top-dashboard-edit-mode-header").offsetHeight;if(titleAreaHeight===0)titleAreaHeight=40;contentLayout.style.height="calc(100% - "+titleAreaHeight+"px)"}},__updateEditButtonText:function(){this.editButton.innerText=this.editButtonText},__updateAddButtonText:function(){this.addButton.innerText=this.addButtonText},__showCustomEmptyLayout:function(){var customLayout=this.querySelector("div.top-dashboard-content-layout-custom");if(this.showList.length===0&&this.editModeIsOn===false&&this.customEmptyLayout){customLayout.style.display="block";var layouts=customLayout.querySelectorAll('top-linearlayout:not([orientation="vertical"])');if(layouts){for(var i=0;i<layouts.length;i++){if(layouts[i].__isAttached&&typeof layouts[i].__setLineHeight==="function"&&layouts[i].id){layouts[i].__setLineHeight()}}}}else{customLayout.style.display="none"}},__setCardTitle:function(cardBound,titleString){if(titleString){if(cardBound.titleArea===undefined){cardBound.titleArea=document.createElement("div");cardBound.titleArea.className="top-dashboard-card-title";cardBound.cardArea.insertBefore(cardBound.titleArea,cardBound.contentArea)}cardBound.titleArea.innerHTML="<span>"+titleString+"</span>"}},__detached:function(){window.removeEventListener("resize",this.resizeFunc)},getTopStyle:function(){this.topstyle=this.querySelector(".top-dashboard-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-dashboard-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-dashboard-root").style.cssText=this.topstyle}};Top.Widget.Dashboard=function(){Dashboard.prototype=Object.create(Top.Widget.prototype);Dashboard.prototype.constructor=Dashboard;function Dashboard(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-dashboard");this.template.innerHTML='<div class="top-dashboard-root"><div class="top-dashboard-content-layout"><div class="top-dashboard-content"></div><div class="top-dashboard-content-layout-custom"></div></div></div>'}this.id=this.template.id}Dashboard.create=function(element){return new Dashboard(element)};Dashboard.prototype.editModeOn=function(){this.template.__setEditModeOn()};Dashboard.prototype.editModeOff=function(){this.template.unSelectAllCards();this.template.__editModeOn(false)};Dashboard.prototype.isEditModeOn=function(){return this.template.editModeIsOn};Dashboard.prototype.openCardListDialog=function(){this.template.__openCardListDialog()};Dashboard.prototype.closeCardListDialog=function(){this.template.__closeCardListDialog()};Dashboard.prototype.selectCard=function(idOrIndex){var _this=this.template;_this.unSelectAllCards();if(typeof idOrIndex==="number"){var cardBounds=_this.querySelectorAll(".top-dashboard-card-bound");if(cardBounds.length<=idOrIndex){return}else{var cardBound=cardBounds[idOrIndex]}}else if(typeof idOrIndex==="string"){if(!_this.showMap.get(idOrIndex))return;var cardBound=_this.querySelector("#"+idOrIndex+".top-dashboard-card-bound")}cardBound.click()};Dashboard.prototype.getHeaderTitleText=function(){return this.template.titleTag.value};Dashboard.prototype.getSelectedCard=function(){return this.template.selected};Dashboard.prototype.getSelectedCardIndex=function(){if(this.template.selected===undefined)return-1;return this.template.selected.index};Dashboard.prototype.getSelectedCardInfo=function(){return this.template.cardMap.get(this.template.selected.id)};Dashboard.prototype.getSelectedCardContent=function(){if(this.template.selected)return this.template.selected.querySelector("div.top-dashboard-card-content").children;else return undefined};Dashboard.prototype.getSelectedCardHtmlString=function(){if(this.template.selected)return this.template.selected.querySelector("div.top-dashboard-card-content").innerHTML;else return undefined};Dashboard.prototype.getCard=function(id){if(this.template.showMap.get(id))return this.template.querySelector("div#"+id+".top-dashboard-card-bound");else return undefined};Dashboard.prototype.getCardIndex=function(id){if(this.template.showMap.get(id)&&this.template.querySelector("div#"+id+".top-dashboard-card-bound"))return this.template.querySelector("div#"+id+".top-dashboard-card-bound").index;else return-1};Dashboard.prototype.getCardInfo=function(id){return this.template.cardMap.get(id)};Dashboard.prototype.getCardContent=function(id){if(this.template.showMap.get(id)&&this.template.querySelector("div#"+id+".top-dashboard-card-bound .top-dashboard-card-content"))return this.template.querySelector("div#"+id+".top-dashboard-card-bound .top-dashboard-card-content").children;else return undefined};Dashboard.prototype.getCardHtmlString=function(id){if(this.template.showMap.get(id)&&this.template.querySelector("div#"+id+".top-dashboard-card-bound .top-dashboard-card-content"))return this.template.querySelector("div#"+id+".top-dashboard-card-bound .top-dashboard-card-content").innerHTML;else return undefined};Dashboard.prototype.addCardToShowList=function(id,childId){this.template.__addCardToShowList(id,childId)};Dashboard.prototype.pushCardToShowList=function(id){if(this.template.cardMap.has(id)){var item={id:id};this.template.showList.push(item);this.template.showMap.set(id,item)}else{return false}};Dashboard.prototype.deleteAllCardFromShowList=function(){this.template.showList=[];this.template.showMap=new Map};Dashboard.prototype.deleteCardFromShowList=function(id){if(this.template.cardMap.has(id)){this.template.showList=this.template.showList.filter(function(v){if(v.id===id)return false;return true});this.template.showMap.delete(id);return true}else{return false}};Dashboard.prototype.reRender=function(){this.template.__renderCards(true)};Dashboard.prototype.save=function(){this.template.__save()};Dashboard.prototype.cancel=function(){this.template.__cancel()};Dashboard.prototype.startDragToAddCard=function(id){if(!this.template.editModeIsOn)return;this.template.__startDragToAddCard(id)};return Dashboard}();TopDatepicker={is:"top-datepicker",behaviors:[TopWidgetBehavior],properties:{date:{type:String,value:""},maxDate:String,minDate:String,format:{type:String,value:"yyyy-mm-dd"},onSelect:String,yearNavigator:{type:String,value:"true"},yearRange:{type:String,value:"-5:+5"},firstDay:{type:String,value:"0"},dayNamesMin:{type:Array,value:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},monthNamesMin:{type:Array,value:["01","02","03","04","05","06","07","08","09","10","11","12"]},containerAlign:{type:String},fromDatepicker:{type:String},toDatepicker:{type:String},tabIndex:{type:String,value:"0"},selectType:{type:Array,value:"day"},inline:Boolean},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-datepicker-root"><input class="top-datepicker-input" type="text"><i class="top-datepicker-icon"></i></div>'},__attached2:function(){this.attachEventHandler()},__initEventInternal:function(){this.__addEventByAttr("select")},__detached:function(){top$("#top-datepicker-div").css("display","none")},__initialize:function(){this.__updateId();this.__updateDisabled();this.__translateFormat();this.__updateMaxDate();this.__updateMinDate();this.__updateDate();
this.__updateName();this.__eventBindingList();this.__updateTabIndex();this.isOpened=false;document.getElementById("top-datepicker-div").style.display="none";this.querySelector(".top-datepicker-input").autocomplete="off"},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-datepicker-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateName:function(){if(this.name){var shadowRoot=this.querySelector(".top-datepicker-root");shadowRoot.name=this.name}},__updateI18nList:function(){this.__updateDate();this.isOpened=false;this.getElementsByClassName("top-datepicker-input")[0].blur();this.hide()},__updateId:function(){if(this.id){var thisPicker=this.querySelector(".top-datepicker-input");thisPicker.id=this.id}},__updateSelectType:function(){this.__updateDate();this.isOpened=false;this.getElementsByClassName("top-datepicker-input")[0].blur();this.hide()},__translateFormat:function(){var format=this.format;var split=format.includes("-")?"-":".";var year=/y{4}/gi.test(format)?"yy":"y";if(this.selectType==="week"&&format.includes("d")){format=this.format="yyyy-WEEKww"}if(this.selectType==="day"||this.selectType==="week"){this.translatedFormat=year+split+"mm"+split+"dd"}else{this.translatedFormat="yy-mm-dd";this.selectType="day";console.error("The"+this.id+"'s format is not correct. month & year are not supported yet.")}},__updateDate:function(){var thisPicker=this.querySelector(".top-datepicker-input");var shadowRoot=this.querySelector(".top-datepicker-root");thisPicker.placeholder=this.format;if(this.selectType==="week")shadowRoot.classList.add("week");var isFormatWeek=this.selectType==="week"||this.selectType==="Week"?true:false;var YMFormat=this.selectType==="month"||this.selectType==="year"?this.selectType:false;var _this=this;var datepicker=thisPicker;if(this.inline===true||this.inline==="true"){datepicker=shadowRoot;shadowRoot.removeChild(thisPicker);var thisIcon=this.querySelector(".top-datepicker-icon");shadowRoot.removeChild(thisIcon);shadowRoot.classList.add("inline")}datepicker.classList.remove("hasDatepicker");if(typeof this.monthNamesMin[0]==="object"||typeof this.dayNamesMin[0]==="object")Top.i18n.__onUpdate(this.id,"__updateI18nList");if(typeof this.monthNamesMin[0]==="object"){var i18nMonthNames=[];var key=Object.keys(this.monthNamesMin[0])[0];for(var i=0;i<this.monthNamesMin.length;i++){i18nMonthNames[i]=this.__i18n(this.monthNamesMin[i][key])}}if(typeof this.dayNamesMin[0]==="object"){var i18nDayNames=[];var key=Object.keys(this.dayNamesMin[0])[0];for(var i=0;i<this.dayNamesMin.length;i++){i18nDayNames[i]=this.__i18n(this.dayNamesMin[i][key])}}var dayNamespace=Top.Util.namespace(this.dayNamesMin);if(typeof dayNamespace!=="object"){this.dayNamesMin=this.dayNamesMin.replace(/\[|\]|'| |"/g,"");this.dayNamesMin=this.dayNamesMin.split(",")}var monthNamespace=Top.Util.namespace(this.monthNamesMin);if(typeof monthNamespace!=="object"){this.monthNamesMin=this.monthNamesMin.replace(/\[|\]|'| |"/g,"");this.monthNamesMin=this.monthNamesMin.split(",")}top$(datepicker).topDatepicker({monthNames:i18nMonthNames||monthNamespace||_this.monthNamesMin,monthNamesShort:i18nMonthNames||monthNamespace||_this.monthNamesMin||["01","02","03","04","05","06","07","08","09","10","11","12"],dayNamesShort:i18nDayNames||dayNamespace||_this.dayNamesMin,showMonthAfterYear:true,showOtherMonths:true,showWeek:isFormatWeek,showMonthOrYear:YMFormat,dateFormat:_this.translatedFormat,userFormat:_this.format,yearRange:_this.yearRange,minDate:_this.minDateObject,maxDate:_this.maxDateObject,firstDay:_this.firstDay,selectType:_this.selectType,inline:_this.inline,containerAlign:_this.containerAlign,onSelect:function(dateText,inst){_this.date=dateText;_this.inst=inst;if(!_this.__checkDateFormat()){_this.date="";if(!top$(_this).hasClass("error"))top$(_this).addClass("error")}else{if(top$(_this).hasClass("error"))top$(_this).removeClass("error")}_this.__checkFromToDatepicker();_this.updateData("date");_this.updateDevice("date");_this.__dispatchEvent(new CustomEvent("select",{detail:{data:dateText}}));_this.__checkToDatepickerMinDate()},onClose:function(){_this.isOpened=false}});if(this.date==="today"){top$(datepicker).topDatepicker("setDate",new Date);this.date=top$(datepicker).topDatepicker().val()}else if(this.date===undefined||this.date===null||this.date.length==0){top$(datepicker).topDatepicker("setDate",null);this.date=top$(datepicker).topDatepicker().val()}else if(!this.__checkDateFormat()){top$(datepicker).topDatepicker("setDate",null);datepicker.value=this.date;this.date="";if(!top$(this).hasClass("error"))top$(this).addClass("error")}else{top$(datepicker).topDatepicker("setDate",this.date);if(top$(this).hasClass("error"))top$(this).removeClass("error")}_this.__checkFromToDatepicker();_this.__checkToDatepickerMinDate();this.attachEventHandler()},__addBeforeShow:function(){var thisPicker=this.querySelector(".top-datepicker-input");var _this=this;top$(thisPicker).topDatepicker("option","beforeShow",function(input){setTimeout(function(){},1)})},__addOnChangeMonthYear:function(){var thisPicker=this.querySelector(".top-datepicker-input");var _this=this;top$(thisPicker).topDatepicker("option","onChangeMonthYear",function(year,month,instance){setTimeout(function(){},1)})},__setYearNavigator:function(thisPicker){var prevBtn=top$(thisPicker).topDatepicker("widget").find(".top-datepicker-prev");top$("<a>",{click:function(){top$.topDatepicker._adjustDate(top$(thisPicker),-1,"Y")}}).insertBefore(prevBtn).addClass("top-datepicker-prev-year ui-corner-all");var nextBtn=top$(thisPicker).topDatepicker("widget").find(".top-datepicker-next");top$("<a>",{click:function(){top$.topDatepicker._adjustDate(top$(thisPicker),+1,"Y")}}).insertBefore(nextBtn).addClass("top-datepicker-next-year ui-corner-all")},attachEventHandler:function(){var thisRoot=this.querySelector(".top-datepicker-root");var $thisInput=top$(this.querySelector(".top-datepicker-input"));var _this=this;top$(thisRoot.querySelector(".top-datepicker-icon")).off("click").on("click",function(){if($thisInput.is(":focus")){$thisInput.focusout();_this.isOpened=false}else{$thisInput.focus();_this.isOpened=true}Top.App.closeOpenedSelectBox();event.stopPropagation()});$thisInput.on("keydown",function(event){var re=/[\u3131-\uD79D]/gi;if(re.test(event.target.value)){this.value=event.target.value.replace(re,"")}if(event.keyCode>47&&event.keyCode<58||event.keyCode>95&&event.keyCode<106){var format=_this.format;var split=format.includes("-")?"-":".";var formatArr=format.split(split);if(_this.selectType==="day"){if(this.value.length===formatArr[0].length)this.value+=split;if(this.value.length===formatArr[0].length+1+formatArr[1].length)this.value+=split;if(this.value.length>=format.length){var dateForValid=this.value;if(Top.Util.Browser.isIE()&&split===".")dateForValid=dateForValid.replace(/\./g,"-");if(isNaN(new Date(/y{4}/gi.test(_this.format)?dateForValid:"20"+dateForValid)))this.value=""}if(_this.minDate&&this.value.length===format.length){if(new Date(this.value)<new Date(_this.minDate))this.value=_this.minDate}}else if(_this.selectType==="week"){if(this.value.length===formatArr[0].length)this.value+=split+"week";if(this.value.length>=format.length){var lastWeek=document.getElementById("top-datepicker-div").querySelector(".top-datepicker-week").lastChild.textContent,boundaryIndex=/y{4}/gi.test(_this.format)?9:7,weekStr=this.value.substring(boundaryIndex);if(parseInt(weekStr)>parseInt(lastWeek))this.value=this.value.substring(0,boundaryIndex)+lastWeek}}}_this.date=this.value});$thisInput.on("focus",function(){_this.isOpened=true});$thisInput.off("click").on("click",function(){Top.App.closeOpenedSelectBox();event.stopPropagation()});$thisInput.off("blur").on("blur",function(){this.value=event.target.value.replace(/[\u3131-\uD79D]/g,"");_this.date=this.value;if(this.value===""){_this.__checkDateFormat(true);if(top$(_this).hasClass("error"))top$(_this).removeClass("error")}else if(!_this.__checkDateFormat()){_this.date="";if(!top$(_this).hasClass("error"))top$(_this).addClass("error")}else{_this.date=this.value;if(top$(_this).hasClass("error"))top$(_this).removeClass("error")}_this.__checkFromToDatepicker();_this.updateData("date");_this.updateDevice("date")})},__updateMaxDate:function(){if(typeof this.maxDate==="string"){if(this.translatedFormat==="yy-mm-dd"||this.translatedFormat==="yy.mm.dd"){var maxDateArray=this.maxDate.split(/\.|-/g)}else if(this.translatedFormat==="y-mm-dd"||this.translatedFormat==="y.mm.dd"){var maxDateArray=this.minDate.split(/\.|-/g);maxDateArray[0]=parseInt((new Date).getFullYear()/100)+maxDateArray[0]}this.maxDateObject=new Date(maxDateArray[0],maxDateArray[1]-1,maxDateArray[2])}var datepicker=this.inline===true||this.inline==="true"?this.querySelector(".top-datepicker-root"):this.querySelector("input");top$(datepicker).topDatepicker("option","maxDate",this.maxDateObject);this.hide()},__updateMinDate:function(){if(typeof this.minDate==="string"){if(this.translatedFormat==="yy-mm-dd"||this.translatedFormat==="yy.mm.dd"){var minDateArray=this.minDate.split(/\.|-/g)}else if(this.translatedFormat==="y-mm-dd"||this.translatedFormat==="y.mm.dd"){var minDateArray=this.minDate.split(/\.|-/g);minDateArray[0]=parseInt((new Date).getFullYear()/100)+minDateArray[0]}this.minDateObject=new Date(minDateArray[0],minDateArray[1]-1,minDateArray[2])}var datepicker=this.inline===true||this.inline==="true"?this.querySelector(".top-datepicker-root"):this.querySelector("input");top$(datepicker).topDatepicker("option","minDate",this.minDateObject);this.hide()},__updateDisabled:function(){var datepicker=this.inline===true||this.inline==="true"?this.querySelector(".top-datepicker-root"):this.querySelector("input");this.__setDisabled(datepicker)},__updateOnSelect:function(){this.__addEventByAttr("select")},__updateYearRange:function(){var thisPicker=this.querySelector(".top-datepicker-input");top$(thisPicker).topDatepicker("option","yearRange",this.yearRange);this.hide()},__updateFirstDay:function(){var thisPicker=this.querySelector(".top-datepicker-input");top$(thisPicker).topDatepicker("option","firstDay",this.firstDay);this.hide()},__updateDayNamesMin:function(){var thisPicker=this.querySelector(".top-datepicker-input");top$(thisPicker).topDatepicker("option","dayNamesMin",this.dayNamesMin);this.hide()},__updateContainerAlign:function(){var thisPicker=this.querySelector(".top-datepicker-input");top$(thisPicker).topDatepicker("option","containerAlign",this.containerAlign);this.hide()},__updateFormat:function(){var thisPicker=this.querySelector(".top-datepicker-input");thisPicker.placeholder=this.format;this.__translateFormat();top$(thisPicker).topDatepicker("option","dateFormat",this.translatedFormat);top$(thisPicker).topDatepicker("option","userFormat",this.format);this.hide()},__updateTabIndex:function(){var datepicker=this.inline===true||this.inline==="true"?this.querySelector(".top-datepicker-root"):this.querySelector("input");datepicker.setAttribute("tabindex",this.tabIndex)},__checkDateFormat:function(isBlank){var date=this.date,thisPicker=this.querySelector(".top-datepicker-input");if(isBlank===true)return true;if(typeof date!=="string")return false;if(date==="today")return true;var userFormat=this.format,yearLength=/y{4}/gi.test(userFormat)?4:2;if(this.selectType==="day"){var Yindex=userFormat.indexOf("y"),Mindex=userFormat.indexOf("m"),Dindex=userFormat.indexOf("d"),yearStr=date.substring(Yindex,Yindex+yearLength),monthStr=date.substring(Mindex,Mindex+2),dateStr=date.substring(Dindex,Dindex+2),fullStr=yearStr+"-"+monthStr+"-"+dateStr;if(yearLength===2)fullStr="20"+fullStr;if(isNaN(parseInt(monthStr))||isNaN(parseInt(dateStr))||isNaN(new Date(fullStr)))return false;else return true}else if(this.selectType==="week"){var yearStr=(yearLength===2?"20":"")+date.substring(0,yearLength),split=userFormat.includes("-")?"-":".";if(thisPicker.value.includes(split+"week")){var kIndex=thisPicker.value.indexOf("k"),week=thisPicker.value.substring(kIndex+1);if(week<55&&week>0)return true}}},__checkFromToDatepicker:function(){var $thisInput=top$(this.querySelector(".top-datepicker-input"));if(this.fromDatepicker){var datepicker_start=Top.Dom.selectById(this.fromDatepicker);var date_start=datepicker_start.getDate();if(new Date(this.date)<new Date(date_start)){this.date=date_start;$thisInput.topDatepicker("setDate",date_start)}}else if(this.toDatepicker){var datepicker_end=Top.Dom.selectById(this.toDatepicker);var date_end=datepicker_end.getDate();if(new Date(this.date)>new Date(date_end)){datepicker_end.setDate(this.date)}}},__checkToDatepickerMinDate:function(){if(this.toDatepicker){var datepicker_end=Top.Dom.selectById(this.toDatepicker);datepicker_end.setProperties({"min-date":this.date})}},__getWeek:function(){var monthStr=this.inst.selectedMonth+1<10?"0"+(this.inst.selectedMonth+1):""+(this.inst.selectedMonth+1);var dayStr=this.inst.selectedDay<10?"0"+this.inst.selectedDay:""+this.inst.selectedDay;var selectedDate=this.inst.selectedYear+"-"+monthStr+"-"+dayStr;var date=new Date(selectedDate),firstDay=new Date(selectedDate),lastDay=new Date(selectedDate),week=this.inst.selectedWeek+"";firstDay.setDate(date.getDate()-date.getDay());lastDay.setDate(date.getDate()+(6-date.getDay()));firstDay=firstDay.getFullYear()+"-"+(firstDay.getMonth()<10?"0":"")+(firstDay.getMonth()+1)+"-"+(firstDay.getDate()<10?"0":"")+firstDay.getDate();lastDay=lastDay.getFullYear()+"-"+(lastDay.getMonth()<10?"0":"")+(lastDay.getMonth()+1)+"-"+(lastDay.getDate()<10?"0":"")+lastDay.getDate();return{from:firstDay,to:lastDay,week:week}},getTopStyle:function(){this.topstyle=this.querySelector(".top-datepicker-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-datepicker-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-datepicker-root").style.cssText=this.topstyle},hide:function(){var curInst=top$.topDatepicker._curInst;if(curInst&&this.id===curInst.id){document.getElementById("top-datepicker-div").style.display="none"}}};Top.Widget.Datepicker=function(){Datepicker.prototype=Object.create(Top.Widget.prototype);Datepicker.prototype.constructor=Datepicker;function Datepicker(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-datepicker");this.template.innerHTML='<div class="top-datepicker-root"><input class="top-datepicker-input" type="text"><i class="top-datepicker-icon"></i></div>'}this.id=this.template.id}Datepicker.create=function(element){return new Datepicker(element)};Datepicker.prototype.getDate=function(getInvalidDate){if(this.template.selectType==="day"){if(!getInvalidDate)return this.template.date;else if(getInvalidDate===true||getInvalidDate==="true")return this.template.getElementsByClassName("top-datepicker-input")[0].value}else if(this.template.selectType==="week"){return this.template.__getWeek()}};Datepicker.prototype.isOpened=function(){return this.template.isOpened};Datepicker.prototype.setDate=function(date){this.setProperties({date:date})};return Datepicker}();TopDialog={is:"top-dialog",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{title:String,onOpen:String,onClose:String,onSuccess:String,onFail:String,content:Object,isConfirmation:{type:Boolean,value:false},dialogLayout:String,movable:{type:Boolean,value:true},closable:{type:Boolean,value:true},maxMinButton:{type:Boolean,value:false},minWidth:{type:Boolean,value:"100px"},minHeight:{type:Boolean,value:"100px"},closedOnclickoutside:Boolean,modeless:Boolean,resizable:{type:String,value:"false"},onOverlayClick:String},__ready:function(){this.__updateId();this.__updateClass();this.initialChilds();this.__initialClassname();this.__initI18n("title");this.__isReady=true;if(Top.Util.Browser.isIE()){this.content=this.childs.clone(true,true);if(typeof this.__onReady==="function")this.__onReady()}else{if(typeof this.__onReady==="function")this.__onReady();this.content=this.childs.clone(true,true)}this.clearChilds()},appendTemplate:function(){this.innerHTML="<div>"+this.innerHTML+"</div>"},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__attached2:function(){},__initEventInternal:function(){this.__addEventByAttr("open");this.__addEventByAttr("close");this.__addEventByAttr("overlayClick")},__updateClass:function(){var _this=this;if(this.class){this.class.split(" ").forEach(function(c){_this.classList.add(c)})}if(document.querySelector("#top-dialog-root_"+this.id+".top-dialog-root")){document.querySelector("#top-dialog-root_"+this.id+".top-dialog-root").className="top-dialog-root "+this.className}},initializeChildRoot:function(){return this.querySelector("div")},showDialog:function(){var _this=this;var pageId=Top.App.getCurrentPage().id;var width,height;var dialogSizeClass="";var objDialog=this;var baseZIndex=110+Object.keys(Top.App.getDialogs()).length;var selected=null;if(parseInt(this.layoutWidth)>0){width=this.layoutWidth;dialogSizeClass+=" fixed-width-dialog"}else{width="auto";if(this.resizable===true||this.resizable==="true"){dialogSizeClass+=" fixed-width-dialog"}}if(parseInt(this.layoutHeight)>80){height=this.layoutHeight;dialogSizeClass+=" fixed-height-dialog"}else if(typeof this.layoutHeight==="string"&&this.layoutHeight.includes("%")){height=this.layoutHeight;dialogSizeClass+=" fixed-height-dialog"}else{height="auto";if(this.resizable===true||this.resizable==="true"){dialogSizeClass+=" fixed-height-dialog"}}var curPage=document.querySelector("#"+pageId);var dialogRoot=document.createElement("div");dialogRoot.id="top-dialog-root_"+this.id;dialogRoot.className="top-dialog-root";var prevDisplay=dialogRoot.style.display;if(!this.dialogLayout&&width==="auto"&&height==="auto"){width=this.minWidth;height=this.minHeight}dialogRoot.style.cssText="width: "+width+"; height: "+height+"; display: none; z-index: "+(baseZIndex+1)+";";this.__adjustPositionImpl(dialogRoot);if(!this.classList.contains("popup_03")){var dialogTitleLayout=document.createElement("div");dialogTitleLayout.className="top-dialog-title-layout";var dialogTitle=document.createElement("span");dialogTitle.className="top-dialog-title";dialogTitle.textContent=this.title;dialogTitleLayout.appendChild(dialogTitle);if(this.maxMinButton===true||this.maxMinButton==="true"){var dialogMaxMinButton=document.createElement("button");dialogMaxMinButton.className="top-dialog-max_min_button";dialogMaxMinButton.classList.add("max");dialogMaxMinButton.addEventListener("click",_sizeMaxMin);dialogTitleLayout.appendChild(dialogMaxMinButton)}if(this.closable===true||this.closable==="true"){var dialogCloseButton=document.createElement("button");dialogCloseButton.className="top-dialog-close";dialogCloseButton.addEventListener("click",function(){objDialog.close()});dialogTitleLayout.appendChild(dialogCloseButton)}dialogRoot.appendChild(dialogTitleLayout)}var dialogContent=document.createElement("div");dialogContent.className="top-dialog-content"+dialogSizeClass;dialogRoot.appendChild(dialogContent);function _sizeMaxMin(e){var dialogRoot=document.querySelector("#top-dialog-root_"+_this.id+".top-dialog-root");if(this.isMaxSize){window.document.body.style.overflow=this.bodyScroll;dialogRoot.style.left=this.prevX+"px";dialogRoot.style.top=this.prevY+"px";dialogRoot.style.height=this.prevHeight+"px";dialogRoot.style.width=this.prevWidth+"px";e.target.classList.remove("min");e.target.classList.add("max");this.isMaxSize=false}else{this.prevY=parseFloat(dialogRoot.style.top);this.prevX=parseFloat(dialogRoot.style.left);this.prevWidth=parseFloat(dialogRoot.offsetWidth);this.prevHeight=parseFloat(dialogRoot.offsetHeight);this.bodyScroll=window.document.body.style.overflow;window.document.body.style.overflow="hidden";var screenHeight=window.document.documentElement["clientHeight"];var screenWidth=window.document.documentElement["clientWidth"];if(_this.classList.contains("popup_02")){screenHeight=screenHeight-35;dialogRoot.style.top="35px"}else{dialogRoot.style.top=0}dialogRoot.style.left=0;dialogRoot.style.height=screenHeight+"px";dialogRoot.style.width=screenWidth+"px";e.target.classList.remove("max");e.target.classList.add("min");this.isMaxSize=true}}if(this.resizable===true||this.resizable==="true"){var reSizer_right=document.createElement("div");reSizer_right.className="top-dialog-resize resize-right";var reSizer_bottom=document.createElement("div");reSizer_bottom.className="top-dialog-resize resize-bottom";var reSizer_right_bottom=document.createElement("div");reSizer_right_bottom.className="top-dialog-resize resize-right-bottom";var reSizer_left=document.createElement("div");reSizer_left.className="top-dialog-resize resize-left";var reSizer_top=document.createElement("div");reSizer_top.className="top-dialog-resize resize-top";var reSizer_left_top=document.createElement("div");reSizer_left_top.className="top-dialog-resize resize-left-top";var reSizer_right_top=document.createElement("div");reSizer_right_top.className="top-dialog-resize resize-right-top";var reSizer_left_bottom=document.createElement("div");reSizer_left_bottom.className="top-dialog-resize resize-left-bottom";reSizer_right.addEventListener("mousedown",_resizeStart);reSizer_bottom.addEventListener("mousedown",_resizeStart);reSizer_right_bottom.addEventListener("mousedown",_resizeStart);reSizer_left.addEventListener("mousedown",_resizeStartLt);reSizer_top.addEventListener("mousedown",_resizeStartLt);reSizer_left_top.addEventListener("mousedown",_resizeStartLt);reSizer_left_bottom.addEventListener("mousedown",_resizeStartLb);reSizer_right_top.addEventListener("mousedown",_resizeStartRt);dialogRoot.appendChild(reSizer_right);dialogRoot.appendChild(reSizer_bottom);dialogRoot.appendChild(reSizer_right_bottom);dialogRoot.appendChild(reSizer_left);dialogRoot.appendChild(reSizer_top);dialogRoot.appendChild(reSizer_left_top);dialogRoot.appendChild(reSizer_left_bottom);dialogRoot.appendChild(reSizer_right_top)}var _this=this;this.isMinWidth;this.isMinWidth;function _resizeStart(e){_this.isResize=true;_this.isRight=true;_this.isBottom=true;_this.prevX=e.pageX;_this.prevY=e.pageY;_this.prevWidth=parseFloat(dialogRoot.offsetWidth);_this.prevHeight=parseFloat(dialogRoot.offsetHeight);if(this.classList.contains("resize-right")){_this.isBottom=false}else if(this.classList.contains("resize-bottom")){_this.isRight=false}document.addEventListener("mousemove",_this._resizeMove);document.addEventListener("mouseup",_this._resizeEnd)}if(this._resizeMove===undefined){this._resizeMove=function(e){if(_this.isResize===false)return;var dialogRoot=document.querySelector("#top-dialog-root_"+_this.id+".top-dialog-root");if(_this.isRight){var movingValue=e.pageX-_this.prevX;if(typeof _this.minWidth=="string")var minWidth=parseFloat(_this.minWidth);_this.prevWidth+=movingValue;if(minWidth&&_this.prevWidth<minWidth){dialogRoot.style.width=_this.minWidth}else{dialogRoot.style.width=_this.prevWidth+"px"}}if(_this.isBottom){var movingValue=e.pageY-_this.prevY;if(typeof _this.minHeight=="string")var minHeight=parseFloat(_this.minHeight);_this.prevHeight+=movingValue;if(minHeight&&_this.prevHeight<minHeight){dialogRoot.style.height=_this.minHeight}else dialogRoot.style.height=_this.prevHeight+"px"}_this.prevY=e.pageY;_this.prevX=e.pageX;Top.App.__closeSelectbox();Top.App.__closePopover();e.preventDefault()}}if(this._resizeEnd===undefined){this._resizeEnd=function(e){_this.isResize=false;_this.isRight=false;_this.isBottom=false}}function _resizeStartLt(e){_this.isResizeLt=true;_this.isLeft=true;_this.isTop=true;_this.prevX=e.pageX;_this.prevY=e.pageY;_this.prevWidth=parseFloat(dialogRoot.offsetWidth);_this.prevHeight=parseFloat(dialogRoot.offsetHeight);if(this.classList.contains("resize-left")){_this.isTop=false}else if(this.classList.contains("resize-top")){_this.isLeft=false}document.addEventListener("mousemove",_this._resizeMoveLt);document.addEventListener("mouseup",_this._resizeEndLt)}if(this._resizeMoveLt===undefined){this._resizeMoveLt=function(e){if(_this.isResizeLt===false)return;var dialogRoot=document.querySelector("#top-dialog-root_"+_this.id+".top-dialog-root");if(_this.isLeft){if(typeof _this.minWidth=="string")var minWidth=parseFloat(_this.minWidth);if(!_this.isMinWidth)dialogRoot.style.left=e.pageX+"px";var movingValue=e.pageX-_this.prevX;_this.prevWidth-=movingValue;if(minWidth&&_this.prevWidth<=minWidth){dialogRoot.style.width=_this.minWidth;_this.isMinWidth=true}else{dialogRoot.style.width=_this.prevWidth+"px";_this.isMinWidth=false}}if(_this.isTop){if(!_this.isMinHeight)dialogRoot.style.top=e.pageY+"px";var movingValue=e.pageY-_this.prevY;if(typeof _this.minHeight=="string")var minHeight=parseFloat(_this.minHeight);_this.prevHeight-=movingValue;if(minHeight&&_this.prevHeight<minHeight){dialogRoot.style.height=_this.minHeight;_this.isMinHeight=true}else{dialogRoot.style.height=_this.prevHeight+"px";_this.isMinHeight=false}}_this.prevY=e.pageY;_this.prevX=e.pageX;Top.App.__closeSelectbox();Top.App.__closePopover();e.preventDefault()}}if(this._resizeEndLt===undefined){this._resizeEndLt=function(e){_this.isResizeLt=false;_this.isLeft=false;_this.isTop=false}}function _resizeStartLb(e){_this.isResizeLb=true;_this.isLeft=true;_this.isBottom=true;_this.prevX=e.pageX;_this.prevY=e.pageY;_this.prevWidth=parseFloat(dialogRoot.offsetWidth);_this.prevHeight=parseFloat(dialogRoot.offsetHeight);if(this.classList.contains("resize-left")){_this.isBottom=false}else if(this.classList.contains("resize-bottom")){_this.isleft=false}document.addEventListener("mousemove",_this._resizeMoveLb);document.addEventListener("mouseup",_this._resizeEndLb)}if(this._resizeMoveLb===undefined){this._resizeMoveLb=function(e){if(_this.isResizeLb===false)return;var dialogRoot=document.querySelector("#top-dialog-root_"+_this.id+".top-dialog-root");if(_this.isLeft){if(typeof _this.minWidth=="string")var minWidth=parseFloat(_this.minWidth);if(!_this.isMinWidth)dialogRoot.style.left=e.pageX+"px";var movingValue=e.pageX-_this.prevX;_this.prevWidth-=movingValue;if(minWidth&&_this.prevWidth<minWidth){dialogRoot.style.width=_this.minWidth;_this.isMinWidth=true}else{dialogRoot.style.width=_this.prevWidth+"px";_this.isMinWidth=false}}if(_this.isBottom){if(typeof _this.minHeight=="string")var minHeight=parseFloat(_this.minHeight);var movingValue=e.pageY-_this.prevY;_this.prevHeight+=movingValue;if(minHeight&&_this.prevHeight<minHeight){dialogRoot.style.height=_this.minHeight;_this.isMinHeight=true}else dialogRoot.style.height=_this.prevHeight+"px";_this.isMinHeight=false}_this.prevY=e.pageY;_this.prevX=e.pageX;Top.App.__closeSelectbox();Top.App.__closePopover();e.preventDefault()}}if(this._resizeEndLb===undefined){this._resizeEndLb=function(e){_this.isResizeLb=false;_this.isLeft=false;_this.isTop=false}}function _resizeStartRt(e){_this.isResizeRt=true;_this.isRight=true;_this.isTop=true;_this.prevX=e.pageX;_this.prevY=e.pageY;_this.prevWidth=parseFloat(dialogRoot.offsetWidth);_this.prevHeight=parseFloat(dialogRoot.offsetHeight);if(this.classList.contains("resize-right")){_this.isTop=false}else if(this.classList.contains("resize-top")){_this.isRight=false}document.addEventListener("mousemove",_this._resizeMoveRt);document.addEventListener("mouseup",_this._resizeEndRt)}if(this._resizeMoveRt===undefined){this._resizeMoveRt=function(e){if(_this.isResizeRt===false)return;var dialogRoot=document.querySelector("#top-dialog-root_"+_this.id+".top-dialog-root");if(_this.isRight){if(typeof _this.minWidth=="string")var minWidth=parseFloat(_this.minWidth);var movingValue=e.pageX-_this.prevX;_this.prevWidth+=movingValue;if(minWidth&&_this.prevWidth<minWidth){dialogRoot.style.width=_this.minWidth;_this.isMinWidth=true}else{dialogRoot.style.width=_this.prevWidth+"px";_this.isMinWidth=false}}if(_this.isTop){if(typeof _this.minHeight=="string")var minHeight=parseFloat(_this.minHeight);if(!_this.isMinHeight)dialogRoot.style.top=e.pageY+"px";var movingValue=e.pageY-_this.prevY;_this.prevHeight-=movingValue;if(minHeight&&_this.prevHeight<minHeight){dialogRoot.style.height=_this.minHeight;_this.isMinHeight=true}else{dialogRoot.style.height=_this.prevHeight+"px";_this.isMinHeight=false}}_this.prevY=e.pageY;_this.prevX=e.pageX;Top.App.__closeSelectbox();Top.App.__closePopover();e.preventDefault()}}if(this._resizeEndRt===undefined){this._resizeEndRt=function(e){_this.isResizeRt=false;_this.isLeft=false;_this.isTop=false}}document.querySelector("#"+pageId).appendChild(dialogRoot);if(Top.Util.__isBooleanTrue(this.modeless)!==true){var dialogOverlay=document.createElement("div");dialogOverlay.id="top-dialog-overlay_"+this.id;dialogOverlay.className="top-dialog-overlay";dialogOverlay.style.cssText="z-index: "+baseZIndex+";";document.querySelector("#"+pageId).appendChild(dialogOverlay);dialogOverlay.addEventListener("click",function(e){var mouseEvent=e;objDialog.__dispatchEvent(new CustomEvent("overlayClick",{detail:{mouseEvent:mouseEvent}}))});if(this.closedOnclickoutside==="true"||this.closedOnclickoutside===true){dialogOverlay.addEventListener("click",function(){objDialog.close()})}}if(typeof this.dialogLayout==="string"){if(!this.dialogLayout.endsWith(".html"))this.dialogLayout=this.dialogLayout.concat(".html");this.__onSuccessSrcLoad=function(data){_this.childRoot=document.querySelector("#top-dialog-root_"+objDialog.id+" .top-dialog-content");_this.appendHtmlString(data);TopRuntime._insertedNodesCallback();_this.initialChilds();TopRuntime._srcRootNodesAttachedCallback();if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("open"))}else{_this.__dispatchEvent(new Event("open"))}objDialog.__adjustPosition();if(this.classList.contains("popup_03")){var titleLayout=document.querySelector("#top-dialog-root_"+this.id+" .top-dialog-title-layout>div");if(titleLayout)this.__initDragMove(titleLayout)}};Top.Ajax.execute(this.dialogLayout,{success:function(data){var controllerPaths=Top.Util.__getControllerPaths(data);if(Top.App.__useCommonLogic()===true&&controllerPaths!==undefined){Top.App.__loadControllerFile(controllerPaths,function(_data){_this.__onSuccessSrcLoad(_data)},data)}else{_this.__onSuccessSrcLoad(data)}}})}if(this.isConfirmation==="true"||this.IsConfirmation===true){dialogContent.classList.add("before-footer");var dialogFooter=document.createElement("div");dialogFooter.className="top-dialog-footer";dialogRoot.appendChild(dialogFooter);this.__okBtnId=Top.Util.guid();this.__cancelBtnId=Top.Util.guid();var wrapper=document.createElement("div");wrapper.innerHTML='<top-button id="'+this.__okBtnId+'" text="OK" margin="0px 10px"></top-button><top-button id="'+this.__cancelBtnId+'" text="Cancel"></top-button>';this.initializeHtmlObjects(wrapper);while(wrapper.firstChild){if(wrapper.firstChild.tagName&&TopRuntime.topWidgets[wrapper.firstChild.tagName.toLowerCase()]!==undefined)TopRuntime.srcRootNode.push(wrapper.firstChild);dialogFooter.appendChild(wrapper.firstChild)}Top.Dom.selectById(this.__okBtnId).template.onClick=function(event,widget){if(typeof _this.onSuccess==="string"){var fn=Top.Util.namespace(_this.onSuccess,_this);if(typeof fn==="function")fn(event,widget,Top.Dom.selectById(_this.id))}else if(typeof _this.onSuccess==="function"){_this.onSuccess(event,widget,Top.Dom.selectById(_this.id));
}};Top.Dom.selectById(this.__cancelBtnId).template.onClick=function(event,widget){if(typeof _this.onFail==="string"){var fn=Top.Util.namespace(_this.onFail,_this);if(typeof fn==="function")fn(event,widget,Top.Dom.selectById(_this.id))}else if(typeof _this.onFail==="function"){_this.onFail(event,widget,Top.Dom.selectById(_this.id))}}}if(!this.classList.contains("popup_03")){var titleLayout=document.querySelector("#top-dialog-root_"+this.id+" > .top-dialog-title-layout");this.__initDragMove(titleLayout,this)}if(typeof this.content==="object"){var wrapper=document.createElement("div");for(var i=0,len=this.content.length;i<len;i++){wrapper.appendChild(this.content[i].cloneNode(true))}while(wrapper.firstChild){this.createHtmlObjects(wrapper.firstChild);dialogContent.appendChild(wrapper.firstChild);this.createdItemWidgetAttachedCallback()}}else{var wrapper=document.createElement("div");wrapper.innerHTML=this.content;while(wrapper.firstChild){this.createHtmlObjects(wrapper.firstChild);dialogContent.appendChild(wrapper.firstChild);this.createdItemWidgetAttachedCallback()}}this.__updateClass();this.__addKeyEvent();var childNodes=document.querySelector("#top-dialog-root_"+this.id+" .top-dialog-content").querySelectorAll("*");for(var i=0,len=childNodes.length;i<len;i++){if(typeof childNodes[i].__initBoundData==="function"){childNodes[i].__initBoundData()}}dialogRoot.style.display=prevDisplay},__addKeyEvent:function(){var _this=this;this.__keyDownListener=function(){if(_this.__hasFocus()===true){if(typeof _this.onKeydown==="string"){var fn=Top.Util.namespace(_this.onKeydown,_this);if(typeof fn==="function")fn(event,_this)}else if(typeof _this.onKeydown==="function"){_this.onKeydown(event,_this)}}};document.addEventListener("keydown",this.__keyDownListener)},__hasFocus:function(){var zIndex=document.getElementById("top-dialog-root_"+this.id).style.zIndex;var ids=Object.keys(Top.App.getDialogs());for(var i=0;i<ids.length;i++){var dialog=document.getElementById("top-dialog-root_"+ids[i]);if(zIndex<dialog.style.zIndex){return false}}return true},__initDragMove:function(titleLayout){if(this.movable==="true"||this.movable===true){var prevX=0;var prevY=0;function positionCalc(num,size,maxNum){if(num<0)return 0;if(num+size>maxNum)return maxNum-size;return num}function _moveElem(e){if(selected!==null){var movementX=prevX?e.screenX-prevX:0;var movementY=prevY?e.screenY-prevY:0;var divX=selected.offsetWidth;var divY=selected.offsetHeight;var body=document.body,html=document.documentElement;var maxWidth=Math.max(body.scrollWidth,body.offsetWidth,html.clientWidth,html.scrollWidth,html.offsetWidth);var maxHeight=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight);prevX=e.screenX;prevY=e.screenY;selected.style.left=positionCalc(selected.offsetLeft+movementX,divX,maxWidth)+"px";selected.style.top=positionCalc(selected.offsetTop+movementY,divY,maxHeight)+"px";Top.App.__closeSelectbox();Top.App.__closePopover()}e.stopPropagation()}function _destroy(){document.removeEventListener("mousemove",_moveElem);selected=null}var _this=this;titleLayout.addEventListener("mousedown",function(e){selected=document.querySelector("#top-dialog-root_"+_this.id);prevX=e.screenX;prevY=e.screenY;document.addEventListener("mousemove",_moveElem);e.preventDefault()});document.addEventListener("mouseup",_destroy)}},createHtmlObjects:function(child,addNodes){if(TopRuntime.topWidgets[child.tagName.toLowerCase()]!==undefined){var topWidget=TopRuntime.topWidgets[child.tagName.toLowerCase()];TopRuntime._initProperties(topWidget,child);TopRuntime._prepAllBehaviors(topWidget,child);if(!child.isTemplateAppended())child.appendTemplate();if(Top.App.isLoaded()){TopRuntime._callCallback(child,"created");TopRuntime._callCallback(child,"ready");if(addNodes!==false)TopRuntime.createdNodes.push(child);if(this.createdItemWidgets===undefined){this.createdItemWidgets=[]}this.createdItemWidgets.push(child)}}if(!child.children)return;for(var i=0;i<child.children.length;i++){this.createHtmlObjects(child.children[i],addNodes)}},createdItemWidgetAttachedCallback:function(){if(this.createdItemWidgets){for(var i=this.createdItemWidgets.length-1;i>=0;i--){TopRuntime._callCallback(this.createdItemWidgets[i],"attached")}this.createdItemWidgets=[]}},__setPosition:function(top,left,zIndex){var str="#top-dialog-root_"+this.id+".top-dialog-root";var dialogRoot=top$(str);if(top==="center"){var height=dialogRoot.height();top=window.pageYOffset+window.innerHeight/2-parseInt(height)/2}if(left==="center"){var width=dialogRoot.width();left=(window.innerWidth-parseInt(width))/2}dialogRoot.css("left",left);dialogRoot.css("top",top);if(zIndex){dialogRoot.css("z-index",zIndex)}},__adjustPosition:function(){var _this=this;_this.__adjustPositionImpl()},__adjustPositionImpl:function(dialogRoot){if(dialogRoot){var dialogRoot=dialogRoot}else{var dialogRoot=document.querySelector("#top-dialog-root_"+this.id+".top-dialog-root")}if(!dialogRoot)return;var width=dialogRoot.style.width;var height=dialogRoot.style.height;if(width==="auto"){width=dialogRoot.offsetWidth}if(height==="auto"){height=dialogRoot.offsetHeight}if(this.layoutTop==="center"||isNaN(parseInt(this.layoutTop))&&isNaN(parseInt(this.layoutBottom))){var top=window.pageYOffset+window.innerHeight/2-parseInt(height)/2;dialogRoot.style.top=top+"px"}else{dialogRoot.style.top=this.layoutTop}if(this.layoutLeft==="center"||isNaN(parseInt(this.layoutLeft))&&isNaN(parseInt(this.layoutRight))){var left=(window.innerWidth-parseInt(width))/2;dialogRoot.style.left=left+"px"}else{dialogRoot.style.left=this.layoutLeft}dialogRoot.style.right=this.layoutRight;dialogRoot.style.bottom=this.layoutBottom;if(this.zIndex){dialogRoot.style.zIndex=this.zIndex}if(document.getElementById("top-dialog-root_"+this.id)){var tableviews=document.getElementById("top-dialog-root_"+this.id).querySelectorAll("top-tableview");for(var i=0,len=tableviews.length;i<len;i++){if(tableviews[i].dataTable)tableviews[i].dataTable.columns.adjust()}}},open:function(){if(this.__isOpen){return}if(Top.configs.closeDialogToBrowserBack){window.history.pushState(null,null,location.href)}this.showDialog();this.__isOpen=true;if(document.activeElement)document.activeElement.blur();var _this=this;if(this.getContent()){if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("open"))}else{this.__dispatchEvent(new Event("open"))}_this.__adjustPosition();if(this.getContent().id&&Top.Dom.selectById(this.getContent().id).onSrcLoad){Top.Dom.selectById(this.getContent().id).onSrcLoad(function(){_this.__adjustPosition();if(typeof _this.getContent().template.adjustSize==="function")_this.getContent().template.adjustSize()})}var tableviews=top$("#top-dialog-root_"+this.id).find("top-tableview");var len=tableviews.length;for(var i=0;i<len;i++){if(tableviews[i].scrollTable&&(tableviews[i].layoutWidth!==undefined&&(tableviews[i].layoutWidth.indexOf("%")!==-1||tableviews[i].layoutWidth==="match_parent")||tableviews[i].layoutWidth===undefined)&&tableviews[i].dataTable){tableviews[i].dataTable.columns.adjust()}}if(typeof this.getContent().template.adjustSize==="function")this.getContent().template.adjustSize()}Top.App.addDialog(this.id,this)},close:function(){this.__isOpen=false;if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("close"))}else{this.__dispatchEvent(new Event("close"))}var content=document.querySelector("#top-dialog-root_"+this.id+" .top-dialog-content");if(content!==undefined&&content!==null)this.clearDeepChilds(document.querySelector("#top-dialog-root_"+this.id+" .top-dialog-content"));top$(document.querySelector("#top-dialog-root_"+this.id)).remove();top$(document.querySelector("#top-dialog-overlay_"+this.id)).remove();Top.App.removeDialog(this.id);if(this.removeOnClose===true){if(Top.Util.Browser.isIE()){this.removeNode(true)}else{this.remove()}}document.removeEventListener("keydown",this.__keyDownListener)},isOpen:function(){return this.__isOpen},getContent:function(){var contentElem=document.querySelector("#top-dialog-root_"+this.id+" .top-dialog-content");if(contentElem){return Top.Dom.__selectImpl(contentElem.firstChild)}else{console.error("The dialog has no content.")}},__updateLayoutWidth:function(){var root=document.querySelector("#top-dialog-root_"+this.id);if(root){root.style.width=this.layoutWidth;this.__adjustPosition()}},__updateLayoutHeight:function(){var root=document.querySelector("#top-dialog-root_"+this.id);if(root){root.style.height=isNaN(this.layoutHeight)||parseInt(this.layoutHeight)>80?this.layoutHeight:"80px";this.__adjustPosition()}},__updateLayoutTop:function(){this.__adjustPosition()},__updateLayoutLeft:function(){this.__adjustPosition()},__updateZIndex:function(){var str="#top-dialog-root_"+this.id+".top-dialog-root";var dialogRoot=top$(str);if(this.zIndex){dialogRoot.css("z-index",this.zIndex)}},__updateTitle:function(){if(this.isOpen()===true){var span=document.querySelector("#top-dialog-root_"+this.id+" .top-dialog-title");span.textContent=this.__i18n(this.title)}},__updateOnOpen:function(){this.__addEventByAttr("open")},__updateOnClose:function(){this.__addEventByAttr("close")},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}};Top.Widget.Dialog=function(){Dialog.prototype=Object.create(Top.Widget.prototype);Dialog.prototype.constructor=Dialog;function Dialog(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-dialog");this.template.innerHTML="<div></div>"}this.id=this.template.id}Dialog.create=function(element){return new Dialog(element)};Dialog.prototype.addClass=function(className){this.template.className+=" "+className;this.template.__updateClass()};Dialog.prototype.removeClass=function(className){var classCheck=new RegExp("(\\s|^)"+className+"(\\s|$)");this.template.className=this.template.className.replace(classCheck," ").trim();this.template.__updateClass()};Dialog.prototype.toggleClass=function(className){var classCheck=new RegExp("(\\s|^)"+className+"(\\s|$)");if(classCheck.test(this.template.className)){this.template.className=this.template.className.replace(classCheck," ").trim()}else{this.template.className+=" "+className}this.template.__updateClass()};Dialog.prototype.open=function(){if(this.template.__isReady===true){this.template.open()}else{var _this=this;if(Top.Util.Browser.isIE()){top$(this.template).html(this.template.content)}this.template.__onReady=function(){_this.template.open()}}};Dialog.prototype.close=function(){this.template.close()};Dialog.prototype.isOpen=function(){return this.template.isOpen()};Dialog.prototype.getContent=function(){return this.template.getContent()};Dialog.prototype.adjustPosition=function(){this.template.__adjustPosition()};Dialog.prototype.setPosition=function(top,left,zIndex){this.template.__setPosition(top,left,zIndex)};Dialog.prototype.show=function(){document.getElementById("top-dialog-root_"+this.id).style.display="block";if(typeof this.template.getContent().template.adjustSize==="function")this.template.getContent().template.adjustSize()};Dialog.prototype.hide=function(){document.getElementById("top-dialog-root_"+this.id).style.display="none"};return Dialog}();TopDocklayout={is:"top-docklayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],ready:function(){this.initialChilds();this.renderLayout();this.updateStyle();this.__updateId();this.__updateName()},appendTemplate:function(){this.innerHTML='<div class="top-docklayout-root">'+this.innerHTML+"</div>"},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.name=this.name}},renderLayout:function(){for(var i=0;i<this.childs.length;i++){this.childRoot.appendChild(this.childs[i])}var layout_children=this.childs;for(var i=0;i<layout_children.length;i++){var layoutAlignParent="";if(layout_children[i].getAttribute("layout-align-parent")!=null){layoutAlignParent=layout_children[i].getAttribute("layout-align-parent")}else{layoutAlignParent=layout_children[i].layoutAlignParent}switch(layoutAlignParent){case"top":top$(layout_children[i]).wrap("<div class='north'></div>");break;case"bottom":top$(layout_children[i]).wrap("<div class='south'></div>");break;case"left":top$(layout_children[i]).wrap("<div class='east'></div>");break;case"right":top$(layout_children[i]).wrap("<div class='west'></div>");break;case"center":top$(layout_children[i]).wrap("<div class='center'></div>");break}}},initializeChildRoot:function(){return this.querySelector("div")},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("div");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle}};Top.Widget.Layout.Docklayout=function(){Docklayout.prototype=Object.create(Top.Widget.Layout.prototype);Docklayout.prototype.constructor=Docklayout;function Docklayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-docklayout");this.template.innerHTML='<div class="top-docklayout-root"></div>'}this.id=this.template.id}Docklayout.create=function(element){return new Docklayout(element)};return Docklayout}();TopFileuploader={is:"top-fileuploader",behaviors:[TopWidgetBehavior],properties:{maxFileCount:{type:Number,value:100},maxFileSize:{type:Number,value:100},dropzone:{type:Boolean,value:false},multiple:{type:Boolean,value:false},uploadButtonText:{type:String,value:"Upload"},deleteButtonText:{type:String,value:"Delete"},fileCountTitle:{type:String,value:"File"},fileSizeTitle:{type:String,value:"Size"},tableNameColumnText:{type:String,value:"File Name"},tableSizeColumnText:{type:String,value:"Size"},tableDeleteColumnText:{type:String,value:"Delete"},emptyMessage:{type:String,value:"No uploaded file in the table"},onBeforeload:String,onFileupload:String,onFilesizeexceed:String},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-fileuploader-root">'+this.innerHTML+"</div>"},__initialize:function(){this.__updateId();this.renderLayout();this.__initI18n("uploadButtonText");this.__initI18n("deleteButtonText");this.__initI18n("fileCountTitle");this.__initI18n("fileSizeTitle");this.__initI18n("tableNameColumnText");this.__initI18n("tableSizeColumnText");this.__initI18n("tableDeleteColumnText");this.__initI18n("emptyMessage")},__initEventInternal:function(){this.__addEventByAttr("beforeload");this.__addEventByAttr("fileupload");this.__addEventByAttr("filesizeexceed")},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-fileuploader-root");shadowRoot.id=this.id}},renderLayout:function(){var root=this.querySelector(".top-fileuploader-root");root.innerHTML="";var _this=this;var layout=Top.Widget.create("top-linearlayout",{className:"top-fileuploader-header "+_this.class});_this.fileData=Top.Data.create({items:[],currentCount:0,currentSize:0});_this.uploadButton=Top.Widget.create("top-button",{id:"fileuploader_upload_btn",className:"top-fileuploader-header-button "+_this.class,text:_this.__i18n(_this.uploadButtonText),margin:"0px 0px 0px 0px"});_this.uploadButton.setProperties({onClick:function(event,widget){Top.Device.FileChooser.create({id:"upload-file",title:"",windowId:"",saveAs:"false",extFilter:"",defaultExt:"",defaultPath:"",multiple:Top.Util.__isBooleanTrue(_this.multiple),charset:"utf-8",onBeforeLoad:function(file){if(_this.fileListTable){Top.Loader.start({parentId:_this.fileListTable.id})}if(!Top.Util.__isBooleanTrue(_this.multiple)||Object.keys(file).length===0){var fileSize=_this.__convertFileSize(file.size,2);var totalFileSize;totalFileSize=Number(_this.fileData.currentSize)+Number(fileSize);totalFileSize=totalFileSize.toFixed(2);if(Number(totalFileSize)>_this.maxFileSize){if(_this.fileListTable){Top.Loader.stop({parentId:_this.fileListTable.id})}_this.__dispatchEvent(new CustomEvent("filesizeexceed",{detail:file}));throw new TypeError("Cannot upload more than the maximum file size")}}else{var totalFileSize;for(var i=0;i<file.length;i++){var fileSize=_this.__convertFileSize(file[i].size,2);if(i===0){totalFileSize=Number(_this.fileData.currentSize)+Number(fileSize)}else{totalFileSize=Number(totalFileSize)+Number(fileSize)}totalFileSize=totalFileSize.toFixed(2);if(Number(totalFileSize)>_this.maxFileSize){if(_this.fileListTable){Top.Loader.stop({parentId:_this.fileListTable.id})}_this.__dispatchEvent(new CustomEvent("filesizeexceed",{detail:file[i]}));throw new TypeError("Cannot upload more than the maximum file size")}}}_this.__dispatchEvent(new CustomEvent("beforeload",{detail:file}))},onFileChoose:function(file){_this.__updateFileTable(file)}}).show()}});_this.uploadButton.template.__addEventByAttr("click");layout.addWidget(_this.uploadButton);_this.deleteButton=Top.Widget.create("top-button",{id:"top-fileuploader_delete_btn",className:"top-fileuploader-header-button "+_this.class,text:_this.__i18n(_this.deleteButtonText),margin:"0px 0px 0px 10px",disabled:"true"});_this.deleteButton.setProperties({onClick:function(event,widget){_this.__calculateRemainFileSize("multiple")}});_this.deleteButton.template.__addEventByAttr("click");layout.addWidget(_this.deleteButton);_this.fileSizeData=Top.Widget.create("top-textview",{id:"top-fileuploader_filesize_data",className:"top-fileuploader-header-text "+_this.class,text:"["+_this.__i18n(_this.fileSizeTitle)+": "+_this.fileData.currentSize+" / "+_this.maxFileSize+"MB]"});layout.addWidget(_this.fileSizeData);_this.fileCountData=Top.Widget.create("top-textview",{id:"top-fileuploader_filecount_data",className:"top-fileuploader-header-text "+_this.class,text:"["+_this.__i18n(_this.fileCountTitle)+": "+_this.fileData.currentCount+" / "+_this.maxFileCount+"]"});layout.addWidget(_this.fileCountData);layout.complete();var headerOption={0:{0:{"layout-width":"10%","header-control":"js::check"},1:{"layout-width":"50%",text:_this.__i18n(_this.tableNameColumnText)},2:{"layout-width":"25%",text:_this.__i18n(_this.tableSizeColumnText)},3:{"layout-width":"15%",text:_this.__i18n(_this.tableDeleteColumnText)}}};var columnOption={0:{type:"checkbox",value:"js::check",property:{onChange:function(event,widget){event.stopPropagation();event.preventDefault();var checkedDataLength=_this.fileListTable.getCheckedData().length;var deleteButton=_this.deleteButton;if(checkedDataLength>0){deleteButton.setDisabled(false)}else{deleteButton.setDisabled(true)}}}},1:{text:"{name}"},2:{text:"{size}"},3:{type:"button",align:"center",property:{icon:"icon-minus_thick",className:"top-fileuploader-cotent-delete-button "+_this.class,onClick:function(event,widget){event.stopPropagation();event.preventDefault();_this.__calculateRemainFileSize("single",widget)}}}};_this.fileListTable=Top.Widget.create("top-tableview",{id:"top-fileupload_fileListTable",className:"top-fileuploader-tableview "+_this.class,layoutWidth:"match_parent",itemClickType:"click",sortable:"false",columnReorder:"false",sequence:"false",paginate:"false",selectType:"row",editable:"false",emptyMessage:_this.__i18n(_this.emptyMessage),headerOption:headerOption,columnOption:columnOption});_this.fileListTable.setProperties({"on-headercheck":function(event,widget){var checkedDataLength=widget.getCheckedData().length;var deleteButton=_this.deleteButton;if(checkedDataLength>0){deleteButton.setDisabled(false)}else{deleteButton.setDisabled(true)}}});_this.fileListTable.template.__addEventByAttr("headercheck");root.insertBefore(layout.template,null);root.insertBefore(_this.fileListTable.template,null);if(_this.dropzone){_this.__updateDropzone()}},__updateFileTable:function(files){if(!Array.isArray(files))files=[files];var _this=this;for(var i=0;i<files.length;i++){var fileObject=new Object;var fileSize=_this.__convertFileSize(files[i].file[i].size,2);fileObject.name=files[i].file[i].name;fileObject.size=fileSize+" MB";fileObject.src=files[i].src;fileObject.path=files[i].path;_this.fileData.addValue("items",fileObject);_this.fileData.currentCount++;_this.fileData.currentSize=Number(_this.fileData.currentSize)+Number(fileSize)}_this.fileListTable.setProperties({items:_this.fileData.items});_this.fileCountData.setProperties({text:"["+_this.__i18n(_this.fileCountTitle)+": "+_this.fileData.currentCount+" / "+_this.maxFileCount+"]"});if(_this.fileData.currentSize>0){_this.fileData.currentSize=_this.fileData.currentSize.toFixed(2)}else{_this.fileData.currentSize=0}_this.fileSizeData.setProperties({text:"["+_this.__i18n(_this.fileSizeTitle)+": "+_this.fileData.currentSize+" / "+_this.maxFileSize+"MB]"});if(_this.fileListTable){Top.Loader.stop({parentId:_this.fileListTable.id})}_this.__dispatchEvent(new CustomEvent("fileupload",{detail:files}))},__updateOnBeforeload:function(){this.__addEventByAttr("beforeload")},__updateOnFileupload:function(){this.__addEventByAttr("fileupload")},__updateOnFilesizeexceed:function(){this.__addEventByAttr("filesizeexceed")},__updateDropzone:function(){var dropZone=document.getElementsByClassName("top-fileuploader-root")[0];if(this.dropzone){dropZone.addEventListener("dragover",this.__handleDragOver,false);dropZone.addEventListener("drop",this.__handleFileSelect,false)}else{dropZone.removeEventListener("dragover",this.__handleDragOver,false);dropZone.removeEventListener("drop",this.__handleFileSelect,false)}},__updateUploadButtonText:function(){this.uploadButton.setText(this.__i18n(this.uploadButtonText))},__updateDeleteButtonText:function(){this.deleteButton.setText(this.__i18n(this.deleteButtonText))},__updateFileCountTitle:function(){this.fileCountData.setText("["+this.__i18n(this.fileCountTitle)+": "+this.fileData.currentCount+" / "+this.maxFileCount+"]")},__updateFileSizeTitle:function(){this.fileSizeData.setText("["+this.__i18n(this.fileSizeTitle)+": "+this.fileData.currentSize+" / "+this.maxFileSize+"MB]")},__updateTableNameColumnText:function(){this.fileListTable.template.headerInfoArray[1].text=this.__i18n(this.tableNameColumnText);this.fileListTable.render()},__updateTableSizeColumnText:function(){this.fileListTable.template.headerInfoArray[2].text=this.__i18n(this.tableSizeColumnText);this.fileListTable.render()},__updateTableDeleteColumnText:function(){this.fileListTable.template.headerInfoArray[3].text=this.__i18n(this.tableDeleteColumnText);this.fileListTable.render()},__updateEmptyMessage:function(){this.fileListTable.template.emptyMessage=this.__i18n(this.emptyMessage);this.fileListTable.render()},__calculateRemainFileSize:function(deleteSrc,widgetInfo){var _this=this;var checkedData=_this.fileListTable.getCheckedData();if(deleteSrc==="multiple"){var checkedDataIndex=_this.fileListTable.getCheckedIndex();for(var i=0;i<checkedData.length;i++){var deleteFileSize=checkedData[i].size.split(" MB")[0];_this.fileData.currentSize=_this.fileData.currentSize-Number(deleteFileSize);_this.fileData.currentCount--}_this.fileListTable.removeRows(checkedDataIndex)}else{var deleteFileSize=_this.fileData.items[widgetInfo.getDataIndex()].size.split(" MB")[0];_this.fileData.currentSize=_this.fileData.currentSize-Number(deleteFileSize);_this.fileListTable.removeRows(widgetInfo.getDataIndex());_this.fileData.currentCount--}if(_this.fileData.currentSize>0){_this.fileData.currentSize=_this.fileData.currentSize.toFixed(2)}else{_this.fileData.currentSize=0}_this.fileSizeData.setProperties({text:"["+_this.__i18n(_this.fileSizeTitle)+": "+_this.fileData.currentSize+" / "+_this.maxFileSize+"MB]"});_this.fileCountData.setProperties({text:"["+_this.__i18n(_this.fileCountTitle)+": "+_this.fileData.currentCount+" / "+_this.maxFileCount+"]"});var deleteButton=_this.deleteButton;if(checkedData.length>0){deleteButton.setDisabled(false)}else{deleteButton.setDisabled(true)}},__handleFileSelect:function(event){event.stopPropagation();event.preventDefault();var _this=Top.Dom.selectById(this.id).template;var files=event.dataTransfer.files;if(_this.fileListTable){Top.Loader.start({parentId:_this.fileListTable.id})}var fileReader=Top.Device.FileChooser.create({id:"dropzone-file",title:"",windowId:"",saveAs:"false",extFilter:"",defaultExt:"",defaultPath:"",multiple:Top.Util.__isBooleanTrue(_this.multiple),file:files,onFileRead:function(readFile){_this.__updateFileTable(readFile)}});fileReader.read()},__handleDragOver:function(event){event.stopPropagation();event.preventDefault();event.dataTransfer.dropEffect="copy"},__convertFileSize:function(fileSize,fixed){var result;if(fileSize===0){result=0}else{result=fileSize/(1024*1024);result=fixed===undefined?result:result.toFixed(fixed)}return result},getCheckedData:function(){return this.fileListTable.getCheckedData()},getSelectedData:function(){return this.fileListTable.getSelectedData()},getClickedData:function(){return this.fileListTable.getClickedData()},getTopStyle:function(){this.topstyle=this.querySelector(".top-fileuploader-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-fileuploader-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-fileuploader-root").style.cssText=this.topstyle}};Top.Widget.Fileuploader=function(){Fileuploader.prototype=Object.create(Top.Widget.prototype);Fileuploader.prototype.constructor=Fileuploader;function Fileuploader(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-fileuploader");this.template.innerHTML='<div class="top-fileuploader-root"></div>'}this.id=this.template.id}Fileuploader.create=function(element){return new Fileuploader(element)};Fileuploader.prototype.getAllFileData=function(){return this.template.fileData.items};Fileuploader.prototype.getCheckedData=function(){return this.template.getCheckedData()};Fileuploader.prototype.getSelectedData=function(){return this.template.getSelectedData()};Fileuploader.prototype.getClickedData=function(){return this.template.getClickedData()};Fileuploader.prototype.getFileCount=function(){return this.template.fileData.currentCount};Fileuploader.prototype.getMaxFileCount=function(){return this.template.maxFileCount};Fileuploader.prototype.setMaxFileCount=function(maxFileCount){this.template.maxFileCount=maxFileCount;this.template.fileCountData.setProperties({text:"["+this.template.__i18n(this.template.fileCountTitle)+": "+this.template.fileData.currentCount+" / "+this.template.maxFileCount+"]"})};Fileuploader.prototype.getTotalFileSize=function(){return this.template.fileData.currentSize};Fileuploader.prototype.getMaxFileSize=function(){return this.template.maxFileSize};Fileuploader.prototype.setMaxFileSize=function(maxFileSize){this.template.maxFileSize=maxFileSize;this.template.fileSizeData.setProperties({text:"["+this.template.__i18n(this.template.fileSizeTitle)+": "+this.template.fileData.currentSize+" / "+this.template.maxFileSize+"MB]"})};return Fileuploader}();TopFlowlayout={is:"top-flowlayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{},__ready:function(){this.__updateId();this.initialChilds();this.renderLayout()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-flowlayout-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-flowlayout-root">'+this.innerHTML+"</div>"},__attached2:function(){this.adjustSize()},initializeChildRoot:function(){return this.querySelector(".top-flowlayout-root")},renderLayout:function(){for(var i=0;i<this.childRoot.children.length;i++){var child=this.childRoot.children[i];this.__setWrapperStyle(child)}},initialChilds:function(){this.childs=[];for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},__setWrapperStyle:function(child){if(!child.classList.contains("flow-child")){child.classList.add("flow-child")}var verticalAlignment="top";if(!child.getAttribute("layout-vertical-alignment")){child.setAttribute("layout-vertical-alignment",verticalAlignment);child.layoutVerticalAlignment=verticalAlignment;if(typeof child.setTopStyle==="function")child.setTopStyle("vertical-align",verticalAlignment)}},__setWidgetSize:function(adjustment){var root=this.childRoot;if(root.children.length<=0)return;var pWrapWidth=!this.layoutWidth||this.layoutWidth==="auto",pWrapHeight=!this.layoutHeight||this.layoutHeight==="auto";for(var i=0,len=root.children.length;i<len;i++){var item=root.children[i];if(adjustment&&typeof item.adjustSize==="function")item.adjustSize();var itemLayoutHeight=item.layoutHeight;var itemLayoutWidth=item.layoutWidth;if(itemLayoutWidth==="match_parent"){item.setThisWidgetWidth("100%")}if(itemLayoutHeight==="match_parent"){item.setThisWidgetHeight("100%")}}},adjustSize:function(){if(this.adjusted===true){for(var i=0;i<this.childRoot.children.length;i++){if(typeof this.childRoot.children[i].adjustSize==="function")this.childRoot.children[i].adjustSize()}return}var isVisible=!!(this.childRoot.offsetWidth||this.childRoot.offsetHeight||this.childRoot.getClientRects().length);if(isVisible===true){this.adjusted=true;this.__setWidgetSize(true)}},addWidget:function(widget){widget.__isRendered=true;this.adjusted=false;this.childRoot.appendChild(widget.template);this.__setWrapperStyle(widget.template)},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;this.adjusted=false;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child);break}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},complete:function(){this.renderLayout();this.__attached2()},getTopStyle:function(){this.topstyle=this.childRoot.style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.childRoot.style[key]=value;this.topstyle=this.childRoot.style.cssText}},setAllTopStyle:function(){this.childRoot.style.cssText=this.topstyle}};Top.Widget.Layout.Flowlayout=function(){Flowlayout.prototype=Object.create(Top.Widget.Layout.prototype);Flowlayout.prototype.constructor=Flowlayout;function Flowlayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-flowlayout");this.template.innerHTML='<div class="top-flowlayout-root"></div>'}this.id=this.template.id}Flowlayout.create=function(element){return new Flowlayout(element)};return Flowlayout}();TopFoldinglayout={
is:"top-foldinglayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{reduction:{type:String,value:"0px"},expansion:{type:String},onOpen:String,onClose:String},__ready:function(){this.__updateId();this.initialChilds();this.renderLayout();this.__attachEvent()},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-foldinglayout-content");shadowRoot.id=this.id}},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-foldinglayout-content");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},appendTemplate:function(){this.innerHTML='<div class="top-foldinglayout-content"><div class="top-foldinglayout-element">'+this.innerHTML+'</div><div class="top-foldinglayout-sub"><center><i class="top-foldinglayout-open top-foldinglayout-icon"></i></center></div></div>'},expectedTemplateClassName:function(){return"top-foldinglayout-content"},__initEventInternal:function(){this.__addEventByAttr("open");this.__addEventByAttr("close")},__attached2:function(){var shadowContent=this.childRoot.parentNode;this.fold=true;this.padding=top$(shadowContent).css("padding");this.borderWidth=shadowContent.style.borderWidth;this.oriWidth=this.layoutWidth;for(var i=0;i<this.childRoot.children.length;i++){var child=this.childRoot.children[i];this.__setWrapperStyle(child)}},__setWrapperStyle:function(child){if(typeof child.setTopStyle==="function")child.setTopStyle("vertical-align","top")},renderLayout:function(){},initializeChildRoot:function(){return this.querySelector(".top-foldinglayout-element")},__updateHorizontalScroll:function(){this.querySelector(".top-foldinglayout-element").style["overflow-x"]=this.horizontalScroll},__updateVerticalScroll:function(){this.querySelector(".top-foldinglayout-element").style["overflow-y"]=this.verticalScroll},close:function(reduction){this.fold=false;var shadowContent=this.childRoot.parentNode;var shadowElement=this.childRoot;var shadowIcon=shadowContent.querySelector(".top-foldinglayout-icon");top$(shadowContent).css("height",top$(shadowContent).height());this.borderWidth=shadowContent.style.borderWidth;this.contentWidth=shadowContent.style.width;if(reduction!==undefined){top$(shadowContent).css("width",reduction).css("padding-left","0px").css("padding-right","0px");this.layoutWidth=reduction}else{top$(shadowContent).css("width","0px").css("padding-left","0px").css("padding-right","0px");this.layoutWidth=this.reduction}if(reduction==="0px"||reduction===undefined)top$(shadowElement).hide();top$(shadowIcon).attr("class","top-foldinglayout-close top-foldinglayout-icon");this.__callParentAdjust();if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("close"),Top.Dom.selectById(this.id))}else{this.__dispatchEvent(new Event("close"),Top.Dom.selectById(this.id))}},open:function(){this.fold=true;var shadowContent=this.childRoot.parentNode;var shadowElement=this.childRoot;var shadowIcon=shadowContent.querySelector(".top-foldinglayout-icon");if(this.layoutHeight==undefined)top$(shadowContent).css("height","");else top$(shadowContent).css("height",this.layoutHeight);if(this.expansion){top$(shadowContent).css("width",this.expansion).css("padding-left",this.paddingLeft).css("padding-right",this.paddingRight).css("border-width",this.borderWidth);this.layoutWidth=this.expansion}else{top$(shadowContent).css("width",this.contentWidth).css("padding-left",this.paddingLeft).css("padding-right",this.paddingRight).css("border-width",this.borderWidth);this.layoutWidth=this.oriWidth}top$(shadowElement).show();top$(shadowIcon).attr("class","top-foldinglayout-open top-foldinglayout-icon");this.__callParentAdjust();if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("open"),Top.Dom.selectById(this.id))}else{this.__dispatchEvent(new Event("open"),Top.Dom.selectById(this.id))}},__callParentAdjust:function(){if(this.layoutParent&&this.layoutParent.tagName==="TOP-LINEARLAYOUT"){this.layoutParent.adjusted=false;this.layoutParent.complete()}},__attachEvent:function(){var _this=this;var shadowContent=this.childRoot.parentNode;var shadowBtn=shadowContent.querySelector(".top-foldinglayout-sub");top$(shadowBtn).on("click",function(e){if(_this.fold===true){_this.close(_this.reduction)}else{_this.open()}})},__updateOnOpen:function(){this.__addEventByAttr("open")},__updateOnClose:function(){this.__addEventByAttr("close")},getTopStyle:function(){this.topstyle=this.querySelector(".top-foldinglayout-content").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-foldinglayout-content");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-foldinglayout-content").style.cssText=this.topstyle}};Top.Widget.Layout.Foldinglayout=function(){Foldinglayout.prototype=Object.create(Top.Widget.Layout.prototype);Foldinglayout.prototype.constructor=Foldinglayout;function Foldinglayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-foldinglayout");this.template.innerHTML='<div class="top-foldinglayout-content"><div class="top-foldinglayout-element"></div><div class="top-foldinglayout-sub"><center><i class="top-foldinglayout-open top-foldinglayout-icon"></i></center></div></div>'}this.id=this.template.id}Foldinglayout.create=function(element){return new Foldinglayout(element)};Foldinglayout.prototype.open=function(){return this.template.open()};Foldinglayout.prototype.close=function(){return this.template.close()};return Foldinglayout}();TopForm={is:"top-form",behaviors:[TopWidgetBehavior],properties:{url:String,request:String,response:String,onSuccess:String,onFail:String},ready:function(){if(this.request){this.data=Top.Util.namespace(this.request.split(".data.")[0]);this.field=this.request.split(".data.")[1]}this.__updateId()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML="<div>"+this.innerHTML+"</div>"},submit:function(){var request=Top.Util.namespace(this.request);var response=Top.Util.namespace(this.response);var prop=this;var onSuccess=function(data,textStatus,jqXHR){var func=Top.Util.namespace(prop.onSuccess);if(typeof func==="function"){func(data,textStatus,jqXHR)}if(prop.data){prop.data.reset(prop.field)}};var onFail=Top.Util.namespace(this.onFail);Top.Ajax.post(this.url,this.request,this.response,onSuccess,onFail)},initializeChildRoot:function(){return this.querySelector("div")},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}};Top.Widget.Layout.Form=function(){Form.prototype=Object.create(Top.Widget.Layout.prototype);Form.prototype.constructor=Form;function Form(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-form");this.template.innerHTML="<div></div>"}this.id=this.template.id}Form.create=function(element){return new Form(element)};Form.prototype.submit=function(){this.template.submit()};return Form}();TopFramelayout={is:"top-framelayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],__ready:function(){this.initialChilds();this.updateStyle();this.__updateId();this.__updateName();this.renderLayout()},__attached2:function(){this.adjustSize()},appendTemplate:function(){this.innerHTML='<div class="top-framelayout-root">'+this.innerHTML+"</div>"},renderLayout:function(){var layoutRoot=this.childRoot;var pPaddingBottom=layoutRoot.style.paddingBottom||0,pPaddingRight=layoutRoot.style.paddingRight||0;for(var i=0;i<layoutRoot.children.length;i++){var child=layoutRoot.children[i];this.__setWrapperStyle(child,pPaddingBottom,pPaddingRight)}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.name=this.name}},__setWrapperStyle:function(child,pPaddingBottom,pPaddingRight){var horizontal_align=this.getAttribute("horizontal-alignment"),vertical_align=this.getAttribute("vertical-alignment"),horizontalString="left: 0",verticalString="top: 0",transformString="",horizontalPercentage="0",verticalPercentage="0";if(child.getAttribute("layout-horizontal-alignment"))horizontal_align=child.getAttribute("layout-horizontal-alignment");if(child.getAttribute("layout-vertical-alignment"))vertical_align=child.getAttribute("layout-vertical-alignment");if(horizontal_align==="center"){horizontalString="left: 50%;";horizontalPercentage="-50"}else if(horizontal_align==="right"){horizontalString="right: "+pPaddingRight||0+";";horizontalPercentage="0"}if(vertical_align==="middle"){verticalString="top: 50%;";verticalPercentage="-50"}else if(vertical_align==="bottom"){verticalString="bottom: "+pPaddingBottom||0+";";verticalPercentage="0"}transformString="transform:translate("+horizontalPercentage+"%, "+verticalPercentage+"%);";child.style.cssText="position: absolute; display:inline-block; "+horizontalString+verticalString+transformString},initialChilds:function(){this.childs=[];for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},initializeChildRoot:function(){return this.querySelector(".top-framelayout-root")},__setWidgetSize:function(){var layoutRoot=this.childRoot;var maxChildWidth=0;var maxChildHeight=0;var root=this.childRoot;for(var i=0,len=root.children.length;i<len;i++){var item=root.children[i];var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto",pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var pPaddingWidth=(parseInt(layoutRoot.style.paddingRight)||0)+(parseInt(layoutRoot.style.paddingLeft)||0),pPaddingHeight=(parseInt(layoutRoot.style.paddingTop)||0)+(parseInt(layoutRoot.style.paddingBottom)||0);if(item.layoutWidth==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{item.style.width="calc(100% - "+pPaddingWidth+"px)";item.setThisWidgetWidth("100%")}}else if(item.layoutWidth&&item.layoutWidth.includes("%")){item.style.width="calc("+item.layoutWidth+" - "+pPaddingWidth+"px)";item.setThisWidgetWidth("100%")}if(item.layoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{item.style.height="calc(100% - "+pPaddingHeight+"px)";item.setThisWidgetHeight("100%")}}else if(item.layoutHeight&&item.layoutHeight.includes("%")){item.style.height="calc("+item.layoutHeight+" - "+pPaddingHeight+"px)";item.setThisWidgetHeight("100%")}if(pWrapWidth){if(item.getElement()&&item.getElement().offsetWidth>maxChildWidth)maxChildWidth=item.getElement().offsetWidth;this.removeTopStyle("width");this.setTopStyle("width",maxChildWidth+"px")}if(pWrapHeight){if(item.getElement()&&item.getElement().offsetHeight>maxChildHeight)maxChildHeight=item.getElement().offsetHeight;this.removeTopStyle("height");this.setTopStyle("height",maxChildHeight+"px")}}},addWidget:function(widget){var layoutRoot=this.childRoot;var pPaddingBottom=layoutRoot.style.paddingBottom||0;var pPaddingRight=layoutRoot.style.paddingRight||0;widget.__isRendered=true;this.adjusted=false;layoutRoot.appendChild(widget.template);this.__setWrapperStyle(widget.template,pPaddingBottom,pPaddingRight)},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;this.adjusted=false;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child);break}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},complete:function(){this.adjustSize()},getTopStyle:function(){this.topstyle=this.querySelector(".top-framelayout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-framelayout-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-framelayout-root").style.cssText=this.topstyle}};Top.Widget.Layout.Framelayout=function(){Framelayout.prototype=Object.create(Top.Widget.Layout.prototype);Framelayout.prototype.constructor=Framelayout;function Framelayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-framelayout");this.template.innerHTML='<div class="top-framelayout-root"></div>'}this.id=this.template.id}Framelayout.create=function(element){return new Framelayout(element)};return Framelayout}();TopGridlayout={is:"top-gridlayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{cols:{type:Number,value:1},rows:{type:Number,value:1},cellWidth:{type:Number,value:0},cellHeight:{type:Number,value:0},innerBorderWidth:String,innerBorderTopWidth:String,innerBorderBottomWidth:String,innerBorderLeftWidth:String,innerBorderRightWidth:String,innerBorderStyle:String,innerBorderColor:String},__ready:function(){this.__updateId();this.initialChilds();this.childDeepCopy();this.renderLayout();this.childs=this.deepChilds},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-gridlayout-content");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-gridlayout-root">'+this.innerHTML+"</div>"},__attached2:function(){this.__initAlign();this.adjustSize()},childDeepCopy:function(){this.deepChilds=this.childs.clone()},renderLayout:function(){this.clearChilds();if(this.tileMode==="inherit"){this.tileMode=this.parentNode.parentNode.getAttribute("tile-mode");this.updateStyle("tile-mode")}var table=document.createElement("table");table.style.cssText="width:100%;";var tbody=document.createElement("tbody");table.appendChild(tbody);this.childRoot.appendChild(table);for(var i=1;i<parseInt(this.rows)+1;i++){var tr=document.createElement("tr");tr.className="row_"+i;tbody.appendChild(tr);for(var j=1;j<parseInt(this.cols)+1;j++){tr.innerHTML+="<td class='top-gridlayout-cell col_"+j+"'><div></div></td>"}}var layout_children=this.deepChilds;this.createdItemWidgets=[];this.createdCustomItemWidgets=[];for(var i=0;i<layout_children.length;i++){var childCol=1;var childRow=1;var childColSpan=1;var childRowSpan=1;var horizontal_align="left";var vertical_align="top";if(layout_children[i].getAttribute("layout-column")!=null){childCol=layout_children[i].getAttribute("layout-column");childRow=layout_children[i].getAttribute("layout-row");childColSpan=layout_children[i].getAttribute("layout-column-span");childRowSpan=layout_children[i].getAttribute("layout-row-span");if(this.getAttribute("horizontal-alignment"))horizontal_align=this.getAttribute("horizontal-alignment");horizontal_align=layout_children[i].getAttribute("layout-horizontal-alignment")||horizontal_align;if(this.getAttribute("vertical-alignment"))vertical_align=this.getAttribute("vertical-alignment");layout_children[i].vertical_align=layout_children[i].getAttribute("layout-vertical-alignment")||vertical_align}if(childColSpan==null){childColSpan=1}if(childRowSpan==null){childRowSpan=1}var cell=this.querySelector("#"+this.id+">table>tbody>.row_"+childRow+">.col_"+childCol);var wrapper=document.createElement("div");wrapper.appendChild(layout_children[i]);this.createHtmlObjects(wrapper);while(wrapper.firstChild){cell.firstChild.appendChild(wrapper.firstChild)}cell.setAttribute("colspan",childColSpan);cell.setAttribute("rowspan",childRowSpan);cell.setAttribute("style","text-align:"+horizontal_align+"; overflow:hidden; white-space:nowrap; vertical-align:"+vertical_align+";");if(parseInt(childColSpan)>1){for(var col=parseInt(childCol)+1;col<parseInt(childCol)+parseInt(childColSpan);col++){this.childRoot.querySelector("tr.row_"+childRow).removeChild(this.childRoot.querySelector("tr.row_"+childRow+" td.col_"+col))}}if(parseInt(childRowSpan)>1){for(var row=parseInt(childRow)+1;row<parseInt(childRow)+parseInt(childRowSpan);row++){this.childRoot.querySelector("tr.row_"+row).removeChild(this.childRoot.querySelector("tr.row_"+row+" td.col_"+childCol))}}}this.createdItemWidgetAttachedCallback()},initializeChildRoot:function(){return this.querySelector(".top-gridlayout-root")},__initAlign:function(){var layout_children=this.childs;for(var i=0;i<layout_children.length;i++){layout_children[i].removeTopStyle("vertical-align");layout_children[i].setTopStyle("vertical-align",layout_children[i].vertical_align)}},getNotInitializedParentRoot:function(){var parent=this.getParent();while(parent.getParent().__initialized===undefined){parent=parent.getParent()}return parent},__setCellStyle:function(){var tds=this.querySelectorAll("#"+this.id+">table>tbody>tr>td.top-gridlayout-cell");for(var i=0;i<tds.length;i++){tds[i].style.borderWidth=this.innerBorderWidth||"0px";tds[i].style.borderBottomWidth=this.innerBorderBottomWidth;tds[i].style.borderLeftWidth=this.innerBorderLeftWidth;tds[i].style.borderRightWidth=this.innerBorderRightWidth;tds[i].style.borderTopWidth=this.innerBorderTopWidth;tds[i].style.borderStyle=this.innerBorderStyle||"solid";tds[i].style.borderColor=this.innerBorderColor||"#000"}},__setCellSize:function(){var _this=this;if(Top.App.isLoaded()){if(this.layoutParent===undefined){var p=this.getNotInitializedParentRoot();if(p.__redrawChild===undefined)p.__redrawChild=[];var f=function(){_this.setCellSize()};p.__redrawChild.push(f)}else{this.setCellSize()}}else{Top.App.onBeforeLoad(function(){if(_this.layoutParent===undefined){var p=_this.getNotInitializedParentRoot();if(p.__redrawChild===undefined)p.__redrawChild=[];var f=function(){_this.setCellSize()};p.__redrawChild.push(f)}else{_this.setCellSize()}})}},setCellSize:function(){this.__setCellStyle();if(Top.Util.Browser.isIE()){var layoutRoot=this.childRoot;var colspans=layoutRoot.querySelectorAll("#"+this.id+">table>tbody>tr>td.top-gridlayout-cell[colspan]");for(var i=0;i<colspans.length;i++){colspans[i].style.width=""}var rowspans=layoutRoot.querySelectorAll("#"+this.id+">table>tbody>tr>td.top-gridlayout-cell[rowspan]>div");for(var i=0;i<rowspans.length;i++){rowspans[i].style.width=""}if(this.layoutWidth==="auto"){var cell=layoutRoot.querySelectorAll("#"+this.id+">table>tbody>tr>td.top-gridlayout-cell[rowspan='1']");for(var i=0;i<cell.length;i++){var maxCellWidth;if(i===0)maxCellWidth=cell[i].clientWidth;else maxCellWidth=Math.max(maxCellWidth,cell[i].clientWidth)}this.cellWidth=maxCellWidth;for(var i=0;i<colspans.length;i++){colspans[i].style.width=this.cellWidth}}else{this.cellWidth=top$(layoutRoot).width()/parseInt(this.cols);for(var i=0;i<colspans.length;i++){colspans[i].style.width=this.cellWidth}}if(this.layoutHeight==="auto"){var cell=layoutRoot.querySelectorAll("td.top-gridlayout-cell[rowspan='1']");for(var i=0;i<cell.length;i++){var maxCellHeight;if(i===0)maxCellHeight=cell[i].clientHeight;else maxCellHeight=Math.max(maxCellHeight,cell[i].clientHeight)}this.cellHeight=maxCellHeight;for(var i=0;i<rowspans.length;i++){rowspans[i].style.height=this.cellHeight+"px";rowspans[i].style.width="inherit"}}else{this.cellHeight=top$(layoutRoot).height()/parseInt(this.rows);for(var i=0;i<rowspans.length;i++){rowspans[i].style.height=this.cellHeight+"px";rowspans[i].style.width="inherit"}}}else{var layoutRoot=this.childRoot;var colspans=this.querySelectorAll("#"+this.id+">table>tbody>tr>td.top-gridlayout-cell[colspan]");for(var i=0;i<colspans.length;i++){colspans[i].style.width=""}var rowspans=this.querySelectorAll("#"+this.id+">table>tbody>tr>td.top-gridlayout-cell[rowspan]>div");for(var i=0;i<rowspans.length;i++){rowspans[i].style.width=""}if(this.layoutWidth==="auto"){var cell=this.querySelectorAll("#"+this.id+">table>tbody>tr>td.top-gridlayout-cell[rowspan='1']");for(var i=0;i<cell.length;i++){var maxCellWidth;if(i===0)maxCellWidth=cell[i].clientWidth;else maxCellWidth=Math.max(maxCellWidth,cell[i].clientWidth)}this.cellWidth=maxCellWidth;for(var i=0;i<colspans.length;i++){colspans[i].style.width=this.cellWidth}}else{this.cellWidth=top$(layoutRoot).width()/parseInt(this.cols);for(var i=0;i<colspans.length;i++){colspans[i].style.width=this.cellWidth}}if(this.layoutHeight==="auto"){var cell=this.querySelectorAll("#"+this.id+">table>tbody>tr>td.top-gridlayout-cell[rowspan=1]");for(var i=0;i<cell.length;i++){var maxCellHeight;if(i===0)maxCellHeight=cell[i].clientHeight;else maxCellHeight=Math.max(maxCellHeight,cell[i].clientHeight)}this.cellHeight=maxCellHeight;for(var i=0;i<rowspans.length;i++){rowspans[i].style.height="100%";rowspans[i].style.width="inherit"}}else{this.cellHeight=top$(layoutRoot).height()/parseInt(this.rows);for(var i=0;i<rowspans.length;i++){rowspans[i].style.height="100%";rowspans[i].style.width="inherit"}}}var newHeight=this.cellHeight;var rowspans=this.querySelectorAll("#"+this.id+">table>tbody>tr>td.top-gridlayout-cell>div");var tds=this.querySelectorAll("#"+this.id+">table>tbody>tr>td.top-gridlayout-cell");for(var i=0;i<rowspans.length;i++){var borderWidthTop=tds[i].style.borderTopWidth.split("px")[0];var borderWidthBottom=tds[i].style.borderBottomWidth.split("px")[0];rowspans[i].style.height=newHeight-borderWidthTop-borderWidthBottom+"px"}},__setWidgetSize:function(){var _this=this;var childrenArray=Array.prototype.slice.call(this.childs);childrenArray.forEach(function(item,index){if(item.layoutWidth==="match_parent"){item.setThisWidgetWidth("100%",_this,_this.childs)}if(item.layoutHeight==="match_parent"){item.setThisWidgetHeight("100%",_this,_this.childs)}})},getTopStyle:function(){this.topstyle=this.querySelector(".top-gridlayout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-gridlayout-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-gridlayout-root").style.cssText=this.topstyle}};Top.Widget.Layout.Gridlayout=function(){Gridlayout.prototype=Object.create(Top.Widget.Layout.prototype);Gridlayout.prototype.constructor=Gridlayout;function Gridlayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-gridlayout");this.template.innerHTML='<div class="top-gridlayout-root"></div>'}this.id=this.template.id}Gridlayout.create=function(element){return new Gridlayout(element)};return Gridlayout}();TopHtmleditor={is:"top-htmleditor",behaviors:[TopWidgetBehavior],properties:{format:String,fontSize:String,fontSizes:Array,color:String,bold:String,italic:String,underline:String,numberList:String,bulletList:String,subScript:String,superScript:String,indent:String,outdent:String,left:String,center:String,right:String,strike:String,link:String,unlink:String,clean:String,rule:String,source:String,placeholder:String,tabIndex:{type:String,value:"0"},text:String,html:String},ready:function(){this.__initialize();this.__updateId();this.__updateName()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-htmleditor-root");var shadowContainer=this.querySelector(".top-htmleditor-container");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func},__eventMouseClick:function(func){shadowContainer.onclick=func},__eventMousePressed:function(func){shadowContainer.onmousedown=func},__eventMouseReleased:function(func){shadowContainer.onmouseup=func},__eventMouseDblclick:function(func){shadowContainer.ondblclick=func},__eventKeyPressed:function(func){shadowContainer.onkeydown=func},__eventKeyTyped:function(func){shadowContainer.onkeypress=func},__eventKeyReleased:function(func){shadowContainer.onkeyup=func},__eventFocused:function(func){shadowContainer.onfocus=func},__eventLostFocused:function(func){shadowContainer.onblur=func},__eventMouseEnter:function(func){shadowContainer.onmouseenter=func},__eventMouseExit:function(func){shadowContainer.onmouseleave=func},__eventMouseMove:function(func){shadowContainer.onmousemove=func},__eventSecondaryClick:function(func){shadowContainer.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.name=this.name}},__reRender:function(){var editorHTML=this.getEditorHTML();while(this.firstChild){this.removeChild(this.firstChild)}this.appendTemplate();this.__initialize();this.querySelector(".jqte_editor").innerHTML=editorHTML},appendTemplate:function(){this.innerHTML='<div class="top-htmleditor-root">'+this.innerHTML+"</div>"},__initialize:function(){var options=this.__makeOptions();top$(this.children[0]).jqte(options);this.querySelector(".jqte").classList.add("top-htmleditor-container");this.__updateLayoutWidth();this.__updateLayoutHeight();this.__updateMargin();this.__updateVerticalAlign();this.__updateDisabled();this.__updateTabIndex();this.querySelector(".jqte_editor").innerHTML="";this.setEditorText(this.text);this.setEditorHTML(this.html)},__makeOptions:function(){return{format:!(this.format==="false"||this.format===false),fsize:!(this.fontSize==="false"||this.fontSize===false),fsizes:this.fontSizes?this.fontSizes:[10,12,16,18,20,24,28],color:!(this.color==="false"||this.color===false),b:!(this.bold==="false"||this.bold===false),i:!(this.italic==="false"||this.italic===false),u:!(this.underline==="false"||this.underline===false),ol:!(this.numberList==="false"||this.numberList===false),ul:!(this.bulletList==="false"||this.bulletList===false),sub:!(this.subScript==="false"||this.subScript===false),sup:!(this.superScript==="false"||this.superScript===false),indent:!(this.indent==="false"||this.indent===false),outdent:!(this.outdent==="false"||this.outdent===false),left:!(this.left==="false"||this.left===false),center:!(this.center==="false"||this.center===false),right:!(this.right==="false"||this.right===false),strike:!(this.strike==="false"||this.strike===false),link:!(this.link==="false"||this.link===false),unlink:!(this.unlink==="false"||this.unlink===false),remove:!(this.clean==="false"||this.remove===false),rule:!(this.rule==="false"||this.rule===false),source:!(this.source==="false"||this.source===false),placeholder:this.placeholder?this.placeholder:""}},__updateLayoutWidth:function(){var layoutWidth=this.layoutWidth;var container=this.querySelector(".top-htmleditor-container");var _this=this;if(this.layoutWidth==="match_parent")return;this.removeTopStyle("width");this.setTopStyle("width",layoutWidth);if(container){if(this.layoutWidth=="wrap_content"||this.layoutWidth==""||this.layoutWidth==undefined||this.layoutWidth=="auto"){this.setTopStyle("width",container.offsetWidth+"px")}}this.updatePositionValue(false);setTimeout(function(){if(typeof _this.__initTooltip==="function")_this.__initTooltip()})},__updateLayoutHeight:function(){this.removeTopStyle("height");this.style.height="";var toolbar=this.querySelector(".jqte_toolbar");var container=this.querySelector(".top-htmleditor-container");var editor=this.querySelector(".jqte_editor");if(container){if(this.layoutHeight==="match_parent"){this.style.height="100%";container.style.height="calc(100% - "+(parseInt(this.marginTop)+parseInt(this.marginBottom))+"px)"}else if(this.layoutHeight&&this.layoutHeight.endsWith("%")){this.style.height=this.layoutHeight;container.style.height="calc("+this.layoutHeight+" - "+(parseInt(this.marginTop)+parseInt(this.marginBottom))+"px)"}else if(this.layoutHeight=="wrap_content"||this.layoutHeight==""||this.layoutHeight==undefined||this.layoutHeight=="auto"){this.setTopStyle("height",container.offsetHeight+"px")}else{this.setTopStyle("height",this.layoutHeight)}window.setTimeout(function(){editor.style.height="calc(100% - "+(toolbar.offsetHeight+1)+"px)"},0)}this.updatePositionValue(false)},__updateMargin:function(){this.setTopStyle("margin",this.margin)},__updateVerticalAlign:function(){this.setTopStyle("vertical-align",this.layoutVerticalAlignment)},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();var container=this.querySelector(".top-htmleditor-container");if(!container.querySelector(".top-htmleditor-disable-cover"))container.insertAdjacentHTML("beforeend",'<div class="top-htmleditor-disable-cover"></div>');if(disabled=="true"||disabled==true){this.setAttribute("disabled","true")}else{this.removeAttribute("disabled")}},__updateTabIndex:function(){this.querySelector(".jqte_editor").setAttribute("tabindex",this.tabIndex)},initializeChildRoot:function(){return this.querySelector(".top-htmleditor-root")},getValue:function(){return top$(this).find(".top-htmleditor-root").val()},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-htmleditor-root");if((key=="width"||key=="height"||key=="margin"||key=="vertical-align")&&this.querySelector(".top-htmleditor-container")){styleNode=this.querySelector(".top-htmleditor-container")}styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-htmleditor-root").style.cssText=this.topstyle;if(this.querySelector(".top-htmleditor-container")){this.querySelector(".top-htmleditor-container").style.cssText=this.topstyle}},getEditorHTML:function(){
return this.getValue()},getEditorText:function(){return this.querySelector(".jqte_editor").innerText},setEditorHTML:function(string){if(string){this.querySelector(".jqte_editor").innerHTML=string}},setEditorText:function(string){if(string){this.querySelector(".jqte_editor").innerText=string}},addImage:function(src,attributes){var html=this.getEditorHTML();var img='<img src="'+src+'"';if(typeof attributes==="object"){var keys=Object.keys(attributes);for(var i=0,len=keys.length;i<len;i++){img+=" "+keys[i]+'="'+attributes[keys[i]]+'"'}}img+=">";top$(this.children[0]).jqteVal(html+img)}};Top.Widget.Htmleditor=function(){Htmleditor.prototype=Object.create(Top.Widget.prototype);Htmleditor.prototype.constructor=Htmleditor;function Htmleditor(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-htmleditor");this.template.innerHTML='<div class="top-htmleditor-root"></div>'}this.id=this.template.id}Htmleditor.create=function(element){return new Htmleditor(element)};Htmleditor.prototype.getValue=function(){return this.template.getValue()};Htmleditor.prototype.getEditorHTML=function(){return this.template.getEditorHTML()};Htmleditor.prototype.getEditorText=function(){return this.template.getEditorText()};Htmleditor.prototype.addImage=function(src,attributes){return this.template.addImage(src,attributes)};Htmleditor.prototype.setEditorHTML=function(string){return this.template.setEditorHTML(string)};Htmleditor.prototype.setEditorText=function(string){return this.template.setEditorText(string)};Htmleditor.prototype.setText=function(string){return};return Htmleditor}();TopIcon={is:"top-icon",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{contentColor:{type:String,value:"#fff"},contentSize:{type:String}},__ready:function(){if(this.classList.length>1){this.__updateByClassList()}this.__updateId()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-icon-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},appendTemplate:function(){this.innerHTML='<span class="top-icon-root"><i class="top-icon-content">'+this.innerHTML+"</i></span>"},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-icon-root");shadowRoot.id=this.id}},__attached2:function(){var contentElement=this.querySelector(".top-icon-content");var rootElement=this.querySelector(".top-icon-root");if(rootElement.offsetHeight>0)contentElement.style.lineHeight=rootElement.offsetHeight+"px";this.__updateClass();this.__updateTextColor()},__updateByClassList:function(){var contentClass="";var checkIconClass=/(icon-[A-Za-z0-9_-]+)/gm;var matchResult=this.className.match(checkIconClass);var contentElement=this.querySelector(".top-icon-content");var beforeContent=contentElement.classList[1];if(matchResult&&matchResult.length>1&&matchResult[matchResult.length-2]!=matchResult[matchResult.length-1]){contentClass=matchResult[matchResult.length-1];if(beforeContent&&contentClass!=beforeContent){contentElement.classList.remove(beforeContent)}this.classList.remove(contentClass);contentElement.classList.add(contentClass);contentElement.style.color=this.contentColor;if(this.contentSize){contentElement.style.fontSize=this.contentSize}}else{contentElement.classList.remove(beforeContent)}},__updateClass:function(){if(this.class!=""){var classArray=this.class.split(" ");var newIcon=classArray[0];if(this.__originClass){var beforeIcon=this.__originClass}if(beforeIcon&&beforeIcon!=newIcon){this.classList.remove(beforeIcon)}else{if(classArray[1]){this.classList.remove(classArray[0],classArray[1]);this.classList.add(classArray[0]);this.classList.add(classArray[1])}else{this.classList.remove(beforeIcon);this.classList.add(newIcon)}}this.__updateByClassList();this.__originClass=this.class.split(" ")[0]}else{this.classList.remove(this.__originClass);var contentElement=this.querySelector(".top-icon-content");contentElement.classList.remove(contentElement.classList[1])}},__updateTextColor:function(){var rootElement=this.querySelector(".top-icon-root");rootElement.style.color=this.textColor},getTopStyle:function(){this.topstyle=this.querySelector(".top-icon-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-icon-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-icon-root").style.cssText=this.topstyle}};Top.Widget.Icon=function(){Icon.prototype=Object.create(Top.Widget.prototype);Icon.prototype.constructor=Icon;function Icon(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-icon");this.template.innerHTML='<span class="top-icon-root"><i class="top-icon-content"></i></span>'}this.id=this.template.id}Icon.create=function(element){return new Icon(element)};return Icon}();TopImagebutton={is:"top-imagebutton",behaviors:[TopWidgetBehavior,TopResourceBehavior],properties:{},__ready:function(){this.__updateId();this.__updateDisabled();this.__updateSrc();this.__updateAlt()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-imagebutton-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-imagebutton-root");shadowRoot.id=this.id}},__updateAlt:function(){if(this.description){var shadowRoot=this.querySelector(".top-imagebutton-root");shadowRoot.alt=this.description}},appendTemplate:function(){this.innerHTML='<input class="top-imagebutton-root" type="image"></input>'},__updateDisabled:function(){var shadowInput=this.querySelector("input");this.__setDisabled(shadowInput)},__updateSrc:function(){if(this.src){if(this.src.includes("@drawable")){this.src=Top.DrawableManager.get(this.src.replace("@drawable/",""))}var shadowRoot=this.querySelector(".top-imagebutton-root");shadowRoot.setAttribute("src",this.src)}},getTopStyle:function(){this.topstyle=this.querySelector(".top-imagebutton-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-imagebutton-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-imagebutton-root").style.cssText=this.topstyle}};Top.Widget.Imagebutton=function(){Imagebutton.prototype=Object.create(Top.Widget.prototype);Imagebutton.prototype.constructor=Imagebutton;function Imagebutton(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-imagebutton");this.template.innerHTML='<input class="top-imagebutton-root" type="image"></input>'}this.id=this.template.id}Imagebutton.create=function(element){return new Imagebutton(element)};return Imagebutton}();TopImageslider={is:"top-imageslider",behaviors:[TopWidgetBehavior,TopGroupBehavior],properties:{mode:{type:String,value:"horizontal"},autoSlide:{type:String,value:"false"},speed:{type:Number,value:500},startSlide:{type:Number,value:0},slide:Object,randomStart:{type:Boolean,value:false},onError:String,onItemClick:String},ready:function(){this.initItems();this.__initialize();this.__initEventInternal();this.__updateMode();this.__updateAutoSlide()},__attached2:function(){var thisSlider=this;if(thisSlider.querySelector(".top-imageslider-ul").offsetHeight==0){}},__initEventInternal:function(){this.__addEventByAttr("itemClick");this.__addEventByAttr("error")},__updateOnItemClick:function(){this.__addEventByAttr("itemClick")},__updateOnError:function(){this.__addEventByAttr("error")},__initialize:function(){this.clearItems();this.slide=null;var _this=this;var imgSrc="";var imgCaption="";var str="";this.autoSlide=this.autoSlide==="true"||this.autoSlide===true;this.randomStart=this.randomStart==="true"||this.randomStart===true;var div=document.createElement("div");var ul=document.createElement("ul");div.setAttribute("id",this.id);div.classList.add("top-imageslider-root");div.setAttribute("style",this.topstyle);ul.classList.add("top-imageslider-ul");div.appendChild(ul);this.appendChild(div);for(var i=0;i<this.widgetItems.length;i++){if(this.widgetItems[i].getAttribute("src")!=null){imgSrc=this.widgetItems[i].getAttribute("src");imgCaption=this.widgetItems[i].getAttribute("caption")}else{imgSrc=this.widgetItems[i].src;imgCaption=this.widgetItems[i].caption}var li=document.createElement("i");var img=document.createElement("img");img.setAttribute("src",imgSrc);if(imgCaption)img.setAttribute("title",imgCaption);if(this.onError){img.addEventListener("error",function(){_this.__dispatchEvent(new CustomEvent("error",{detail:{src:this.getAttribute("src"),title:this.getAttribute("title")}}))})}if(this.onItemClick){img.addEventListener("click",function(){_this.__dispatchEvent(new CustomEvent("itemClick",{detail:{src:this.getAttribute("src"),title:this.getAttribute("title")}}))})}var cntLoaded=0;img.onload=function(){cntLoaded++;if(cntLoaded===_this.widgetItems.length&&_this.__redrawed!==true){if(_this.querySelector(".top-imageslider-ul").offsetHeight==0){_this.slide.redrawSlider();var viewport=_this.querySelector(".top-imageslider-viewport");if(viewport){viewport.style.height="calc(100% - 2px)";viewport.style.width="100%"}}}};li.appendChild(img);this.querySelector(".top-imageslider-ul").appendChild(li)}var root=_this.querySelector(".top-imageslider-root");if(this.widgetItems.length!=0){this.slide=top$(this.querySelector("#"+this.id+" .top-imageslider-ul")).bxSlider({mode:this.mode,auto:this.autoSlide,speed:this.speed,startSlide:this.startSlide,randomStart:this.randomStart,wrapperClass:"top-imageslider-container",nextText:"",prevText:"",onSliderLoad:function(){var viewport=_this.querySelector(".top-imageslider-viewport");if(viewport){viewport.style.height="calc(100% - 2px)";viewport.style.width="100%"}setTimeout(function(){var iTag=_this.getElementsByTagName("i");for(var i=0;i<iTag.length;i++){if(_this.layoutHeight!=""&&_this.layoutHeight!="auto"&&_this.layoutHeight!="wrap_content"){if(_this.layoutHeight=="match_parent"||_this.layoutHeight=="100%"){iTag[i].style.height=_this.offsetHeight+"px"}else{iTag[i].style.height=_this.layoutHeight}}else{iTag[i].style.height=root.clientHeight+"px"}if(_this.layoutWidth=="match_parent")iTag[i].style.width=_this.offsetWidth+"px"}});var container=_this.querySelector(".top-imageslider-container");container.style.height="100%";if(_this.layoutHeight==="match_parent"){root.style.height="100%"}if(_this.layoutWidth==="match_parent"){root.style.width="100%"}if(_this.slide){_this.slide.redrawSlider();_this.__redrawed=true}}})}top$(document).off("mouseenter").on("mouseenter","#"+this.id+" .top-imageslider-prev",function(){_this.querySelector(".top-imageslider-pager").style.backgroundColor="rgba(0, 0, 0, 0.7)"});top$(document).off("mouseenter").on("mouseenter","#"+this.id+" .top-imageslider-next",function(){_this.querySelector(".top-imageslider-pager").style.backgroundColor="rgba(0, 0, 0, 0.7)"});top$(document).off("mouseleave").on("mouseleave","#"+this.id+" .top-imageslider-prev",function(){_this.querySelector(".top-imageslider-pager").style.backgroundColor=""});top$(document).off("mouseleave").on("mouseleave","#"+this.id+" .top-imageslider-next",function(){_this.querySelector(".top-imageslider-pager").style.backgroundColor=""})},initializeChildRoot:function(){return this},__updateMode:function(){},reloadSlide:function(){this.slide.reloadSlider()},redrawSlide:function(){this.slide.redrawSlider()},__updateAutoSlide:function(){},goToSlide:function(index){this.slide.goToSlide(index)},goToNextSlide:function(){this.slide.goToNextSlide()},goToPrevSlide:function(){this.slide.goToPrevSlide()},startAuto:function(){this.slide.startAuto(index)},stopAuto:function(){this.slide.stopAuto(index)},getCurrentSlide:function(){return this.slide.getCurrentSlide()},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){if((key==="height"||key==="width")&&value=="auto")return;this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}};Top.Widget.Group.Imageslider=function(){Imageslider.prototype=Object.create(Top.Widget.Group.prototype);Imageslider.prototype.constructor=Imageslider;function Imageslider(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-imageslider")}this.id=this.template.id}Imageslider.create=function(element){return new Imageslider(element)};Imageslider.prototype.goToSlide=function(index){this.template.goToSlide(index)};Imageslider.prototype.goToNextSlide=function(){this.template.goToNextSlide()};Imageslider.prototype.goToPrevSlide=function(){this.template.goToPrevSlide()};Imageslider.prototype.startAuto=function(){this.template.startAuto(index)};Imageslider.prototype.stopAuto=function(){this.template.stopAuto(index)};Imageslider.prototype.getCurrentSlide=function(){return this.template.getCurrentSlide()};Imageslider.prototype.reload=function(){return this.template.reloadSlide()};Imageslider.prototype.redraw=function(){return this.template.redrawSlide()};return Imageslider}();TopImageview={is:"top-imageview",behaviors:[TopWidgetBehavior,TopResourceBehavior],__ready:function(){this.__updateId();this.__updateSrc();this.__updateAlt();this.__initFontSize();this.__updateTabIndex()},__initFontSize:function(){if(this.boxShadow!==undefined&&this.textSize===undefined){this.setTopStyle("font-size","medium")}},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-imageview-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateTabIndex:function(){if(this.onClick||this.onFocus||this.onBlur||this.onKeypress||this.onKeydown||this.onKeyup){this.querySelector(".top-imageview-root").tabIndex=0}},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-imageview-root");shadowRoot.id=this.id}},__updateAlt:function(){if(this.description){var shadowRoot=this.querySelector(".top-imageview-root");shadowRoot.alt=this.description}},appendTemplate:function(){this.innerHTML='<img class="top-imageview-root"></img>'},__updateSrc:function(){if(this.src){if(this.src.includes("@drawable")){this.src=Top.DrawableManager.get(this.src.replace("@drawable/",""))}this.querySelector("img").setAttribute("src",this.src)}else{this.querySelector("img").removeAttribute("src")}},getTopStyle:function(){this.topstyle=this.querySelector(".top-imageview-root").style.cssText;return this.topstyle},setAllTopStyle:function(){this.querySelector(".top-imageview-root").style.cssText=this.topstyle}};Top.Widget.Imageview=function(){Imageview.prototype=Object.create(Top.Widget.prototype);Imageview.prototype.constructor=Imageview;function Imageview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-imageview");this.template.innerHTML='<img class="top-imageview-root"></img>'}this.id=this.template.id}Imageview.create=function(element){return new Imageview(element)};return Imageview}();TopLayout={is:"top-layout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],__ready:function(){this.__updateId();this.initialChilds();this.renderLayout()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-layout-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-layout-root">'+this.innerHTML+"</div>"},__attached2:function(){this.adjustSize()},renderLayout:function(){var layout_children=this.childRoot.children;for(var i=0;i<layout_children.length;i++){var child=layout_children[i];if(child.tagName!=="STYLE"){this.__setWrapperStyle(child)}}},__setWrapperStyle:function(child){child.style.width="100%";child.style.height="100%";child.style.display="block"},__addWrapper:function(child){var wrapper=document.createElement("div");wrapper.style.width="100%";wrapper.style.height="100%";wrapper.appendChild(child);return wrapper},initialChilds:function(){this.childs=[];if(this.childRoot)for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},initializeChildRoot:function(){return this.querySelector(".top-layout-root")},__setWidgetSize:function(adjustment){if(this.childRoot.children.length<=0)return;var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto";var pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var root=this.childRoot;for(var i=0;i<root.children.length;i++){var item=root.children[i];if(item.nodeName==="DIV")item=item.firstElementChild;if(adjustment&&typeof item.adjustSize==="function"){item.adjustSize()}if(item.getAttribute("layout-width")==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{item.setThisWidgetWidth("100%")}}if(item.getAttribute("layout-height")==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{item.setThisWidgetHeight("100%")}}}},adjustSize:function(){if(this.adjusted===true){for(var i=0;i<this.childRoot.children.length;i++){if(typeof this.childRoot.children[i].adjustSize==="function")this.childRoot.children[i].adjustSize()}return}var isVisible=!!(this.childRoot.offsetWidth||this.childRoot.offsetHeight||this.childRoot.getClientRects().length);if(isVisible===true){this.adjusted=true;this.__setWidgetSize(true)}},setThisWidgetWidth:function(parentWidth,parentElement){var borderRightWidth=this.borderRightWidth||0;var borderLeftWidth=this.borderLeftWidth||0;var layoutWidth=parseInt(this.marginRight)+parseInt(this.marginLeft);if(layoutWidth>0)layoutWidth="calc("+parentWidth+" - "+layoutWidth+"px)";else if(parentWidth.includes("-"))layoutWidth="calc("+parentWidth+")";else layoutWidth=parentWidth;this.removeTopStyle("width");this.setTopStyle("width",layoutWidth);return layoutWidth},setThisWidgetHeight:function(parentHeight){var checkWeightValue;var borderTopWidth=this.borderTopWidth||0;var borderBottomWidth=this.borderBottomWidth||0;var layoutHeight=parseInt(this.marginTop)+parseInt(this.marginBottom);if(layoutHeight>0)layoutHeight="calc("+parentHeight+" - "+layoutHeight+"px)";else if(parentHeight.includes("-"))layoutHeight="calc("+parentHeight+")";else layoutHeight=parentHeight;this.removeTopStyle("height");this.setTopStyle("height",layoutHeight);return layoutHeight},addWidget:function(widget){widget.__isRendered=true;this.adjusted=false;this.childRoot.appendChild(widget.template);this.__setWrapperStyle(widget.template)},removeWidget:function(widgetId){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;this.adjusted=false;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child);break}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},complete:function(){this.adjustSize()},getTopStyle:function(){this.topstyle=this.querySelector(".top-layout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-layout-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-layout-root").style.cssText=this.topstyle}};Top.Widget.Layout.Layout=function(){Layout.prototype=Object.create(Top.Widget.Layout.prototype);Layout.prototype.constructor=Layout;function Layout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-layout");this.template.innerHTML='<div class="top-layout-root"></div>'}this.id=this.template.id}Layout.create=function(element){return new Layout(element)};return Layout}();TopLinearlayout={is:"top-linearlayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{orientation:{type:String,value:"horizontal",reflectToAttribute:true},verticalAlignment:{type:String,value:"top"}},__ready:function(){this.__updateId();this.initialChilds();this.renderLayout()},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-linearlayout-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-linearlayout-root">'+this.innerHTML+"</div>"},__attached2:function(){this.adjustSize();this.__setWidgetWeight()},initializeChildRoot:function(){return this.querySelector(".top-linearlayout-root")},renderLayout:function(){if(this.orientation=="vertical"){this.topstyle="overflow:hidden;"+this.topstyle;this.setAllTopStyle()}else{this.topstyle="overflow:hidden;white-space:nowrap;"+this.topstyle;this.setAllTopStyle();this.removeTopStyle("text-align")}for(var i=0;i<this.childRoot.children.length;i++){var child=this.childRoot.children[i];this.__setWrapperStyle(child)}},initialChilds:function(){this.childs=[];if(this.childRoot)for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},__setWrapperStyle:function(child){if(this.orientation=="vertical"){var horizontalAlignment=this.horizontalAlignment||"left";if(child.getAttribute("layout-horizontal-alignment")){horizontalAlignment=child.getAttribute("layout-horizontal-alignment")}var height=child.getAttribute("layout-height");child.classList.remove("linear-child-horizontal");if(!child.classList.contains("linear-child-vertical")){child.classList.add("linear-child-vertical")}if(height&&height.includes("%")){child.style.height=height;child.style.textAlign=horizontalAlignment;if(typeof child.__updateLayoutHeight==="function")child.__updateLayoutHeight()}else{child.style.textAlign=horizontalAlignment}}else{child.classList.remove("linear-child-vertical");if(!child.classList.contains("linear-child-horizontal")){child.classList.add("linear-child-horizontal")}var verticalAlignment=this.verticalAlignment;if(!child.getAttribute("layout-vertical-alignment")){child.setAttribute("layout-vertical-alignment",verticalAlignment);child.layoutVerticalAlignment=verticalAlignment;if(typeof child.setTopStyle==="function")child.setTopStyle("vertical-align",verticalAlignment)}child.style.lineHeight="normal"}},__setLineHeight:function(){if(this.orientation==="vertical")return;var shadowRoot=this.childRoot;this.removeTopStyle("line-height");this.setTopStyle("line-height","0px");var sHeight=document.defaultView.getComputedStyle(shadowRoot).height;var isVisible=!!(shadowRoot.offsetWidth||shadowRoot.offsetHeight||shadowRoot.getClientRects().length);if(isVisible&&parseFloat(sHeight)>0){if(typeof parseFloat(this.childRoot.style.lineHeight)==="number"&&parseFloat(sHeight)==parseFloat(this.childRoot.style.lineHeight))return;this.removeTopStyle("line-height");this.setTopStyle("line-height",sHeight)}},__adjustLineHeight:function(){if(this.layoutHeight&&(this.layoutHeight.includes("%")||this.layoutHeight==="match_parent")){this.__setLineHeight();this.childs.forEach(function(child){if(typeof child.__adjustLineHeight==="function")child.__adjustLineHeight()})}else{return}},__setWidgetSize:function(adjustment){var root=this.childRoot;if(root.children[0]&&root.children[0].tagName==="DIV")root=root.children[0];if(root.children.length<=0)return;if(this.layoutWidth==="match_parent"&&this.parentNode.tagName==="TD"){this.layoutWidth="100%";this.__updateLayoutWidth()}var pHorizontal=this.orientation==="horizontal";var pWrapWidth=!this.layoutWidth||this.layoutWidth==="auto",pWrapHeight=!this.layoutHeight||this.layoutHeight==="auto";this.wSum=0,this.hSum=0,this.weightSum=0;if(this.orientation==="horizontal"){for(var i=0,len=root.children.length;i<len;i++){var item=root.children[i];if(item.nodeName==="DIV")item=item.firstElementChild;if(adjustment&&typeof item.adjustSize==="function")item.adjustSize();var itemLayoutHeight=item.layoutHeight;var itemLayoutWidth=item.layoutWidth;if(itemLayoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseFloat(item.marginTop)+parseFloat(item.marginBottom)+"px")}else{item.setThisWidgetHeight("100%")}}if(root.children.length===1&&(!itemLayoutWidth||itemLayoutWidth==="auto"||itemLayoutWidth==="wrap_content")){return}var iWidth=parseFloat(itemLayoutWidth);if(!isNaN(iWidth)){if(item.__isLayout&&item.tagName!=="TOP-LAYOUT")iWidth+=parseFloat(item.paddingLeft)+parseFloat(item.paddingRight)+parseFloat(item.marginLeft)+parseFloat(item.marginRight)+parseFloat(item.borderLeftWidth)+parseFloat(item.borderRightWidth);else iWidth+=parseFloat(item.marginLeft)+parseFloat(item.marginRight);item.setAttribute("actual-width",iWidth);this.wSum+=iWidth}else if(!itemLayoutWidth||itemLayoutWidth==="auto"||itemLayoutWidth==="wrap_content"){if(typeof item.getElement==="function"&&item.getElement()){if(item.tagName==="TOP-RADIOBUTTON"){iWidth+=item.getElement(".top-radiobutton-text")?parseFloat(window.getComputedStyle(item.getElement(".top-radiobutton-text")[0]).width)||0:0}else if(item.tagName==="TOP-CHECKBOX"){iWidth+=item.getElement(".top-checkbox-text")?parseFloat(window.getComputedStyle(item.getElement(".top-checkbox-text")[0]).width)||0:0}else{iWidth=parseFloat(window.getComputedStyle(item.getElement()).width)||0}if(item.__isLayout&&item.tagName!=="TOP-LAYOUT")iWidth+=parseFloat(item.paddingLeft)+parseFloat(item.paddingRight)+parseFloat(item.marginLeft)+parseFloat(item.marginRight)+parseFloat(item.borderLeftWidth)+parseFloat(item.borderRightWidth);else iWidth+=parseFloat(item.marginLeft)+parseFloat(item.marginRight);item.setAttribute("actual-width",iWidth);this.wSum+=iWidth}}else if(itemLayoutWidth==="match_parent"){if(item.__isLayout&&item.tagName!=="TOP-LAYOUT")var iMargin=(parseFloat(item.marginRight)||0)+(parseFloat(item.marginLeft)||0)+parseFloat(item.borderLeftWidth)+parseFloat(item.borderRightWidth);else var iMargin=(parseFloat(item.marginRight)||0)+(parseFloat(item.marginLeft)||0);if(pWrapWidth){item.setThisWidgetWidth(iMargin+"px")}else{item.setThisWidgetWidth(this.wSum>0?"100% - "+this.wSum+"px":"100%")}if(!item.getAttribute("layout-weight")){this.weightSum=0;return}this.wSum+=iMargin}var iWeight=parseFloat(item.getAttribute("layout-weight"));if(!isNaN(iWeight))this.weightSum+=iWeight}}else{for(var i=0,len=root.children.length;i<len;i++){var item=root.children[i];if(adjustment&&typeof item.adjustSize==="function")item.adjustSize();var itemLayoutHeight=item.layoutHeight;var itemLayoutWidth=item.layoutWidth;if(itemLayoutWidth==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseFloat(item.marginLeft)+parseFloat(item.marginRight)+"px")}else{item.setThisWidgetWidth("100%")}}if(root.children.length===1&&(!itemLayoutHeight||itemLayoutHeight==="auto"||itemLayoutHeight==="wrap_content")){return}var iHeight=parseFloat(itemLayoutHeight);if(!isNaN(iHeight)){iHeight+=parseFloat(item.paddingTop)+parseFloat(item.paddingBottom)+parseFloat(item.marginTop)+parseFloat(item.marginBottom);if(item.__isLayout&&item.tagName!=="TOP-LAYOUT"){if(item.borderBottomWidth!==undefined)iHeight+=parseFloat(item.borderBottomWidth);if(item.borderTopWidth!==undefined)iHeight+=parseFloat(item.borderTopWidth)}item.setAttribute("actual-height",iHeight);this.hSum+=iHeight}else if(!itemLayoutHeight||itemLayoutHeight==="auto"||itemLayoutHeight==="wrap_content"){if(typeof item.getElement==="function"){if(item.tagName==="TOP-RADIOBUTTON"){iHeight=item.getElement(".top-radiobutton-text")?parseFloat(window.getComputedStyle(item.getElement(".top-radiobutton-text")[0]).height)||0:0}else if(item.tagName==="TOP-CHECKBOX"){iHeight=item.getElement(".top-checkbox-text")?parseFloat(window.getComputedStyle(item.getElement(".top-checkbox-text")[0]).height)||0:0;
}else if(item.getElement()){iHeight=parseFloat(document.defaultView.getComputedStyle(item.getElement()).height)||0}iHeight+=parseFloat(item.marginTop)+parseFloat(item.marginBottom);if(item.__isLayout&&item.tagName!=="TOP-LAYOUT"){if(item.borderBottomWidth!==undefined)iHeight+=parseFloat(item.borderBottomWidth);if(item.borderTopWidth!==undefined)iHeight+=parseFloat(item.borderTopWidth)}item.setAttribute("actual-height",iHeight);this.hSum+=iHeight}}else if(itemLayoutHeight==="match_parent"){var iMargin=(parseFloat(this.marginTop)||0)+(parseFloat(this.marginBottom)||0);if(pWrapHeight){item.setThisWidgetHeight(iMargin+"px")}else{item.style.height=this.hSum>0?"calc(100% - "+this.hSum+"px)":"100%";item.setThisWidgetHeight("100%")}if(!item.getAttribute("layout-weight")){this.weightSum=0;return}this.hSum+=iMargin}var iWeight=parseFloat(item.getAttribute("layout-weight"));if(!isNaN(iWeight))this.weightSum+=iWeight}}},__setWidgetWeight:function(){if(this.childRoot.children.length<=0||!Top.App.__compatibleWithTOP()||this.weightSum<=0)return;var layoutRoot=this.childRoot;var whiteSpaceSize=0;var rootSize=0;if(this.getAttribute("orientation")==="vertical"){var pPadding=parseFloat(this.paddingTop)+parseFloat(this.paddingBottom);rootSize=layoutRoot.clientHeight-pPadding;whiteSpaceSize=rootSize;if(whiteSpaceSize<=0&&!isNaN(parseFloat(this.getAttribute("layout-height")))){whiteSpaceSize=parseFloat(this.getAttribute("layout-height"))-pPadding}whiteSpaceSize-=this.hSum;if(whiteSpaceSize<=0)return;var weightRatio=whiteSpaceSize/this.weightSum;var root=this.childRoot;for(var i=0;i<root.children.length;i++){var item=root.children[i];if(item.getAttribute("layout-weight")){var itemHeight;itemHeight=item.getAttribute("actual-height");itemHeight=itemHeight+weightRatio*parseFloat(item.getAttribute("layout-weight"));itemHeight=itemHeight/rootSize*100+"%";var minusValue=parseFloat(item.marginTop)||0;minusValue+=parseFloat(item.marginBottom)||0;if(typeof item.getElement==="function"&&item.getElement().style.boxSizing!=="border-box"){minusValue+=parseFloat(item.borderTopWidth)||0;minusValue+=parseFloat(item.borderBottomWidth)||0;minusValue+=parseFloat(item.paddingTop)||0;minusValue+=parseFloat(item.paddingBottom)||0}item.removeTopStyle("height");item.setTopStyle("height","calc(100% - "+minusValue+"px)");item.style.height=itemHeight;if(typeof item.__adjustWidgets==="function"){item.__adjustWidgets()}}}}else{var pPadding=parseFloat(this.paddingLeft)+parseFloat(this.paddingRight);rootSize=layoutRoot.clientWidth-pPadding;whiteSpaceSize=rootSize;if(whiteSpaceSize<=0&&!isNaN(parseFloat(this.getAttribute("layout-width")))){whiteSpaceSize=parseFloat(this.getAttribute("layout-width"))-pPadding}whiteSpaceSize-=this.wSum;if(whiteSpaceSize<=0)return;var weightRatio=whiteSpaceSize/this.weightSum;for(var i=0;i<layoutRoot.children.length;i++){var item=layoutRoot.children[i];if(item.getAttribute("layout-weight")){if(item.layoutWidth==="auto"||!item.layoutWidth)item.setTopStyle("width","");if(!isNaN(parseFloat(item.layoutWidth)))item.setTopStyle("width",item.layoutWidth);var itemWidth=item.getAttribute("actual-width");itemWidth=itemWidth+weightRatio*parseFloat(item.getAttribute("layout-weight"));itemWidth=itemWidth/rootSize*100+"%";item.removeTopStyle("width");item.setTopStyle("width",itemWidth);if(typeof item.__adjustWidgets==="function"){item.__adjustWidgets()}}}}},getWidth:function(){return this.childRoot.offsetWidth},getHeight:function(){return this.childRoot.offsetHeight},adjustSize:function(){if(this.adjusted===true){for(var i=0;i<this.childRoot.children.length;i++){if(typeof this.childRoot.children[i].adjustSize==="function")this.childRoot.children[i].adjustSize()}return}var isVisible=!!(this.childRoot.offsetWidth||this.childRoot.offsetHeight||this.childRoot.getClientRects().length);if(isVisible===true){this.adjusted=true;this.__setWidgetSize(true)}},addWidget:function(widget){widget.__isRendered=true;this.adjusted=false;this.childRoot.appendChild(widget.template);this.__setWrapperStyle(widget.template)},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;this.adjusted=false;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child);break}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},complete:function(){this.renderLayout();this.__attached2()},getTopStyle:function(){this.topstyle=this.childRoot.style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value&&this.childRoot){this.childRoot.style[key]=value;this.topstyle=this.childRoot.style.cssText}},setAllTopStyle:function(){this.childRoot.style.cssText=this.topstyle}};Top.Widget.Layout.Linearlayout=function(){Linearlayout.prototype=Object.create(Top.Widget.Layout.prototype);Linearlayout.prototype.constructor=Linearlayout;function Linearlayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-linearlayout");this.template.innerHTML='<div class="top-linearlayout-root"></div>'}this.id=this.template.id}Linearlayout.create=function(element){return new Linearlayout(element)};Linearlayout.prototype.getWidth=function(){return this.template.getWidth()};Linearlayout.prototype.getHeight=function(){return this.template.getHeight()};Linearlayout.prototype.addWidgetByIndex=function(widget,index){this.removeWidget(widget);this.template.childs.splice(index,0,widget.template)};return Linearlayout}();TopListview={is:"top-listview",behaviors:[TopWidgetBehavior,TopContainerBehavior,TopGroupBehavior],properties:{rowSelected:{type:String,reflectToAttribute:true},onRowclick:String,itemDrag:false,virtualScroll:{type:String,value:"false"},onScrollend:String},ready:function(){this.childTemplate=this.childRoot.innerHTML;if(this.childTemplate.includes("</ul>"))this.childTemplate=""},appendTemplate:function(){this.innerHTML='<div class="top-listview-root">'+this.innerHTML+"</div>"},initializeChildRoot:function(){return this.querySelector(".top-listview-root")},__ready:function(){this.initialChilds();this.initialLayout();this.initItems();this.renderLayout();this.__updateId();this.__updateName();this.__updateAlign();this.updateStyle();this.__initialized=true},attached:function(){this.attachEventHandler()},__initEventInternal:function(){this.__addEventByAttr("rowclick")},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-listview-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateItemDrag:function(){this.renderLayout()},__updateName:function(){if(this.name){this.childRoot.name=this.name}},__updateAlign:function(){},__updateOnScrollend:function(){this.__addEventByAttr("scrollend")},__renderVirtualLayout:function(){if(typeof this.onScrollend==="string")this.onScrollend=Top.Util.namespace(this.onScrollend,this);var _this=this;if(this.items&&typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else if(typeof this.items==="object"){var items=this.items}else if(this.widgetItems){this.renderByWidgetItem();return}if(items===undefined||items.length===0)return;var layout=this.childTemplate===undefined||this.childTemplate===""?this.itemLayout:this.childTemplate;var switchedItem=this.getSwitchedItem();if(layout.includes("<top-widgetitem")){var layoutWithoutWidgetItem=layout.split("\n");layout="";for(i=2;i<layoutWithoutWidgetItem.length-2;i++){layout=layout+layoutWithoutWidgetItem[i]}}if(this.widgetItems[0]&&this.widgetItems[0].tagName==="TOP-WIDGETITEM"){var layout=this.widgetItems[0].innerHTML}this.itemData=items;var root=this.childRoot;root.innerHTML="<ul data-role='listview' data-inset='true' class='top-listview-container top-listview-virtual'></ul>";var content=root.querySelector(".top-listview-container");if(this.rh!==undefined||this.rg!==null){var sample=document.createElement("div");sample.innerHTML=layout;for(var k=0;k<sample.children.length;k++){this.createHtmlObjects(sample.children[k]);content.append(sample.children[k])}this.rh=parseInt(top$(content).css("height"));this.createdItemWidgets=[];content.innerHTML=""}var h=this.rh*items.length;var vp=parseInt(this.layoutHeight);if(typeof bind_widget_info==="undefined")var bind_widget_info=[];content.style.height=h+"px";var num_li=Math.min(parseInt(top$(root).height()/_this.rh),items.length);for(var i=0;i<num_li;i++){var li=document.createElement("li");li.id="list_"+i;li.classList.add("row_"+i);li.classList.add("top-listview-list");li.setAttribute("data-index",i);li.style.height=_this.rh+"px";li.style.left="0px";li.style.width="100%";li.style.position="absolute";if(i==0){li.classList.add("first-child");li.style.top=i*_this.rh+"px"}else if(i==num_li-1){li.classList.add("last-child");li.style.top=i*_this.rh+"px"}else{li.style.top=i*_this.rh+"px"}content.append(li)}var li_list=content.children;for(var i=0;i<num_li;i++){li_list[i].innerHTML=layout;this.createHtmlObjects(li_list[i].children[0])}this.createdItemWidgetAttachedCallback();dataBinding();this.attachEventHandler();var layouts=root.querySelectorAll('top-linearlayout:not([orientation="vertical"])');if(layouts){for(var i=0;i<layouts.length;i++){if(layouts[i].__isAttached&&typeof layouts[i].__setLineHeight==="function"&&layouts[i].id){layouts[i].__setLineHeight()}}}root.addEventListener("scroll",top$.throttle(50,false,onScroll));function dataBinding(){var topWidget=/^TOP-[a-zA-Z]*/;for(var i=0;i<num_li;i++){var keys=Object.keys(items[i]);var listChildren=root.querySelectorAll("#list_"+i+".row_"+i+" *");var topWidgets=[];var k=0;var listChildrenLength=listChildren.length;while(k<listChildrenLength){if(topWidget.test(listChildren[k].tagName))topWidgets.push(listChildren[k]);k++}var j=0;var keysLength=keys.length;while(j<keys.length){top$.each(topWidgets,function(index){var attr=topWidgets[index].attributes;var l=0;var attrLength=attr.length;while(l<attrLength){if(attr[l].value==="{"+keys[j]+"}"){if(i===0){var sel=topWidgets[index].tagName.toLowerCase()+"#"+topWidgets[index].id;bind_widget_info.push({selector:sel,prop:attr[l].name,field:keys[j]})}var attrName=Top.Util.toCamelCase(attr[l].name);topWidgets[index].setAttribute(attrName,items[i][keys[j]]);topWidgets[index][attrName]=items[i][keys[j]];topWidgets[index].__updateProperties(attrName)}l++}});j++}topWidgets.forEach(function(_item){_item.id=_item.id+"_"+i;if(typeof _item.__updateId==="function")_item.__updateId();if(_item.tagName==="TOP-RADIOBUTTON"){if(_item.getAttribute("group-id")){Top.Dom.selectById(_item.id).setProperties({"group-id":_item.getAttribute("group-id")+"_"+i})}}})}}function onScroll(e){var scrollTop=top$(root).scrollTop();var start_index=Math.floor(scrollTop/_this.rh);for(var i=0;i<li_list.length;i++){var listItem=li_list[i];if(i===0)listItem.style.top=scrollTop+"px";else if(i>0)listItem.style.top=scrollTop+i*_this.rh+"px";for(var j=0;j<bind_widget_info.length;j++){var target=listItem.querySelector(bind_widget_info[j].selector+"_"+i);var prop=bind_widget_info[j].prop;var value=items[start_index+i][bind_widget_info[j].field];var keyvalue={};keyvalue[prop]=value;Top.Dom.selectById(target.id).setProperties(keyvalue)}}if(typeof _this.onScrollend==="function"){_this.onScrollend()}}},renderLayout:function(){var _this=this;if(!this.__initialized)this.widgetItems=Top.Util.Browser.isIE()?top$(this.childRoot.cloneNode(true).children):this.childRoot.cloneNode(true).children;this.clearLayout();if(this.virtualScroll==="true"||this.virtualScroll===true){this.__renderVirtualLayout();return}if(this.items&&typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else if(typeof this.items==="object"){var items=this.items}else if(this.widgetItems){this.renderByWidgetItem();return}var layout=this.childTemplate===undefined||this.childTemplate===""?this.itemLayout:this.childTemplate;var switchedItem=this.getSwitchedItem();var reg=/<top-widgetitem[^>]*>([\s\S]+)<\/top-widgetitem>/;if(reg.test(layout)&&reg.exec(layout)[1].trim()){layout=reg.exec(layout)[1].trim()}if(this.widgetItems[0]&&this.widgetItems[0].tagName==="TOP-WIDGETITEM"&&this.widgetItems[0].innerHTML.trim()){layout=this.widgetItems[0].innerHTML}if(items===undefined)return;this.itemData=items;var root=this.childRoot;var fragment=document.createDocumentFragment();for(var i=0;i<items.length;i++){if(this.itemSwitchLogic){fragment.appendChild(switchedItem[i].outerHTML)}else{var listItemWidget=document.createElement("div");listItemWidget.innerHTML=layout;for(var k=0;k<listItemWidget.children.length;k++){this.createHtmlObjects(listItemWidget.children[k]);fragment.appendChild(listItemWidget.children[k])}}if(i==items.length-1){top$(fragment).children().last().wrapAll("<li id='list_"+i+"' class='row_"+i+" top-listview-list  last-child' data-index='"+i+"'></li>")}else if(i==0){top$(fragment).children().last().wrapAll("<li id='list_"+i+"' class='row_"+i+" top-listview-list  first-child' data-index='"+i+"'></li>")}else{top$(fragment).children().last().wrapAll("<li id='list_"+i+"' class='row_"+i+" top-listview-list ' data-index='"+i+"'></li>")}}top$(fragment).children().wrapAll("<ul data-role='listview' data-inset='true' class='top-listview-container'></ul>");var topWidget=/^TOP-[a-zA-Z]*/;var i=0;var itemsLength=items.length;while(i<itemsLength){var keys=Object.keys(items[i]);var listChildren=fragment.firstChild.children[i].querySelectorAll("*");var topWidgets=[];var k=0;var listChildrenLength=listChildren.length;while(k<listChildrenLength){if(topWidget.test(listChildren[k].tagName))topWidgets.push(listChildren[k]);k++}var j=0;var keysLength=keys.length;while(j<keys.length){top$.each(topWidgets,function(index){var attr=topWidgets[index].attributes;var l=0;var attrLength=attr.length;while(l<attrLength){if(attr[l].value==="{"+keys[j]+"}"){var attrName=Top.Util.toCamelCase(attr[l].name);topWidgets[index].setAttribute(attr[l].name,items[i][keys[j]]);topWidgets[index][attrName]=items[i][keys[j]];topWidgets[index].__updateProperties(attrName)}else if(topWidgets[index].tagName==="TOP-ICON"&&attr[l].name==="class"&&attr[l].value.includes("{"+keys[j]+"}")){topWidgets[index].classList.remove("{"+keys[j]+"}");topWidgets[index].classList.add(items[i][keys[j]]);topWidgets[index]["class"]=topWidgets[index]["class"].replace("{"+keys[j]+"}",items[i][keys[j]])}l++}});j++}topWidgets.forEach(function(_item){_item.id=_item.id+"_"+i;if(typeof _item.__updateId==="function")_item.__updateId();if(_item.tagName==="TOP-RADIOBUTTON"){if(_item.getAttribute("group-id")){(function(i){Top.App.onWidgetAttach(_item.id,function(widget){widget.setProperties({"group-id":_item.getAttribute("group-id")+"_"+i})})})(i)}}if(_item.tagName==="TOP-LISTVIEW"){_this.__addIndexInnerChildren(_item,i)}});i++}var listElement=fragment.querySelectorAll(".top-listview-list");var i=0;var listElementLength=listElement.length;while(i<listElementLength){var j=0;var len=listElement[i].childNodes.length;while(j<len){if(listElement[i].childNodes[j].tagName==="TOP-WIDGETITEM"&&listElement[i].childNodes[j].getAttribute("value")){listElement[i].setAttribute("value",listElement[i].childNodes[j].getAttribute("value"))}if(listElement[i].childNodes[j].tagName==="TOP-WIDGETITEM"&&listElement[i].childNodes[j].getAttribute("text")){listElement[i].setAttribute("text",listElement[i].childNodes[j].getAttribute("text"))}if(listElement[i].childNodes[j].tagName==="TOP-WIDGETITEM"&&listElement[i].childNodes[j].childElementCount===0){var text=listElement[i].childNodes[j].getAttribute("text");listElement[i].innerText=text}j++}i++}if(this.headerItem&&this.headerItem.length>0){top$(fragment).prepend("<label class='top-listview-header'></label>");if(this.headerItem[0].attributes["text"])fragment.querySelector(".top-listview-header").innerText=this.headerItem[0].attributes.text.nodeValue;if(this.headerItem[0].childElementCount>0)fragment.querySelector(".top-listview-header").innerHTML=this.headerItem[0].innerHTML}if(this.separatorVisible){if(this.separatorVisible===true||this.separatorVisible==="true"){var separatorSize=parseInt(this.separatorSize)||"";var separatorColor=this.separatorColor||"";top$(fragment.querySelectorAll(".top-listview-list")).css("border-bottom-color",separatorColor);top$(fragment.querySelectorAll(".top-listview-list")).css("border-bottom-width",separatorSize+"px")}else{top$(fragment.querySelectorAll(".top-listview-list")).css("border-bottom","none")}}root.appendChild(fragment);this.createdItemWidgetAttachedCallback();this.attachEventHandler();var layouts=root.querySelectorAll('top-linearlayout:not([orientation="vertical"])');if(layouts){for(var i=0;i<layouts.length;i++){if(layouts[i].__isAttached&&typeof layouts[i].__setLineHeight==="function"&&layouts[i].id){layouts[i].__setLineHeight()}}}},__addIndexInnerChildren:function(list,index){var children=list.querySelectorAll("*");for(var i=0,len=children.length;i<len;i++){if(Top.Util.__isTopWidget(children[i].tagName)){children[i].id=children[i].id.replace(/_([^_]*)$/,"_"+index+"_$1");if(typeof children[i].__updateId==="function"){children[i].__updateId()}}}},initializeChildRoot:function(){return this.querySelector(".top-listview-root")},setAllTopStyle:function(){this.querySelector(".top-listview-root").style.cssText=this.topstyle},renderByWidgetItem:function(){this.clearItems();var items=this.makeItems(this.widgetItems);var subItems=[];this.itemData=items;var i=0;var thisWidgetItemsLength=this.widgetItems.length;while(i<thisWidgetItemsLength){if(this.widgetItems[i].childElementCount>0)subItems[i]=this.widgetItems[i].innerHTML;i++}var root=this.childRoot;var i=0;var itemsLength=items.length;while(i<itemsLength){var liDom=document.createElement("li");var liId="list_"+i;var liClass="row_"+i;liDom.setAttribute("id",liId);liDom.classList.add(liClass);liDom.classList.add("top-listview-list");liDom.setAttribute("data-index",i);if(i==items.length-1){liDom.classList.add("last-child")}else if(i==0){liDom.classList.add("first-child")}root.appendChild(liDom);if(items[i]["text"])liDom.innerText=this.__i18n(items[i]["text"]);if(subItems[i]){liDom.innerHTML=subItems[i];this.createHtmlObjects(liDom.children[0])}i++}this.createdItemWidgetAttachedCallback();top$(root).children().wrapAll("<ul data-role='listview' data-inset='true' class='top-listview-container'></ul>");if(this.headerItem.length>0){var tempLabel=document.createElement("label");tempLabel.classList.add("top-listview-header");root.insertBefore(tempLabel,root.firstChild);if(this.headerItem[0].attributes["text"])root.querySelector(".top-listview-header").innerText=this.headerItem[0].attributes.text.nodeValue;if(this.headerItem[0].childElementCount>0)root.querySelector(".top-listview-header").innerHTML=this.headerItem[0].innerHTML}if(this.separatorVisible){if(this.separatorVisible===true||this.separatorVisible==="true"){var separatorSize=parseInt(this.separatorSize)||"";var separatorColor=this.separatorColor||"";top$(root.querySelectorAll(".top-listview-list")).css("border-bottom-color",separatorColor);top$(root.querySelectorAll(".top-listview-list")).css("border-bottom-width",separatorSize+"px")}else{top$(root.querySelectorAll(".top-listview-list")).css("border-bottom","none")}}var allLis=root.querySelectorAll("li.top-listview-list");for(var i=0,len=allLis.length;i<len;i++){var li=allLis[i];for(var j=0,len2=li.children.length;j<len2;j++){li.children[j].layoutParent=this}}var layouts=root.querySelectorAll('top-linearlayout:not([orientation="vertical"])');if(layouts){for(var i=0;i<layouts.length;i++){if(layouts[i].__isAttached&&typeof layouts[i].__setLineHeight==="function"&&layouts[i].id){layouts[i].__setLineHeight()}}}this.attachEventHandler();if(items)Top.i18n.__onUpdate(this.id,"__updateItems")},attachEventHandler:function(){var rowSelected=this.rowSelected;if(typeof rowSelected=="string"){rowSelected=Top.Util.namespace(rowSelected,this)}var _this=this;var root=this.childRoot;var lastClickedIndex,lastClickedType,firstClickedIndex;var allListElements=root.querySelectorAll(".top-listview-container .top-listview-list");top$(allListElements).off("click").on("click",function(e){var thisClickedIndex=this.getAttribute("data-index");if(_this.itemClicktype==="select"){if(e.shiftKey||e.ctrlKey){if(e.shiftKey){if(!lastClickedIndex)lastClickedIndex=0;if(!firstClickedIndex)firstClickedIndex=0;if(lastClickedType=="ctrl"||parseInt(lastClickedIndex)>parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)<parseInt(firstClickedIndex)||parseInt(lastClickedIndex)<parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)>parseInt(firstClickedIndex)){top$(root.querySelectorAll(".top-listview-list.selected")).removeClass("selected");lastClickedIndex=firstClickedIndex}var selectedElement=root.querySelector(".top-listview-list[data-index='"+lastClickedIndex+"']");if(thisClickedIndex!==lastClickedIndex){while(true){selectedElement.classList.add("selected");if(selectedElement.getAttribute("data-index")===thisClickedIndex)break;selectedElement=thisClickedIndex>lastClickedIndex?selectedElement.nextSibling:selectedElement.previousSibling}}else if(thisClickedIndex===lastClickedIndex){selectedElement.classList.add("selected")}lastClickedType="shift"}else if(e.ctrlKey){if(this.classList){this.classList.toggle("selected")}else{var classes=this.className.split(" ");var existingIndex=classes.indexOf("selected");if(existingIndex>=0)classes.splice(existingIndex,1);else classes.push("selected");this.className=classes.join(" ")}lastClickedType="ctrl";firstClickedIndex=thisClickedIndex}var allListHasSelected=root.querySelectorAll(".top-listview-list.selected");_this.selectedItemIndex=[];var len=allListHasSelected.length;var i=0;while(i<len){var item=allListHasSelected[i];_this.selectedItemIndex.push(item.getAttribute("data-index"));i++}lastClickedIndex=thisClickedIndex}else{top$(root.querySelectorAll(".top-listview-list.selected")).removeClass("selected");this.classList.add("selected");_this.selectedItemIndex=thisClickedIndex;lastClickedIndex=thisClickedIndex;lastClickedType="";firstClickedIndex=thisClickedIndex}}else if(_this.itemClicktype==="click"){_this.clickedItemIndex=thisClickedIndex}if(typeof rowSelected==="function"){if(Top.App.__compatibleWithTOP()){_this.clickedItemIndex=thisClickedIndex;rowSelected(e,Top.Dom.selectById(_this.id))}else{rowSelected(thisClickedIndex)}}_this.__dispatchEvent(new CustomEvent("rowclick"))});if(Top.Util.__isBooleanTrue(this.itemDrag)){var li_Cells=_this.getElementsByClassName("top-listview-list");var listbox=_this.querySelector(".top-listview-container");if(this.__uiDragstartListener===undefined){this.__uiDragstartListener=function(ev){ev.dataTransfer.setData("text",ev.target.getAttribute("data-index"))}}if(this.__uiDropListener===undefined){this.__uiDropListener=function(ev){ev.preventDefault();ev.stopPropagation();var target=_this.li;if(!target){return}target.classList.remove("rowabove");var start_Index=parseInt(ev.dataTransfer.getData("text"));var end_index=parseInt(target.getAttribute("data-index"));var datas=_this.itemData;if(start_Index>end_index){datas.splice(end_index+1,0,datas[start_Index]);datas.splice(start_Index+1,1)}else{datas.splice(end_index+1,0,datas[start_Index]);datas.splice(start_Index,1)}_this.renderLayout()}}if(this.__uiDragoverListener===undefined){this.__uiDragoverListener=function(ev){ev.preventDefault();var oldTarget=_this.querySelector(".rowabove");if(oldTarget)oldTarget.classList.remove("rowabove");var newtarget=ev.target;while(true){if(newtarget.tagName=="BODY"||newtarget.tagName==undefined){return}if(newtarget.tagName=="LI"){break}if(newtarget.tagName!="LI"){newtarget=newtarget.parentNode}}if(newtarget)newtarget.classList.add("rowabove");_this.li=newtarget}}if(this.__uiout===undefined){this.__uiout=function(ev){ev.preventDefault();var oldTarget=_this.querySelector(".rowabove");if(oldTarget)oldTarget.classList.remove("rowabove")}}for(var i=0;i<li_Cells.length;i++){li_Cells[i].draggable=true;li_Cells[i].addEventListener("dragstart",this.__uiDragstartListener)}if(listbox){listbox.removeEventListener("dragover",this.__uiDragoverListener);listbox.addEventListener("dragover",this.__uiDragoverListener);listbox.removeEventListener("drop",this.__uiDropListener);listbox.addEventListener("drop",this.__uiDropListener);listbox.removeEventListener("mouseleave",this.__uiout);listbox.addEventListener("mouseleave",this.__uiout)}}},makeItems:function(parent){var len=parent.length;var node=[];var i=0;while(i<len){var obj={};obj["text"]=parent[i].getAttribute("text");obj["value"]=parent[i].getAttribute("value");node[i]=obj;i++}return node},__update:function(){this.renderLayout();this.updateStyle()},__updateItems:function(){if(this.__initialized===true){this.renderLayout()}},getSelectedIndex:function(){return this.selectedItemIndex},getSelectedData:function(){if(this.selectedItemIndex instanceof Array){var len=this.selectedItemIndex.length;var selectedData=[];var i=0;while(i<len){selectedData.push(this.itemData[this.selectedItemIndex[i]]);i++}return selectedData}else{return this.itemData[this.selectedItemIndex]}},getClickedIndex:function(){return this.clickedItemIndex},getClickedData:function(){return this.itemData[this.clickedItemIndex]},__selectData:function(index){var selectedList;var root=this.childRoot;if(index instanceof Array){var i=0;var indexLength=index.length;while(i<indexLength){if(typeof index[i]==="number"){selectedList=root.querySelector(".top-listview-list[data-index='"+index[i]+"']")}top$(selectedList).trigger(top$.Event("click",{ctrlKey:true}));i++}}else{if(typeof index==="number"){selectedList=root.querySelector(".top-listview-list[data-index='"+index+"']")}top$(selectedList).click()}},__updateOnRowclick:function(){this.__addEventByAttr("rowclick")},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("div");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle}};Top.Widget.Container.Listview=function(){Listview.prototype=Object.create(Top.Widget.Container.prototype);Listview.prototype.constructor=Listview;function Listview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-listview");this.template.innerHTML='<div class="top-listview-root"></div>'}this.id=this.template.id}Listview.create=function(element){return new Listview(element)};Listview.prototype.addLayout=function(layout){this.template.itemLayout=top$(layout.template).wrap("<p/>").parent().html();top$(layout.template).unwrap()};Listview.prototype.getSelectedIndex=function(){return this.template.getSelectedIndex()};Listview.prototype.getSelectedData=function(){return this.template.getSelectedData()};Listview.prototype.getClickedIndex=function(){return this.template.getClickedIndex()};Listview.prototype.getClickedData=function(){return this.template.getClickedData()};Listview.prototype.selectData=function(index){this.template.__selectData(index)};return Listview}();TopMenu={is:"top-menu",behaviors:[TopWidgetBehavior,TopTextBehavior,TopMenuBehavior],properties:{items:{type:String},type:{type:Object,reflectToAttribute:true},init:{type:String,value:false},position:String,placement:String,autoClose:String,listMaxHeight:String,listLocation:String,icon:String,animation:String,selectedNode:Object,onOpen:String,onClose:String,onSelect:String,onItemclick:String,sideType:String},__ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-menu">'+this.innerHTML+"</div>"},expectedTemplateClassName:function(){return"top-menu"},__initialize:function(){this.initMenuItems();if(this.type!=="floating"){var tempDiv=document.createElement("div");tempDiv.classList.add("top-menu-root");this.childRoot.appendChild(tempDiv)}this.__updateId();this.__updateItems();this.__initialClassname();this.dataName=this.items?Top.Util.getDataName(this.items):"";this.autoClose=this.autoClose==="true"||this.autoClose===true;this.__initAnimation();this.__updateAnimation();this.__isRendered=true},__updateId:function(){if(this.id){this.childRoot.id=this.id}},initializeChildRoot:function(){return this.firstElementChild},__initEventInternal:function(){this.__addEventByAttr("itemclick")},__initAnimation:function(){if(Top.App.__compatibleWithTOP()){if(this.animation==="true")this.animation=true;else this.animation=false}else{if(this.animation===undefined||this.animation==="true")this.animation=true;else this.animation=false}},__attached2:function(){if(this.type==="floating")this.attachEventHandlerforFloating();else if(this.type==="side")this.attachEventHandlerforSide();else if(this.type==="dropdown")this.attachEventHandlerforDropdown();else if(this.type==="drawer")this.attachEventHandlerforDrawer();else if(this.type==="header")this.attachEventHandlerforHeader();else if(this.type==="cascading")this.attachEventHandlerforCascading();this.__initBoundData()},__detached:function(){this.__detachEventHandler()},__updateAnimation:function(){var shadowRoot=this.childRoot;if(this.animation===true){shadowRoot.classList.remove("withoutAnimation");shadowRoot.classList.add("withAnimation")}else{shadowRoot.classList.remove("withAnimation");shadowRoot.classList.add("withoutAnimation")}},renderFloating:function(){this.clearMenuItems();if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);var ulId=Top.Util.guid();var str=document.createElement("ul");str.setAttribute("id",ulId);str.innerHTML=this.makeMenu(items);var root=this;root.appendChild(str);if(this.menuLayout)this.bindDataToTopWidget(items,1);top$(root.querySelector("#"+ulId)).slicknav({prependTo:this,label:""})},renderSide:function(){var checkClass02=/\b(menu_02)\b/g;var isMenu02=false;isMenu02=checkClass02.test(this.classList.value)?true:false;if(Top.Util.Browser.isIE()){isMenu02=checkClass02.test(this.classList[0])?true:false}isMenu02=this.sideType==="shown"?true:isMenu02;this.clearMenuItems();if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);if(this.placement===undefined)this.placement="left";this.childRoot.classList.remove("placement_left");this.childRoot.classList.remove("placement_right");this.childRoot.classList.add("placement_"+this.placement);
var root=this.childRoot;var str="<div class='top-menu-container'><ul class='top-menu_nav'>";str+=this.makeMenu(items);str+="</ul></div>";top$(root.firstElementChild).html(str);if(this.menuLayout)this.bindDataToTopWidget(items,1);var sideMenu=this;this.selectedList=[];top$(root.querySelectorAll(".top-menu_nav ul")).hide();top$(root.querySelectorAll(".top-menu_nav ul")).children(".current").parent().show();var li=root.querySelectorAll(".top-menu_nav li");for(var i=0;i<li.length;i++){if(li[i].lastChild.tagName=="UL"){li[i].classList.add("top-menu_parent");li[i].classList.add("top-menu_collapsed");if(isMenu02){var iDom=document.createElement("i");iDom.classList.add("top-menu_arrow");iDom.classList.add("icon-arrow_potab_down");li[i].getElementsByClassName("top-menu_item_inner")[0].appendChild(iDom)}}}if(this.layoutTop){root.getElementsByClassName("top-menu-container").style.height="calc(100% - "+this.layoutTop+")"}if(!isMenu02&&this.layoutHeight){root.querySelector(".top-menu-container").style.height=this.layoutHeight}if(this.placement=="right"){this.layoutRight="0px";this.__updateLayoutRight()}},renderDropdown:function(){this.clearMenuItems();if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);var root=this.childRoot;var str="<a class='top-menu_btn top-menu_collapsed'><i class='top-menu_title_icon "+this.icon+"'></i><span class='top-menu_title' style='color: "+this.textColor+"; font-size: "+this.textSize+"; font-style: "+this.textStyle+"; font-weight: "+this.textWeight+";'>"+this.title+"</span><i class='icon-arrow_filled_down'></i></a><ul class='top-menu_nav'>";str+=this.makeMenu(items);str+="</ul>";top$(root.firstElementChild).html(str);top$(root.querySelector(".top-menu_nav")).css("display","none");var li=root.querySelectorAll(".top-menu_nav li");for(var i=0;i<li.length;i++){if(li[i].lastChild.tagName=="UL"){li[i].classList.add("top-menu_parent");li[i].classList.add("top-menu_collapsed");top$("<i class='top-menu_arrow icon-arrow_filled_right'></i>").insertBefore(li[i].querySelector("ul"))}}if(this.listMaxHeight){this.querySelector(".top-menu_nav").style.maxHeight=this.listMaxHeight;this.querySelector(".top-menu_nav").style.overflowY="scroll"}else this.querySelector(".top-menu_nav").style.overflowY="";if(this.menuLayout)this.bindDataToTopWidget(items,1)},renderDrawer:function(){var root=this.childRoot;if(top$(root).find(".top-menu_btn").hasClass("top-menu_collapsed"))var isClosed=true;this.clearMenuItems();if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);if(isClosed)var str="<div class='top-menu-container'><button class='top-menu_btn top-menu_collapsed'></button><ul class='top-menu_nav' style='display: none;'>";else var str="<div class='top-menu-container'><button class='top-menu_btn top-menu_open'></button><ul class='top-menu_nav'>";str+=this.makeMenu(items);str+="</ul></div>";top$(root.firstElementChild).html(str);if(this.menuLayout)this.bindDataToTopWidget(items,1);top$(root.querySelectorAll(".top-menu_nav ul")).hide();var li=root.querySelectorAll(".top-menu_nav li");for(var i=0;i<li.length;i++){if(li[i].lastChild.tagName=="UL"){li[i].classList.add("top-menu_parent");li[i].classList.add("top-menu_collapsed")}}if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("open"))}else{this.__dispatchEvent(new Event("open"))}var icons=root.querySelectorAll(".top-menu-container > ul > li > a > i.top-menu_icon");for(var i=0,len=icons.length;i<len;i++){if(!icons[i].className.includes("icon-")){icons[i].style.paddingRight="0px"}}},renderHeader:function(){var root=this.childRoot;this.clearMenuItems();if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);if(this.placement===undefined){this.placement="vertical"}this.childRoot.classList.remove("placement_vertical");this.childRoot.classList.remove("placement_horizontal");this.childRoot.classList.add("placement_"+this.placement);var str="<div class='top-menu-container'><ul class='top-menu_nav'>";str+=this.makeMenu(items);str+="</ul></div>";top$(root.firstElementChild).html(str);if(this.menuLayout)this.bindDataToTopWidget(items,1);top$(root.querySelectorAll(".top-menu_nav ul")).hide();top$(root.querySelectorAll(".depth3")).remove();var li=root.querySelectorAll(".top-menu_nav li");var i=0;var liLength=li.length;while(i<liLength){if(li[i].lastChild.tagName=="UL"&&!li[i].classList.contains("depth2")||li[i].classList.contains("connected_layout")){li[i].classList.add("top-menu_parent");li[i].classList.add("top-menu_collapsed");var iDom=document.createElement("i");iDom.classList.add("top-menu_arrow");iDom.classList.add("icon-arrow_down");li[i].appendChild(iDom)}i++}},renderCascading:function(){var root=this.childRoot;this.clearMenuItems();this.menuArray=[];if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}if(items===undefined)return;this.setDepth(items);var str="<div class='top-menu-container'><ul class='top-menu_nav'>";str+=this.makeMenu(items);str+="</ul></div>";top$(root.firstElementChild).html(str);if(this.menuLayout)this.bindDataToTopWidget(items,1);var li=root.querySelectorAll(".top-menu_nav li");var i=0;var liLength=li.length;while(i<liLength){if(li[i].lastChild.tagName=="UL"){li[i].classList.add("top-menu_parent");li[i].classList.add("top-menu_collapsed");top$("<i class='top-menu_arrow icon-arrow_filled_left'></i>").insertBefore(li[i].querySelector("ul"));if(li[i].classList.contains("depth1")){li[i].lastChild.classList.add("ul_depth2")}}i++}},makeItems:function(parent){var len=parent.length;var item=[];for(var i=0;i<len;i++){var obj={};obj["text"]=parent[i].getAttribute("text");obj["selected"]=parent[i].getAttribute("selected");obj["divider"]=parent[i].getAttribute("divider");obj["id"]=parent[i].getAttribute("id");obj["icon"]=parent[i].getAttribute("icon");obj["image"]=parent[i].getAttribute("image");obj["onClick"]=parent[i].getAttribute("onClick");if(parent[i].children.length>0){obj["children"]=this.makeItems(parent[i].children)}item[i]=obj}return item},makeMenu:function(item){var str="",id="";var len=item.length;var className=this.type==="floating"?"":"top-menu_item ";for(var i=0;i<len;i++){if(item[i].children&&item[i].children.length>0){str+="<li class='"+className+"depth"+item[i].depth+(item[i].divider===true||item[i].divider==="true"?" divider":"")+"'>"+(this.menuLayout?this.__setMenuLayout(item[i]):this.getAnchor(item[i]))+"<ul>";str+=this.makeMenu(item[i].children);str+="</ul></li>"}else{str+="<li class='"+className+"depth"+item[i].depth+(item[i].divider===true||item[i].divider==="true"?" divider":"")+(item[i].itemLayoutId?" connected_layout":"")+"'>"+(this.menuLayout?this.__setMenuLayout(item[i]):this.getAnchor(item[i]))+"</li>"}if(item[i].onClick){if(typeof item[i].onClick==="function")var fnOnClick=item[i].onClick;else if(typeof item[i].onClick==="string")var fnOnClick=Top.Util.namespace(item[i].onClick,this);if(this.itemOnClick===undefined)this.itemOnClick={};if(fnOnClick)this.itemOnClick[item[i].id]=fnOnClick}}return str},getAnchor:function(item){var a="<a class='top-menu_item_inner inner_depth"+item.depth;var id="";var selected="";var icon="";var text="";var img="";var fnOnClick;if(item.id)id=" top-menu_"+this.id+"_"+item.id;if(item.selected)selected=item.selected.startsWith("/")?selected="' href = 'javascript:Top.App.routeTo(\""+item.selected+'")':"' href='"+item.selected;selected+="'>";if(item.icon)icon="<i class='top-menu_icon "+item.icon+" icon_depth"+item.depth+"'></i>";else if(item.image)img="<img class='top-menu_image' src='"+item.image+"'/>";else icon="<i class='top-menu_icon icon_depth"+item.depth+"'></i>";if(item.text)text="<span class='top-menu_text text_depth"+item.depth+"'>"+this.__i18n(item.text)+"</span>";a=a+id+selected+icon+img+text+"</a>";return a},__setMenuLayout:function(){var str="<a class='top-menu_item_inner'>";str+=this.menuLayout;str+="</a>";return str},bindDataToTopWidget:function(item,depth,parentNode){if(!parentNode)parentNode=this.childRoot;var topWidget=/^TOP-[a-zA-Z]*/;var itemElement=parentNode.querySelectorAll(".top-menu_item.depth"+depth);for(var i=0;i<item.length;i++){var keys=Object.keys(item[i]);var listChildren=top$(itemElement[i]).find("> .top-menu_item_inner  *");var itemInnerElem=top$(itemElement[i]).find("> .top-menu_item_inner");var topWidgets=[];for(var k=0;k<listChildren.length;k++)if(topWidget.test(listChildren[k].tagName))topWidgets.push(listChildren[k]);for(var j=0;j<keys.length;j++){top$.each(topWidgets,function(index,_item){var attr=topWidgets[index].attributes;for(var l=0;l<attr.length;l++){if(attr[l].value==="{"+keys[j]+"}"){topWidgets[index].setAttribute(attr[l].name,item[i][keys[j]]);topWidgets[index].__updateProperties(attr[l].name)}}if(keys[j]==="id"){_item.id=_item.id+"_"+item[i][keys[j]]}});if(keys[j]==="id"){itemInnerElem.addClass("top-menu_"+this.id+"_"+item[i][keys[j]])}}topWidgets.forEach(function(_item){if(typeof _item.__renderedImpl==="function"){_item.__renderedImpl()}if(typeof _item.__adjustWidgets==="function"){_item.__adjustWidgets()}});if(item[i].children&&item[i].children.length>0){this.bindDataToTopWidget(item[i].children,depth+1,itemElement[i])}}},getMaxWidth:function(){var nodes=this.childRoot.getElementsByTagName("li");if(this.layoutWidth&&this.layoutWidth!=="match_parent"&&this.layoutWidth!=="auto"){return this.layoutWidth}var len=nodes.length;var maxText="";var temp="";for(var i=0;i<len;i++){temp=top$(nodes[i]).children("a").text();if(temp.length>maxText.length){maxText=temp}}String.prototype.width=function(){var f="13px arial",o=top$("<div>"+this+"</div>").css({position:"absolute",float:"left","white-space":"nowrap",visibility:"hidden",font:f}).appendTo(top$("body")),w=o.width();o.remove();return w};return maxText.width()+110},attachEventHandlerforFloating:function(){var thisMenu=this;var checkReg=new RegExp("^top-menu_"+this.id+"_");var shadowRoot=this.firstElementChild;this.childRoot.remove();this.childRoot=shadowRoot;shadowRoot.classList.add("Menu_type_floating");var connectedLayout;top$(document).off("mouseleave","#"+this.id).on("mouseleave","#"+this.id,function(){top$(thisMenu.childRoot.lastChild).slicknav("close");if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("close"))}else{this.__dispatchEvent(new Event("close"))}});top$(document).off("click","#"+this.id+' li:not(.top-menu_parent) a[role="menuitem"]').on("click","#"+this.id+' li:not(.top-menu_parent) a[role="menuitem"]',function(e){var itemList=thisMenu.childRoot.querySelectorAll('li:not(.top-menu_parent) a[role="menuitem"]');var selectedItem=this;var selectedParentNode=selectedItem.parentNode.parentNode.parentNode;for(var i=0;i<itemList.length;i++){if(itemList[i]==selectedItem){if(!top$(itemList[i]).hasClass("selected"))itemList[i].classList.add("selected")}else{var itemListParentNode=itemList[i].parentNode.parentNode.parentNode;if(top$(itemList[i]).hasClass("selected"))itemList[i].classList.remove("selected");if(itemListParentNode!=selectedParentNode&&top$(itemListParentNode).hasClass("top-menu_open")&&top$(itemListParentNode).hasClass("depth2")){}}if(top$(itemList[i]).hasClass("selected")&&(top$(itemList[i].parentNode).hasClass("depth3")||top$(itemList[i].parentNode).hasClass("depth4")||top$(itemList[i].parentNode).hasClass("depth5"))){itemList[i].parentNode.classList.add("selected")}else if(!top$(itemList[i]).hasClass("selected")&&(top$(itemList[i].parentNode).hasClass("depth3")||top$(itemList[i].parentNode).hasClass("depth4")||top$(itemList[i].parentNode).hasClass("depth5"))){itemList[i].parentNode.classList.remove("selected")}}for(var i=0;i<this.classList.length;i++){if(checkReg.test(this.classList[i])){thisMenu.selectedMenuId=this.classList[i].replace("top-menu_"+thisMenu.id+"_","");break}}e.stopPropagation()});top$(document).off("click","#"+this.id+" .top-menu_nav .top-menu_item_inner").on("click","#"+this.id+" .top-menu_nav .top-menu_item_inner",function(e){var menuData=thisMenu.__getSelectedMenuDataById(thisMenu.selectedMenuId);var menuDiv=this;if(menuData&&menuData.itemLayoutId&&menuData.depth===1){if(!connectedLayout){connectedLayout=document.createElement("div");connectedLayout.style.display="none";connectedLayout.style.zIndex=100;thisMenu.appendChild(connectedLayout)}Top.Ajax.execute({url:menuData.itemLayoutId+".html",success:function(data){connectedLayout.innerHTML=data;connectedLayout.style.display="block";connectedLayout.style.position="absolute";connectedLayout.style.top=menuDiv.parentElement.offsetTop+"px";connectedLayout.style.left=shadowRoot.offsetLeft+shadowRoot.offsetWidth+"px";thisMenu.createHtmlObjects(connectedLayout);thisMenu.createdItemWidgetAttachedCallback()}});return}if(Top.Util.Browser.isIE()){thisMenu.__dispatchEvent(new CustomEvent("itemclick"));thisMenu.__dispatchEvent(new CustomEvent("select"),thisMenu.selectedMenuId)}else{thisMenu.__dispatchEvent(new Event("itemclick"));thisMenu.__dispatchEvent(new Event("select"),thisMenu.selectedMenuId)}if(thisMenu.selectedMenuId in thisMenu.itemOnClick){thisMenu.itemOnClick[thisMenu.selectedMenuId](event,Top.Dom.selectById(thisMenu.id))}if(!top$(this).parent().hasClass("top-menu_parent")){e.stopPropagation()}});top$(document).off("#"+this.id+" .top-menu_btn").on("click","#"+this.id+" .top-menu_btn",function(){if(top$(this).hasClass("top-menu_collapsed")){if(connectedLayout)connectedLayout.style.display="none";if(Top.Util.Browser.isIE()){thisMenu.__dispatchEvent(new CustomEvent("close"))}else{thisMenu.__dispatchEvent(new Event("close"))}}else{if(Top.Util.Browser.isIE()){thisMenu.__dispatchEvent(new CustomEvent("open"))}else{thisMenu.__dispatchEvent(new Event("open"))}}})},attachEventHandlerforSide:function(){var sideMenu=this;this.childRoot.classList.add("Menu_type_side");this.childRoot.classList.add("menu_01");var checkReg=new RegExp("^top-menu_"+this.id+"_");var checkClass02=/\b(menu_02)\b/g;var width=sideMenu.getMaxWidth();var isMenu02=checkClass02.test(this.classList.value)?true:false;if(Top.Util.Browser.isIE()){isMenu02=checkClass02.test(this.classList[0])?true:false}isMenu02=this.sideType==="shown"?true:isMenu02;top$(this.childRoot).find(".top-menu_nav").css("width",width);if(isMenu02){this.childRoot.classList.remove("menu_01");this.childRoot.classList.add("menu_02");top$(document).off("click","#"+this.id+" .top-menu_nav li").on("click","#"+this.id+" .top-menu_nav li",function(e){var thisLI=this;top$(sideMenu.childRoot).find(".selected").removeClass("selected");var opened_LIs=top$(sideMenu.childRoot).find("li.top-menu_open");var parent_LIs=top$(this).closest("ul").parents("li");top$.each(opened_LIs,function(index,openedLI){var isParent=false;top$.each(parent_LIs,function(_index,parent_li){if(openedLI===parent_li)isParent=true});if(openedLI===thisLI)isParent=true;if(!isParent){top$(openedLI).find("> ul").slideUp();openedLI.classList.remove("top-menu_open");openedLI.classList.add("top-menu_collapsed")}});this.classList.add("selected");top$(sideMenu.childRoot).find("li.depth1.active").removeClass("active");var activeDepth1=top$(thisLI).parents("li.depth1")[0];if(!activeDepth1)activeDepth1=thisLI;activeDepth1.classList.add("active");if(top$(thisLI).hasClass("top-menu_open")){var iDom=thisLI.querySelector(".top-menu_arrow");if(iDom){iDom.classList.remove("icon-arrow_potab_up");iDom.classList.add("icon-arrow_potab_down")}thisLI.classList.remove("top-menu_open");thisLI.classList.add("top-menu_collapsed");top$(thisLI).find("> ul").slideUp();if(top$(thisLI).hasClass("depth1")){top$(activeDepth1).removeClass("active")}}else if(top$(thisLI).hasClass("top-menu_collapsed")){var iDom=thisLI.querySelector(".top-menu_arrow");if(iDom){iDom.classList.add("icon-arrow_potab_up");iDom.classList.remove("icon-arrow_potab_down")}thisLI.classList.remove("top-menu_collapsed");thisLI.classList.add("top-menu_open");top$(thisLI).find("> ul").slideDown()}var anchor=this.querySelector(".top-menu_item_inner");for(var i=0;i<anchor.classList.length;i++){if(checkReg.test(anchor.classList[i])){sideMenu.selectedMenuId=anchor.classList[i].replace("top-menu_"+sideMenu.id+"_","");break}}if(Top.Util.Browser.isIE()){if(e.clientX){sideMenu.__dispatchEvent(new CustomEvent("itemclick"))}sideMenu.__dispatchEvent(new CustomEvent("select"),sideMenu.selectedMenuId)}else{if(e.clientX){sideMenu.__dispatchEvent(new Event("itemclick"))}sideMenu.__dispatchEvent(new Event("select"),sideMenu.selectedMenuId)}if(sideMenu.selectedMenuId in sideMenu.itemOnClick){sideMenu.itemOnClick[sideMenu.selectedMenuId](event,Top.Dom.selectById(sideMenu.id))}e.stopPropagation()});top$(document).off("click","#"+this.id+" .top-menu_nav li.depth3").on("click","#"+this.id+" .top-menu_nav li.depth3",function(){var menuItemDepth3=this;for(var i=0;i<menuItemDepth3.length;i++){if(top$(menuItemDepth3[i]).hasClass("selected"))top$(menuItemDepth3[i].parentNode).addClass("selected");else top$(menuItemDepth3[i]).removeClass("selected")}});top$(document).off("click","#"+this.id+" .top-menu_nav li.depth4").on("click","#"+this.id+" .top-menu_nav li.depth4",function(){var menuItemDepth4=this;for(var i=0;i<menuItemDepth4.length;i++){if(top$(menuItemDepth4[i]).hasClass("selected"))top$(menuItemDepth4[i].parentNode).addClass("selected");else top$(menuItemDepth4[i]).removeClass("selected")}});top$(document).off("click","#"+this.id+" .top-menu_nav li.depth5").on("click","#"+this.id+" .top-menu_nav li.depth5 ",function(){var menuItemDepth5=this;for(var i=0;i<menuItemDepth5.length;i++){if(top$(menuItemDepth5[i]).hasClass("selected"))top$(menuItemDepth5[i].parentNode).addClass("selected");else top$(menuItemDepth5[i]).removeClass("selected")}})}else{top$(document).off("mouseenter","#"+this.id+" .placement_right .top-menu-container").on("mouseenter","#"+this.id+" .placement_right .top-menu-container",function(){top$(this).css("margin-left","-"+sideMenu.getMaxWidth()+"px")});top$(document).off("mouseleave","#"+this.id+" .placement_right .top-menu-container").on("mouseleave","#"+this.id+" .placement_right .top-menu-container",function(){top$(this).css("margin-left","")});top$(document).off("click","#"+this.id+" .top-menu_nav li").on("click","#"+this.id+" .top-menu_nav li",function(e){var thisLI=this;top$(sideMenu.childRoot).find(".selected").removeClass("selected");var opened_LIs=top$(sideMenu.childRoot).find("li.top-menu_open");var parent_LIs=top$(this).closest("ul").parents("li");top$.each(opened_LIs,function(index,openedLI){var isParent=false;top$.each(parent_LIs,function(_index,parent_li){if(openedLI===parent_li)isParent=true});if(openedLI===thisLI)isParent=true;if(!isParent){top$(openedLI).find("> ul").slideUp();openedLI.classList.remove("top-menu_open");openedLI.classList.add("top-menu_collapsed")}});this.classList.add("selected");top$(sideMenu.childRoot).find("li.depth1.active").removeClass("active");var activeDepth1=top$(thisLI).parents("li.depth1")[0];if(!activeDepth1)activeDepth1=thisLI;activeDepth1.classList.add("active");if(top$(thisLI).hasClass("top-menu_open")){thisLI.classList.remove("top-menu_open");thisLI.classList.add("top-menu_collapsed");top$(thisLI).find("> ul").slideUp();if(top$(thisLI).hasClass("depth1")){top$(activeDepth1).removeClass("active")}}else if(top$(thisLI).hasClass("top-menu_collapsed")){thisLI.classList.remove("top-menu_collapsed");thisLI.classList.add("top-menu_open");top$(thisLI).find("> ul").slideDown()}var anchor=this.querySelector(".top-menu_item_inner");for(var i=0;i<anchor.classList.length;i++){if(checkReg.test(anchor.classList[i])){sideMenu.selectedMenuId=anchor.classList[i].replace("top-menu_"+sideMenu.id+"_","");break}}if(Top.Util.Browser.isIE()){if(e.clientX){sideMenu.__dispatchEvent(new CustomEvent("itemclick"))}sideMenu.__dispatchEvent(new CustomEvent("select"),sideMenu.selectedMenuId)}else{if(e.clientX){sideMenu.__dispatchEvent(new Event("itemclick"))}sideMenu.__dispatchEvent(new Event("select"),sideMenu.selectedMenuId)}if(sideMenu.selectedMenuId in sideMenu.itemOnClick){sideMenu.itemOnClick[sideMenu.selectedMenuId](event,Top.Dom.selectById(sideMenu.id))}e.stopPropagation()});top$(document).off("mouseleave","#"+this.id+" .top-menu-container").on("mouseleave","#"+this.id+" .top-menu-container",function(){top$(this).css("width","50px");top$(this).find(" .top-menu_nav ul:visible").slideUp();top$(this).find(".top-menu_parent").removeClass("top-menu_open");top$(this).find(".top-menu_parent").addClass("top-menu_collapsed");if(Top.Util.Browser.isIE()){sideMenu.__dispatchEvent(new CustomEvent("close"))}else{sideMenu.__dispatchEvent(new Event("close"))}});top$(document).off("mouseenter","#"+this.id+" .top-menu-container").on("mouseenter","#"+this.id+" .top-menu-container",function(){sideMenu.sideOpen(sideMenu.selectedNode);if(Top.Util.Browser.isIE()){sideMenu.__dispatchEvent(new CustomEvent("open"))}else{sideMenu.__dispatchEvent(new Event("open"))}})}top$(this.childRoot).find(".top-menu-container").css("width","50px")},attachEventHandlerforDropdown:function(){var _this=this;var _this_id;if(_this.getAttribute("row")&&_this.getAttribute("col")){_this_id=_this.id.replace("_"+_this.getAttribute("row")+"_"+_this.getAttribute("col"),"")}else{_this_id=_this.id}var checkReg=new RegExp("^top-menu_"+_this_id+"_");var shadowRoot=this.childRoot.firstElementChild;this.childRoot.classList.add("Menu_type_dropdown");function closeMenuItem(menuElem){if(!menuElem)return;var childMenu_ul=menuElem.querySelector("ul");menuElem.classList.remove("selected");menuElem.classList.remove("top-menu_open");menuElem.classList.add("top-menu_collapsed");childMenu_ul.style.display="none";var childMenuItem_li=top$(childMenu_ul).find("> .selected");if(childMenuItem_li.length>0&&childMenuItem_li.hasClass("top-menu_parent")){for(var i=0;i<childMenuItem_li.length;i++)closeMenuItem(childMenuItem_li[i])}}function openMenuItem(menuElem){if(!menuElem)return;var parent_ul=menuElem.parentNode;var childMenu_ul=menuElem.querySelector("ul");menuElem.classList.add("selected");menuElem.classList.add("top-menu_open");menuElem.classList.remove("top-menu_collapsed");if(childMenu_ul){childMenu_ul.style.display="block";childMenu_ul.style.top=(parent_ul.clientHeight-parent_ul.offsetHeight)/2+"px";childMenu_ul.style.left=menuElem.offsetLeft+menuElem.offsetWidth+"px"}}top$(document).off("click","#"+this.id+" .top-menu_btn.top-menu_collapsed").on("click","#"+this.id+" .top-menu_btn.top-menu_collapsed",function(){top$('top-menu[type="dropdown"] .top-menu_btn.top-menu_open').click();var thisNav=_this.childRoot.querySelector(".top-menu_nav");var thisIcon=this.querySelector(".icon-arrow_filled_down");this.classList.add("top-menu_open");this.classList.remove("top-menu_collapsed");top$(thisNav).css("display","block");thisIcon.classList.add("icon-arrow_filled_up");thisIcon.classList.remove("icon-arrow_filled_down");if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("open"))}else{_this.__dispatchEvent(new Event("open"))}_this.setDropdownPosition()});top$(document).off("click","#"+this.id+" .top-menu_btn.top-menu_open").on("click","#"+this.id+" .top-menu_btn.top-menu_open",function(){var thisNav=_this.childRoot.querySelector(".top-menu_nav");var thisIcon=this.querySelector(".icon-arrow_filled_up");this.classList.add("top-menu_collapsed");this.classList.remove("top-menu_open");top$(thisNav).css("display","none");thisIcon.classList.add("icon-arrow_filled_down");thisIcon.classList.remove("icon-arrow_filled_up");if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("close"))}else{_this.__dispatchEvent(new Event("close"))}thisNav.style.top="";thisNav.style.left="";thisNav.style.width="";thisNav.style.right="";thisNav.style.bottom=""});top$(document).on("click","#"+this.id+" .top-menu_item.top-menu_collapsed:not(.top-menu_open)",function(e){var parent_ul=this.parentNode;var prevSelectedItem=top$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}openMenuItem(this);e.stopPropagation()});top$(document).on("click","#"+this.id+" .top-menu_item.top-menu_open:not(.top-menu_collapsed)",function(e){closeMenuItem(this);e.stopPropagation()});top$(document).on("click","#"+this.id+" .top-menu_item:not(.top-menu_parent)",function(e){var innerItem=this.querySelector(".top-menu_item_inner");for(var i=0;i<innerItem.classList.length;i++){if(checkReg.test(innerItem.classList[i])){_this.selectedMenuId=innerItem.classList[i].replace("top-menu_"+_this_id+"_","");break}}if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("itemclick"));_this.__dispatchEvent(new CustomEvent("select"),_this.selectedMenuId)}else{_this.__dispatchEvent(new Event("itemclick"));_this.__dispatchEvent(new Event("select"),_this.selectedMenuId)}if(_this.selectedMenuId in _this.itemOnClick){_this.itemOnClick[_this.selectedMenuId](event,_this)}var parent_ul=this.parentNode;var prevSelectedItem=top$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}this.classList.add("selected");if(_this.autoClose)top$(_this.childRoot.querySelector(".top-menu_btn.top-menu_open")).click();e.stopPropagation()});top$(document).off("mousedown click","#"+this.id).on("mousedown click","#"+this.id,function(e){e.stopPropagation()});top$(document).off("mouseleave","#"+this.id).on("mouseleave","#"+this.id,function(e){top$(_this.childRoot.querySelector(".top-menu_btn.top-menu_open")).click();e.stopPropagation()})},attachEventHandlerforDrawer:function(){var drawerMenu=this;var checkReg=new RegExp("^top-menu_"+this.id+"_");var shadowRoot=this.childRoot;shadowRoot.classList.add("Menu_type_drawer");top$(document).off("click","#"+this.id+" .top-menu_nav li a").on("click","#"+this.id+" .top-menu_nav li a",function(e){var thisLI=this.parentNode;top$(drawerMenu.childRoot).find(".selected").removeClass("selected");var opened_LIs=top$(drawerMenu.childRoot).find("li.top-menu_open");var parent_LIs=top$(this).closest("ul").parents("li");top$.each(opened_LIs,function(index,openedLI){var isParent=false;top$.each(parent_LIs,function(_index,parent_li){if(openedLI===parent_li)isParent=true});if(openedLI===thisLI)isParent=true;if(!isParent){drawerMenu.animation===true?top$(openedLI).find("> ul").slideUp():top$(openedLI).find("> ul").hide();openedLI.classList.remove("top-menu_open");openedLI.classList.add("top-menu_collapsed")}});this.classList.add("selected");top$(drawerMenu.childRoot).find("li.depth1.active").removeClass("active");var activeDepth1=top$(this).parents("li.depth1")[0];activeDepth1.classList.add("active");if(top$(thisLI).hasClass("top-menu_open")){drawerMenu.animation===true?top$(thisLI).find("> ul").slideUp():top$(thisLI).find("> ul").hide();thisLI.classList.remove("top-menu_open");thisLI.classList.add("top-menu_collapsed");if(top$(thisLI).hasClass("depth1")){top$(activeDepth1).removeClass("active")}}else if(top$(this.parentNode).hasClass("top-menu_collapsed")){drawerMenu.animation===true?top$(thisLI).find("> ul").slideDown():top$(thisLI).find("> ul").show();thisLI.classList.remove("top-menu_collapsed");thisLI.classList.add("top-menu_open")}for(var i=0;i<this.classList.length;i++){if(checkReg.test(this.classList[i])){drawerMenu.selectedMenuId=this.classList[i].replace("top-menu_"+drawerMenu.id+"_","");break}}if(Top.Util.Browser.isIE()){if(e.clientX){drawerMenu.__dispatchEvent(new CustomEvent("itemclick"))}drawerMenu.__dispatchEvent(new CustomEvent("select"),drawerMenu.selectedMenuId)}else{if(e.clientX){drawerMenu.__dispatchEvent(new Event("itemclick"))}drawerMenu.__dispatchEvent(new Event("select"),drawerMenu.selectedMenuId)}if(drawerMenu.selectedMenuId in drawerMenu.itemOnClick){drawerMenu.itemOnClick[drawerMenu.selectedMenuId](event,Top.Dom.selectById(drawerMenu.id))}});top$(document).off("click","#"+this.id+" .top-menu_nav li.depth3 > a").on("click","#"+this.id+" .top-menu_nav li.depth3 > a",function(){var menuItemDepth3=top$("li.depth3 a");for(var i=0;i<menuItemDepth3.length;i++){if(top$(menuItemDepth3[i]).hasClass("selected"))top$(menuItemDepth3[i].parentNode).addClass("selected");else top$(menuItemDepth3[i].parentNode).removeClass("selected")}});top$(document).off("click","#"+this.id+" .top-menu_nav li.depth4 > a").on("click","#"+this.id+" .top-menu_nav li.depth4 > a",function(){var menuItemDepth4=top$("li.depth4 a");for(var i=0;i<menuItemDepth4.length;i++){if(top$(menuItemDepth4[i]).hasClass("selected"))top$(menuItemDepth4[i].parentNode).addClass("selected");else top$(menuItemDepth4[i].parentNode).removeClass("selected")}});top$(document).off("click","#"+this.id+" .top-menu_nav li.depth5 > a").on("click","#"+this.id+" .top-menu_nav li.depth5 > a",function(){var menuItemDepth5=top$("li.depth5 a");for(var i=0;i<menuItemDepth5.length;i++){if(top$(menuItemDepth5[i]).hasClass("selected"))top$(menuItemDepth5[i].parentNode).addClass("selected");else top$(menuItemDepth5[i].parentNode).removeClass("selected")}});var originWidth=0;var originHeight=0;top$(document).off("click","#"+this.id+" .top-menu_btn").on("click","#"+this.id+" .top-menu_btn",function(){if(originWidth===0)originWidth=shadowRoot.offsetWidth;if(originHeight===0)originHeight=shadowRoot.offsetHeight;if(top$(this).hasClass("top-menu_open")){this.classList.add("top-menu_collapsed");this.classList.remove("top-menu_open");var btnWidth=this.offsetWidth;top$(this.nextSibling).css("display","none");top$(shadowRoot).css("width",btnWidth);if(!drawerMenu.layoutHeight||drawerMenu.layoutHeight==="auto"){top$(shadowRoot).css("height",originHeight)}if(Top.Util.Browser.isIE()){drawerMenu.__dispatchEvent(new CustomEvent("close"))}else{drawerMenu.__dispatchEvent(new Event("close"))}}else{this.classList.add("top-menu_open");this.classList.remove("top-menu_collapsed");top$(this.nextSibling).css("display","");top$(shadowRoot).css("width",originWidth);if(drawerMenu.layoutHeight==="auto"){top$(shadowRoot).css("height","auto")}if(Top.Util.Browser.isIE()){drawerMenu.__dispatchEvent(new CustomEvent("open"))}else{drawerMenu.__dispatchEvent(new Event("open"))}}})},attachEventHandlerforHeader:function(){var _this=this;var checkReg=new RegExp("^top-menu_"+this.id+"_");var menuRoot=this.childRoot.firstElementChild;this.childRoot.classList.add("Menu_type_header");top$(document).off("mouseenter","#"+this.id+" .depth1.top-menu_parent.top-menu_collapsed").on("mouseenter","#"+this.id+" .depth1.top-menu_parent.top-menu_collapsed",function(){var list_elem=this.querySelector("ul");top$(_this.childRoot.querySelector(".top-menu_open")).mouseleave();top$(list_elem).stop().slideDown();this.classList.remove("top-menu_collapsed");this.classList.add("top-menu_open");top$(this.querySelector(".top-menu_item_inner")).addClass("selected");top$(this.querySelector(".top-menu_arrow")).removeClass("icon-arrow_down");top$(this.querySelector(".top-menu_arrow")).addClass("icon-arrow_up");if(!list_elem&&this.classList.contains("connected_layout")){var depth1_li=_this.querySelector("ul");for(var i=0;i<depth1_li.childElementCount;i++){if(this===depth1_li.children[i]){var items=Top.Util.namespace(_this.items,_this);break}}if(typeof items[i]!=="undefined"&&items[i].itemLayoutId){list_elem=document.createElement("ul");this.appendChild(list_elem);Top.Ajax.execute({url:items[i].itemLayoutId+".html",success:function(data){
list_elem.innerHTML=data;_this.createHtmlObjects(list_elem);_this.createdItemWidgetAttachedCallback()}})}}if(_this.placement==="vertical"){if(list_elem.offsetWidth<this.offsetWidth){list_elem.style.width=this.offsetWidth-2+"px"}}else{list_elem.style.left="";if(list_elem.offsetWidth<menuRoot.offsetWidth){list_elem.style.width=menuRoot.offsetWidth-2+"px"}list_elem.style.left=menuRoot.getBoundingClientRect().left-list_elem.getBoundingClientRect().left+"px"}});top$(document).off("mouseleave","#"+this.id+" .depth1.top-menu_parent.top-menu_open").on("mouseleave","#"+this.id+" .depth1.top-menu_parent.top-menu_open",function(){var list_elem=this.querySelector("ul");top$(list_elem).stop().slideUp();this.classList.remove("top-menu_open");this.classList.add("top-menu_collapsed");top$(this.querySelector(".top-menu_item_inner")).removeClass("selected");top$(this.querySelector(".top-menu_arrow")).removeClass("icon-arrow_up");top$(this.querySelector(".top-menu_arrow")).addClass("icon-arrow_down")});top$(document).off("click","#"+this.id+" .top-menu_item_inner").on("click","#"+this.id+" .top-menu_item_inner",function(e){if(top$(this.parentNode).hasClass("depth1"))top$(this.parentNode).mouseenter();top$(_this.childRoot.querySelectorAll(".top-menu_item_inner.selected")).removeClass("selected");this.classList.add("selected");top$(_this.childRoot.querySelectorAll(".depth2.active")).removeClass("active");top$(this.parentNode).addClass("active");for(var i=0;i<this.classList.length;i++){if(checkReg.test(this.classList[i])){_this.selectedMenuId=this.classList[i].replace("top-menu_"+_this.id+"_","");break}}if(_this.selectedMenuId in _this.itemOnClick){_this.itemOnClick[_this.selectedMenuId](event,Top.Dom.selectById(_this.id))}if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("itemclick"));_this.__dispatchEvent(new CustomEvent("select"),_this.selectedMenuId)}else{_this.__dispatchEvent(new Event("itemclick"));_this.__dispatchEvent(new Event("select"),_this.selectedMenuId)}e.stopPropagation()});top$(document).off("click","#"+this.id+" .depth2").on("click","#"+this.id+" .depth2",function(){top$(_this.childRoot.querySelectorAll(".depth2.active")).removeClass("active");this.classList.add("active");top$(this.querySelector(".top-menu_item_inner"))[0].click()})},attachEventHandlerforCascading:function(){var _this=this;this.childRoot.classList.add("Menu_type_cascading");var timer;var checkReg=new RegExp("^top-menu_"+this.id+"_");var shadowRoot=this.childRoot;function closeMenuItem(menuElem){if(!menuElem)return;var childMenu_ul=menuElem.querySelector("ul");var arrowElem=menuElem.querySelector(".top-menu_arrow");menuElem.classList.remove("selected");menuElem.classList.remove("top-menu_open");menuElem.classList.add("top-menu_collapsed");childMenu_ul.style.display="none";var childMenuItem_li=top$(childMenu_ul).find("> .selected");if(childMenuItem_li.length>0&&childMenuItem_li.hasClass("top-menu_parent")){for(var i=0;i<childMenuItem_li.length;i++)closeMenuItem(childMenuItem_li[i])}arrowElem.classList.remove("icon-arrow_filled_right");arrowElem.classList.add("icon-arrow_filled_left")}function openMenuItem(menuElem){if(!menuElem)return;var parent_ul=menuElem.parentNode;var childMenu_ul=menuElem.querySelector("ul");var arrowElem=menuElem.querySelector(".top-menu_arrow");menuElem.classList.add("selected");menuElem.classList.add("top-menu_open");menuElem.classList.remove("top-menu_collapsed");childMenu_ul.style.display="block";childMenu_ul.style.top="0px";childMenu_ul.style.left=menuElem.offsetWidth+"px";arrowElem.classList.remove("icon-arrow_filled_left");arrowElem.classList.add("icon-arrow_filled_right")}top$("#"+this.id+" .top-menu_item.top-menu_collapsed").off("click").on("click",function(e){var parent_ul=this.parentNode;var prevSelectedItem=top$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}openMenuItem(this);e.stopPropagation()});top$(this.childRoot).on("mouseenter"," .top-menu_item.top-menu_collapsed",function(e){var thisItem=this;var parent_ul=this.parentNode;timer=setTimeout(function(){var prevSelectedItem=top$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}openMenuItem(thisItem)},200);e.stopPropagation()});top$("#"+this.id+" .top-menu_item:not(.top-menu_parent)").off("click").on("click",function(e){var innerItem=this.querySelector(".top-menu_item_inner");for(var i=0;i<innerItem.classList.length;i++){if(checkReg.test(innerItem.classList[i])){_this.selectedMenuId=innerItem.classList[i].replace("top-menu_"+_this.id+"_","");break}}if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("itemclick"));_this.__dispatchEvent(new CustomEvent("select"),_this.selectedMenuId)}else{_this.__dispatchEvent(new Event("itemclick"));_this.__dispatchEvent(new Event("select"),_this.selectedMenuId)}if(_this.selectedMenuId in _this.itemOnClick){_this.itemOnClick[_this.selectedMenuId](event,Top.Dom.selectById(_this.id))}var parent_ul=this.parentNode;var prevSelectedItem=top$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0]);else prevSelectedItem.removeClass("selected")}this.classList.add("selected");e.stopPropagation()});top$(this.childRoot).on("mouseenter"," .top-menu_item:not(.top-menu_parent)",function(e){var thisItem=this;var parent_ul=this.parentNode;timer=setTimeout(function(){var prevSelectedItem=top$(parent_ul).find("> .selected");if(prevSelectedItem){if(prevSelectedItem.hasClass("top-menu_parent"))closeMenuItem(prevSelectedItem[0])}},200);e.stopPropagation()});top$("#"+this.id+" ul.top-menu_nav").off("mouseleave").on("mouseleave",function(){var opend_li=shadowRoot.querySelector("li.depth1.top-menu_open");closeMenuItem(opend_li)})},__detachEventHandler:function(){top$(document).off("click","#"+this.id+" .top-menu_btn.top-menu_collapsed");top$(document).off("click","#"+this.id+" .top-menu_btn.top-menu_open");top$(document).off("click","#"+this.id+" .top-menu_item.top-menu_collapsed:not(.top-menu_open)");top$(document).off("click","#"+this.id+" .top-menu_item.top-menu_open:not(.top-menu_collapsed)");top$(document).off("click","#"+this.id+" .top-menu_item:not(.top-menu_parent)");top$(document).off("click","#"+this.id)},setDepth:function(obj,depth){if(!depth)depth=1;for(var i=0;i<obj.length;i++){if(!obj[i].hasOwnProperty("depth")){obj[i].depth=depth}if(obj[i].hasOwnProperty("children")){this.setDepth(obj[i].children,depth+1)}}},sideOpen:function(selectedNode){var width=this.getMaxWidth();top$(this.querySelector(".top-menu-container")).css("width",width);top$(this.querySelector(".top-menu-container")).find(".top-menu_nav").css("width",width);if(selectedNode&&selectedNode.parentNode){top$(selectedNode.parentNode).slideDown();top$(selectedNode.parentNode.parentNode).addClass("top-menu_open");top$(selectedNode.parentNode.parentNode).removeClass("top-menu_collapsed");top$(selectedNode.parentNode.parentNode.parentNode).slideDown();top$(selectedNode.parentNode.parentNode.parentNode.parentNode).addClass("top-menu_open");top$(selectedNode.parentNode.parentNode.parentNode.parentNode).removeClass("top-menu_collapsed")}},open:function(menuId,animate){this.__openedMenuId=menuId;var root=this.childRoot;switch(this.type){case"floating":{if(menuId){if(!Array.isArray(menuId)){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_collapsed"))$this.click()}else $this.click()}else{for(var i=0;i<menuId.length;i++){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_collapsed"))$this.click()}else $this.click()}}}else{top$(root.lastChild).slicknav("open");if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("open"))}else{this.__dispatchEvent(new Event("open"))}}break}case"side":{if(menuId){if(!Array.isArray(menuId)){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_collapsed"))$this.click()}else $this.click()}else{for(var i=0;i<menuId.length;i++){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_collapsed"))$this.click()}else $this.click()}}}else{if(!top$(this).hasClass("menu_02")){top$(root.querySelector(".top-menu-container")).mouseenter();if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("open"))}else{this.__dispatchEvent(new Event("open"))}}}break}case"drawer":{if(menuId){if(!Array.isArray(menuId)){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.length===0)return;var depth=parseInt($this.attr("class").match(/depth([1-9])/)[1]);var pivot=$this;var toBeOpened=[];for(var i=depth;i>0;i--){toBeOpened.push(pivot);pivot=pivot.parent().parent().prev()}toBeOpened.reverse().forEach(function(node){if(node.parent().hasClass("top-menu_parent")){if(node.parent().hasClass("top-menu_collapsed")){if(animate===false){node.next().css("display","block");node.parent().removeClass("top-menu_collapsed");node.parent().addClass("top-menu_open")}else{node.click()}}}else node.click()})}else{for(var i=0;i<menuId.length;i++){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_collapsed")){if(animate===false){$this.next().css("display","block");$this.parent().removeClass("top-menu_collapsed");$this.parent().addClass("top-menu_open")}else{$this.click()}}}else $this.click()}}}else{top$(root.querySelector(".top-menu_btn.top-menu_collapsed")).click();if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("open"))}else{this.__dispatchEvent(new Event("open"))}}break}case"dropdown":{if(menuId){if(!Array.isArray(menuId)){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));$this.click()}else{for(var i=0;i<menuId.length;i++){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));$this.click()}}}else{top$(root.querySelector(".top-menu_btn.top-menu_collapsed")).click();if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("open"))}else{this.__dispatchEvent(new Event("open"))}}break}case"header":{if(menuId){if(!Array.isArray(menuId)){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));$this.click()}else{for(var i=0;i<menuId.length;i++){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));$this.click()}}}break}case"cascading":{if(menuId){if(!Array.isArray(menuId)){var $this=top$("#"+this.id+" .top-menu_"+this.id+"_"+menuId).parent();$this.click()}else{for(var i=0;i<menuId.length;i++){var $this=top$("#"+this.id+" .top-menu_"+this.id+"_"+menuId[i]).parent();$this.click()}}}else{var rootElement=root.firstElementChild;rootElement.style.display="inline-block";if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("open"))}else{this.__dispatchEvent(new Event("open"))}}break}}},close:function(menuId){function closeMenuItem(menuElem){if(!menuElem)return;var childMenu_ul=menuElem.querySelector("ul");var arrowElem=menuElem.querySelector(".top-menu_arrow");menuElem.classList.remove("selected");menuElem.classList.remove("top-menu_open");menuElem.classList.add("top-menu_collapsed");if(childMenu_ul){childMenu_ul.style.display="none";var childMenuItem_li=top$(childMenu_ul).find("> .selected");if(childMenuItem_li.length>0&&childMenuItem_li.hasClass("top-menu_parent")){for(var i=0;i<childMenuItem_li.length;i++)closeMenuItem(childMenuItem_li[i])}}arrowElem.classList.remove("icon-arrow_filled_right");arrowElem.classList.add("icon-arrow_filled_left")}var root=this.childRoot;switch(this.type){case"floating":{if(menuId){if(!Array.isArray(menuId)){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}else{for(var i=0;i<menuId.length;i++){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}}}else{top$(root.lastChild).slicknav("close");if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("close"))}else{this.__dispatchEvent(new Event("close"))}}break}case"side":{if(menuId){if(!Array.isArray(menuId)){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}else{for(var i=0;i<menuId.length;i++){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}}}else{if(!top$(this).hasClass("menu_02")){top$(root.querySelector(".top-menu-container")).mouseleave();if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("close"))}else{this.__dispatchEvent(new Event("close"))}}}break}case"drawer":{if(menuId){if(!Array.isArray(menuId)){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}else{for(var i=0;i<menuId.length;i++){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.click()}else $this.click()}}}else{top$(root.querySelector(".top-menu_btn.top-menu_open")).click();if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("close"))}else{this.__dispatchEvent(new Event("close"))}}break}case"dropdown":{if(menuId){if(!Array.isArray(menuId)){var menuItem=root.querySelector(" .top-menu_"+this.id+"_"+menuId).parentNode;closeMenuItem(menuItem)}else{for(var i=0;i<menuId.length;i++){var menuItem=root.querySelector(" .top-menu_"+this.id+"_"+menuId[i]).parentNode;closeMenuItem(menuItem)}}}else{top$(root.querySelector(".top-menu_btn.top-menu_open")).click();if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("close"))}else{this.__dispatchEvent(new Event("close"))}}break}case"header":{if(menuId){if(!Array.isArray(menuId)){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.mouseleave()}}else{for(var i=0;i<menuId.length;i++){var $this=top$(root.querySelector(" a.top-menu_"+this.id+"_"+menuId[i]));if($this.parent().hasClass("top-menu_parent")){if($this.parent().hasClass("top-menu_open"))$this.mouseleave()}}}}break}case"cascading":{if(menuId){if(!Array.isArray(menuId)){var menuItem=root.querySelector(" .top-menu_"+this.id+"_"+menuId).parentNode;closeMenuItem(menuItem)}else{for(var i=0;i<menuId.length;i++){var menuItem=root.querySelector(" .top-menu_"+this.id+"_"+menuId[i]).parentNode;closeMenuItem(menuItem)}}}else{var rootElement=root.firstElementChild;rootElement.style.display="none";if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("close"))}else{this.__dispatchEvent(new Event("close"))}}break}}},setDropdownPosition:function(){var btn=this.childRoot.querySelector(".top-menu_btn");var list=this.childRoot.querySelector(".top-menu_nav");if(!list||list.offsetWidth===undefined||list.offsetWidth===0)return;list.style.top="";list.style.left="";list.style.width="";list.style.right="";list.style.bottom="";if(this.listLocation){if(this.listLocation.startsWith("b")){list.style.top=btn.getBoundingClientRect().top+btn.getBoundingClientRect().height+"px"}else{list.style.bottom=window.innerHeight-btn.getBoundingClientRect().bottom+btn.offsetHeight+"px"}if(this.listLocation.endsWith("l")){list.style.left=btn.getBoundingClientRect().left+"px"}else{var calcedRight=Math.abs(btn.getBoundingClientRect().right-top$(document).width());list.style.right=calcedRight+"px"}}else{list.style.top=btn.getBoundingClientRect().top+btn.getBoundingClientRect().height+"px";list.style.left=btn.getBoundingClientRect().left+"px";var calcedRight=btn.getBoundingClientRect().right-top$(document).width();if(calcedRight>0){calcedRight=Math.abs(btn.getBoundingClientRect().right-top$(document).width());list.style.left="";list.style.right=calcedRight+"px"}if(top$(list).offset().top+list.offsetHeight>top$(document).height()){list.style.top="";list.style.bottom=window.innerHeight-btn.getBoundingClientRect().bottom+btn.offsetHeight+"px"}}if(list.offsetWidth!==undefined&&btn&&btn.offsetWidth!==undefined&&list.offsetWidth<=btn.offsetWidth){list.style.width=btn.offsetWidth+"px"}if(top$(list).css("position")!=="fixed")list.style.position="fixed"},__updateItems:function(){this.itemOnClick={};if(this.type==="floating"){this.renderFloating()}else if(this.type==="side"){this.renderSide()}else if(this.type==="dropdown"){this.renderDropdown()}else if(this.type==="drawer"){this.renderDrawer()}else if(this.type==="header"){this.renderHeader()}else if(this.type==="cascading"){this.renderCascading()}this.__addEventByAttr("select");this.__addEventByAttr("open");this.__addEventByAttr("close");if(this.items)Top.i18n.__onUpdate(this.id,"__updateItems")},__updateType:function(){switch(this.type){case"floating":{this.attachEventHandlerforFloating();break}case"side":{this.attachEventHandlerforSide();break}case"dropdown":{this.attachEventHandlerforDropdown();break}case"drawer":{this.attachEventHandlerforDrawer();break}case"header":{this.attachEventHandlerforHeader();break}case"cascading":{this.attachEventHandlerforCascading();break}}},__updateTitle:function(){switch(this.type){case"dropdown":{this.childRoot.querySelector(".top-menu_title").innerText=this.title;break}}},__getSelectedMenuDataById:function(menuId,items){if(!items){if(this.items){if(typeof this.items==="string"){var items=Top.Util.namespace(this.items);if(!Array.isArray(items))return}else{var items=this.items}}else if(this.menuItems){var items=this.makeItems(this.menuItems)}}if(!items||!menuId)return;var selectedMenuItem;for(var i=0,len=items.length;i<len;i++){if(items[i].id===menuId){return items[i]}if(typeof items[i].children==="object"&&items[i].children.length>0){selectedMenuItem=this.__getSelectedMenuDataById(menuId,items[i].children);if(selectedMenuItem){return selectedMenuItem}}}return selectedMenuItem},__updateMenuId:function(){var items=this.dataName+"."+this.menuId;this.dataModel["items"]=items;this.__initBoundData();this.__updateItems()},__updateOnItemclick:function(){this.__addEventByAttr("itemclick")},setMenuLayout:function(selector,layout){var menuItems=this.childRoot.querySelectorAll(selector);for(var i=0,len=menuItems.length;i<len;i++){var newLayout=layout({menuId:menuItems[i].className.split("top-menu_"+this.id+"_")[1],element:menuItems[i]});if(newLayout!==undefined)menuItems[i].innerHTML=newLayout}},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("div");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle},deSelect:function(){var selectedItems=this.childRoot.querySelectorAll(".selected");for(var i=0;i<selectedItems.length;i++){selectedItems[i].classList.remove("selected")}var activedItems=this.childRoot.querySelectorAll(".active");for(var i=0;i<activedItems.length;i++){activedItems[i].classList.remove("active")}this.selectedMenuId=""},createHtmlObjects:function(child,addNodes){if(TopRuntime.topWidgets[child.tagName.toLowerCase()]!==undefined){var topWidget=TopRuntime.topWidgets[child.tagName.toLowerCase()];TopRuntime._initProperties(topWidget,child);TopRuntime._prepAllBehaviors(topWidget,child);if(!child.isTemplateAppended())child.appendTemplate();if(Top.App.isLoaded()){TopRuntime._callCallback(child,"created");TopRuntime._callCallback(child,"ready");if(addNodes!==false)TopRuntime.createdNodes.push(child);if(this.createdItemWidgets===undefined||!Array.isArray(this.createdItemWidgets)){this.createdItemWidgets=[]}this.createdItemWidgets.push(child)}}if(!child.children)return;for(var i=0;i<child.children.length;i++){this.createHtmlObjects(child.children[i],addNodes)}},createdItemWidgetAttachedCallback:function(){if(this.createdItemWidgets){for(var i=this.createdItemWidgets.length-1;i>=0;i--){TopRuntime._callCallback(this.createdItemWidgets[i],"attached")}this.createdItemWidgets=[]}}};String.format=function(){var str=arguments[0];for(var i=1;i<arguments.length;i++){str=str.replace(RegExp("\\{"+(i-1)+"\\}","gm"),arguments[i])}return str};TopNotification={is:"top-notification",behaviors:[TopWidgetBehavior],properties:{icon:String,title:String,message:String,url:String,target:{type:String,value:"_blank"},type:{type:String,value:"info"},position:{type:String,value:null},placement:{type:Object,value:{from:"top",align:"right"}},offset:{type:Number,value:0},offsetX:Number,offsetY:Number,delay:{type:Number,value:0},onClick:String},ready:function(){this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-notification-event-handler"></div>'},__initialize:function(){if(!this.icon)this.__initDefaultIcon();if(this.offset||this.offset===0){this.offsetX=this.offsetX||this.offset;this.offsetY=this.offsetY||this.offset}this.__updatePlacement();this.notification={};this.element="body";this.__initI18n("title");this.__initI18n("message")},__initEventInternal:function(){this.__addEventByAttr("click")},__updateOnClick:function(){this.__addEventByAttr("click")},__initDefaultIcon:function(){switch(this.type){case"success":this.defaultIcon="icon-circle_check";break;case"info":this.defaultIcon="icon-info";break;case"warning":this.defaultIcon="icon-bell";break;case"danger":this.defaultIcon="icon-fatal";break}},__updatePlacement:function(){if(typeof this.placement!=="string"){return}var from=this.placement.includes("b")?"bottom":"top";var align=this.placement.includes("l")?"left":this.placement.includes("r")?"right":"center";this.placement={from:from,align:align}},__updateTitle:function(){if(Object.keys(this.notification).length){var span=document.querySelectorAll("#"+this.id+" .top-notification-message");for(var i=0;i<span.length;i++){span[i].textContent=this.__i18n(this.title)}}},__updateMessage:function(){if(Object.keys(this.notification).length){var span=document.querySelectorAll("#"+this.id+" .top-notification-message");for(var i=0;i<span.length;i++){span[i].textContent=this.__i18n(this.message)}}},setTitle:function(title){if(this.notification)this.notification.update("title",title)},setIcon:function(icon){if(this.notification){icon=icon||this.defaultIcon;this.notification.update("icon",icon)}},setType:function(type){if(this.notification){if(this.icon){this.notification.update("type",type)}else{this.__initDefaultIcon();this.notification.update({icon:this.defaultIcon,type:type})}}},setUrl:function(url){if(this.notification)this.notification.update("url",url)},setTarget:function(target){if(this.notification)this.notification.update("target",target)},setMessage:function(message){if(this.notification)this.notification.update("message",message)},setPlacement:function(placement){this.placement=placement;__updatePlacement();if(this.notification)this.notification.update("placement",placement)},open:function(){var icon=this.icon?this.icon:this.defaultIcon;this.notification=new Notify({icon:icon,title:this.title,message:this.message,url:this.url,target:this.target},{element:this.element,type:this.type,placement:this.placement,offsetX:this.offsetX,offsetY:this.offsetY,delay:this.delay,onClick:this.onClick,id:this.id}).notify},setAllTopStyle:function(){},close:function(){this.notification.close()}};function Notify(content,options){this.settings={content:{icon:content.icon?content.icon:"",message:content.message,title:content.title?content.title:"",url:content.url?content.url:"#",target:content.target?content.target:"-"},element:options.element?options.element:"body",type:options.type?options.type:"info",placement:options.placement?options.placement:{from:"top",align:"right"},offsetX:options.offsetX?options.offsetX:10,offsetY:options.offsetY?options.offsetY:20,delay:options.delay?options.delay:5e3,onClick:options.onClick?options.onClick:undefined,notificationId:options.id?options.id:undefined,timer:1e3,z_index:1031,id:options.id};this.init()}top$.extend(Notify.prototype,{init:function(){var self=this;this.__buildNotify();this.__setIcon();if(this.settings.content.url!="#"){this.__styleURL()}this.__styleDismiss();this.__placement();this.__bind();this.notify={$ele:this.$ele,update:function(command,update){var commands={};if(typeof command==="string"){commands[command]=update}else{commands=command}for(var cmd in commands){switch(cmd){case"type":this.$ele.classList.remove("alert-"+self.settings.type);self.settings.type=commands[cmd];break;case"icon":var $icon=this.$ele.find('[data-notify="icon"]');$icon.classList.remove(self.settings.content.icon);$icon.classList.add(commands[cmd]);break;case"url":this.$ele.find('[data-notify="url"]').setAttribute("href",commands[cmd]);break;case"target":this.$ele.find('[data-notify="url"]').setAttribute("target",commands[cmd]);break;default:this.$ele.find('[data-notify="'+cmd+'"]').innerHTML=commands[cmd]}}var posX=this.$ele[0].offsetHeight+10+parseInt(self.settings.offsetY);self.__reposition(posX)},close:function(){self.close()}}},__buildNotify:function(){var template='<div data-notify="container" class="top-notification-root col-xs-11 col-sm-4 alert alert-{0}" role="alert" id="'+this.settings.id+'">'+'<button type="button" aria-hidden="true" class="top-notification-close" data-notify="dismiss"></button>'+'<span data-notify="icon" class="top-notification-icon"></span>'+'<span data-notify="title" class="top-notification-title">{1}</span>'+'<span data-notify="message" class="top-notification-message">{2}</span>'+'<a href="{3}" target="{4}" data-notify="url"></a></div>';var content=this.settings.content;this.$ele=top$(String.format(template,this.settings.type,content.title,content.message,content.url,content.target));this.$ele.attr("data-notify-position",this.settings.placement.from+"-"+this.settings.placement.align)},__setIcon:function(){this.$ele.find('[data-notify="icon"]').addClass(this.settings.content.icon)},__styleDismiss:function(){this.$ele.find('[data-notify="dismiss"]').css({position:"absolute",right:"16px",top:"10px",zIndex:this.settings.z_index+2})},__styleURL:function(){this.$ele.find('[data-notify="url"]').css({backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:this.settings.z_index+1})},__placement:function(){var self=this,offsetAmt=this.settings.offsetY,css={display:"inline-block",margin:"0px auto",position:"fixed",transition:"all .5s ease-in-out",zIndex:this.settings.z_index};top$('[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])').each(function(){offsetAmt=Math.max(offsetAmt,parseInt(top$(this).css(self.settings.placement.from))+parseInt(this.offsetHeight)+10)});css[this.settings.placement.from]=offsetAmt+"px";switch(this.settings.placement.align){case"left":case"right":css[this.settings.placement.align]=this.settings.offsetX+"px";break;case"center":css.left=0;css.right=0;break}this.$ele.css(css).addClass("animated fadeInDown");top$(this.settings.element).append(this.$ele)},__bind:function(){var self=this;this.$ele.find('[data-notify="dismiss"]').on("click",function(e){e.stopPropagation();self.close()});this.$ele.on("click",function(){if(typeof self.settings.onClick==="function")self.settings.onClick(typeof self.settings.onClick);else if(typeof self.settings.onClick==="string")Top.Dom.selectById(self.settings.notificationId).template.__dispatchEvent(new CustomEvent("click"))});this.$ele.mouseover(function(){top$(this).data("data-hover","true")}).mouseout(function(){top$(this).data("data-hover","false")});this.$ele.data("data-hover","false");if(this.settings.delay>0){self.$ele.data("notify-delay",self.settings.delay);var timer=setInterval(function(){var delay=parseInt(self.$ele.data("notify-delay"))-self.settings.timer;if(self.$ele.data("data-hover")==="false"){self.$ele.data("notify-delay",delay)}if(delay<=-self.settings.timer){clearInterval(timer);self.close()}},self.settings.timer)}},close:function(){var self=this,posX=parseInt(this.$ele.css(this.settings.placement.from));this.$ele.attr("data-closing","true").addClass("animated fadeOutUp");top$('[data-closing="true"]').each(function(){posX=Math.min(posX,parseInt(this.style.top.slice(0,-2)))});this.__reposition(posX);setTimeout(function(){self.$ele.remove()},600)},__reposition:function(posX){var self=this,notifies='[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])',$elements=this.$ele.nextAll(notifies);$elements.each(function(){top$(this).css(self.settings.placement.from,posX);posX=posX+10+this.offsetHeight})},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}});Top.Widget.Notification=function(){Notification.prototype=Object.create(Top.Widget.prototype);Notification.prototype.constructor=Notification;function Notification(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-notification");this.template.innerHTML='<div class="top-notification-event-handler"></div>'}this.id=this.template.id}Notification.create=function(element){return new Notification(element)};Notification.prototype.setTitle=function(title){this.template.setTitle(title)};Notification.prototype.setIcon=function(icon){this.template.setIcon(icon)};Notification.prototype.setType=function(type){this.template.setType(type)};Notification.prototype.setUrl=function(url){this.template.setUrl(url)};Notification.prototype.setTarget=function(target){this.template.setTarget(target)};Notification.prototype.open=function(){this.template.open()};Notification.prototype.close=function(){this.template.close()};return Notification}();TopPage={is:"top-page",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{id:String,src:String,onLoad:Object,onBeforeActivate:Object,onActivate:Object,onDeactivate:Object,visible:String,style:String},__srcLoad:function(onSuccess){var _this=this;Top.Ajax.execute(_this.src,{type:"get",success:function(data){var controllerPaths=Top.Util.__getControllerPaths(data);if(Top.App.__useCommonLogic()===true&&controllerPaths!==undefined){Top.App.__loadControllerFile(controllerPaths,function(_data){onSuccess();_this.__onSuccessSrcLoad(_data)},data)}else{onSuccess();_this.__onSuccessSrcLoad(data)}data=null}})},__onSuccessSrcLoad:function(data,callback){this.clearChilds(true);this.appendHtmlString(data);TopRuntime._insertedNodesCallback();Top.App.__makeTooltip(Top.App.getCurrentPage());Top.App.__makeContextMenu(Top.App.getCurrentPage());this.initialChilds();if(typeof this.srcLoad==="string"){this.srcLoad=Top.Util.namespace(this.srcLoad)}if(typeof this.srcLoad==="function")this.srcLoad();TopRuntime._srcRootNodesAttachedCallback();if(typeof callback==="function")callback();if(this.srcLoadListeners!==undefined){for(var i=0,len=this.srcLoadListeners.length;i<len;i++){if(typeof this.srcLoadListeners[i]==="function")this.srcLoadListeners[i]()}this.srcLoadListeners=[]}Top.Dialog.init();Top.Notification.init();if(document.getElementById("top-datepicker-div"))document.getElementById("top-datepicker-div").style.display="none";
},initialChilds:function(){var i=0;var thisChildrenLength=this.children.length;var maxHeight=0;this.childs=[];while(i<thisChildrenLength){if(Top.Util.__isTopWidget(this.children[i].tagName))this.childs.push(this.children[i]);this.children[i].layoutParent=this;if(this.children[i].childRoot&&this.children[i].childRoot.offsetHeight>maxHeight){maxHeight=this.children[i].childRoot.offsetHeight}i++}this.__height=maxHeight+"px"},ready:function(){this.initialChilds();if(typeof this.onLoad==="string")this.onLoad=Top.Util.namespace(this.onLoad);if(typeof this.onBeforeActivate==="string")this.onBeforeActivate=Top.Util.namespace(this.onBeforeActivate);if(typeof this.onActivate==="string")this.onActivate=Top.Util.namespace(this.onActivate);if(typeof this.onDeactivate==="string")this.onDeactivate=Top.Util.namespace(this.onDeactivate);this.style="display: "+this.visible+";";var _this=this;Top.App.onLoad(function(){if(typeof _this.__attachedImpl==="function")_this.__attachedImpl()})},__updateVisible:function(){if(Top.Util.Browser.isIE())this.style.display=this.visible==="none"?"none":"";else this.style.display=this.visible==="none"?"none":"block"},__adjustLineHeight:function(){this.childs.forEach(function(child){if(typeof child.__adjustLineHeight==="function")child.__adjustLineHeight()})},getAllTopStyle:function(){},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){}};Top.Widget.Page=function(){Page.prototype=Object.create(Top.Widget.prototype);Page.prototype.constructor=Page;function Page(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-page")}this.id=this.template.id}Page.create=function(element){return new Page(element)};Page.prototype.loaded=false;Page.prototype.activated=false;Page.prototype.append=function(htmlString){if(Top.Util.getFileExtension(htmlString)==="html"){var _this=this;Top.Ajax.execute(htmlString,{success:function(data){_this.template.appendHtmlString(data);_this.template.initialChilds();TopRuntime._insertedNodesCallback();if(typeof callback==="function")callback();TopRuntime._srcRootNodesAttachedCallback();data=null}})}else{this.template.appendHtmlString(htmlString);this.template.initialChilds();TopRuntime._insertedNodesCallback();TopRuntime._srcRootNodesAttachedCallback()}};Page.prototype.html=function(htmlString){this.template.clearChilds();if(!htmlString||htmlString===""){return}this.template.appendHtmlString(htmlString);this.template.initialChilds();TopRuntime._insertedNodesCallback();TopRuntime._srcRootNodesAttachedCallback()};Page.prototype.src=function(htmlFile,jsFile,callback){if(Top.Util.getFileExtension(htmlFile)!="html")return;if(typeof jsFile==="function"&&callback===undefined)callback=jsFile;var _this=this;loadHtml=function(){Top.Ajax.execute(htmlFile,{success:function(data,textStatus,jqXHR){var controllerPaths=Top.Util.__getControllerPaths(data);if(Top.App.__useCommonLogic()===true&&controllerPaths!==undefined){Top.App.__loadControllerFile(controllerPaths,function(){_this.template.__onSuccessSrcLoad(data,callback)})}else{_this.template.__onSuccessSrcLoad(data,callback)}data=null}})};if(typeof jsFile==="string"){this.template.__loadScript(jsFile,loadHtml)}else{loadHtml()}};Page.prototype.onLoad=function(func){this.template["onLoad"]=func};Page.prototype.onBeforeActivate=function(func){var page=this;this.template["onBeforeActivate"]=function(){func(page.template.params)}};Page.prototype.onActivate=function(func){var page=this;this.template["onActivate"]=function(){if(location.hash!=""&&location.hash.replace("#!","")!=Top.curRoute.path){var path=location.hash.replace("#!","");if(typeof Top.routes[path]==="string")return;Top.App.__routeReplace(path)}func(page.template.params)}};Page.prototype.onDeactivate=function(func){this.template["onDeactivate"]=func};Page.prototype.getChildren=function(selector){var topElements=[];if(selector){var elements=this.template.querySelectorAll(selector)}else{var elements=this.template.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements};Page.prototype.selectById=function(id){var element=this.template.querySelector("#"+id);if(element==null)return null;return Top.Dom.__selectImpl(element)};Page.prototype.select=function(selector){var element=this.template.querySelectorAll(selector);var len=element.length;var widgets=[];for(var i=0;i<len;i++){var selected=Top.Dom.__selectImpl(element[i]);if(selected)widgets.push(selected)}return widgets};return Page}();TopPagination={is:"top-pagination",behaviors:[TopWidgetBehavior],properties:{total:{type:Number,value:1},page:{type:Number},beforepage:{type:Number},type:{type:String,value:"basic"},pagememory:{type:Object,value:{}},maxVisible:Number,targetArea:String,targetContent:String,eventPageSelected:String,hrefSrc:{type:String,value:"javascript:void(0);"},hrefVariable:"{{number}}",pagerId:String,onPagechange:String},__ready:function(){var shadowPage=this.querySelector(".top-pagination-root");this.pagerId=Top.Util.guid();shadowPage.setAttribute("id",this.pagerId);this.__initialize()},appendTemplate:function(){this.innerHTML='<div class="top-pagination-root"></div>'},__attached2:function(){this.__bindEvent()},__initEventInternal:function(){this.__addEventByAttr("pagechange")},__bindEvent:function(){var shadowPage=this.querySelector(".top-pagination-root");var _this=this;top$(shadowPage).off("page");top$(shadowPage).on("page",function(event,num){_this.beforepage=_this.page;_this.page=num;_this.updateData("page");if(typeof _this.eventPageSelected==="function")_this.eventPageSelected(_this.page);if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("pagechange"))}else{_this.__dispatchEvent(new Event("pagechange"))}})},__initialize:function(){this.page=parseInt(this.page);this.total=parseInt(this.total);this.maxVisible=parseInt(this.maxVisible);this.__renderPage();this.__updateEventPageSelected();this.__updatePage()},__renderPage:function(){this.clearWidget();this.setAttribute("type",this.type);if(this.type=="basic"||this.type=="big"){this.renderBasic()}else if(this.type=="input"){this.renderInput()}else if(this.type==="button"){this.renderButton()}},__updatePage:function(){this.__renderPage();if(typeof this.eventPageSelected==="function"&&this.page)this.eventPageSelected(this.page)},__updateTotal:function(){this.__renderPage()},__updateMaxVisible:function(){this.__renderPage()},__updateEventPageSelected:function(){if(typeof this.eventPageSelected=="string"){this.eventPageSelected=Top.Util.namespace(this.eventPageSelected,this)}},renderBasic:function(){if(this.total===0)return;var shadowPage=this.querySelector("div.top-pagination-root");if(this.maxVisible===undefined)this.maxVisible=null;top$(shadowPage).bootpag({total:this.total,page:this.page,maxVisible:this.maxVisible,firstLastUse:true,first:" ",last:" ",next:" ",prev:" ",leaps:false})},renderInput:function(){if(this.total===0)return;if(this.maxVisible===null)this.maxVisible=undefined;var shadowPage=this.querySelector("div.top-pagination-root");var thisPager=this;var $owner=top$(shadowPage);this.maxVisible=1;var $pager,lp,me=top$(shadowPage),p=['<ul class="top-pagination-container">'];p=p.concat(['<li data-lp="1" class="first"><a class="cell_link" href="',this.href(1),'">',"</a></li>"]);p=p.concat(['<li data-lp="1" class="prev"><a class="cell_link" href="',this.href(1),'">',"</a></li>"]);p=p.concat(['<li class="cell" ><a class="cell_link"><input class="cell_input" type="number" min="1" max="',this.total,'"> of ',this.total," </a></li>"]);lp=this.total>this.maxVisible?Math.min(this.maxVisible+1,this.total):2;p=p.concat(['<li data-lp="',lp,'" class="next"><a class="cell_link" href="',this.href(lp),'">',"</a></li>"]);p=p.concat(['<li data-lp="',this.total,'" class="last"><a class="cell_link" href="',this.href(this.total),'">',"</a></li>"]);p.push("</ul>");me.find("ul.top-pagination-container").remove();me.append(p.join(""));$pager=me.find("ul.top-pagination-container");me.find("li:not(.cell)").on("click",function paginationClick(){var me=top$(this);if(me.hasClass("disabled")||me.hasClass("active")){return}var page=parseInt(me.attr("data-lp"),10);$owner.find("ul.top-pagination-container").each(function(){thisPager.renderInputPage(top$(this),page)});$owner.trigger("page",page)});me.find("input").keypress(function(event){var $this=top$(me.find("ul"));if(event.which==13){thisPager.renderInputPage($this,this.value);thisPager.__updatePage()}});this.renderInputPage($pager,this.page)},renderInputPage:function($pager,page){var thisPager=this;var lp,maxV=thisPager.maxVisible==0?1:thisPager.maxVisible,step=thisPager.maxVisible==1?0:1,vis=Math.floor((page-1)/maxV)*maxV,$page=$pager.find("li");page=parseInt(page,10);thisPager.page=page=page<0?0:page>thisPager.total?thisPager.total:page;lp=page-1<1?1:page-1>=thisPager.maxVisible?Math.floor((page-1)/maxV)*maxV:page-1;$page.first().toggleClass("disabled",page===1);var lfirst=$page.first();lfirst=lfirst.next();lfirst.toggleClass("disabled",page===1).attr("data-lp",lp).find("a").attr("href",thisPager.href(lp));var step=thisPager.maxVisible==1?0:1;lp=page+1>thisPager.total?thisPager.total:thisPager.leaps&&page+1<thisPager.total-thisPager.maxVisible?vis+thisPager.maxVisible+step:page+1;var llast=$page.last();llast=llast.prev();llast.toggleClass("disabled",page===thisPager.total).attr("data-lp",lp).find("a").attr("href",thisPager.href(lp));$page.last().toggleClass("disabled",page===thisPager.total);$page[2].setAttribute("data-lp",page);$page[2].querySelector("a > input").value=page},renderButton:function(){if(this.total===0)return;var shadowPage=this.querySelector("div.top-pagination-root");top$(shadowPage).bootpag({total:this.total,page:this.page,next:" ",prev:" ",maxVisible:null})},href:function(c){return this.hrefSrc.replace(this.hrefVariable,c)},setPageEvent:function(fn){this.eventPageSelected=fn},clearWidget:function(){var shadowPage=this.querySelector("div#"+this.pagerId);top$(shadowPage).children().remove()},__updateOnPagechange:function(){this.__addEventByAttr("pagechange")},getTopStyle:function(){this.topstyle=this.querySelector(".top-pagination-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-pagination-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-pagination-root").style.cssText=this.topstyle}};Top.Widget.Pagination=function(){Pagination.prototype=Object.create(Top.Widget.prototype);Pagination.prototype.constructor=Pagination;function Pagination(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-pagination");this.template.innerHTML='<div class="top-pagination-root"></div>'}this.id=this.template.id}Pagination.create=function(element){return new Pagination(element)};Pagination.prototype.getSelectedPage=function(){return this.template.page};Pagination.prototype.savePage=function(repo,instance){var currentpagedata="pagedata"+this.template.page;var beforepagedata="pagedata"+this.template.beforepage;this.template.pagememory[beforepagedata]=top$.extend(true,[],repo[instance]);repo[instance]=[];if(this.template.pagememory[currentpagedata]==undefined){return true}else{repo[instance]=top$.extend(true,[],this.template.pagememory[currentpagedata]);return false}};return Pagination}();TopPanel={is:"top-panel",behaviors:[TopWidgetBehavior,TopContainerBehavior],properties:{title:String,titleHtml:String},__ready:function(){this.__updateId();this.__initI18n("title");this.initialChilds();this.initialLayout();this.renderLayout();if(this.__eventMouseClick&&typeof this.__eventMouseClick==="function"){this.querySelector(".top-panel-title-layout").style.cursor="pointer";this.querySelector(".top-panel-content").style.cursor="pointer"}},appendTemplate:function(){this.innerHTML='<div class="top-panel-root">'+this.innerHTML+"</div>"},__eventBindingList:function(){var shadowDiv=this.querySelector(".top-panel-root");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},renderLayout:function(){var divA=document.createElement("div");var divB=document.createElement("div");var span=document.createElement("span");divA.classList.add("top-panel-title-layout");span.classList.add("top-panel-title");span.textContent=this.title;divB.classList.add("top-panel-content");divA.appendChild(span);this.childRoot.appendChild(divA);this.childRoot.appendChild(divB);this.querySelector(".top-panel-content").style.padding=this.padding;this.querySelector(".top-panel-content").style.height="calc(100% - 28px)";for(var i=0,len=this.itemLayoutDom.length;i<len;i++){this.querySelector(".top-panel-content").appendChild(this.itemLayoutDom[i]);var item=this.itemLayoutDom[i];if(item.layoutWidth==="match_parent"){item.setThisWidgetWidth("100%")}if(item.layoutHeight==="match_parent"){item.setThisWidgetHeight("100%")}}if(this.titleHtml){top$(this.querySelector(".top-panel-title-layout")).append(this.titleHtml)}},initializeChildRoot:function(){return this.querySelector(".top-panel-root")},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateTitle:function(){top$(this.querySelector("span.top-panel-title")).html(this.__i18n(this.title))},__updateTitleHtml:function(){top$(this.querySelector(".top-panel-title-layout")).append(this.titleHtml)},setContent:function(htmlString){this.itemLayoutDom=htmlString;this.renderLayout()},setTitle:function(title){this.__updateTitle()},setIcon:function(icon){this.icon=icon;this.renderLayout()},setSrc:function(src){this.src=src;this.renderLayout()},setTitleHtml:function(titleHtml){this.__updateTitleHtml()},getTopStyle:function(){this.topstyle=this.querySelector(".top-panel-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-panel-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-panel-root").style.cssText=this.topstyle}};Top.Widget.Container.Panel=function(){Panel.prototype=Object.create(Top.Widget.Container.prototype);Panel.prototype.constructor=Panel;function Panel(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-panel");this.template.innerHTML='<div class="top-panel-root"></div>'}this.id=this.template.id}Panel.create=function(element){return new Panel(element)};Panel.prototype.setContent=function(layout){this.template.itemLayout=top$(layout.template).wrap("<p/>").parent().html();top$(layout.template).unwrap();this.template.setContent(this.template.itemLayout)};Panel.prototype.setTitle=function(title){this.template.title=title;this.template.setTitle(title)};Panel.prototype.setTitleHtml=function(titleHtml){this.template.titleHtml=titleHtml;this.template.setTitleHtml(titleHtml)};return Panel}();TopPopover={is:"top-popover",behaviors:[TopWidgetBehavior],properties:{title:String,content:String,placement:String,delay:Number,trigger:String,template:String,onOpen:String,popoverTarget:String,openTarget:String,parentId:String,parentIds:Array,__popovers:Array,__parent:Object,__popover:Object},ready:function(){this.__updateId();this.__parent=this.parentNode;this.__addPopover();this.__initI18n("title");this.__initI18n("content")},__attached2:function(){this.attachEventHandler()},attachEventHandler:function(){var _this=this;top$(document).on("click scroll",function(e){top$('[data-toggle="popover"],[data-original-title]').each(function(){if(!top$(this).is(e.target)&&top$(this).has(e.target).length===0&&top$(".top-popover").has(e.target).length===0){((top$(this).popover("hide").data("bs.popover")||{}).inState||{}).click=false}})});top$(window).on("resize",_this.adjustPosition.bind(this))},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-popover-root">'+this.innerHTML+"</div>"},__eventBindingList:function(){var shadowDiv=this.querySelector(".top-popover-root");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__addPopover:function(){if(!this.__parent){return}if(TopRuntime.topWidgets[this.__parent.tagName.toLowerCase()]!==undefined){if(TopRuntime.topWidgets[this.__parent.tagName.toLowerCase()].is==="top-checkbox"){var element=this.__parent.getElementsByTagName("label")[0]}else{var element=this.__parent.getElement()}}else{var element=this.__parent}this.__popover=top$(element).popover(this.__makeOptions());this.__popovers=this.__popovers||[];this.__popovers.push(this.__popover);this.__initOnOpen()},__makeOptions:function(){var hasChildren=this.childRoot.children.length>0;if(hasChildren){var _content=this.childRoot.children[0];var popoverDiv=document.createElement("div");var arrowDiv=document.createElement("div");popoverDiv.className="top-popover "+this.className;arrowDiv.className+="top-popover-arrow";popoverDiv.appendChild(arrowDiv);this.childRoot.replaceChild(popoverDiv,_content);popoverDiv.appendChild(_content)}if(!this.template||this.canBeReused){this.template='<div class="top-popover '+this.className+'" role="tooltip"><div class="top-popover-arrow"></div><h3 class="top-popover-title"></h3><div class="top-popover-content"></div></div>'}else if(this.template){this.template='<div class="top-popover '+this.className+'"><div class="top-popover-arrow"></div>'+this.template+"</div>"}if(this.content===undefined)this.content="-";this.delay=parseInt(this.delay);return{title:this.title?this.title:"",content:this.popoverLayout?"-":this.content,placement:this.placement,delay:this.delay,trigger:this.trigger,template:hasChildren?this.childRoot.children[0]:this.template}},setContent:function(content){var popover=top$(this).parent().data("bs.popover");if(popover){popover.options.content=content;popover.setContent();popover.$tip.addClass(popover.options.placement)}},setTitle:function(title){var popover=top$(this).parent().data("bs.popover");if(popover){popover.options.title=title;popover.setContent();popover.$tip.addClass(popover.options.placement)}},__updateContent:function(){var content=document.querySelector(".top-popover-content");if(content){content.textContent=this.__i18n(this.content)}},__updateTitle:function(){var title=document.querySelector(".top-popover-title");if(title){title.textContent=this.__i18n(this.title)}},initializeChildRoot:function(){return this.querySelector(".top-popover-root")},getTopStyle:function(){this.topstyle=this.querySelector(".top-popover-root").style.cssText;return this.topstyle},setAllTopStyle:function(){this.querySelector(".top-popover-root").style.cssText=this.topstyle},__reRender:function(){this.__updateParentIds();this.__setPopoverTarget();this.__updateParentId();this.__addPopover();this.canBeReused=false},__setPopoverTarget:function(targetId){this.openTarget=targetId?targetId:this.parentId},__updateParentId:function(parentId){var id=parentId&&typeof parentId==="string"?parentId:this.parentId;if(parentId)this.parentId=id;this.__parent=document.getElementById(id)},__updateParentIds:function(){if(this.parentId){this.parentIds=this.parentIds||[];this.parentIds.push(this.parentId);this.canBeReused=true}},__initOnOpen:function(){var _this=this;var length=_this.parentIds?_this.parentIds.length:1;this.__addEventByAttr("open");this.__popovers[length-1].off("shown.bs.popover").on("shown.bs.popover",function(){if(_this.parentIds){_this.__updateParentId(this.id);_this.__setPopoverTarget(this.parentNode.popoverTarget)}if(!_this.IDEpopover||!_this.popoverLayout){if(this.parentNode.popoverTarget)_this.adjustPosition();if(!_this.onOpen)return}var contentDiv=_this.__parent.querySelector("div.top-popover-content");var contentLayout=Top.Widget.create("top-layout");if(_this.layoutId){contentLayout.id=_this.layoutId;contentLayout.template.id=_this.layoutId}contentDiv.innerHTML="";contentDiv.appendChild(contentLayout.template);_this.originWidth=_this.__parent.querySelector(".top-popover").offsetWidth;_this.__dispatchEvent(new CustomEvent("open",{detail:{contentLayout:contentLayout}}));contentLayout.setProperties({"border-width":"0px"});if(contentLayout&&_this.popoverLayout){contentLayout.src(_this.popoverLayout,function(){_this.adjustPosition()});var popover=_this.__parent.querySelector(".top-popover");popover.style.visibility="hidden"}});this.attachEventHandler()},adjustPosition:function(){var popover=this.__parent.querySelector(".top-popover");if(!popover){return}var target=document.getElementById(this.openTarget);if(TopRuntime.topWidgets[this.__parent.tagName.toLowerCase()]!==undefined){target=document.getElementById(this.openTarget).getElement()}var parentLeft=this.openTarget?top$(target).offset().left:this.__popover.offset().left;var parentWidth=this.openTarget?target.offsetWidth:this.__popover.outerWidth();var parentTop=this.openTarget?top$(target).offset().top:this.__popover.offset().left;var parentHeight=this.openTarget?target.offsetHeight:this.__popover.outerHeight();var contentWidth=popover.offsetWidth;var contentHeight=popover.offsetHeight;if(this.placement==="bottom"){popover.style.left=parseFloat(parentLeft)-(contentWidth-parentWidth)/2+"px";popover.style.top=parseFloat(parentTop)+parentHeight+"px"}else if(this.placement==="right"){popover.style.left=parseFloat(parentLeft+parentWidth)+"px";popover.style.top=parseFloat(parentTop)+parentHeight/2-20+"px"}else if(this.placement==="left"){popover.style.left=parseFloat(parentLeft-contentWidth)+"px";popover.style.top=parseFloat(parentTop)+parentHeight/2-20+"px"}else if(this.placement==="top"){popover.style.left=parseFloat(parentLeft)-(contentWidth-parentWidth)/2+"px";popover.style.top=parseFloat(parentTop)-contentHeight+"px"}popover.style.visibility="visible"}};Top.Widget.Popover=function(){Popover.prototype=Object.create(Top.Widget.prototype);Popover.prototype.constructor=Popover;function Popover(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-popover");this.template.innerHTML='<div class="top-popover-root"></div>'}this.id=this.template.id}Popover.create=function(element){return new Popover(element)};Popover.prototype.setContent=function(content){this.template.setContent(content)};Popover.prototype.setTitle=function(title){this.template.setTitle(title)};Popover.prototype.adjustPosition=function(){this.template.adjustPosition()};Popover.prototype.open=function(){if(this.template.__popover){this.template.__popover.popover("show")}};Popover.prototype.close=function(){if(this.template.__popover){this.template.__popover.popover("hide")}};Popover.prototype.toggle=function(){if(this.template.__popover){this.template.__popover.popover("toggle")}};return Popover}();TopProgressbar={is:"top-progressbar",behaviors:[TopWidgetBehavior,TopRangeBehavior],properties:{indeterminate:String,progressColor:String,progress:String,type:{type:String,value:"normal"}},__ready:function(){this.__initialize()},appendTemplate:function(){if(this.type==="normal"){this.innerHTML='<span class="top-progressbar-root"><progress class="top-progressbar-progress"></progress></span>'}else{var innerHTML='<div class="top-progressbar-root discrete">';for(var i=0;i<10;i++){innerHTML+='<div class="top-progressbar-progress bar_'+i+'"></div>'}this.innerHTML=innerHTML+"</div>"}},__eventBindingList:function(){var shadowDiv=this.type==="normal"?this.querySelector(".top-progressbar-progress"):this.querySelector(".top-progressbar-root.discrete");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__initBindingEvent:function(){var _this=this,root=this.querySelector(".top-progressbar-root.discrete");root.addEventListener("mousedown",function(e){if(_this.rootLeft===undefined){e.preventDefault();var fillIdx=parseInt(e.target.className.match(/[0-9]/gi)[0]);_this.rootWidth=e.target.parentNode.offsetWidth;_this.rootLeft=e.screenX-fillIdx*_this.rootWidth/10-e.offsetX;document.addEventListener("mousemove",_this.__dragProgress);_this.__dragProgress(e)}});document.addEventListener("mouseup",function(e){if(_this.rootLeft!==undefined){document.removeEventListener("mousemove",_this.__dragProgress);_this.rootWidth=undefined;_this.rootLeft=undefined}});if(this.__dragProgress===undefined){this.__dragProgress=function(e){var rootLeft=_this.rootLeft,mouseX=e.screenX-rootLeft+1,rootWidth=_this.rootWidth,barWidth=rootWidth/10;if(mouseX<0){mouseX=0}else if(mouseX>rootLeft+rootWidth){mouseX=rootWidth}var progress=Math.ceil(mouseX/barWidth)/10;if(_this.progress!==progress){_this.progress=progress;_this.__updateProgress()}}}},__initialize:function(){this.__updateId();if(this.type!=="discrete")this.__updateIndeterminate();this.__updateProgress();this.__updateProgressColor();if(this.type==="discrete")this.__initBindingEvent();this.__eventBindingList()},__updateId:function(){if(this.id){var progress=this.querySelector(".top-progressbar-root");progress.id=this.id}},__updateIndeterminate:function(){var progress=this.querySelector(".top-progressbar-progress");this.indeterminate=this.indeterminate==="true"||this.indeterminate===true;if(progress===null)return;if(this.indeterminate){progress.removeAttribute("value")}else{progress.setAttribute("value",this.progress)}},__updateProgress:function(){var progress=this.type==="normal"?this.querySelector(".top-progressbar-progress"):this.querySelectorAll(".top-progressbar-progress");if(this.progress>1){this.progress=1}else if(this.progress<0){this.progress=0}if(progress===null)return;if(this.type==="normal"){if(this.progress!==null&&this.progress!==undefined&&!this.indeterminate){progress.setAttribute("value",this.progress)}}else if(this.type==="discrete"){this.progress=Math.round(this.progress*10)/10;var value=this.progress*10;for(var i=0;i<10;i++){if(i<value)progress[i].classList.add("fill");else progress[i].classList.remove("fill")}}},__updateProgressColor:function(){if(!this.progressColor)return;var styles="background-color:"+this.progressColor+";";if(this.type==="normal"){if(Top.Util.Browser.isChrome()){var s="top-progressbar#"+this.id+" .top-progressbar-progress::-webkit-progress-value"}else if(Top.Util.Browser.isIE()){var s="top-progressbar#"+this.id+" .top-progressbar-progress::-ms-fill"}}else if(this.type==="discrete"){var s="top-progressbar#"+this.id+" .top-progressbar-root.discrete .top-progressbar-progress.fill"}var sheet=document.styleSheets[0];if(!this.rule&&this.rule!==0||!sheet.cssRules.length){if(sheet.insertRule){this.rule=sheet.insertRule(s+"{"+styles+"}",0)}else if(sheet.addRule){this.rule=sheet.addRule(s,styles)}}else{sheet.rules[this.rule].style.backgroundColor=this.progressColor}},initBackgroundColor:function(){},getTopStyle:function(){this.topstyle=this.querySelector(".top-progressbar-root .top-progressbar-progress").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){if(this.type==="normal"){var styleNode=this.querySelector(".top-progressbar-root .top-progressbar-progress");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}else if(this.type==="discrete"){var styleNode=this.querySelector(".top-progressbar-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}}},setAllTopStyle:function(){this.querySelector(".top-progressbar-root .top-progressbar-progress").style.cssText=this.topstyle}};Top.Widget.Progressbar=function(){Progressbar.prototype=Object.create(Top.Widget.prototype);Progressbar.prototype.constructor=Progressbar;function Progressbar(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-progressbar");this.template.innerHTML='<span class="top-progressbar-root"><progress class="top-progressbar-progress"></progress></span>'}this.id=this.template.id}Progressbar.create=function(element){return new Progressbar(element)};Progressbar.prototype.getProgress=function(){return this.template.progress};Progressbar.prototype.setProgress=function(progress){this.template.progress=progress;this.template.__updateProgress()};return Progressbar}();TopRadiobutton={is:"top-radiobutton",behaviors:[TopWidgetBehavior,TopCheckBehavior,TopChecktypeBehavior],properties:{text:{type:String,reflectToAttribute:true},tabIndex:{type:String,value:"0"}},__attached2:function(){this.__initLabel();this.__updateVerticalAlignment()},__eventBindingList:function(){var input=this.querySelector("input");var label=this.querySelector("label");return{__eventKeyReleased:function(func){input.onkeyup=func},__eventLostFocused:function(func){input.onblur=func},__eventMouseClick:function(func){input.onclick=func},__eventMouseEnter:function(func){label.onmouseenter=func},__eventMouseExit:function(func){label.onmouseleave=func},__eventMouseMove:function(func){label.onmousemove=func},__eventMousePressed:function(func){input.onmousedown=func},__eventMouseReleased:function(func){input.onmouseup=func},__eventMouseDblclick:function(func){input.ondblclick=func},__eventKeyTyped:function(func){input.onkeypress=func},__eventKeyReleased:function(func){input.onkeyup=func},__eventFocused:function(func){input.onfocus=func},__eventSecondaryClick:function(func){label.oncontextmenu=func}}},__initLabel:function(){var shadowLabel=this.querySelector("label");shadowLabel.setAttribute("for",this.id)},__ready:function(){this.__initI18n("text");this.__initialize()},appendTemplate:function(){this.innerHTML='<input class="top-radiobutton-check" type="radio"/><label class="top-radiobutton-text"><span></span></label>'},expectedTemplateClassName:function(){return"top-radiobutton-check"},__initialize:function(){this.__initTrueFalseValue();this.__initChecked();this.__updateId();this.__updateDisabled();this.__updateText();this.__updateGroupId();this.__updateChecked();
this.__updateCheckPosition();this.__initBindingEvent();this.__updateTabIndex()},__updateId:function(){if(this.id){var shadowInput=this.querySelector(".top-radiobutton-check");shadowInput.id=this.id}},__updateText:function(){this.text=this.__i18n(this.text);if(this.text||this.text===""||this.text===0){var buttonText=this.querySelector(".top-radiobutton-text");if(buttonText){if(buttonText.getElementsByTagName("span")[0]){buttonText.getElementsByTagName("span")[0].innerHTML=this.text}else{var span=document.createElement("span");buttonText.appendChild(span);buttonText.getElementsByTagName("span")[0].innerHTML=this.text}}}},__updateDisabled:function(){var shadowInput=this.querySelector(".top-radiobutton-check");var shadowLabel=this.querySelector(".top-radiobutton-text");var disabled=this.calculateDerivedDisabled();this.__setDisabled(shadowInput);this.__setDisabled(shadowLabel);if(disabled=="true"||disabled==true){shadowLabel.classList.add("disabled");this.__detachBindingEvent()}else{shadowLabel.classList.remove("disabled");this.__initBindingEvent()}},__updateChecked:function(dataBound){var shadowInput=this.querySelector("input");var shadowText=this.querySelector(".top-radiobutton-text");if(this.__isCheckedTrue()){shadowInput.checked=true;shadowText.classList.add("checked");this.__unCheckRadioGroup()}else{shadowInput.checked=false;shadowText.classList.remove("checked")}if(dataBound!==true){this.updateData("checked");this.updateDevice("checked")}if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("change"),this.checked)}else{this.__dispatchEvent(new Event("change"),this.checked)}},__unCheckRadioGroup:function(){if(this.__isAttached!==true)return;var _this=this;Top.Widget.RadioGroup[this.groupId].forEach(function(r){if(r!==_this){r.checked=_this.falseValue;r.__updateChecked()}})},__updateGroupId:function(){var bfgroupId=this.getAttribute("group-id");if(Top.Widget.RadioGroup[bfgroupId]&&Top.Widget.RadioGroup[bfgroupId].indexOf(this)>=0){Top.Widget.RadioGroup[bfgroupId].splice(Top.Widget.RadioGroup[bfgroupId].indexOf(this),1)}if(this.groupId){var shadowInput=this.querySelector("input");shadowInput.name=this.groupId;if(Top.Widget.RadioGroup[this.groupId]===undefined)Top.Widget.RadioGroup[this.groupId]=[];Top.Widget.RadioGroup[this.groupId].push(this)}this.setAttribute("group-id",this.groupId)},__updateCheckPosition:function(){var shadowLabel=this.querySelector(".top-radiobutton-text");shadowLabel.innerHTML=shadowLabel.innerHTML.replace('<i class="top-radiobutton-icon"></i>',"");if(this.checkPosition==="right"){shadowLabel.classList.remove("left");shadowLabel.classList.add("right");shadowLabel.innerHTML+='<i class="top-radiobutton-icon"></i>'}else{shadowLabel.classList.remove("right");shadowLabel.classList.add("left");shadowLabel.innerHTML='<i class="top-radiobutton-icon"></i>'+shadowLabel.innerHTML}if(this.layoutWidth=="auto"||this.layoutWidth==""||this.layoutWidth=="wrap_content"){if(!this.paddingRight)shadowLabel.style.paddingRight=shadowLabel.querySelector("span").offsetWidth/5+"px"}},__detachBindingEvent:function(){var shadowLabel=this.querySelector("label");shadowLabel.removeEventListener("click",this.__clickListener)},__initBindingEvent:function(){var _this=this;var shadowLabel=this.querySelector("label");if(this.__clickListener===undefined){this.__clickListener=function(e){_this.toggle()}}shadowLabel.removeEventListener("click",this.__clickListener);shadowLabel.addEventListener("click",this.__clickListener)},toggle:function(){if(this.__isCheckedTrue()){this.checked=this.falseValue}else{this.checked=this.trueValue}this.__updateChecked()},focus:function(){this.querySelector(".top-checkbox-text").classList.add("focus");this.querySelector(".top-radiobutton-check").focus()},blur:function(){this.querySelector(".top-checkbox-text").classList.remove("focus");this.querySelector(".top-radiobutton-check").blur()},__updateTabIndex:function(){this.querySelector("input").setAttribute("tabindex",this.tabIndex)},__detached:function(){var bfgroupId=this.getAttribute("group-id");if(Top.Widget.RadioGroup[bfgroupId]&&Top.Widget.RadioGroup[bfgroupId].indexOf(this)>=0){Top.Widget.RadioGroup[bfgroupId].splice(Top.Widget.RadioGroup[bfgroupId].indexOf(this),1)}},getTopStyle:function(){this.topstyle=this.querySelector(".top-radiobutton-text").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-radiobutton-text");if(value==="bold"||value==="italic"||value==="underline"){if(!styleNode.getElementsByTagName("span")[0])this.__updateText();styleNode=styleNode.getElementsByTagName("span")[0]}styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-radiobutton-text").style.cssText=this.topstyle}};Top.Widget.RadioGroup={};Top.Widget.Radiobutton=function(){Radiobutton.prototype=Object.create(Top.Widget.prototype);Radiobutton.prototype.constructor=Radiobutton;function Radiobutton(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-radiobutton");this.template.innerHTML='<input class="top-radiobutton-check" type="radio"/><label class="top-radiobutton-text"><span></span></label>'}this.id=this.template.id}Radiobutton.create=function(element){return new Radiobutton(element)};Radiobutton.prototype.isChecked=function(){return this.template.isChecked()};Radiobutton.prototype.getWidth=function(){return this.template.querySelector(".top-radiobutton-text").offsetWidth};Radiobutton.prototype.getHeight=function(){return this.template.querySelector(".top-radiobutton-text").offsetHeight};Radiobutton.prototype.getChecked=function(){return this.template.isChecked()};Radiobutton.prototype.getCheckedButton=function(){var groupButtons=document.querySelectorAll('top-radiobutton[group-id="'+this.template.groupId+'"]');var checkedButton;for(var i=0;i<groupButtons.length;i++){if(groupButtons[i].isChecked()===true||groupButtons[i].isChecked()==="true"){checkedButton=groupButtons[i];break}}return Top.Dom.__selectImpl(checkedButton)};Radiobutton.prototype.trigger=function(event){var _event;if(typeof Event==="function"){_event=new Event(event)}else{_event=document.createEvent("Event");_event.initEvent(event,true,true)}if(event=="click")this.template.__clickListener(_event);else this.template.__dispatchEvent(_event)};Radiobutton.prototype.getState=function(){return this.template.checked};return Radiobutton}();TopScrolllayout={is:"top-scrolllayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{horizontalScroll:{type:String,value:true},verticalScroll:{type:String,value:true},horizontalScrollPosition:{type:Number,value:0},verticalScrollPosition:{type:Number,value:0}},__ready:function(){this.__updateId();this.initialChilds();this.renderLayout()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-scrolllayout-root">'+this.innerHTML+"</div>"},__eventBindingList:function(){var shadowDiv=this.querySelector(".top-scrolllayout-root");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__attached2:function(){this.adjustSize();var layoutRoot=this.childRoot;if(layoutRoot.style.paddingTop==="")layoutRoot.style.paddingTop=0;if(layoutRoot.style.paddingBottom==="")layoutRoot.style.paddingBottom=0;if(this.lineHeight===undefined){this.setTopStyle("line-height",layoutRoot.clientHeight-parseInt(layoutRoot.style.paddingTop)-parseInt(layoutRoot.style.paddingBottom)+"px")}},initialChilds:function(){this.childs=[];for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},initializeChildRoot:function(){return this.querySelector(".top-scrolllayout-root")},__setWrapperStyle:function(child){var vertical_align=child.getAttribute("layout-vertical-alignment")||"top";child.style.cssText="display:inline-block; line-height:normal; width:100%; height:100%; vertical-align:"+vertical_align+";"},renderLayout:function(){if(Top.Util.Browser.isIE()){var layoutRoot=this.childRoot;var horizontalPosition=0;var verticalPosition=0;for(var i=0;i<this.childRoot.children.length;i++){var child=this.childRoot.children[i];if(child.getAttribute("layout-horizontal-alignment")){this.removeTopStyle("text-align");this.setTopStyle("text-align",item.getAttribute("layout-horizontal-alignment"))}this.__setWrapperStyle(child)}this.horizontalScrollPosition*=.01;this.verticalScrollPosition*=.01;horizontalPosition=(layoutRoot.scrollWidth-layoutRoot.clientWidth)*this.horizontalScrollPosition;verticalPosition=(layoutRoot.scrollHeight-layoutRoot.clientHeight)*this.verticalScrollPosition;layoutRoot.scrollTop=verticalPosition;layoutRoot.scrollLeft=horizontalPosition}else{if(this.childRoot.children.length===0){return}var layoutRoot=this.childRoot;var horizontalPosition=0;var verticalPosition=0;for(var i=0;i<this.childRoot.children.length;i++){var child=this.childRoot.children[i];if(child.getAttribute("layout-horizontal-alignment")){this.removeTopStyle("text-align");this.setTopStyle("text-align",item.getAttribute("layout-horizontal-alignment"))}this.__setWrapperStyle(child)}this.horizontalScrollPosition*=.01;this.verticalScrollPosition*=.01;horizontalPosition=(layoutRoot.scrollWidth-layoutRoot.clientWidth)*this.horizontalScrollPosition;verticalPosition=(layoutRoot.scrollHeight-layoutRoot.clientHeight)*this.verticalScrollPosition;layoutRoot.scrollTop=verticalPosition;layoutRoot.scrollLeft=horizontalPosition}},__setWidgetSize:function(adjustment){if(this.childRoot.children.length<=0)return;var layoutRoot=this.childRoot;var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto";var pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var pPaddingWidth=layoutRoot.style.paddingRight||0+layoutRoot.style.paddingLeft||0;var pPaddingHeight=layoutRoot.style.paddingTop||0+layoutRoot.style.paddingBottom||0;var root=this.childRoot;for(var i=0;i<root.children.length;i++){var item=root.children[i];if(item.nodeName==="DIV")item=item.firstElementChild;if(adjustment&&typeof item.adjustSize==="function"){item.adjustSize()}if(item.layoutWidth==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{item.setThisWidgetWidth("100% - "+pPaddingWidth+"px")}}if(item.layoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{item.setThisWidgetHeight("100% - "+pPaddingHeight+"px")}}}},adjustSize:function(){if(this.adjusted===true){for(var i=0;i<this.childRoot.children.length;i++){if(typeof this.childRoot.children[i].adjustSize==="function")this.childRoot.children[i].adjustSize()}return}var isVisible=!!(this.childRoot.offsetWidth||this.childRoot.offsetHeight||this.childRoot.getClientRects().length);if(isVisible===true){this.adjusted=true;this.__setWidgetSize(true)}},addWidget:function(widget){widget.__isRendered=true;this.adjusted=false;this.childRoot.appendChild(widget.template);this.__setWidgetSize(widget.template)},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;this.adjusted=false;for(var i=0;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){this.clearDeepChilds(child);root.removeChild(child)}}},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.tagName==="DIV")item=item.firstElementChild;topElements[i]=Top.Dom.__selectImpl(item)}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},complete:function(){this.adjustSize()},getTopStyle:function(){this.topstyle=this.querySelector(".top-scrolllayout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector(".top-scrolllayout-root");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-scrolllayout-root").style.cssText=this.topstyle}};Top.Widget.Layout.Scrolllayout=function(){Scrolllayout.prototype=Object.create(Top.Widget.Layout.prototype);Scrolllayout.prototype.constructor=Scrolllayout;function Scrolllayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-scrolllayout");this.template.innerHTML='<div class="top-scrolllayout-root"></div>'}this.id=this.template.id}Scrolllayout.create=function(element){return new Scrolllayout(element)};return Scrolllayout}();TopSelectbox={is:"top-selectbox",behaviors:[TopWidgetBehavior,TopGroupBehavior,TopTextBehavior,TopContainerBehavior],properties:{title:String,nodes:{type:Object},selectedIndex:{type:String},selectedText:{type:String},selectedValue:{type:String},searchable:{type:String},focusTooltip:String,listLocation:String,listMaxHeight:String,value:String,autoWidth:Boolean,autoScroll:String,onChange:String,multiSelect:{type:Boolean,value:false},tabIndex:{type:String,value:"0"}},__ready:function(){this.optValue=[];this.__updateDisabled();if(this.focusTooltip)this.tooltip=this.tooltip||true;this.__updateBoundData("disabled");this.autoWidth=this.autoWidth==="true"||this.autoWidth===true;this.originTitle=this.__i18n(this.title);this.__updateId();this.initItems();this.initialLayout();this.initialChilds();this.renderSelectBox();this.__initBindingEvent();this.__updateTabIndex()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateFocusTooltip:function(){this.__updateTooltip()},__updateTooltip:function(){var thisPageId=Top.App.getCurrentPage().id;var _this=this;if(this.tooltip){var tooltip;if(typeof this.tooltip==="string"){tooltip=Top.Util.namespace(this.tooltip,this);if(typeof tooltip==="string"){this.tooltip=tooltip}}}if(this.focusTooltip)this.tooltip=this.tooltip||true;function setTooltipPosition(e){var x=e.clientX+window.pageXOffset+20,y=e.clientY+window.pageYOffset+20;var tooltipText=document.querySelector("#"+thisPageId+" .top-tooltip-text");var text="";if(Array.isArray(_this.tooltip)&&_this.tooltip.length){if(_this.hoverIndex>=0){text=_this.tooltip[_this.hoverIndex]}else if(_this.hoverIndex<0){text=_this.hoverText}}else{text=_this.focusTooltip?_this.hoverText:_this.tooltip}if(!text&&_this.focusTooltip){text=_this.selectedText}else if(!text){text=""}tooltipText.innerHTML=_this.__i18n(text);tooltipText.style.top=y+"px";tooltipText.style.left=x+"px";e.preventDefault()}this.__addEventFnByCore("eventMouseEnter",function(){window.addEventListener("mousemove",setTooltipPosition);document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="inline-block"});this.__addEventFnByCore("eventMouseExit",function(){document.querySelector("#"+thisPageId+" .top-tooltip-text").style.display="none";window.removeEventListener("mousemove",setTooltipPosition)})},appendTemplate:function(){this.innerHTML='<div class="top-selectbox-root">'+this.innerHTML+"</div>"},__eventBindingList:function(){var shadowDiv=this.querySelector(".top-selectbox-root");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__attached2:function(){this.__updateAutoWidth()},initializeChildRoot:function(){return this.querySelector(".top-selectbox-root")},initialChilds:function(){for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this}},attached:function(){if(this.getElementsByClassName("top-selectbox-container")[0]){this.attachEventHandler()}},__detached:function(){top$(document).off("click","#"+this.id+" .top-selectbox-options");top$(document).off("click","#"+this.id+" .top-selectbox-container");top$(this.childRoot).unbind("keydown")},__initEventInternal:function(){this.__addEventByAttr("change");this.__addEventByAttr("open");this.__addEventByAttr("close")},changeSelected:function(){if(typeof this.eventChanged==="string"){this.__eventChanged=Top.Util.namespace(this.eventChanged,this)}if(Top.App.__compatibleWithTOP()===true){if(typeof this.__eventChanged==="function"){this.__eventChanged(event,Top.Dom.selectById(this.id))}else if(typeof this.__eventChanged==="object"){fn.fn(event,Top.Dom.selectById(this.id))}}else if(typeof this.__eventChanged==="function"){var rowInfo={};rowInfo.index=this.dataIndex;this.dataObj[this.columnName]=this.selectedText;rowInfo.data=this.dataObj;this.__eventChanged(this.selectedText,rowInfo,this.value)}if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("change"))}else{this.__dispatchEvent(new Event("change"))}},renderSelectBox:function(){var root=this.childRoot;this.clearItems();var optText=[];var optValue=this.optValue;var optDisabled=[];var optSeperated=[];if(this.nodes){if(typeof this.nodes=="string"){this.nodes=Top.Util.namespace(this.nodes,this)}if(this.nodes===undefined){if(this.widgetItems.length===0&&typeof root.children==="object"){this.isCustomSelectBox=true}else{return}}if(typeof this.nodes[0]==="object"){for(var i=0;i<this.nodes.length;i++){optText[i]=this.nodes[i]["text"];optValue[i]=this.nodes[i]["value"]!==undefined?this.nodes[i]["value"]:optText[i];optDisabled[i]=this.nodes[i]["disabled"];optSeperated[i]=this.nodes[i]["seperated"]}}else if(!this.isCustomSelectBox){optText=this.nodes;optValue=optText}}else if(this.widgetItems){this.itemsList=[];if(this.items){this.clearLayout();if(typeof this.items==="string"){var items=Top.Util.namespace(this.items,this)}else if(typeof this.items==="object"){var items=this.items}if(!items)return;this.__nodes=items}else{for(var i=0;i<this.widgetItems.length;i++){if(this.widgetItems[i].getAttribute("text")!=null){optText[i]=this.widgetItems[i].getAttribute("text");optValue[i]=this.widgetItems[i].getAttribute("value")!=undefined&&this.widgetItems[i].getAttribute("value")!=null?this.widgetItems[i].getAttribute("value"):optText[i];optDisabled[i]=this.widgetItems[i].getAttribute("disabled");optSeperated[i]=this.widgetItems[i].getAttribute("seperated")}else{optText[i]=this.widgetItems[i].text;optValue[i]=this.widgetItems[i].value!==undefined&&this.widgetItems[i].value!==null?this.widgetItems[i].value:optText[i];optDisabled[i]=this.widgetItems[i].getAttribute("disabled");optSeperated[i]=this.widgetItems[i].getAttribute("seperated")}optText[i]=this.__i18n(optText[i])}this.itemsList=optText}}if(!this.isCustomSelectBox){if(!this.items)this.allValues=optValue;if(this.multiSelect===true||this.multiSelect==="true"){this.checkedItems=[];this.checkedItems.length=this.items?items.length:optText.length;this.checkedItems["number"]=0;this.checkedItems["all"]=false;this.checkedItems["texts"]=""}}var fragment=document.createDocumentFragment();var child=document.createElement("ul");child.className="top-selectbox-options";if(this.isCustomSelectBox)child.style.backgroundColor="#fbfbfb";fragment.appendChild(child);var selectBoxOp=child;if(selectBoxOp&&!this.isCustomSelectBox){if(this.multiSelect===true||this.multiSelect==="true"){child=document.createElement("li");child.className="top-selectbox-option all option_-1";var checkboxAll=Top.Widget.create("top-checkbox");checkboxAll.template.children[1].innerHTML="All";child.appendChild(checkboxAll.template);selectBoxOp.appendChild(child)}if(this.items){var layout=this.itemLayout;if(this.itemSwitchLogic)var switchedItem=this.getSwitchedItem()}for(var i=0;i<(this.items?items.length:optText.length);i++){child=document.createElement("li");child.className="top-selectbox-option option_"+i;if(!this.items)child.setAttribute("data-value",optValue[i]);if(this.multiSelect===false||this.multiSelect==="false"){if(this.items){child.innerHTML=this.itemSwitchLogic?switchedItem[i].outerHTML:layout}else{child.textContent=optText[i]}}else{var checkboxEach=Top.Widget.create("top-checkbox");if(this.items){checkboxEach.template.children[1].innerHTML=this.itemSwitchLogic?switchedItem[i].outerHTML:layout}else{checkboxEach.template.children[1].textContent=optText[i]}checkboxEach.template.givenIndex=i;child.appendChild(checkboxEach.template)}selectBoxOp.appendChild(child)}}child=document.createElement("span");child.className="top-selectbox-container top-selectbox_collapsed";var child_child=this.querySelector(".top-selectbox-icon");if(child_child===null){child_child=document.createElement("i");child.appendChild(child_child)}child_child.className="top-selectbox-icon icon-arrow_filled_down";if(this.isCustomSelectBox){child.appendChild(document.createTextNode(this.originTitle||this.text||""))}else{child.appendChild(document.createTextNode(""))}if(this.backgroundColor)child.style.backgroundColor=this.backgroundColor;fragment.appendChild(child);root.appendChild(fragment);if(!this.isCustomSelectBox){if(!this.items){this.__applyDataOfNonItems(optText,optValue,optDisabled,optSeperated)}else{this.__applyDataOfItems(items)}if(this.separatorVisible){if(this.separatorVisible===true||this.separatorVisible==="true"){var separatorSize=parseInt(this.separatorSize)||1.3;var separatorColor=this.separatorColor||"#f3f4f5";var separatorStyle="solid";var selectBoxOp_nt_nl=this.getElementsByClassName("top-selectbox-option");var l=selectBoxOp_nt_nl.length;while(l--){if(selectBoxOp_nt_nl[l].classList.contains("title")||l==selectBoxOp_nt_nl.length)continue;selectBoxOp_nt_nl[l].style.borderBottomStyle=separatorStyle;selectBoxOp_nt_nl[l].style.borderBottomColor=separatorColor;selectBoxOp_nt_nl[l].style.borderBottomWidth=separatorSize+"px"}}}if(!this.items)this.optValue=optValue}else{top$(selectBoxOp).append(this.childs);if(selectBoxOp.children.length>0){var children=selectBoxOp.children;for(var i=0,len=children.length;i<len;i++){if(children[i].localName!=="li"){children[i].layoutParent=this}}}}root.tabIndex="0";this.__setOptions();this.__updateTitle();if(this.items)Top.i18n.__onUpdate(this.id,"__updateItems")},attachEventHandler:function(){var _this=this;var selectContainer=this.getElementsByClassName("top-selectbox-container")[0];var selectOptions=this.getElementsByClassName("top-selectbox-options")[0];if(!selectContainer)return;top$(selectContainer).off("click").on("click",function(){if(_this.getAttribute("disabled")!==null)return;var options=this.previousSibling;var selectBoxIcon=this.getElementsByClassName("top-selectbox-icon")[0];if(selectBoxIcon){if(this.classList.contains("active")){options.style.display="none";selectBoxIcon.classList.remove("icon-arrow_filled_up");selectBoxIcon.classList.add("icon-arrow_filled_down");this.classList.remove("top-selectbox_open");this.classList.add("top-selectbox_collapsed");this.classList.remove("active");_this.hoverText="";_this.hoverIndex="";options.style.top="";options.style.left="";options.style.width="";options.style.right="";options.style.bottom="";if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("close"))}else{_this.__dispatchEvent(new Event("close"))}}else{var selectBoxCont_act=document.querySelectorAll(".top-selectbox-container.active");top$(selectBoxCont_act).click();options.style.display="block";var height=this.getBoundingClientRect().height;var offsetY=this.getBoundingClientRect().top;var pageHeight=document.body.clientHeight;var optionsHeight=options.offsetHeight;var listMaxHeight;if(_this.listLocation){if(_this.listLocation.startsWith("b")){options.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height-1+"px";if(_this.autoScroll===true||_this.autoScroll==="true"){listMaxHeight=pageHeight-(offsetY+height)-1+"px"}}else{options.style.bottom=window.innerHeight-this.getBoundingClientRect().bottom+this.offsetHeight-1+"px";if(_this.autoScroll===true||_this.autoScroll==="true"){listMaxHeight=offsetY-1+"px"}}if(_this.listLocation.endsWith("l")){options.style.left=this.getBoundingClientRect().left+"px"}else{var calcedRight=Math.abs(this.getBoundingClientRect().right-top$(document).width());options.style.right=calcedRight+"px"}}else{if(offsetY<pageHeight/2){options.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height-1+"px";options.style.left=this.getBoundingClientRect().left+"px";listMaxHeight=pageHeight-(offsetY+height)-1+"px"}else{options.style.bottom=window.innerHeight-this.getBoundingClientRect().bottom+this.offsetHeight-1+"px";options.style.left=this.getBoundingClientRect().left+"px";listMaxHeight=offsetY-1+"px"}options.style.left=this.getBoundingClientRect().left+"px";var calcedRight=options.getBoundingClientRect().right-document.body.clientWidth;if(calcedRight>0){calcedRight=Math.abs(this.getBoundingClientRect().right-document.body.clientWidth);options.style.left="";options.style.right=calcedRight+"px"}}if(_this.listMaxHeight||listMaxHeight){var styleMaxHeight=_this.listMaxHeight||listMaxHeight;_this.querySelector(".top-selectbox-options").style.maxHeight=styleMaxHeight}options.style.width=this.offsetWidth-2+"px";selectBoxIcon.classList.remove("icon-arrow_filled_down");selectBoxIcon.classList.add("icon-arrow_filled_up");this.classList.remove("top-selectbox_collapsed");this.classList.add("top-selectbox_open");this.classList.add("active");_this.__scrollToSelectedIndex();if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("open"))}else{_this.__dispatchEvent(new Event("open"))}}}});top$(this).find('.top-selectbox-option:not(".title,.disabled")').off("click").on("click",function(){if(_this.multiSelect===true||_this.multiSelect==="true"){if(!this.getAttribute("class").includes("all")){var checkedIndex=this.getAttribute("class").replace(/[^0-9]/gi,"");this.querySelector("input").checked=_this.checkedItems[checkedIndex]?false:true;if(this.querySelector("input").checked){_this.checkedItems[checkedIndex]=this.querySelector(".top-checkbox-text").innerText;_this.checkedItems["number"]++}else{delete _this.checkedItems[checkedIndex];_this.checkedItems["number"]--}if(_this.checkedItems.number===_this.checkedItems.length){_this.getElementsByClassName("top-checkbox-check")[0].checked=true;_this.checkedItems.all=true}else{_this.getElementsByClassName("top-checkbox-check")[0].checked=false;_this.checkedItems.all=false}}else{var i;this.querySelector("input").checked=_this.checkedItems.all?false:true;if(this.querySelector("input").checked){_this.checkedItems.all=true;for(i=0;i<_this.checkedItems.length;i++){_this.getElementsByClassName("top-checkbox-check")[i+1].checked=true;_this.checkedItems[i]=_this.getElementsByClassName("top-checkbox-text")[i+1].innerText;_this.checkedItems.number=_this.checkedItems.length}}else{_this.checkedItems.all=false;for(i=0;i<_this.checkedItems.length;i++){_this.getElementsByClassName("top-checkbox-check")[i+1].checked=false;delete _this.checkedItems[i];_this.checkedItems.number=0}}}_this.checkedItems.texts="";_this.checkedItems.forEach(function(value){_this.checkedItems.texts+=value+","});var checkedTexts=_this.checkedItems.texts?_this.checkedItems.texts.slice(0,-1):_this.title?_this.title:""}var selectedText=this.innerText?this.innerText:this.getAttribute("text");selectedText=_this.checkedItems?checkedTexts:selectedText;var containerElement=this.parentNode.nextSibling;if(!containerElement.childNodes[1]){containerElement.innerHTML+=selectedText}else{containerElement.childNodes[1].nodeValue=selectedText}_this.selectedText=selectedText;_this.updateData("selectedText");var index=this.classList[1].split("_");_this.selectedIndex=parseInt(index[1]);_this.value=_this.optValue[_this.selectedIndex]!==undefined&&_this.optValue[_this.selectedIndex]!==null?_this.optValue[_this.selectedIndex]:this.getAttribute("data-value");_this.updateData("selectedIndex");_this.updateData("value");var siblingArray=this.parentNode.children;for(var i=0;i<siblingArray.length;i++){siblingArray[i].classList.remove("active")}if(_this.multiSelect===false||_this.multiSelect==="false")this.classList.add("active");var selectBoxOp=_this.getElementsByClassName("top-selectbox_open")[0];if(_this.multiSelect===false||_this.multiSelect==="false"){if(selectBoxOp)top$(selectBoxOp).click()}_this.changeSelected()});top$(this.querySelectorAll(".top-selectbox-option")).add(selectContainer).off("mouseenter").on("mouseenter",function(){var selectedText,hoverIndex;var tmpHoverIndex=this.getAttribute("class").split("option_")[1];if(this===selectContainer){selectedText=_this.title?_this.title:this.innerText===""?"undefined":this.innerText}else{selectedText=this.innerText?this.innerText:this.getAttribute("text")}if(tmpHoverIndex){hoverIndex=tmpHoverIndex.split(" ")[0]}else if(!tmpHoverIndex||this===selectContainer){hoverIndex=-1}_this.hoverIndex=hoverIndex;_this.hoverText=selectedText;_this.updateData("hoverText");_this.updateData("hoverIndex")});top$(selectContainer).add(selectOptions).on("click",function(e){e.stopPropagation()});var no_data_li=document.createElement("li");no_data_li.classList.add("top-selectbox-option");no_data_li.style.borderBottom="1.3px solid rgb(243, 244, 245)";no_data_li.innerText="검색 결과가 없습니다";top$(selectContainer).off("keypress").on("keypress",function(e){e.stopPropagation()});if(this.searchable==="true"||this.searchable===true){top$(selectContainer).off("dblclick").on("dblclick",handlerForDblclick)}function handlerForDblclick(){var inp=document.createElement("input");inp.addEventListener("keydown",handleKeydown);inp.oninput=handleInput;inp.onclick=handleClick;inp.addEventListener("focus",handleFocus);inp.addEventListener("focusout",handleFocusOut);if(this.childNodes[1]&&this.childNodes[1].nodeName==="#text"){var text=this.childNodes[1].nodeValue||"";inp.setAttribute("value",text);this.replaceChild(inp,this.childNodes[1]);if(text)handleInput()}inp.focus();function handleFocusOut(e){for(var i=0;i<selectOptions.children.length;i++){(function(j){setTimeout(function(){var option=selectOptions.children[j];if(option.classList.contains("title"))return;selectOptions.children[j].style.display="block"},100)})(i)}selectContainer.replaceChild(document.createTextNode(_this.selectedText||""),selectContainer.childNodes[1]);if(selectOptions.contains(no_data_li))selectOptions.removeChild(no_data_li)}function handleFocus(e){if(selectContainer.classList.contains("top-selectbox_collapsed"))_this.open()}function handleClick(e){e.stopPropagation()}function handleInput(e){_this.search_result=[];var no_data=true;for(var i=0;i<_this.items.length;i++){var target_li=selectOptions.children[i+!!_this.title+Top.Util.__isBooleanTrue(_this.multiSelect)];
if(_this.items[i].name.includes(inp.value)){_this.search_result.push(i);target_li.style.display="";no_data=false}else{target_li.style.display="none"}}if(Top.Util.__isBooleanTrue(_this.multiSelect)&&inp.value)selectOptions.querySelector(".top-selectbox-option.all").style.display="none";else if(Top.Util.__isBooleanTrue(_this.multiSelect)&&inp.value==="")selectOptions.querySelector(".top-selectbox-option.all").style.display="block";if(!no_data&&selectOptions.contains(no_data_li))selectOptions.removeChild(no_data_li);if(no_data&&!selectOptions.contains(no_data_li))selectOptions.appendChild(no_data_li);if(selectContainer.classList.contains("top-selectbox_collapsed"))_this.open()}function handleKeydown(e){if(e.keyCode===27||e.keyCode===13){inp.blur()}else if(e.keyCode===40){if(_this.search_result.indexOf(_this.selectedIndex)>-1){var idx=_this.search_result.indexOf(_this.selectedIndex);_this.select(_this.search_result[idx+1])}else{_this.select(_this.search_result[0])}e.stopPropagation()}else if(e.keyCode===38){if(_this.search_result.indexOf(_this.selectedIndex)>0){var idx=_this.search_result.indexOf(_this.selectedIndex);_this.select(_this.search_result[idx-1])}e.stopPropagation()}}}},__scrollToSelectedIndex:function(){var options=this.querySelector(".top-selectbox-options");var option=this.querySelector(".option_"+this.selectedIndex);if(option!==null){options.scrollTop=option.offsetTop}},__applyDataOfNonItems:function(optText,optValue,optDisabled,optSeperated){for(var i=0;i<(this.items?items.length:optText.length);i++){var child=this.getElementsByClassName("option_"+i)[0];if(optDisabled[i]===true||optDisabled[i]==="true"){child.classList.add("disabled")}if(optSeperated[i]===true||optSeperated[i]==="true"){child.classList.add("seperated")}if(this.selectedText&&this.selectedText===optText[i]){child.classList.add("active");this.selectedIndex=i;this.value=optValue[i];this.__updateBoundData("selectedIndex");this.__updateBoundData("value")}else if(this.value&&this.value===optValue[i]){child.classList.add("active");this.selectedIndex=i;this.selectedText=optText[i];this.__updateBoundData("selectedIndex");this.__updateBoundData("selectedText")}else if(this.selectedIndex&&parseInt(this.selectedIndex)===i){this.selectedText=optText[i];this.value=optValue[i];child.classList.add("active");this.__updateBoundData("selectedText");this.__updateBoundData("value")}}child=this.getElementsByClassName("top-selectbox-container")[0];if(this.selectedText){child.childNodes[1].nodeValue=this.selectedText}else if(this.value){child.childNodes[1].nodeValue=this.value}else if(this.selectedIndex){var selected=this.getElementsByClassName("option_"+this.selectedIndex)[0];if(selected)var selectedIndexingText=selected.innerText;if(selectedIndexingText)child.childNodes[1].nodeValue=selectedIndexingText}else if(this.originTitle){child.childNodes[1].nodeValue=this.originTitle}else{child.childNodes[1].nodeValue=""}},__applyDataOfItems:function(items){var topWidget=/^TOP-[a-zA-Z]*/;var _this=this;for(var i=0;i<items.length;i++){if(typeof items[i]==="object"){var keys=Object.keys(items[i]);var listChildren=this.querySelectorAll(".option_"+i+" *");var topWidgets=[];for(var k=0;k<listChildren.length;k++)if(topWidget.test(listChildren[k].tagName))topWidgets.push(listChildren[k]);topWidgets.forEach(function(topWidget){for(var j=0;j<keys.length;j++){var attr=topWidget.attributes;for(var l=0;l<attr.length;l++){if(attr[l].value==="{"+keys[j]+"}"){topWidget.setAttribute(attr[l].name,items[i][keys[j]]);if(attr[l].name==="value"){_this.optValue[i]=items[i][keys[j]]}if(topWidget.tagName!=="TOP-WIDGETITEM")topWidget.__updateProperties(attr[l].name)}}}topWidget.id=topWidget.id+"_"+i;if(topWidget.tagName==="TOP-RADIOBUTTON"){if(topWidget.getAttribute("group-id")){topWidget.setAttribute("group-id",topWidget.getAttribute("group-id")+"_"+i)}}})}}var listElement=this.getElementsByClassName("top-selectbox-option");var nodes=[];var startIndex=this.multiSelect===true||this.multiSelect==="true"?1:0;for(var i=startIndex;i<listElement.length;i++){if(listElement[i].getElementsByTagName("top-widgetitem")[0].getAttribute("data-value")){listElement[i].setAttribute("value",listElement[i].getElementsByTagName("top-widgetitem")[0].getAttribute("data-value"))}if(listElement[i].getElementsByTagName("top-widgetitem")[0].getAttribute("value")){listElement[i].setAttribute("value",listElement[i].getElementsByTagName("top-widgetitem")[0].getAttribute("value"))}var itemText=listElement[i].getElementsByTagName("top-widgetitem")[0].getAttribute("text");if(itemText){itemText=this.__i18n(itemText);nodes.push(itemText);listElement[i].setAttribute("text",itemText)}if(listElement[i].getElementsByTagName("top-widgetitem")[0].getAttribute("tooltip")){var tooltip=listElement[i].getElementsByTagName("top-widgetitem")[0].getAttribute("tooltip");listElement[i].setAttribute("tooltip",tooltip);if(i===startIndex){var tooltipSet=[]}tooltipSet.push(tooltip)}var isDisabled=listElement[i].getElementsByTagName("top-widgetitem")[0].getAttribute("disabled");if(isDisabled===true||isDisabled==="true"){listElement[i].classList.add("disabled")}if(this.multiSelect===false||this.multiSelect==="false"){if(listElement[i].children[0].childElementCount===0){var text=listElement[i].children[0].getAttribute("text");listElement[i].innerText=this.__i18n(text)}}else{var text=listElement[i].getElementsByTagName("top-widgetitem")[0].getAttribute("text");listElement[i].getElementsByClassName("top-checkbox-text")[0].innerText=this.__i18n(text)}}if(tooltipSet){this.tooltip=tooltipSet;this.__updateTooltip()}this.itemsList=nodes;if(this.selectedIndex){var selectBoxOp_i=this.getElementsByClassName("option_"+this.selectedIndex)[0];if(selectBoxOp_i){var selectedText=selectBoxOp_i.getAttribute("text");var selectBoxCont=this.getElementsByClassName("top-selectbox-container")[0];if(selectBoxCont){selectBoxCont.childNodes[1].nodeValue=selectedText;selectBoxOp_i.classList.add("active");this.selectedText=selectedText;this.value=this.optValue[i]!==undefined&&this.optValue[i]!==null?this.optValue[i]:selectedText;this.__updateBoundData("selectedText");this.__updateBoundData("value")}}}},__setOptions:function(){var _this=this;this.attachEventHandler();this.__updateAutoWidth()},select:function(value){if(typeof value==="number"){if(Top.Util.__isBooleanTrue(this.multiSelect)&&value>=-1&&value<(this.items||this.allValues).length){this.querySelector(".top-selectbox-option.option_"+value).click()}else{this.selectedIndex=value;this.__updateSelectedIndex();this.updateData("selectedIndex")}}else{var selectedOption=this.querySelector('.top-selectbox-option[data-value="'+value+'"]')||this.querySelector('.top-selectbox-option[value="'+value+'"]');if(selectedOption){top$(selectedOption).click()}else{this.selectedText=value;this.__updateSelectedText();this.updateData("selectedText")}}},selectByIndex:function(index){this.select(this.allValues[index])},close:function(){var selectBoxOp=this.getElementsByClassName("top-selectbox_open");top$(selectBoxOp).click()},open:function(){var selectBox=this.getElementsByClassName("top-selectbox-container");top$(selectBox).click()},__initBindingEvent:function(){var _this=this;var root=this.childRoot;var containerElement=this.getElementsByClassName("top-selectbox-container")[0];var selectOptions=this.getElementsByClassName("top-selectbox-options")[0];top$(root).bind("keydown",function(e){var len=_this.allValues?_this.allValues.length:_this.itemsList.length;var startIndex=_this.multiSelect===true||_this.multiSelect==="true"?-1:0;if(_this.getAttribute("disabled")!==null){e.preventDefault();return}if(e.keyCode===39||e.keyCode===40){if(_this.selectedIndex===undefined||isNaN(_this.selectedIndex)){_this.select(startIndex)}else if(_this.selectedIndex>=startIndex&&_this.selectedIndex<len-1){_this.select(_this.selectedIndex+1)}e.preventDefault()}else if(e.keyCode===37||e.keyCode===38){if(_this.selectedIndex>startIndex&&_this.selectedIndex<len){_this.select(_this.selectedIndex-1)}e.preventDefault()}else if(e.keyCode===27){_this.close()}else if(e.keyCode===13){var inTable=_this.getParent().tagName==="TOP-TABLEVIEW";var isClosed=containerElement.classList.contains("top-selectbox_collapsed");if(inTable&&isClosed)return;else if(inTable&&!isClosed)_this.close();else if(!inTable&&isClosed)_this.open();else if(!inTable&&!isClosed)_this.close();var activeItem=selectOptions.getElementsByClassName("active");if((_this.multiSelect===true||_this.multiSelect==="true")&&activeItem.length!==0){activeItem[0].classList.remove("active");containerElement.childNodes[1].data=_this.checkedItems.texts?_this.checkedItems.texts:_this.title}e.preventDefault()}else if(e.keyCode===32){e.preventDefault();var activeItem=selectOptions.getElementsByClassName("active");if(activeItem.length!==0)top$(activeItem).click();e.preventDefault()}});top$(root).bind("keypress",function(e){if(containerElement.classList.contains("top-selectbox_collapsed"))_this.open();if(!_this.virtualInput||_this.virtualInput.length>=2)_this.virtualInput="";var option_list=_this.itemsList?_this.itemsList:_this.nodes;var key=e.key;_this.virtualInput+=key;for(var i=0;i<option_list.length;i++){var item=option_list[i].text||option_list[i];if(item.toLowerCase().startsWith(_this.virtualInput))break}if(i===option_list.length)i=_this.selectedIndex;_this.select(i);setTimeout(function(){_this.virtualInput=undefined},200)})},__updateNodes:function(){if(this.__isAttached){this.renderSelectBox()}else{var _this=this;Top.App.onWidgetAttach(function(){_this.renderSelectBox()})}},__updateItems:function(){this.selectedText=undefined;this.selectedIndex=undefined;this.renderSelectBox()},__updateValue:function(){var selectBoxOp=this.getElementsByClassName("top-selectbox-option");var l=selectBoxOp.length;while(l--){selectBoxOp[l].classList.remove("active")}var selectedItem=this.querySelector('.top-selectbox-option[data-value="'+this.value+'"]')||this.querySelector('.top-selectbox-option[value="'+this.value+'"]');if(selectedItem)selectedItem.classList.add("active");if(!selectedItem)return;if(selectedItem.textContent!==this.selectedText){this.selectedText=selectedItem.textContent;this.updateData("selectedText")}var index=selectedItem.classList[1].split("_");if(this.selectedIndex!==parseInt(index[1])){this.selectedIndex=parseInt(index[1]);this.updateData("selectedIndex")}var selectBoxCont=this.getElementsByClassName("top-selectbox-container")[0];if(selectBoxCont)selectBoxCont.childNodes[1].nodeValue=this.selectedText},__updateSelectedText:function(){var listArray=this.getElementsByClassName("top-selectbox-option");var containerElement=this.getElementsByClassName("top-selectbox-container")[0];if(!containerElement)return;var selectBoxOp=this.getElementsByClassName("top-selectbox-option");var l=selectBoxOp.length;while(l--){selectBoxOp[l].classList.remove("active")}var selectedItems=[];for(var i=0;i<listArray.length;i++){if(listArray[i].textContent===this.selectedText){listArray[i].classList.add("active");selectedItems.push(listArray[i])}}if(selectedItems.length===0){this.value=this.selectedText;this.selectedIndex=undefined;var title=typeof this.originTitle==="string"?this.originTitle:this.selectedText;if(containerElement.childNodes[1])containerElement.childNodes[1].nodeValue=title}else if(selectedItems.length===1){var index=selectedItems[0].classList[1].split("_");if(this.selectedIndex!==parseInt(index[1])){this.selectedIndex=parseInt(index[1]);this.updateData("selectedIndex")}if(this.optValue[this.selectedIndex]!==this.value){this.value=this.optValue[this.selectedIndex];this.updateData("value")}}else if(selectedItems.length>1){}if(selectedItems.length>0&&this.selectedText!==undefined&&this.selectedText!==null)containerElement.childNodes[1].nodeValue=this.selectedText},__updateSelectedIndex:function(){var selectBoxOp=this.getElementsByClassName("top-selectbox-option");var l=selectBoxOp.length;while(l--){selectBoxOp[l].classList.remove("active")}var selectedItem=this.getElementsByClassName("option_"+this.selectedIndex)[0];if(selectedItem!==undefined)selectedItem.classList.add("active");if(this.optValue[this.selectedIndex]!==this.value){this.value=this.optValue[this.selectedIndex];this.updateData("value")}if(selectedItem&&selectedItem.textContent!==this.selectedText){this.selectedText=selectedItem.textContent;this.updateData("selectedText")}if(this.selectedText){var selectBoxCont=this.getElementsByClassName("top-selectbox-container")[0];if(selectBoxCont)selectBoxCont.childNodes[1].nodeValue=this.selectedText}},__updateSelectedValue:function(){this.value=this.selectedValue;this.__updateValue()},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();if((disabled==="true"||disabled===true)&&(disabled!=="false"||disabled!==false)){this.close();this.setAttribute("disabled","true")}else{this.removeAttribute("disabled")}},__updateTitle:function(){this.originTitle=this.__i18n(this.title);var options=this.querySelector(".top-selectbox-options");if(!this.originTitle){if(this.childRoot.querySelector(".top-selectbox-options").querySelector(".title")){this.childRoot.querySelector(".top-selectbox-options").querySelector(".title").remove()}return}if(!options.querySelector(".title")){top$(options).prepend("<li class='top-selectbox-option title'>"+this.originTitle+"</li>")}if(!this.selectedText&&!this.selectedIndex){var item=this.getElementsByClassName("top-selectbox-container")[0];if(item){item.replaceChild(document.createTextNode(this.originTitle),item.lastChild)}}var titleElement=this.getElementsByClassName("title")[0];if(titleElement)titleElement.innerText=this.originTitle;if(this.getAttribute("title")){this.setAttribute("title","")}},focus:function(){this.childRoot.focus()},blur:function(){this.childRoot.blur()},__updateOnChange:function(){this.__addEventByAttr("change")},__updateAutoWidth:function(){if(this.multiSelect=="true"||this.multiSelect==true)return;var selectContainer=this.getElementsByClassName("top-selectbox-container")[0];var selectOptions=this.getElementsByClassName("top-selectbox-options")[0];var optionWidth;this.autoWidth=this.autoWidth==="true"||this.autoWidth===true;if(selectContainer){if(this.autoWidth){if(!selectOptions)return;selectOptions.style.display="block";optionWidth=selectOptions.offsetWidth;selectOptions.style.display="none";var iconWidth=this.querySelector(".top-selectbox-icon").offsetWidth;if(optionWidth>selectContainer.offsetWidth){selectContainer.style.width=optionWidth+iconWidth+"px"}}else{optionWidth=this.layoutWidth||"";if(optionWidth.indexOf("%")===-1){selectContainer.style.width=optionWidth}}}},getTopStyle:function(){this.topstyle=this.querySelector(".top-selectbox-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(!value)return;var styleNode=this.querySelector(".top-selectbox-root");if(key==="background-color"){return}else{styleNode.style[key]=value;this.topstyle=styleNode.style.cssText}},setAllTopStyle:function(){this.querySelector(".top-selectbox-root").style.cssText=this.topstyle},__updateTabIndex:function(){this.querySelector(".top-selectbox-root").tabIndex=this.tabIndex}};Top.Widget.Group.Selectbox=function(){Selectbox.prototype=Object.create(Top.Widget.Group.prototype);Selectbox.prototype.constructor=Selectbox;function Selectbox(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-selectbox");this.template.innerHTML='<div class="top-selectbox-root"></div>'}this.id=this.template.id}Selectbox.create=function(element){return new Selectbox(element)};Selectbox.prototype.select=function(value){this.template.select(value)};Selectbox.prototype.getCheckedItems=function(){var texts=[];var indexes=[];this.template.checkedItems.forEach(function(text,index){texts.push(text);indexes.push(index)});return{texts:texts,indexes:indexes}};Selectbox.prototype.getSelected=function(){if(this.template.nodes){return this.template.nodes[this.template.selectedIndex]}else if(this.template.__nodes){return this.template.__nodes[this.template.selectedIndex]}};Selectbox.prototype.getSelectedText=function(){return this.template.selectedText};Selectbox.prototype.getTitle=function(){return this.template.originTitle};Selectbox.prototype.getValue=function(){return this.template.value};Selectbox.prototype.close=function(){this.template.close()};Selectbox.prototype.open=function(){this.template.open()};Selectbox.prototype.getClickedIndex=function(){return this.template.selectedIndex};return Selectbox}();TopSidemenu={is:"top-sidemenu",behaviors:[TopWidgetBehavior,TopMenuBehavior],properties:{items:String,type:{type:Object,reflectToAttribute:true},layoutTop:String,selectedNode:Object},__updateItems:function(){if(typeof this.items==="string"){this.items=Top.Util.namespace(this.items)}},renderLayout:function(){this.__initialize();this.initMenu()},initializeChildRoot:function(){return this.querySelector("div")},initMenu:function(){var sideMenu=this;this.selectedList=[];top$("#wrapper").toggleClass("toggled-2");top$("#menu ul").hide();top$("#menu ul").children(".current").parent().show();top$("#menu li a").click(function(){var icon=top$(this).find(".children");if(top$(icon).hasClass("icon-arrow_down color_b")){top$(icon).removeClass("icon-arrow_down color_b");top$(icon).addClass("icon-arrow_right")}else{top$(icon).removeClass("icon-arrow_right");top$(icon).addClass("icon-arrow_down color_b children")}var checkElement=top$(this).next();if(checkElement.is("ul")){var selected=top$("ul.selected");var len=selected.length;for(var i=0;i<len;i++){if(selected[i]!=this&&selected[i]!=this.parentNode.parentNode){var icon=top$(selected[i].parentNode).find(".children");icon.removeClass("icon-arrow_down color_b");icon.addClass("icon-arrow_right");top$(selected[i]).slideUp();top$(selected[i]).removeClass("selected")}}if(checkElement.is(":visible")){checkElement.slideUp()}else{top$(checkElement).addClass("selected");checkElement.slideDown()}return false}else{top$(sideMenu.querySelector(".active")).removeClass("active");top$(this).addClass("active");sideMenu.selectedNode=this.parentNode}});if(this.layoutTop){top$("#sidebar-wrapper").css("height","calc(100% - "+this.layoutTop+")")}top$("#sidebar-wrapper").mouseleave(function(event){top$(this).css("width","50px");top$("#menu .children").attr("class","icon-arrow_right children");top$("#menu ul:visible").slideUp()});top$("#sidebar-wrapper").mouseenter(function(event){var width=sideMenu.getMaxWidth();top$(this).css("width",width);top$(this.querySelector(".sidebar-nav")).css("width",width);sideMenu.open(sideMenu.selectedNode)})},__ready:function(){this.__updateItems();this.__initialize();this.initMenu()},makeMenu:function(items){var str="";var len=items.length;for(var i=0;i<len;i++){if(items[i].children){if(items[i].hasOwnProperty("icon")){str+="<li><a href='javascript:Top.Util.namespace(\""+items[i].selected+"\")()'><span class='fa-stack fa-lg pull-left'><i class='"+items[i].icon+"'></i></span>"+items[i].text+"</a>"}else{items[i].icon="icon-arrow_right";str+="<li><a href='javascript:Top.Util.namespace(\""+items[i].selected+"\")()'><span class='fa-stack fa-lg pull-left'><i class='"+items[i].icon+" children'></i></span>"+items[i].text+"</a>"}str+="<ul class='nav-pills nav-stacked' style='list-style-type:none;'>";str+=this.makeMenu(items[i].children);str+="</ul></li>"}else{if(!items[i].hasOwnProperty("icon"))items[i].icon="";str+="<li><a href='javascript:Top.Util.namespace(\""+items[i].selected+"\")()'><span class='fa-stack fa-lg pull-left'><i class='"+items[i].icon+"'></i></span>"+items[i].text+"</a></li>"}}return str},__initialize:function(){if(top$(this).children().length!=0){this.clearMenuItems()}var str="<div id='wrapper'><div id='sidebar-wrapper'><ul class='sidebar-nav nav-pills nav-stacked' id='menu'>";str+=this.makeMenu(this.items);str+="</ul></div></div>";top$(this).html(str)},getMaxWidth:function(){var nodes=this.getElementsByTagName("li");var len=nodes.length;var maxText="";var temp="";for(var i=0;i<len;i++){temp=top$(nodes[i]).children("a").text();if(temp.length>maxText.length){maxText=temp}}String.prototype.width=function(){var f="13px arial",o=top$("<div>"+this+"</div>").css({position:"absolute",float:"left","white-space":"nowrap",visibility:"hidden",font:f}).appendTo(top$("body")),w=o.width();o.remove();return w};return maxText.width()+110},open:function(selectedNode){if(selectedNode){top$(selectedNode.parentNode).slideDown();top$(selectedNode.parentNode.parentNode.parentNode).slideDown();top$(selectedNode.parentNode.parentNode).find(".children").addClass("icon-arrow_down color_b");top$(selectedNode.parentNode.parentNode).find(".children").removeClass("icon-arrow_right")}},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector("div").style[key]=value;this.topstyle=this.querySelector("div").style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle}};TopSlider={is:"top-slider",behaviors:[TopWidgetBehavior,TopRangeBehavior],properties:{orientation:{type:String,value:"horizontal"},direction:String,onHandlechange:String,onHandledragstart:String,onHandledragend:String},__ready:function(){this.__updateId();this.__updateDisabled();this.min=parseInt(this.min);this.max=parseInt(this.max);this.isRendered=false},appendTemplate:function(){this.innerHTML='<div class="top-slider-root"></div>'},__eventBindingList:function(){var shadowInput=this.querySelector(".top-slider-root");return{__eventMouseClick:function(func){shadowInput.onclick=func},__eventMousePressed:function(func){shadowInput.onmousedown=func},__eventMouseReleased:function(func){shadowInput.onmouseup=func},__eventMouseDblclick:function(func){shadowInput.ondblclick=func},__eventKeyPressed:function(func){shadowInput.onkeydown=func},__eventKeyTyped:function(func){shadowInput.onkeypress=func},__eventKeyReleased:function(func){shadowInput.onkeyup=func},__eventMouseEnter:function(func){shadowInput.onmouseenter=func},__eventMouseExit:function(func){shadowInput.onmouseleave=func},__eventMouseMove:function(func){shadowInput.onmousemove=func},__eventFocused:function(func){shadowInput.onfocus=func},__eventLostFocused:function(func){shadowInput.onblur=func},__eventSecondaryClick:function(func){shadowInput.oncontextmenu=func}}},__attached2:function(){this.__initialize()},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-slider-root");shadowRoot.id=this.id}},__updateDisabled:function(newValue){var shadowRoot=this.querySelector(".top-slider-root");this.__setDisabled(shadowRoot)},__initialize:function(){if(this.orientation==="horizontal"){if(!this.direction)this.direction="ltr"}else if(this.orientation==="vertical"){if(!this.direction)this.direction="btt"}this.renderSlider()},renderSlider:function(){var shadowRoot=this.querySelector(".top-slider-root");var direction=this.direction;switch(direction){case"btt":{direction="rtl";break}case"ttb":{direction="ltr";break}}var connect=true;if(!(this.number instanceof Array)){connect=[true,false]}if(typeof this.number!=="string"&&!(this.number instanceof Array)){this.number=this.getAttribute("number")}if(typeof this.number==="string"&&this.number.endsWith("%")){this.number=this.max*parseInt(this.number.replace("%",""))*.01}this.slider=noUiSlider.create(shadowRoot,{start:this.number,step:parseInt(this.step),connect:connect,range:{min:this.min,max:this.max},orientation:this.orientation,direction:direction});this.attachEventHandler();this.isRendered=true},attachEventHandler:function(){this.slider.off();var _this=this;var shadowRoot=this.querySelector(".top-slider-root");var shadowFill=this.querySelector(".top-slider-fill");var shadowBase=this.querySelector(".top-slider-base");if(this.onHandlechange&&typeof this.onHandlechange==="string")var fnHandlechange=Top.Util.namespace(this.onHandlechange,this);if(this.onHandledragend&&typeof this.onHandledragend==="string")var fnHandleDragend=Top.Util.namespace(this.onHandledragend,this);if(this.onHandledragstart&&typeof this.onHandledragstart==="string")var fnHandleDragstart=Top.Util.namespace(this.onHandledragstart,this);this.slider.on("update",function(){var value=this.get();_this.value=value;_this.number=value;_this.updateData("number");_this.updateData("value")});this.slider.on("slide",function(value){if(typeof fnHandlechange==="function"){fnHandlechange(event,Top.Dom.selectById(_this.id),value)}});this.slider.on("start",function(value){shadowBase.classList.add("active");if(typeof fnHandleDragstart==="function"){fnHandleDragstart(event,Top.Dom.selectById(_this.id),value)}});this.slider.on("end",function(value){shadowBase.classList.remove("active");if(typeof fnHandleDragend==="function"){fnHandleDragend(event,Top.Dom.selectById(_this.id),value)}})},__updateNumber:function(){if(this.number<=this.max){this.number=Math.round(this.number/this.step)*this.step;this.value=this.number}if(this.number<this.min){this.number=Math.round(this.min/this.step)*this.step;this.value=this.number}if(typeof this.number==="string"){if(Top.Util.namespace(this.number,this))this.number=Top.Util.namespace(this.number,this);else if(this.number.startsWith("["))this.number=JSON.parse(this.number);else this.number=parseFloat(this.number)}if(this.isRendered){this.slider.set(this.number)}},__updateMin:function(){this.min=parseInt(this.min);this.slider.updateOptions({range:{min:this.min,max:this.max}})},__updateMax:function(){this.max=parseInt(this.max);this.slider.updateOptions({range:{min:this.min,max:this.max}})},__updateStep:function(){this.slider.updateOptions({step:parseInt(this.step)})},__updateOrientation:function(){this.slider.updateOptions({orientation:this.orientation});this.__updateDirection()},__updateDirection:function(){var direction=this.direction;switch(direction){case"btt":{direction="rtl";break}case"ttb":{direction="ltr";break}}this.slider.updateOptions({direction:direction})},getTopStyle:function(){this.topstyle=this.querySelector(".top-slider-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-slider-root").style[key]=value;this.topstyle=this.querySelector(".top-slider-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-slider-root").style.cssText=this.topstyle}};Top.Widget.Slider=function(){Slider.prototype=Object.create(Top.Widget.prototype);Slider.prototype.constructor=Slider;function Slider(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-slider");this.template.innerHTML='<div class="top-slider-root"></div>'}this.id=this.template.id}Slider.create=function(element){return new Slider(element)};return Slider}();TopSpinner={is:"top-spinner",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{type:{type:String,value:"number"},step:{type:Number,value:1},valueByType:String,number:{type:String,value:0},min:String,max:String,wrap:String,time:String,format:{type:String,value:"HH:mm"},onChange:String},__attached2:function(){this.__initialize();this.__updateId();this.__updateDisabled();this.__updateValueByType()},appendTemplate:function(){this.innerHTML='<div class="top-spinner-root"><input class="top-spinner-input" type="text"><i class="top-spinner-button up"></i><i class="top-spinner-button down"></i></div>'},__eventBindingList:function(){var shadowInput=this.querySelector(".top-spinner-root");return{__eventMouseClick:function(func){shadowInput.onclick=func},__eventMousePressed:function(func){shadowInput.onmousedown=func},__eventMouseReleased:function(func){shadowInput.onmouseup=func},__eventMouseDblclick:function(func){shadowInput.ondblclick=func},__eventKeyPressed:function(func){shadowInput.onkeydown=func},__eventKeyTyped:function(func){shadowInput.onkeypress=func},__eventKeyReleased:function(func){shadowInput.onkeyup=func},__eventMouseEnter:function(func){shadowInput.onmouseenter=func},__eventMouseExit:function(func){shadowInput.onmouseleave=func},__eventMouseMove:function(func){shadowInput.onmousemove=func},__eventFocused:function(func){shadowInput.onfocus=func},__eventLostFocused:function(func){shadowInput.onblur=func},__eventSecondaryClick:function(func){shadowInput.oncontextmenu=func}}},__updateId:function(){var shadowInput=this.querySelector("div input");if(this.id){shadowInput.id=this.id}},__updateValueByType:function(){var shadowInput=this.querySelector("div input");if(this.valueByType){shadowInput.setAttribute("value",this.valueByType)}},__initialize:function(){var shadowInput=this.querySelector("input");var _this=this;if(this.type=="number"){this.numberOfD=this.format.match(/d/gi)&&this.format.match(/d/gi).length||0;__calcNumber();shadowInput.setAttribute("step",this.step);shadowInput.setAttribute("title","");shadowInput.setAttribute("value",this.value);shadowInput.value=this.value}else if(this.type=="time"){var d=new Date;var hour,min,second,msec,period="";var isContainHour=/h/gi;var isContainPeriod=/(am)|(pm)/gi;if(isContainHour.test(this.format)){this.timeSystem=this.format.includes("h")?"12":"24"}if(this.time===undefined||this.time===null){hour=d.getHours().toString();min=d.getMinutes().toString();second=d.getSeconds().toString();msec=this.format.match(/S/g)?d.getMilliseconds().toString().substring(0,this.format.match(/S/g).length):d.getMilliseconds().toString();this.time=hour+min+second+msec}else{if(/[\s]*p*[\s]*/gi.test(this.time)){this.time=this.time.replace(/[\s]*p*[\s]*/,"")}shadowInput.value=this.time;var numberArray=this.time.match(/[0-9]/g);var timeFormat=this.format.replace(/[\s]*p[\s]*/,"");if(this.timeSystem==="12"){hour=this.time.substring(timeFormat.indexOf("h"),timeFormat.lastIndexOf("h")+1)}else{hour=this.time.substring(timeFormat.indexOf("H"),timeFormat.lastIndexOf("H")+1)}min=this.time.substring(timeFormat.indexOf("m"),timeFormat.lastIndexOf("m")+1);second=this.time.substring(timeFormat.indexOf("s"),timeFormat.lastIndexOf("s")+1);msec=this.time.substring(timeFormat.indexOf("S"),timeFormat.lastIndexOf("S")+1)}period=isContainPeriod.test(this.time)?""+this.time.match(isContainPeriod)[0]:hour>11?"PM":"AM";if(this.timeSystem==="12"&&hour>11){hour=Math.abs(12-parseInt(hour))}this.numberOfH=this.format.match(/h/gi)&&this.format.match(/h/gi).length||0;this.numberOfM=this.format.match(/m/gi)&&this.format.match(/m/gi).length||0;this.numberOfS=this.format.match(/s/g)&&this.format.match(/s/g).length||0;this.numberOfMS=this.format.match(/S/g)&&this.format.match(/S/g).length||0;hour=this.__leadingZeros(hour,this.numberOfH);min=this.__leadingZeros(min,this.numberOfM);second=this.__leadingZeros(second,this.numberOfS);msec=this.__leadingZeros(msec,this.numberOfMS);this.hour=hour;this.min=min;this.second=second;this.msec=msec;this.period=period;var newTimeValue=this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,hour);newTimeValue=newTimeValue.replace(/mm|m/gi,min);newTimeValue=newTimeValue.replace(/ss|s/g,second);newTimeValue=newTimeValue.replace(/SSS|SS|S/g,msec);newTimeValue=newTimeValue.replace(/p/,period);this.time=newTimeValue;this.valueByType=this.time;this.value=this.time;shadowInput.value=this.time;this.hourIndexRange=this.timeSystem=="12"?[this.format.indexOf("h"),this.format.lastIndexOf("h")]:[this.format.indexOf("H"),this.format.lastIndexOf("H")];this.minIndexRange=[this.format.indexOf("m"),this.format.lastIndexOf("m")];this.secondIndexRange=[this.format.indexOf("s"),this.format.lastIndexOf("s")];this.msecIndexRange=[this.format.indexOf("S"),this.format.lastIndexOf("S")];this.periodIndexRange=[this.format.indexOf("p"),this.format.indexOf("p")+1];this.order=this.format.split(/[^phms]/gi);var orderLength=this.order.length;var index=0;while(index<orderLength){var item=this.order[index];if(item.match(/hh|h/gi)){this.order[index]="hour"}else if(item.match(/mm|m/gi)){this.order[index]="min"}else if(item.match(/ss|s/g)){this.order[index]="second"}else if(item.match(/SSS|SS|S/g)){this.order[index]="msec";
}else if(item.match(/p/gi)){this.order[index]="period"}index++}var startsWithP=/^[\s]*p[\s]*/;if(startsWithP.test(this.format)){addArrayValue(this.hourIndexRange);addArrayValue(this.minIndexRange);addArrayValue(this.secondIndexRange);addArrayValue(this.msecIndexRange);function addArrayValue(array){if(array[0]===-1)return;array[0]++;array[1]++}}}function __calcNumber(){if(!_this.max||parseInt(_this.number)<=parseInt(_this.max)){_this.number=Math.round(_this.number/_this.step)*_this.step;_this.value=_this.__leadingZeros(_this.number,_this.numberOfD)}if(parseInt(_this.number)>parseInt(_this.max)){_this.number=Math.round(_this.max/_this.step)*_this.step;_this.value=_this.__leadingZeros(_this.number,_this.numberOfD)}if(parseInt(_this.number)<parseInt(_this.min)){_this.number=Math.round(_this.min/_this.step)*_this.step;_this.value=_this.__leadingZeros(_this.number,_this.numberOfD)}}},__leadingZeros:function(n,digits){var zero="";n=n.toString();if(n==""||isNaN(n))n="0";if(n.includes("-")){n=n.substring(1);zero+="-"}if(n.length<digits){var len=digits-n.length;while(len--){zero+="0"}}return zero+n},__attachEventHandler:function(){var _this=this;var shadowRoot=this.querySelector(".top-spinner-root");var shadowInput=this.querySelector("input");var shadowButtonUp=this.querySelector(".top-spinner-button.up:not([disabled])");var shadowButtonDown=this.querySelector(".top-spinner-button.down:not([disabled])");var intervals=[];var interval;if(this.type=="number"){top$(shadowInput).off("keydown").on("keydown",function(e){if(e.which===38){clickSpinBtn(e,"up");e.preventDefault()}else if(e.which===40){clickSpinBtn(e,"down");e.preventDefault()}if(e.which===69||e.which===110||e.which===190){return false}}).off("keyup").on("keyup",function(e){this.value=event.target.value.replace(/[\u3131-\uD79D]/g,"");_this.value=e.target.value===""?"0":e.target.value;if(parseInt(_this.value)<parseInt(_this.min))_this.value=_this.min;_this.number=_this.value;shadowInput.value=parseInt(_this.value);_this.updateData("number")}).off("focus").on("focus",function(e){shadowRoot.classList.add("active");top$(this).off("mousewheel").on("mousewheel",function(e){e.originalEvent.wheelDelta/120>0?clickSpinBtn(e,"up"):clickSpinBtn(e,"down");e.preventDefault()})}).off("blur").on("blur",function(){this.value=event.target.value.replace(/[\u3131-\uD79D]/g,"");_this.value=parseInt(_this.value)>parseInt(_this.max)?_this.max:_this.value;_this.value=parseInt(_this.value)<parseInt(_this.min)?_this.min:_this.value;_this.value=_this.__leadingZeros(_this.value,_this.numberOfD);if(this.type=="number"){_this.value=parseInt(_this.value).toString()}this.value=_this.value;_this.valueByType=_this.value;_this.number=this.value;_this.updateData("number");shadowRoot.classList.remove("active")}).off("input").on("input",function(){shadowRoot.classList.add("active")}).off("mouseup").on("mouseup",function(e){e.originalEvent.attribute="input#"+e.target.id});top$(shadowButtonUp).add(shadowButtonDown).off("mousedown").on("mousedown",function(e){var count=0;var delay=150;shadowRoot.classList.add("active");clickSpinBtn(e);intervals.push(interval=setInterval(numberSpinSpeed,delay));function numberSpinSpeed(){clearInterval(interval);clickSpinBtn(e);count++;delay=count<8?delay:count<16?120:count<36?80:count<101?50:30;interval=setInterval(numberSpinSpeed,delay)}});top$(shadowButtonUp).add(shadowButtonDown).off("mouseup mouseleave").on("mouseup mouseleave",function(e){for(var i=0;i<intervals.length;i++){clearInterval(intervals.pop())}if(interval)clearInterval(interval)});function clickSpinBtn(e,direction){var currentValue=shadowInput.value;if(e.target==shadowButtonUp||direction=="up"){var newValue=parseFloat(currentValue)+parseFloat(_this.step);shadowInput.value=newValue>_this.max?_this.wrap==="true"||_this.wrap===true?_this.min:currentValue:newValue}else if(e.target==shadowButtonDown||direction=="down"){var newValue=parseFloat(currentValue)-parseFloat(_this.step);shadowInput.value=newValue<_this.min?_this.wrap==="true"||_this.wrap===true?_this.max:currentValue:newValue}_this.value=_this.__leadingZeros(shadowInput.value,_this.numberOfD);_this.valueByType=_this.value;_this.number=shadowInput.value;_this.updateData("number");_this.__dispatchEvent(new CustomEvent("change",{detail:{oldValue:currentValue,value:_this.value}}))}}else if(this.type=="time"){var selectedRange="";var intervals=[];var interval;top$(shadowInput).off("click").on("click",function(e){var thisPosition=doGetCaretPosition(this);if(_this.hourIndexRange[0]!=-1&&_this.hourIndexRange[0]<=thisPosition&&_this.hourIndexRange[1]+1>=thisPosition)selectedRange="hour";else if(_this.minIndexRange[0]!=-1&&_this.minIndexRange[0]<=thisPosition&&_this.minIndexRange[1]+1>=thisPosition)selectedRange="min";else if(_this.secondIndexRange[0]!=-1&&_this.secondIndexRange[0]<=thisPosition&&_this.secondIndexRange[1]+1>=thisPosition)selectedRange="second";else if(_this.msecIndexRange[0]!=-1&&_this.msecIndexRange[0]<=thisPosition&&_this.msecIndexRange[1]+1>=thisPosition)selectedRange="msec";else if(_this.periodIndexRange[0]!=-1&&_this.periodIndexRange[0]<=thisPosition&&_this.periodIndexRange[1]+1>=thisPosition)selectedRange="period";setSelectionByRange(this)});top$(shadowButtonUp).add(shadowButtonDown).off("mousedown").on("mousedown",function(e){shadowRoot.classList.add("active");var count=0;var delay=150;intervals.push(interval=setInterval(timeSpinSpeed,delay));function timeSpinSpeed(){clearInterval(interval);spinInputValue(e);count++;delay=count<8?delay:count<16?120:count<36?80:count<101?50:30;interval=setInterval(timeSpinSpeed,delay)}});top$(shadowButtonUp).add(shadowButtonDown).off("click").on("click",function(e){spinInputValue(e)});top$(shadowButtonUp).add(shadowButtonDown).off("mouseup").on("mouseup",function(e){if(e.originalEvent.attribute!=="input#"+_this.id){shadowRoot.classList.remove("active")}for(var i=0;i<intervals.length;i++){clearInterval(intervals.pop())}if(interval)clearInterval(interval)});top$(shadowButtonUp).add(shadowButtonDown).off("mouseleave").on("mouseleave",function(e){for(var i=0;i<intervals.length;i++){clearInterval(intervals.pop())}if(interval)clearInterval(interval)});var down={};top$(shadowInput).off("keydown").on("keydown",function(e){if(isValidKey(e.keyCode,e.key)){if(e.which===38){spinInputValue(e,"up")}else if(e.which===40){spinInputValue(e,"down")}else{if(down[e.which]!=null){return false}else{down[e.which]=true}}}else{e.preventDefault();return false}}).off("keyup").on("keyup",function(e){this.value=event.target.value.replace(/[\u3131-\uD79D]/g,"");_this.time=this.value;_this.value=this.value;down[e.which]=null;if(!isValidKey(e.keyCode,e.key)){e.preventDefault();return false}validateTimeValue(e);if(e.which===39||e.which===37){if(!selectedRange)selectedRange=_this.order[0];else{var newIndex=e.which===39?_this.order.indexOf(selectedRange)+1:_this.order.indexOf(selectedRange)-1;if(newIndex<0)newIndex=0;if(newIndex>_this.order.length-1)newIndex=_this.order.length-1;selectedRange=_this.order[newIndex];setSelectionByRange(this)}}}).off("focusout").on("focusout",function(e){this.value=event.target.value.replace(/[\u3131-\uD79D]/g,"");_this.time=this.value;validateTimeValue(e);e.stopPropagation()}).off("focus").on("focus",function(e){shadowRoot.classList.add("active");top$(this).off("mousewheel").on("mousewheel",function(e){if(e.originalEvent.wheelDelta/120>0){spinInputValue(e,"up")}else{spinInputValue(e,"down")}})}).off("input").on("input",function(){shadowRoot.classList.add("active")}).off("mouseup").on("mouseup",function(e){e.originalEvent.attribute="input#"+e.target.id});function isValidKey(keycode,key){var checkP=/^[AMPM]$/gi;var key=String.fromCharCode(keycode);if(keycode==13||keycode>=37&&keycode<=40||keycode===8||keycode===46){return true}if(/^[0-9]*$/.test(key)===false)return false;if(selectedRange=="period"){return!checkP.test(key)?false:true}else{return!(keycode>=48&&keycode<=57||keycode>=96&&keycode<=105)?false:true}return false}function spinInputValue(e,direction){var currentValue=shadowInput.value;if(!selectedRange)selectedRange=_this.order[_this.order.length-1];if(selectedRange==="hour"){e.target==shadowButtonUp||direction=="up"?changeHourValue("up"):changeHourValue("down")}else if(selectedRange==="min"){e.target==shadowButtonUp||direction=="up"?changeMSValue("up","min"):changeMSValue("down","min")}else if(selectedRange==="second"){e.target==shadowButtonUp||direction=="up"?changeMSValue("up","second"):changeMSValue("down","second")}else if(selectedRange==="msec"){e.target==shadowButtonUp||direction=="up"?changeMsecValue("up"):changeMsecValue("down")}else if(selectedRange==="period"){changePeriodValue()}_this.value=shadowInput.value;_this.time=shadowInput.value;_this.updateData("time");_this.__dispatchEvent(new CustomEvent("change",{oldValue:currentValue,value:_this.value}))}function doGetCaretPosition(oField){var iCaretPos=0;if(document.selection){oField.focus();var oSel=document.selection.createRange();oSel.moveStart("character",-oField.value.length);iCaretPos=oSel.text.length}else if(oField.selectionStart||oField.selectionStart=="0"){iCaretPos=oField.selectionStart}return iCaretPos}function setSelectionByRange(input){if(selectedRange==="hour"){input.setSelectionRange(_this.hourIndexRange[0],_this.hourIndexRange[1]+1)}else if(selectedRange==="min"){input.setSelectionRange(_this.minIndexRange[0],_this.minIndexRange[1]+1)}else if(selectedRange==="second"){input.setSelectionRange(_this.secondIndexRange[0],_this.secondIndexRange[1]+1)}else if(selectedRange==="msec"){input.setSelectionRange(_this.msecIndexRange[0],_this.msecIndexRange[1]+1)}else if(selectedRange==="period"){input.setSelectionRange(_this.periodIndexRange[0],_this.periodIndexRange[1]+1)}}function changeHourValue(direction,fromMin){var currentValue;var newValue;var index1=_this.hourIndexRange[0];var index2=_this.hourIndexRange[1];var hourStep=fromMin?1:parseFloat(_this.step);currentValue=shadowInput.value.substring(index1,index2+1);if(currentValue==="")currentValue="00";if(isNaN(currentValue))currentValue=_this.hour;newValue=direction=="up"?parseFloat(currentValue)+hourStep:parseFloat(currentValue)-hourStep;switch(_this.timeSystem){case"12":{if(newValue>11){newValue=0;changePeriodValue()}if(newValue<0){newValue=11;changePeriodValue()}break}case"24":{if(newValue>23){newValue=0;changePeriodValue()}if(newValue<0){newValue=23;changePeriodValue()}break}}newValue=_this.__leadingZeros(newValue,_this.numberOfH);_this.hour=newValue;var newTimeValue=_this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,_this.hour);newTimeValue=newTimeValue.replace(/mm|m/gi,_this.min);newTimeValue=newTimeValue.replace(/ss|s/g,_this.second);newTimeValue=newTimeValue.replace(/SSS|SS|S/g,_this.msec);newTimeValue=newTimeValue.replace(/p/,_this.period);shadowInput.value=newTimeValue}function changeMSValue(direction,range,fromChild){var currentValue;var newValue;var index1,index2;var digits;var newStep=fromChild?1:parseFloat(_this.step);if(range==="min"){index1=_this.minIndexRange[0];index2=_this.minIndexRange[1];digits=_this.numberOfM}else{index1=_this.secondIndexRange[0];index2=_this.secondIndexRange[1];digits=_this.numberOfS}currentValue=shadowInput.value.substring(index1,index2+1);if(currentValue==="")currentValue="00";if(isNaN(currentValue)){currentValue=range==="min"?_this.min:_this.second}newValue=parseFloat(currentValue)+(direction=="up"?newStep:-newStep);if(newValue>59){newValue=parseFloat(currentValue)+newStep-60;range==="min"?changeHourValue("up",true):changeMSValue("up","min",true)}if(newValue<0){newValue=parseFloat(currentValue)-newStep+60;range==="min"?changeHourValue("down",true):changeMSValue("down","min",true)}newValue=_this.__leadingZeros(newValue,digits);if(range==="min")_this.min=newValue;else _this.second=newValue;var newTimeValue=_this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,_this.hour);newTimeValue=newTimeValue.replace(/mm|m/gi,_this.min);newTimeValue=newTimeValue.replace(/ss|s/g,_this.second);newTimeValue=newTimeValue.replace(/SSS|SS|S/g,_this.msec);newTimeValue=newTimeValue.replace(/p/,_this.period);shadowInput.value=newTimeValue}function changeMsecValue(direction,fromChild){var currentValue;var newValue;var index1=_this.msecIndexRange[0];var index2=_this.msecIndexRange[1];var digits=_this.numberOfMS;var msecStep=fromChild?1:parseFloat(_this.step);currentValue=shadowInput.value.substring(index1,index2+1);if(currentValue==="")currentValue=digits==3?"000":digits==2?"00":"0";if(isNaN(currentValue))currentValue=_this.msec;newValue=direction=="up"?parseFloat(currentValue)+msecStep:parseFloat(currentValue)-msecStep;if(newValue>(digits==3?999:digits==2?99:9)){newValue=parseFloat(currentValue)+msecStep-(digits==3?1e3:digits==2?100:10);changeMSValue("up","second",true)}if(newValue<0){newValue=parseFloat(currentValue)-msecStep+(digits==3?1e3:digits==2?100:10);changeMSValue("down","second",true)}newValue=_this.__leadingZeros(newValue,_this.numberOfMS);_this.msec=newValue;var newTimeValue=_this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,_this.hour);newTimeValue=newTimeValue.replace(/mm|m/gi,_this.min);newTimeValue=newTimeValue.replace(/ss|s/g,_this.second);newTimeValue=newTimeValue.replace(/SSS|SS|S/g,_this.msec);newTimeValue=newTimeValue.replace(/p/,_this.period);shadowInput.value=newTimeValue}function changePeriodValue(){var currentValue,newValue,index1,index2;var testPeriod=/\b(am)|\b(pm)/gi;index1=_this.periodIndexRange[0];index2=_this.periodIndexRange[1];currentValue=shadowInput.value.substring(index1,index2+1);if(!testPeriod.test(currentValue))currentValue=_this.period;newValue=togglePeriod(currentValue);_this.period=newValue;var newTimeValue=_this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,_this.hour);newTimeValue=newTimeValue.replace(/mm|m/gi,_this.min);newTimeValue=newTimeValue.replace(/ss|s/g,_this.second);newTimeValue=newTimeValue.replace(/SSS|SS|S/g,_this.msec);newTimeValue=newTimeValue.replace(/p/,_this.period);shadowInput.value=newTimeValue;function togglePeriod(p){var ret;var includeA=/a/gi;if(includeA.test(p)){if(p.includes("a"))ret=p.replace("a","p");else ret=p.replace("A","P")}else{if(p.includes("p"))ret=p.replace("p","a");else ret=p.replace("P","A")}return ret}}function validateTimeValue(e){if(e.type=="blur"||e.which==37||e.which==38||e.which==39||e.which==40||e.which==13){var currentValue;var newValue;var index1,index2;var digits;if(selectedRange==="hour"){index1=_this.hourIndexRange[0];index2=_this.hourIndexRange[1];digits=_this.numberOfH;currentValue=shadowInput.value.substring(index1,index2+1);if(isNaN(currentValue))currentValue=_this.hour;if(_this.timeSystem=="12"){currentValue=currentValue>11?0:currentValue;currentValue=currentValue<0?11:currentValue}else if(_this.timeSystem=="24"){currentValue=currentValue>23?0:currentValue;currentValue=currentValue<0?23:currentValue}currentValue=_this.__leadingZeros(currentValue,digits);_this.hour=currentValue}else if(selectedRange==="min"){index1=_this.minIndexRange[0];index2=_this.minIndexRange[1];digits=_this.numberOfM;currentValue=shadowInput.value.substring(index1,index2+1);if(isNaN(currentValue))currentValue=_this.min;currentValue=currentValue>59?0:currentValue;currentValue=currentValue<0?59:currentValue;currentValue=_this.__leadingZeros(currentValue,digits);_this.min=currentValue}else if(selectedRange==="second"){index1=_this.secondIndexRange[0];index2=_this.secondIndexRange[1];digits=_this.numberOfS;currentValue=shadowInput.value.substring(index1,index2+1);if(isNaN(currentValue))currentValue=_this.second;currentValue=currentValue>59?0:currentValue;currentValue=currentValue<0?59:currentValue;currentValue=_this.__leadingZeros(currentValue,digits);_this.second=currentValue}else if(selectedRange==="msec"){index1=_this.msecIndexRange[0];index2=_this.msecIndexRange[1];digits=_this.numberOfMS;currentValue=shadowInput.value.substring(index1,index2+1);if(isNaN(currentValue))currentValue=_this.msec;var maxDigits=digits==3?999:digits==2?99:9;currentValue=currentValue>maxDigits?0:currentValue;currentValue=currentValue<0?maxDigits:currentValue;currentValue=_this.__leadingZeros(currentValue,digits);_this.msec=currentValue}else if(selectedRange==="period"){var testPeriod=/\b(am)|\b(pm)/gi;index1=_this.periodIndexRange[0];index2=_this.periodIndexRange[1];currentValue=shadowInput.value.substring(index1,index2+1);if(!testPeriod.test(currentValue))currentValue=_this.period;_this.period=currentValue}var newTimeValue=_this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,_this.hour);newTimeValue=newTimeValue.replace(/mm|m/gi,_this.min);newTimeValue=newTimeValue.replace(/ss|s/g,_this.second);newTimeValue=newTimeValue.replace(/SSS|SS|S/g,_this.msec);newTimeValue=newTimeValue.replace(/p/,_this.period);shadowInput.value=newTimeValue;_this.value=shadowInput.value;_this.time=shadowInput.value;_this.updateData("time");setSelectionByRange(shadowInput)}else if(e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=105){var key=e.key;var hunds,tens,units;if(selectedRange==="hour"){index1=_this.hourIndexRange[0];index2=_this.hourIndexRange[1];digits=_this.numberOfH;tens=_this.hour.length==2?_this.hour.substr(_this.hour.length-1,1):0;units=key;if(_this.timeSystem=="12"){if(tens>1){tens=0}else if(tens==1&&units>1){tens=0;units="0"}}else if(_this.timeSystem=="24"){if(tens>2){tens=0}else if(tens==2&&units>3){tens=0;units="0"}}currentValue=digits==2?tens+units:units;_this.hour=currentValue}else if(selectedRange==="min"){index1=_this.minIndexRange[0];index2=_this.minIndexRange[1];digits=_this.numberOfM;tens=_this.min.length==2?_this.min.substr(_this.min.length-1,1):0;units=key;if(tens>5)tens=0;currentValue=digits==2?tens+units:units;_this.min=currentValue}else if(selectedRange==="second"){index1=_this.secondIndexRange[0];index2=_this.secondIndexRange[1];digits=_this.numberOfS;tens=_this.second.length==2?_this.second.substr(_this.second.length-1,1):0;units=key;if(tens>5)tens=0;currentValue=digits==2?tens+units:units;_this.second=currentValue}else if(selectedRange==="msec"){index1=_this.msecIndexRange[0];index2=_this.msecIndexRange[1];digits=_this.numberOfMS;if(_this.msec.length==3){hunds=_this.msec.substr(_this.msec.length-2,1);tens=_this.msec.substr(_this.msec.length-1,1);units=key}else if(_this.msec.length==2){hunds=_this.msec.substr(_this.msec.length-1,1);tens=key}else if(_this.msec.length==1){hunds=key}else{hunds=0;tens=0;units=key}if(digits==3)currentValue=hunds+tens+units;else if(digits==2)currentValue=hunds+tens;else if(digits==1)currentValue=hunds;else currentValue=units;_this.msec=currentValue}var newTimeValue=_this.format;newTimeValue=newTimeValue.replace(/hh|h/gi,_this.hour);newTimeValue=newTimeValue.replace(/mm|m/gi,_this.min);newTimeValue=newTimeValue.replace(/ss|s/g,_this.second);newTimeValue=newTimeValue.replace(/SSS|SS|S/g,_this.msec);newTimeValue=newTimeValue.replace(/p/,_this.period);shadowInput.value=newTimeValue;_this.value=shadowInput.value;_this.time=shadowInput.value;_this.updateData("time");setSelectionByRange(shadowInput)}}}},__initEventInternal:function(){this.__addEventByAttr("change")},__updateOnChange:function(){this.__addEventByAttr("change")},__updateDisabled:function(){var shadowInput=this.querySelector("input");var shadowButton=this.querySelectorAll(".top-spinner-button");var disabled=this.calculateDerivedDisabled();this.__setDisabled(shadowInput);this.__setDisabled(shadowButton[0]);this.__setDisabled(shadowButton[1]);if(disabled=="true"||disabled==true){top$(this).unbind();top$(shadowInput).unbind();top$(shadowButton).unbind()}else{this.__attachEventHandler()}},__updateTime:function(){this.__initialize()},__updateFormat:function(){this.__initialize()},__updateNumber:function(){this.__initialize()},__updateMax:function(){this.__initialize()},__updateMin:function(){this.__initialize()},getTopStyle:function(){this.topstyle=this.querySelector(".top-spinner-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-spinner-root").style[key]=value;this.topstyle=this.querySelector(".top-spinner-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-spinner-root").style.cssText=this.topstyle}};Top.Widget.Spinner=function(){Spinner.prototype=Object.create(Top.Widget.prototype);Spinner.prototype.constructor=Spinner;function Spinner(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-spinner");this.template.innerHTML='<div class="top-spinner-root"><input class="top-spinner-input" type="text"><i class="top-spinner-button up"></i><i class="top-spinner-button down"></i></div>'}this.id=this.template.id}Spinner.create=function(element){return new Spinner(element)};return Spinner}();TopSplitterlayout={is:"top-splitterlayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{orientation:{type:String,value:"horizontal",reflectToAttribute:true},splitter:{type:Number,value:1},ratio:{type:String,value:"1:1"},onDrag:String,postResize:String},__ready:function(){this.__updateId();this.initialChilds();this.postResize=this.postResize==="true"||this.postResize===true;this.renderLayout()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-splitterlayout-root">'+this.innerHTML+"</div>"},__eventBindingList:function(){var shadowDiv=this.querySelector("div");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},attached:function(){this.attachEventHandler();this.__adjustLayoutSize(this.__sizeArray,this.__sizeSum)},__attached2:function(){this.__setWidgetSize()},initialChilds:function(){var root=this.childRoot;this.childs=[];for(var i=0;i<root.children.length;i++){root.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}this.childrenLen=root.children.length},initializeChildRoot:function(){return this.querySelector(".top-splitterlayout-root")},renderLayout:function(){var fragment=document.createDocumentFragment();var sizeArray=[];var sizeSum=0;var layoutRoot=this.childRoot;this.layouts=[];if(this.onDrag&&typeof this.onDrag==="string"){this.onDrag=Top.Util.namespace(this.onDrag,this)}sizeArray=this.ratio.split(":");for(var i=0;i<sizeArray.length;i++){if(sizeArray[i]==="")sizeArray[i]="0";var size=parseInt(sizeArray[i]);sizeSum+=size}var tempChildArray=[];var childWithoutLocation=[];this.originFirstContentRatio=parseInt(sizeArray[0])/sizeSum*100;this.__sizeArray=sizeArray;this.__sizeSum=sizeSum;var root=this.childRoot;for(var i=0;i<root.children.length;i++){var item=root.children[i];var location=item.getAttribute("layout-split-location");if(location)tempChildArray[parseInt(location)]=item;else tempChildArray[i]=item}if(this.orientation=="vertical"){for(var i=0;i<2;i++){var horizontalAlignment=this.horizontalAlignment||"left";var item=tempChildArray[i];if(item&&item.getAttribute("layout-horizontal-alignment")){horizontalAlignment=item.getAttribute("layout-horizontal-alignment")}var wrapper=document.createElement("div");wrapper.className="top-splitterlayout-content content_"+i;wrapper.style.cssText="text-align: "+horizontalAlignment+";";if(item)wrapper.appendChild(item);fragment.appendChild(wrapper);this.layouts.push(wrapper);if(this.splitter>i){var splitter=document.createElement("div");splitter.className="top-splitterlayout-splitter vertical";fragment.appendChild(splitter)}}}else{for(var i=0;i<2;i++){var item=tempChildArray[i];var horizontalAlignment=item?item.getAttribute("layout-horizontal-alignment")||"left":"left";var verticalAlignment=item?item.getAttribute("layout-vertical-alignment")||"top":"top";var wrapper=document.createElement("div");wrapper.className="top-splitterlayout-content content_"+i;wrapper.style.cssText="display:inline-block; text-align:"+horizontalAlignment+"; vertical-align:"+verticalAlignment+";";if(item)wrapper.appendChild(item);fragment.appendChild(wrapper);this.layouts.push(wrapper);if(this.splitter>i){var splitter=document.createElement("div");splitter.className="top-splitterlayout-splitter horizontal";splitter.style.cssText="display:inline-block;";fragment.appendChild(splitter)}}}this.splitterBar=splitter;root.appendChild(fragment)},__adjustLayoutSize:function(sizeArray,sizeSum){var root=this.childRoot;var splitter=this.splitterBar;var layouts=this.layouts;if(this.orientation==="vertical"){var splitterHeight=splitter.offsetHeight;var len=this.childrenLen;for(var i=0;i<len;i++){var height="calc("+parseInt(sizeArray[i])/sizeSum*100+"% - "+parseInt(splitterHeight/len)+"px)";layouts[i].style.width="100%";layouts[i].style.height=height}}else{var splitterWidth=splitter.offsetWidth;var len=layouts.length;for(var i=0;i<len;i++){var width="calc("+parseInt(sizeArray[i])/sizeSum*100+"% - "+parseInt(splitterWidth/len)+"px)";layouts[i].style.width=width;layouts[i].style.height="100%"}}},initDefaultWidth:function(){var splitter=this.splitterBar;var firstChild=splitter.previousSibling.firstChild;var secondChild=splitter.nextSibling.firstChild;if(firstChild&&secondChild){var defaultWidth=firstChild.getAttribute("default-width");var maxWidth=firstChild.getAttribute("max-width");if(defaultWidth===null)defaultWidth=maxWidth;if(defaultWidth){var initRatio=(parseFloat(defaultWidth)+splitter.offsetWidth/2)/this.childRoot.offsetWidth*100;splitter.previousSibling.style.width=splitter.previousSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,initRatio+"%");splitter.nextSibling.style.width=splitter.nextSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,100-initRatio+"%");splitter.style.left=splitter.previousSibling.style.width;this.originFirstContentRatio=initRatio}}},attachEventHandler:function(){if(this.isAttachedHandler===true)return;this.isAttachedHandler=true;var _this=this;var layoutRoot=this.childRoot;var selected=null,min=0,max=0,prevX,prevY,changeValue;var root=this.childRoot;var splitter=this.splitterBar;splitter.removeEventListener("mousedown",_dragInit);splitter.addEventListener("mousedown",_dragInit);if(this.__splitMouseUpEvent===undefined){this.__splitMouseUpEvent=function(e){if(selected===null)return;_destroy();_this.removeEventListener("mousemove",_moveElem);_this.removeEventListener("mousemove",_destroy);e.preventDefault();selected=null}}document.removeEventListener("mouseup",this.__splitMouseUpEvent);document.addEventListener("mouseup",this.__splitMouseUpEvent);function _dragInit(e){if(_this.postResize){var splitterMove=document.createElement("div");splitterMove.className="top-splitterlayout-splitter_move";splitterMove.style.cssText=_this.orientation==="vertical"?"top:0px":"left:0px"+";";this.appendChild(splitterMove);selected=splitterMove}else{selected=this}prevX=e.pageX;prevY=e.pageY;changeValue=_this.originFirstContentRatio;_this.originTop=_this.getOffsetTop(this)-_this.getOffsetTop(layoutRoot);_this.originLeft=_this.getOffsetLeft(this)-_this.getOffsetLeft(layoutRoot);_this.addEventListener("mousemove",_moveElem);_this.addEventListener("mouseup",_destroy);e.preventDefault()}function _moveElem(e){if(selected==null)return;if(!selected.previousSibling.firstChild)return;var movingValue=_this.orientation==="vertical"?e.pageY-prevY:e.pageX-prevX;var movingRatio=_this.orientation==="vertical"?Math.abs(movingValue)/layoutRoot.offsetHeight*100:Math.abs(movingValue)/layoutRoot.offsetWidth*100;if(movingValue>0){changeValue=_this.originFirstContentRatio+movingRatio}else if(movingValue<0){changeValue=_this.originFirstContentRatio-movingRatio}if(changeValue>100)changeValue=100;else if(changeValue<0)changeValue=0;if(_this.orientation==="horizontal"){var maxRatio=(parseFloat(selected.previousSibling.firstChild.getAttribute("max-width"))+splitter.offsetWidth/2)/_this.childRoot.offsetWidth*100;var minRatio=(parseFloat(selected.previousSibling.firstChild.getAttribute("min-width"))+splitter.offsetWidth/2)/_this.childRoot.offsetWidth*100}else{var maxRatio=(parseFloat(selected.previousSibling.firstChild.getAttribute("max-height"))+splitter.offsetHeight/2)/_this.childRoot.offsetHeight*100;var minRatio=(parseFloat(selected.previousSibling.firstChild.getAttribute("min-height"))+splitter.offsetHeight/2)/_this.childRoot.offsetHeight*100}if(maxRatio&&changeValue>maxRatio)changeValue=maxRatio;if(minRatio&&changeValue<minRatio)changeValue=minRatio;if(_this.orientation==="vertical"){if(_this.postResize){var originTop=selected.style.top;selected.style.top=parseFloat(originTop)+movingValue+"px"}else{selected.previousSibling.style.height=selected.previousSibling.style.height.replace(/[0-9]*[.]?[0-9]+%/g,changeValue+"%");selected.nextSibling.style.height=selected.nextSibling.style.height.replace(/[0-9]*[.]?[0-9]+%/g,100-changeValue+"%");selected.style.top=selected.previousSibling.style.height}}else{if(_this.postResize){var originLeft=selected.style.left;selected.style.left=parseFloat(originLeft)+movingValue+"px"}else{selected.previousSibling.style.width=selected.previousSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,changeValue+"%");selected.nextSibling.style.width=selected.nextSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,100-changeValue+"%");selected.style.left=selected.previousSibling.style.width}}_this.originFirstContentRatio=changeValue;prevY=e.pageY;prevX=e.pageX;if(_this.onDrag)_this.onDrag(e,Top.Dom.selectById(_this.id));var tableviews=_this.getElementsByTagName("TOP-TABLEVIEW");var len=tableviews.length;for(var i=0;i<len;i++){var tableElement=tableviews[i].getElementsByClassName("multiple-header");if(tableElement.length>0){if(tableviews[i].scrollTable&&(tableviews[i].layoutWidth!==undefined&&(tableviews[i].layoutWidth.indexOf("%")!==-1||tableviews[i].layoutWidth==="match_parent")||tableviews[i].layoutWidth===undefined)&&tableviews[i].dataTable){tableviews[i].dataTable.columns.adjust()}}}e.preventDefault()}function _destroy(){if(selected===null)return;if(_this.postResize){if(_this.orientation==="vertical"){selected.parentNode.previousSibling.style.height=selected.parentNode.previousSibling.style.height.replace(/[0-9]*[.]?[0-9]+%/g,changeValue+"%");selected.parentNode.nextSibling.style.height=selected.parentNode.nextSibling.style.height.replace(/[0-9]*[.]?[0-9]+%/g,100-changeValue+"%");selected.parentNode.style.top=selected.parentNode.previousSibling.style.height}else{selected.parentNode.previousSibling.style.width=selected.parentNode.previousSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,changeValue+"%");selected.parentNode.nextSibling.width=selected.parentNode.nextSibling.style.width.replace(/[0-9]*[.]?[0-9]+%/g,100-changeValue+"%");selected.parentNode.style.left=selected.parentNode.previousSibling.style.width}top$(root).find("> .top-splitterlayout-splitter .top-splitterlayout-splitter_move").remove()}selected=null}},adjustSize:function(){if(this.adjusted===true){for(var i=0;i<this.childRoot.children.length;i++){var item=this.childRoot.children[i];if(item.nodeName==="DIV"&&item.firstElementChild)item=item.firstElementChild;if(typeof item.adjustSize==="function")item.adjustSize()}return}if(this.childRoot){var isVisible=!!(this.childRoot.offsetWidth||this.childRoot.offsetHeight||this.childRoot.getClientRects().length)}else{var isVisible=!!(this.offsetWidth||this.offsetHeight||this.getClientRects().length)}if(isVisible===true){this.adjusted=true;this.__adjustLayoutSize(this.__sizeArray,this.__sizeSum);
this.__setWidgetSize()}},__setWidgetSize:function(){var secondContent=this.childRoot.querySelector(".top-splitterlayout-content.content_1");var splitterElem=this.splitterBar;if(this.orientation==="vertical"){secondContent.style.top=splitterElem.offsetHeight+"px"}else{secondContent.style.left=splitterElem.offsetWidth+"px"}var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto",pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var root=this.childRoot;for(var i=0;i<root.children.length;i++){var item=root.children[i];if(item.nodeName==="DIV"&&item.firstElementChild)item=item.firstElementChild;else if(item.nodeName==="DIV"&&!item.firstElementChild)continue;if(typeof item.adjustSize==="function")item.adjustSize();if(item.layoutWidth==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{item.setThisWidgetWidth("100%")}}if(item.layoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{item.setThisWidgetHeight("100%")}}}},__updateRatio:function(){var sizeArray=[];var sizeSum=0;var layoutRoot=this.childRoot;sizeArray=this.ratio.split(":");if(sizeArray.length!==this.childrenLen){console.warn("Validation Error Message: check ratio property")}for(var i=0;i<sizeArray.length;i++){if(sizeArray[i]==="")sizeArray[i]="0";var size=parseInt(sizeArray[i]);sizeSum+=size}var tempChildArray=[];var childWithoutLocation=[];this.originFirstContentRatio=parseInt(sizeArray[0])/sizeSum*100;this.__sizeArray=sizeArray;this.__sizeSum=sizeSum;this.__adjustLayoutSize(this.__sizeArray,this.__sizeSum);if(this.orientation==="horizontal")this.splitterBar.style.left=this.splitterBar.previousSibling.style.width;else this.splitterBar.style.top=this.splitterBar.previousSibling.style.height},getWidth:function(){return this.childRoot.offsetWidth},getHeight:function(){return this.childRoot.offsetHeight},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.nodeName==="DIV"&&item.firstElementChild)item=item.firstElementChild;else if(item.nodeName==="DIV"&&!item.firstElementChild)continue;topElements.push(Top.Dom.__selectImpl(item))}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},clear:function(){this.adjusted=false;this.clearChilds()},getTopStyle:function(){this.topstyle=this.querySelector(".top-splitterlayout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-splitterlayout-root").style[key]=value;this.topstyle=this.querySelector(".top-splitterlayout-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-splitterlayout-root").style.cssText=this.topstyle},__detached:function(){document.removeEventListener("mouseup",this.__splitMouseUpEvent);this.__splitMouseUpEvent=undefined}};Top.Widget.Layout.Splitterlayout=function(){Splitterlayout.prototype=Object.create(Top.Widget.Layout.prototype);Splitterlayout.prototype.constructor=Splitterlayout;function Splitterlayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-splitterlayout");this.template.innerHTML='<div class="top-splitterlayout-root"></div>'}this.id=this.template.id}Splitterlayout.create=function(element){return new Splitterlayout(element)};Splitterlayout.prototype.getWidth=function(){return this.template.getWidth()};Splitterlayout.prototype.getHeight=function(){return this.template.getHeight()};return Splitterlayout}();TopStepper={is:"top-stepper",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{disabled:String,text:String,textAlign:String,steps:Number,radius:Number,spacing:String,labels:{type:Object}},__attached2:function(){var _this=this;if(Top.App.isLoaded()){if(this.layoutParent===undefined){var p=this.getNotInitializedParentRoot();if(p.__redrawChild===undefined)p.__redrawChild=[];var f=function(){_this.__initialize()};p.__redrawChild.push(f)}else{this.__initialize()}}else{Top.App.onBeforeLoad(function(){if(_this.layoutParent===undefined){var p=_this.getNotInitializedParentRoot();if(p.__redrawChild===undefined)p.__redrawChild=[];var f=function(){_this.__initialize()};p.__redrawChild.push(f)}else{_this.__initialize()}})}},getNotInitializedParentRoot:function(){var parent=this.getParent();while(parent.getParent().__initialized===undefined){parent=parent.getParent()}return parent},__initialize:function(){this.__initProperties();var _this=this;if(Top.App.isLoaded()){if(_this.layoutParent===undefined){_this.getParent().__isReadied=function(){_this.renderStepper()}}else{_this.renderStepper()}}else{var _this=this;Top.App.onBeforeLoad(function(){if(_this.layoutParent===undefined){_this.getParent().__isReadied=function(){_this.renderStepper()}}else{_this.renderStepper()}})}},__initProperties:function(){this.nodeIndex=0;this.radius=this.radius||11.5;this.steps=this.steps>2?this.steps:2;if(this.spacing&&typeof this.spacing==="string")this.spacing=this.spacing.split("px")[0]*1;this.spacing=this.spacing||.5},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-stepper-root");return{__eventMouseClick:function(func){shadowRoot.onclick=func},__eventMousePressed:function(func){shadowRoot.onmousedown=func},__eventMouseReleased:function(func){shadowRoot.onmouseup=func},__eventMouseDblclick:function(func){shadowRoot.ondblclick=func},__eventKeyPressed:function(func){shadowRoot.onkeydown=func},__eventKeyTyped:function(func){shadowRoot.onkeypress=func},__eventKeyReleased:function(func){shadowRoot.onkeyup=func},__eventFocused:function(func){shadowRoot.onfocus=func},__eventLostFocused:function(func){shadowRoot.onblur=func},__eventMouseEnter:function(func){shadowRoot.onmouseenter=func},__eventMouseExit:function(func){shadowRoot.onmouseleave=func},__eventMouseMove:function(func){shadowRoot.onmousemove=func},__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},appendTemplate:function(){this.innerHTML='<svg class = "top-stepper-root"><g class = "top-stepper-lines" ></g><g class = "top-stepper-circles" ><g class = "circles" ></g><g class = "numbers" >< /g></g> <g class = "top-stepper-labels" > </g></svg>'},__updateId:function(){if(this.id){var shadowRoot=this.querySelector(".top-stepper-root");shadowRoot.id=this.id}},__makePath:function(svgWidth,svgHeight){var linePath=[],lineCount=this.steps-1,height=svgHeight/2,radius=parseInt(this.radius||0),startPoint=parseInt(this.spacing),endPoint,width=svgWidth-startPoint*2-radius*2,interval=width/lineCount,lineGenerator=d3.svg.line();for(var i=0;i<lineCount;i++){if(i===0){startPoint=startPoint+radius}var newPath=[[startPoint,height],[startPoint+interval,height]];var pathString=lineGenerator(newPath);linePath.push(pathString);startPoint=startPoint+interval}return linePath},__makePoints:function(svgWidth,svgHeight){var points=[],circleCount=this.steps,height=svgHeight/2,radius=parseInt(this.radius||0),startPoint=parseInt(this.spacing),endPoint,width=svgWidth-startPoint*2-radius*2,interval=width/(circleCount-1);for(var i=0;i<circleCount;i++){if(i===0){startPoint=startPoint+radius}var newPoint=[startPoint,height];points.push(newPoint);startPoint=startPoint+interval}return points},renderStepper:function(){var svg=this.querySelector(".top-stepper-root");if(this.layoutWidth==null){this.layoutWidth="100%";this.setTopStyle("width",this.layoutWidth)}if(this.layoutHeight==null){this.layoutHeight="100%";this.setTopStyle("height",this.layoutHeight)}var _this=this;if(this.layoutWidth.includes("%")){top$(window).resize(function(){_this.renderStepper()})}if(!this.layoutWidth||this.layoutWidth=="auto"||this.layoutWidth=="wrap_content"){this.svgWidth=300}else{this.svgWidth=svg.clientWidth}if(!this.layoutHeight||this.layoutHeight=="auto"||this.layoutHeight=="wrap_content"){this.svgHeight=150}else{this.svgHeight=svg.clientHeight}if(typeof this.labels==="string"){this.labels=Top.Util.namespace(this.labels,this)}this.updateSvgLine();this.updateSvgCircle();this.updateSvgLabels()},__updateRadius:function(){if(this.radius<11.5)this.radius=11.5;this.renderStepper()},__updateSteps:function(){this.steps=this.steps>2?this.steps:2;this.renderStepper()},__updateSpacing:function(){if(this.spacing&&typeof this.spacing==="string"){this.spacing=this.spacing.split("px")[0]*1}this.spacing=this.spacing||.5;this.renderStepper()},__updateLabels:function(){this.__initProperties();this.renderStepper()},updateSvgLine:function(){var _this=this;var svg=this.querySelector(".top-stepper-root"),svgWidth=this.svgWidth,svgHeight=this.svgHeight;var path=this.__makePath(svgWidth,svgHeight);var lineGroup=d3.select(svg).select(".top-stepper-lines");this.d3_line=lineGroup.selectAll("path").data(path);this.d3_line.exit().remove();this.d3_line.enter().append("path");this.d3_line.attr("class",function(d,i){if(_this.nodeIndex>i){return"top-stepper-line stepper-line-"+i+" completed"}else{return"top-stepper-line stepper-line-"+i+" unfocused"}}).attr("d",function(d,i){return d})},updateSvgCircle:function(){var _this=this;var svg=this.querySelector(".top-stepper-root"),radius=_this.radius||0,svgWidth=this.svgWidth,svgHeight=this.svgHeight;this.points=this.__makePoints(svgWidth,svgHeight);var circleGroup=d3.select(svg).select(".top-stepper-circles").select(".circles");this.d3_circle=circleGroup.selectAll("circle").data(this.points);this.d3_circle.exit().remove();this.d3_circle.enter().append("circle");this.d3_circle.attr("class",function(d,i){if(_this.nodeIndex>i){return"top-stepper-circle stepper-circle-"+i+" completed"}else if(_this.nodeIndex===i){return"top-stepper-circle stepper-circle-"+i+" focused"}else{return"top-stepper-circle stepper-circle-"+i+" unfocused"}}).attr("r",radius).attr("cx",function(d,i){return d[0]}).attr("cy",function(d,i){return d[1]});var numberGroup=d3.select(svg).select(".top-stepper-circles").select(".numbers");this.d3_text=numberGroup.selectAll("text").data(this.points);this.d3_text.exit().remove();this.d3_text.enter().append("text");this.d3_text.attr("class",function(d,i){if(_this.nodeIndex>i){return"top-stepper-number completed"}else if(_this.nodeIndex===i){return"top-stepper-number stepper-number-"+i+" focused"}else{return"top-stepper-number stepper-number-"+i+" unfocused"}}).text(function(d,i){if(_this.nodeIndex<=i)return i+1;else return""}).attr("x",function(d,i){if(_this.nodeIndex<=i){if(i>8){return d[0]-10}else{return d[0]-4}}else{return d[0]-6}}).attr("y",function(d,i){return d[1]+6})},updateSvgLabels:function(){var svg=this.querySelector(".top-stepper-root");var labelsGroup=d3.select(svg).select(".top-stepper-labels");var _this=this,radius=_this.radius||0,points=this.points;this.d3_labels=labelsGroup.selectAll("text").data(points);this.d3_labels.exit().remove();this.d3_labels.enter().append("text");this.d3_labels.attr("class",function(d,i){if(_this.nodeIndex>i){return"top-stepper-label stepper-label-"+i+" completed"}else if(_this.nodeIndex===i){return"top-stepper-label stepper-label-"+i+" focused"}else{return"top-stepper-label stepper-label-"+i+" unfocused"}}).text(function(d,i){if(_this.labels)return _this.labels[i]}).attr("x",function(d,i){if(_this.textAlign==="left"){return d[0]-radius}else{return d[0]-this.textLength.baseVal.value/2}}).attr("y",function(d,i){return d[1]+(radius+20)});if(Top.Util.Browser.isIE()){var text=document.createElement("text");text.style.fontSize="13px";this.appendChild(text);var textWidths=[];this.d3_labels.text(function(d,i){if(_this.labels){text.innerText=_this.labels[i];textWidths.push(text.getBoundingClientRect().width);return _this.labels[i]}}).attr("x",function(d,i){if(_this.textAlign==="left"){return d[0]-radius}else{return d[0]-textWidths[i]/2}}).attr("y",function(d,i){return d[1]+(radius+20)});this.removeChild(text)}},__updateDisabled:function(){if(this.disabled===null)this.disabled=this.getAttribute("disabled");var disabled=this.calculateDerivedDisabled();if((disabled==="true"||disabled===true)&&(disabled!=="false"||disabled!==false)){this.setAttribute("disabled","true")}else{this.removeAttribute("disabled")}},__updateOnClick:function(){this.__addEventByAttr("click")},focus:function(){this.childRoot.focus()},blur:function(){this.childRoot.blur()},getTopStyle:function(){this.topstyle=this.querySelector("svg").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){var styleNode=this.querySelector("svg");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText;if(key=="width"&&this.spacing)this.renderStepper()}},setAllTopStyle:function(){this.querySelector("svg").style.cssText=this.topstyle}};Top.Widget.Stepper=function(){Stepper.prototype=Object.create(Top.Widget.prototype);Stepper.prototype.constructor=Stepper;function Stepper(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-stepper");this.template.innerHTML='<svg class = "top-stepper-root"><g class = "top-stepper-lines" ></g><g class = "top-stepper-circles" ><g class = "circles" ></g><g class = "numbers" >< /g></g> <g class = "top-stepper-labels" > </g></svg>'}this.id=this.template.id}Stepper.create=function(element){return new Stepper(element)};Stepper.prototype.next=function(){var _this=this.template;if(_this.nodeIndex<_this.steps-1)_this.nodeIndex=_this.nodeIndex+1;_this.renderStepper()};Stepper.prototype.prev=function(){var _this=this.template;if(_this.nodeIndex>0)_this.nodeIndex=_this.nodeIndex-1;_this.renderStepper()};Stepper.prototype.goTo=function(nodeIndex){var _this=this.template;var index=nodeIndex*1;if(index>0&&index<_this.steps+1){_this.nodeIndex=index-1}_this.renderStepper()};Stepper.prototype.getStatus=function(nodeIndex){var _this=this.template;if(nodeIndex)var index=nodeIndex*1-1;else return;if(_this.nodeIndex===index){return"focused"}else if(_this.nodeIndex<index){return"unfocused"}else{return"completed"}};Stepper.prototype.getStepNumber=function(){var _this=this.template;return _this.nodeIndex+1};Stepper.prototype.getWidth=function(){return this.template.svgWidth};Stepper.prototype.getHeight=function(){return this.template.svgHeight};return Stepper}();TopSwitch={is:"top-switch",behaviors:[TopWidgetBehavior,TopCheckBehavior],properties:{textOn:{type:String,value:"On"},textOff:{type:String,value:"Off"},textColor:String,tabIndex:{type:String,value:0}},getElement:function(){return this.querySelector("div")},__ready:function(){this.__initI18n("textOn");this.__initI18n("textOff");this.__initialize()},__attached2:function(){this.__initLineHeight()},__updateId:function(){if(this.id){var label=this.querySelector("label");label.id=this.id}},appendTemplate:function(){this.innerHTML='<label class="top-switch-root"><input class="top-switch-background" type="checkbox"/><div class="top-switch-slider"><div class="top-switch-on"><div class="top-switch-text"></div></div><div class="top-switch-off"><div class="top-switch-text"></div></div></label>'},__eventBindingList:function(){var shadowInput=this.querySelector("label input");return{__eventMouseClick:function(func){shadowInput.onclick=func},__eventMousePressed:function(func){shadowInput.onmousedown=func},__eventMouseReleased:function(func){shadowInput.onmouseup=func},__eventMouseDblclick:function(func){shadowInput.ondblclick=func},__eventKeyPressed:function(func){shadowInput.onkeydown=func},__eventKeyTyped:function(func){shadowInput.onkeypress=func},__eventKeyReleased:function(func){shadowInput.onkeyup=func},__eventMouseEnter:function(func){shadowInput.onmouseenter=func},__eventMouseExit:function(func){shadowInput.onmouseleave=func},__eventMouseMove:function(func){shadowInput.onmousemove=func},__eventFocused:function(func){shadowInput.onfocus=func},__eventLostFocused:function(func){shadowInput.onblur=func}}},__initialize:function(){this.__initTrueFalseValue();this.__initChecked();this.__updateId();this.__updateTextOn();this.__updateTextOff();this.__updateTextColor();this.__updateChecked();this.__updateDisabled();this.__initBindingEvent()},__initLineHeight:function(){var textOn=this.querySelector(".top-switch-on");var textOff=this.querySelector(".top-switch-off");var _this=this;setTimeout(function(){var height=_this.querySelector(".top-switch-root").offsetHeight+"px";textOn.style.lineHeight=height;textOff.style.lineHeight=height})},on:function(){this.checked=this.trueValue;this.__updateChecked()},off:function(){this.checked=this.falseValue;this.__updateChecked()},toggle:function(){if(this.__isCheckedTrue()){this.off()}else{this.on()}},__updateChecked:function(dataBound){var shadowBackground=this.querySelector(".top-switch-root").querySelector(".top-switch-background");if(this.__isCheckedTrue())shadowBackground.checked=true;else shadowBackground.checked=false;if(dataBound!==true){this.updateData("checked");this.updateDevice("checked")}if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("change"),this.checked)}else{this.__dispatchEvent(new Event("change"),this.checked)}},__updateDisabled:function(){var shadowInput=this.querySelector("input");var shadowLabel=this.querySelector("label");this.__setDisabled(shadowInput);this.__setDisabled(shadowLabel);if(this.disabled==="true"||this.disabled===true)this.__detachBindingEvent();else if(this.disabled==="false"||this.disabled===false)this.__initBindingEvent()},__updateTextOn:function(){var switchRoot=this.querySelector(".top-switch-root");if(switchRoot){var shadowOn=switchRoot.querySelector(".top-switch-on").querySelector(".top-switch-text");shadowOn.textContent=this.textOn}},__updateTextOff:function(){var switchRoot=this.querySelector(".top-switch-root");if(switchRoot){var shadowOff=switchRoot.querySelector(".top-switch-off").querySelector(".top-switch-text");shadowOff.textContent=this.textOff}},__updateTextColor:function(){var shadowOn=this.querySelector(".top-switch-on").querySelector(".top-switch-text");var shadowOff=this.querySelector(".top-switch-off").querySelector(".top-switch-text");if(shadowOn){shadowOn.style.color=this.textColor;shadowOff.style.color=this.textColor}},__initBindingEvent:function(){var _this=this;var shadowLabel=this.querySelector("input");if(this.labelClickEvent===undefined){this.labelClickEvent=function(e){_this.toggle()}}shadowLabel.removeEventListener("click",this.labelClickEvent);shadowLabel.addEventListener("click",this.labelClickEvent)},__detachBindingEvent:function(){var shadowLabel=this.querySelector("input");shadowLabel.removeEventListener("click",this.labelClickEvent)},getTopStyle:function(){this.topstyle=this.querySelector(".top-switch-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-switch-root").style[key]=value;this.topstyle=this.querySelector(".top-switch-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-switch-root").style.cssText=this.topstyle}};Top.Widget.Switch=function(){Switch.prototype=Object.create(Top.Widget.prototype);Switch.prototype.constructor=Switch;function Switch(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-switch");this.template.innerHTML='<label class="top-switch-root"><input class="top-switch-background" type="checkbox"/><div class="top-switch-slider"><div class="top-switch-on"><div class="top-switch-text"></div></div><div class="top-switch-off"><div class="top-switch-text"></div></div></label>'}this.id=this.template.id}Switch.create=function(element){return new Switch(element)};Switch.prototype.on=function(){this.template.on()};Switch.prototype.off=function(){this.template.off()};Switch.prototype.toggle=function(){this.template.toggle()};Switch.prototype.getState=function(){return this.template.checked};return Switch}();TopTablayout={is:"top-tablayout",behaviors:[TopWidgetBehavior,TopLayoutBehavior],properties:{tabs:String,selected:String,onSelect:String,onDeselect:String,paginate:{type:String,value:false},tabPaging:Object,maxTab:Number,currentPage:Number,nextPage:Number,prevPage:Number,onTabchange:String,onTabclick:String,onPlusclick:String,onClose:String,onTabclose:String,tabMaxWidth:String,custommenu:String,tabTooltip:String,hiddenTabArray:Array,plusbutton:{type:String,value:true},menuFocus:{type:String,value:false},tabIndex:{type:String,value:"0"},childString:String},__ready:function(){this.tabId=this.id||Top.Util.guid();this.__initI18n("title");this.initialChilds();this.__updateId();this.__updateName();this.__initialClassname();this.closedTabId="";this.checkTabClassName();this.renderLayout();this.initClosable();this.__load();if(this.paginate===true||this.paginate==="true"){this.tabPaginate();this.resizeWindow()}this.__attachClickEvent();this.__attachKeyEvent();this.__updateSelected();this.__updateTabTooltip();this.__updateTabIndex()},__updateTabTooltip:function(){if(this.tabTooltip===true||this.tabTooltip==="true")this.attachTabTooltip()},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.setAttribute("name",this.name)}},appendTemplate:function(){this.innerHTML='<div class="top-tablayout-root">'+this.innerHTML+"</div>"},initialChilds:function(){this.childs=[];for(var i=0;i<this.childRoot.children.length;i++){this.childRoot.children[i].layoutParent=this;if(Top.Util.__isTopWidget(this.childRoot.children[i].tagName))this.childs.push(this.childRoot.children[i])}},initializeChildRoot:function(){return this.querySelector(".top-tablayout-root")},__initEventInternal:function(){this.__addEventByAttr("tabchange");this.__addEventByAttr("tabclick");this.__addEventByAttr("close");this.__addEventByAttr("plusclick")},initializeChildRoot:function(){return this.querySelector(".top-tablayout-root")},__attached2:function(){this.__updateVerticalAlignment();this.attachTooltip()},checkTabClassName:function(){var tabClassName="";var checkClass=[];checkClass.push(/\b(tab_01)\b/g);checkClass.push(/\b(tab_02)\b/g);checkClass.push(/\b(tab_03)\b/g);checkClass.push(/\b(tab_04)\b/g);checkClass.push(/\b(light)\b/g);checkClass.push(/\b(dark)\b/g);for(var i=0;i<checkClass.length;i++){if(checkClass[i].test(this.classList)){var j=i+1;switch(i){case 0:case 1:case 2:case 3:{tabClassName="tab_0"+j;break}case 4:{tabClassName="light";break}case 5:{tabClassName="dark";break}}}}this.tabClassName=tabClassName},initClosable:function(){},onLoad:function(func){if(this.__loadEvent===undefined)this.__loadEvent=[];this.__loadEvent.push(func)},isLoaded:function(){return!!this.__isLoaded},__load:function(){this.__isLoaded=true;if(this.__loadEvent!==undefined){for(var i=0,len=this.__loadEvent.length;i<len;i++){this.__loadEvent[i]()}}},__addChildrenLoadEvent:function(fn){Top.App.onWidgetAttach(this.id,fn)},complete:function(){this.refresh(true);var numberPattern=/^[0-9]*$/;if(typeof this.selected==="number"){this.selectTabByIndex(this.selected)}else if(numberPattern.test(this.selected)){this.selectTabByIndex(parseInt(this.selected))}else{this.selectTab(this.selected)}},refresh:function(__isFromComplete){__isFromComplete?this.renderLayout(true):this.renderLayout();this.__attachClickEvent();this.__attachKeyEvent();this.__updateSelected();this.__updateVerticalAlignment()},resizeWindow:function(){var _this=this;top$(window).resize(top$.throttle(500,false,function(e){_this.tabPaginate(false)}))},tabPaginate:function(tabSelect){var _this=this;var container=this.getElementsByClassName("top-tablayout-container")[0];if(!this.tabs.length||!container)return;var table=container.getElementsByTagName("table")[0];var tabTr=this.getElementsByTagName("tr")[0];var firstTab=tabTr.children[1];var navigatorTab=tabTr.children[0];var prevNaviTab=this.querySelectorAll(".top-tablayout-tab-btn")[0];var nextNaviTab=this.querySelectorAll(".top-tablayout-tab-btn")[1];var lastTab=tabTr.children[tabTr.children.length-4];if(this.tableWidth===undefined){this.tableWidth=table.clientWidth}if(this.firstTab_clientWidth===undefined){this.firstTab_clientWidth=firstTab.clientWidth}this.display_tab_length=Math.floor(container.clientWidth/this.firstTab_clientWidth);if(this.display_tab_length>this.tabs.length+1){this.display_tab_length=this.tabs.length+1}if(tabSelect!==false){for(var i=1;i<this.display_tab_length;i++){tabTr.children[i].style.display="table-cell"}for(var i=this.display_tab_length;i<tabTr.children.length-3;i++){tabTr.children[i].style.display="none"}}if(this.tableWidth>container.clientWidth+navigatorTab.clientWidth*2){if(tabSelect!==false){for(var i=1;i<this.display_tab_length;i++){tabTr.children[i].style.display="table-cell"}for(var i=this.display_tab_length;i<tabTr.children.length-3;i++){tabTr.children[i].style.display="none"}}}var alt_display_num=0;if(this.hiddenTabArray!==undefined){for(var i=1;i<this.display_tab_length;i++){for(var j=0;j<this.hiddenTabArray.length;j++){if(this.hiddenTabArray[j]===tabTr.children[i].id){tabTr.children[i].style.display="none";alt_display_num++}}}}var last_tab=tabTr.children[this.display_tab_length-1];for(var i=1;i<tabTr.children.length;i++){if(last_tab&&last_tab.id===tabTr.children[i].id){for(var j=0;j<alt_display_num;j++){if(tabTr.children[i+j+1].classList[0]==="top-tablayout-tab-wrapper"){break}if(tabTr.children[i+j+1]!==undefined){tabTr.children[i+j+1].style.display="table-cell"}}}}if(lastTab.style.display!=="table-cell"){nextNaviTab.style.display="table-cell";var paginateList=_this.querySelector(".tap_paginate-next-list");var flag=false;paginateList.innerHTML="";for(var i=tabTr.children.length-4;i>0;i--){if(tabTr.children[i].style.display==="none"){var thisTab=_this.tabs[i-1];var tab=document.createElement("li");tab.setAttribute("id",thisTab.id);tab.classList.add("list_item");tab.classList.add(this.tabClassName);if(thisTab.disabled===true){tab.classList.add("tab-disabled")}tab.innerText=thisTab.text;if(thisTab.icon!==undefined&&thisTab.icon!==null){var icon=document.createElement("i");icon.classList.add("icon");icon.classList.add(thisTab.icon);icon.classList.add(this.tabClassName);icon.style.marginRight="13px";tab.appendChild(icon)}paginateList.insertAdjacentElement("afterbegin",tab)}else{break}}}else{tabTr.children[tabTr.children.length-3].style.display="none"}if(firstTab.style.display!=="table-cell"){prevNaviTab.style.display="table-cell";prevNaviTab.children[0].style.display="table-cell";var prev_paginateList=container.querySelector(".tap_paginate-prev-list");prev_paginateList.innerHTML="";var flag=false;for(var i=1;i<tabTr.children.length-3;i++){if(tabTr.children[i].style.display==="none"){var thisTab=_this.tabs[i-1];var tab=document.createElement("li");tab.setAttribute("id",thisTab.id);tab.classList.add("list_item");tab.classList.add(this.tabClassName);if(thisTab.disabled===true){tab.classList.add("tab-disabled")}tab.innerText=thisTab.text;if(thisTab.icon!==undefined&&thisTab.icon!==null){var icon=document.createElement("i");icon.classList.add("icon");icon.classList.add(thisTab.icon);icon.classList.add(this.tabClassName);icon.style.marginRight="13px";tab.appendChild(icon)}prev_paginateList.appendChild(tab);flag=true}else if(flag===true){break}}}else{prevNaviTab.children[0].style.display="none"}this.makeCustomMenu()},makeCustomMenu:function(){var container=this.getElementsByClassName("top-tablayout-container")[0];if(this.custommenu){if(this.querySelector(".tab_custommenu")){return}var custommenu=document.createElement("div");custommenu.classList.add("tab_custommenu");custommenu.classList.add(this.tabClassName);var custommenu_ul=document.createElement("ul");for(var i=0;i<this.custommenu.length;i++){var custommenu_li=document.createElement("li");custommenu_li.innerText=this.custommenu[i].text;custommenu_li.classList.add("custommenu_item");custommenu_li.classList.add(this.tabClassName);custommenu_ul.appendChild(custommenu_li)}custommenu.appendChild(custommenu_ul);this.appendChild(custommenu)}},__attachKeyEvent:function(){var _this=this;Top.EventManager.on("keydown",this.id,function(e){if(e.keyCode===13||e.keyCode===32)e.target.click()})},__attachClickEvent:function(){var _this=this;var container=this.querySelector("#"+this.tabId+".top-tablayout-container");Top.EventManager.on("click",this.id,".top-tablayout-container .top-tablayout-tab-wrapper",function(e){_this.updateData("selected");_this.selected=e.target.id;if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("tabclick"))}else{_this.__dispatchEvent(new Event("tabclick"))}_this.__tabChangeEvent(e.target.children[0])});Top.EventManager.on("click",this.id,".top-tablayout-container .top-tablayout-next",function(e){var list=_this.querySelector(".tab_paginate-container .tap_paginate-next-list");_this.__tabPaginateEvent(list,e,true);e.stopPropagation()});Top.EventManager.on("click",this.id,".top-tablayout-container .top-tablayout-prev",function(e){var list=_this.querySelector(".tab_paginate-prev-container .tap_paginate-prev-list");_this.__tabPaginateEvent(list,e,true);e.stopPropagation()});_this.cnt=0;Top.EventManager.on("click",this.id,".top-tablayout-container .top-tablayout-plus",function(e){if(_this.onPlusclick){if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("plusclick"))}else{_this.__dispatchEvent(new Event("plusclick"))}}else _this.__tabPlusEvent(_this);e.stopPropagation()});Top.EventManager.on("click",this.id,".top-tablayout-container li.list_item",function(e){if(e.target.classList.contains("tab-disabled"))return;_this.__tabDisplayEvent(e);e.stopPropagation()});Top.EventManager.on("click",this.id,".top-tablayout-container .td_menu",function(e){_this.__tabMenuOpenCloseEvent(e);e.stopPropagation()});Top.EventManager.on("click",this.id,".tab_custommenu .custommenu_item",function(e){_this.__tabMenuEvent(e);e.stopPropagation()});Top.EventManager.on("click",this.id,".top-tablayout-container .close_btn",function(e){var target=e.target.parentNode.parentNode.id;_this.closedTabId=target;_this.remove(target);_this.selectTabByIndex(0);e.stopPropagation()})},attachTabTooltip:function(){var _this=this;var container=this.querySelector("#"+this.tabId+".top-tablayout-container");var thisPageId=Top.App.getCurrentPage().id;top$(container).off("mouseenter",".top-tablayout-tab-wrapper").on("mouseenter",".top-tablayout-tab-wrapper",function(e){var textSpan=this.querySelector(".tab_text");if(!textSpan)return;var text=textSpan.innerText;var tooltip=document.querySelector("#"+thisPageId+" .top-tooltip-text");tooltip.innerText=text;tooltip.style.display="inline-block";tooltip.style.left=e.clientX+2+"px";tooltip.style.top=e.clientY+5+"px";e.stopPropagation()});top$(container).off("mouseleave",".top-tablayout-tab-wrapper").on("mouseleave",".top-tablayout-tab-wrapper",function(e){var tooltip=document.querySelector("#"+thisPageId+" .top-tooltip-text");tooltip.innerText="";tooltip.style.display="none";e.stopPropagation()})},__tabCloseEvent:function(e){var target=e.target.parentNode.parentNode;for(var i=0;i<this.tabs.length;i++){if(this.tabs[i].id===target.id){this.tabs.splice(i,1);break}}for(var i=1;i<this.childRoot.children.length;i++){var currentChild=this.childRoot.children[i];if(currentChild.layoutTabId!==undefined&&currentChild.layoutTabId===target.id){currentChild.remove();break}if(currentChild.getAttribute("layout-tab-id")!==null&&currentChild.getAttribute("layout-tab-id")===target.id){currentChild.remove();break}var layoutTabName="";if(currentChild.getAttribute("layout-tab-name")!==null)layoutTabName=this.id+"_"+currentChild.getAttribute("layout-tab-name")+"_"+(i-1);else layoutTabName=this.id+"_"+currentChild.layoutTabName+"_"+(i-1);if(layoutTabName===target.id){currentChild.remove();break}}this.renderLayout(true);this.selectTabByIndex(0)},__tabMenuOpenCloseEvent:function(e){var container=this.querySelector(".top-tablayout-container");var containerLeft=top$(container).offset().left||0;var menuLeft=top$(e.target).offset().left;
var custommenu_ul=this.querySelector(".tab_custommenu");if(custommenu_ul===null)return;if(custommenu_ul.children[0].style.display!=="block"){custommenu_ul.style.left=menuLeft-containerLeft+"px";custommenu_ul.children[0].style.display="block"}else{custommenu_ul.children[0].style.display="none"}this.__currentTabText=e.target.parentNode.innerText;this.__currentTab=e.target.parentNode.parentNode},__tabMenuEvent:function(e){for(var i=0;i<this.custommenu.length;i++){if(this.custommenu[i].text===e.target.innerText){if(typeof this.custommenu[i].onClick==="string")var callback=Top.Util.namespace(this.custommenu[i].onClick,this);else var callback=this.custommenu[i].onClick;var thisTab;for(var j=0;j<this.tabs.length;j++){if(this.tabs[j].text===this.__currentTabText){var thisTab=this.tabs[j];break}}if(callback)callback(this.__currentTab,thisTab);this.__currentTabText=undefined;this.__currentTab=undefined;var custommenu_ul=this.querySelector(".tab_custommenu");custommenu_ul.children[0].style.display="none";break}}},__tabPlusEvent:function(_this,tab){if(tab){var new_tab=tab}else{var new_tab={id:"new_"+_this.cnt,text:"new_"+_this.cnt};_this.cnt++}this.tabs.push(new_tab);var tr=this.querySelector("tr");var cnt=0;var tab_td=document.createElement("td");tab_td.id=new_tab.id;tab_td.classList.add("top-tablayout-tab-wrapper");tab_td.classList.add("tabs");tab_td.classList.add(this.tabClassName);var td_div=document.createElement("div");td_div.classList.add("top-tablayout-tab");td_div.classList.add("tab_"+new_tab.id);td_div.classList.add(this.tabClassName);var td_span=document.createElement("span");td_span.classList.add("tab_text");td_span.classList.add(this.tabClassName);td_span.innerHTML=this.__i18n(new_tab.text);if(new_tab.closable===true||new_tab.closable==="true"){var td_close=document.createElement("span");td_close.classList.add("close_btn");td_close.classList.add(this.tabClassName);td_div.appendChild(td_close)}td_div.appendChild(td_span);tab_td.appendChild(td_div);if(tr.children[tr.children.length-4].style.display==="none"){tab_td.style.display="none"}tr.children[tr.children.length-3].insertAdjacentElement("beforeBegin",tab_td);if(_this.custommenu!==undefined){var td_menu=document.createElement("span");td_menu.classList.add("td_menu");td_menu.classList.add(this.tabClassName);td_menu.id=new_tab.id+"_menuBtn";td_div.appendChild(td_menu);if(new_tab.closable===true||new_tab.closable==="true")td_menu.style.marginRight="-25%";if(this.menuFocus==="true"||this.menuFocus===true){td_menu.style.display="none"}}this.objTabs[new_tab.id]=new_tab;this.tabPaginate()},__tabPaginateEvent:function(list,e,flag){if(list.style.display!="none")list.style.display="none";else list.style.display="block";if(flag===true){target=e.target.tagName==="SPAN"?e.target.parentNode:e.target;left=top$(target).offset().left;aa=top$(target).offset().top;list.style.left=left+"px";list.style.top=aa+target.clientHeight+"px"}},__tabDisplayEvent:function(e){var list=this.querySelector(".tab_paginate-container .tap_paginate-next-list");list.style.display="none";var list=this.querySelector(".tab_paginate-prev-container .tap_paginate-prev-list");list.style.display="none";var tab_tr=this.querySelector("tr");var listLength=this.display_tab_length;var halfLength=Math.floor(listLength/2);var selectedIndex;for(var i=1;i<tab_tr.children.length-3;i++){if(tab_tr.children[i].id===e.target.id){tab_tr.children[i].style.display="table-cell";selectedIndex=i;this.__tabClick(tab_tr.children[i].children[0])}else{tab_tr.children[i].style.display="none"}}if(selectedIndex<=halfLength){for(var i=1;i<listLength;i++){tab_tr.children[i].style.display="table-cell"}}for(var j=selectedIndex-1;j>selectedIndex-halfLength;j--){tab_tr.children[j].style.display="table-cell";if(j<1)break}for(var j=selectedIndex+1;j<selectedIndex+halfLength;j++){tab_tr.children[j].style.display="table-cell";if(j>tab_tr.children.length-4)break}this.tabPaginate(false)},__tabClick:function(target){var __this;var thisTabLayout=this;var tab_tr=this.querySelector("tr");if(target.tagName==="DIV")__this=target.parentNode;else if(target.tagName==="SPAN")__this=target.parentNode.parentNode;if(!__this||__this.classList.contains("tab-disabled"))return;for(var j=0;j<tab_tr.children.length;j++){tab_tr.children[j].children[0].classList.remove("active")}__this.children[0].classList.add("active");thisTabLayout.updateData("selected");thisTabLayout.selected=__this.id;thisTabLayout.__addChildrenLoadEvent(function(){if(thisTabLayout.select){thisTabLayout.select(thisTabLayout.objTabs[__this.id])}if(Top.Util.Browser.isIE()){thisTabLayout.__dispatchEvent(new CustomEvent("tabchange"))}else{thisTabLayout.__dispatchEvent(new Event("tabchange"))}if(thisTabLayout.__isIDETab){var selectedChild=thisTabLayout.objTabs[__this.id].layout;if(selectedChild){if(thisTabLayout.objTabs[__this.id].__isCalled===false){var tmp=thisTabLayout.__setSelectedWidgetSize(selectedChild);thisTabLayout.objTabs[__this.id].__isCalled=true}selectedChild.style.display="";if(typeof selectedChild.adjustSize==="function"){selectedChild.adjustSize()}if(thisTabLayout.objTabs[__this.id].isLineHeightSet===false){var layouts=selectedChild.querySelectorAll('top-linearlayout:not([orientation="vertical"])');if(layouts){for(var i=0;i<layouts.length;i++){if(layouts[i].__isAttached&&typeof layouts[i].__setLineHeight==="function"&&layouts[i].id){layouts[i].__setLineHeight()}}}thisTabLayout.objTabs[__this.id].isLineHeightSet=true}var charts=selectedChild.querySelectorAll("top-chart");if(charts){for(var i=0;i<charts.length;i++){var chart=charts[i].chart;if(chart)chart.flush()}}var tableviews=selectedChild.getElementsByTagName("TOP-TABLEVIEW");var len=tableviews.length;for(var i=0;i<len;i++){tableviews[i].__adjustBytablayout()}if(selectedChild.getAttribute("layout-horizontal-alignment")){thisTabLayout.removeTopStyle("text-align");thisTabLayout.setTopStyle("text-align",selectedChild.getAttribute("layout-horizontal-alignment"))}if(selectedChild.getAttribute("layout-vertical-alignment")){thisTabLayout.hasVerticalAlign=true;selectedChild.setTopStyle("line-height","normal")}}for(var k=1;k<thisTabLayout.childRoot.children.length;k++){if(TopRuntime.topWidgets[thisTabLayout.childRoot.children[k].tagName.toLowerCase()]!==undefined){if(selectedChild!=thisTabLayout.childRoot.children[k]){thisTabLayout.childRoot.children[k].style.display="none"}}}}})},__tabChangeEvent:function(event){var custommenuBtns=this.querySelectorAll(".td_menu");if(custommenuBtns.length&&(this.menuFocus==="true"||this.menuFocus===true)){for(var i=0;i<custommenuBtns.length;i++)custommenuBtns[i].style.display="none"}this.__tabClick(event);var custommenu=this.querySelector(".tab_custommenu");if(custommenu!==null)custommenu.children[0].style.display="none";var paginate=this.querySelector(".tab_paginate-container");if(paginate!==null)paginate.children[0].style.display="none";if(this.navigator===true||this.navigator==="true"){this.tabPaginate(false)}var custommenuBtn=this.querySelector(".active").querySelector(".td_menu");if(custommenuBtn&&(this.menuFocus==="true"||this.menuFocus===true)){custommenuBtn.style.display="block"}},__updateLayoutTabName:function(){var tabs=this.tabs;var root=this.childRoot;for(var i=1;i<root.children.length;i++){var child=root.children[i];if(child.getAttribute("layout-tab-name")){var tabName=this.__i18n(child.getAttribute("layout-tab-name"));var current_id=this.id+"_"+tabName.replace(/ /g,"")+"_"+(i-1);if(child.getAttribute("layout-tab-id")!==undefined&&child.getAttribute("layout-tab-id")!==null)current_id=child.getAttribute("layout-tab-id");this.tabs[i-1].id=current_id;this.tabs[i-1].text=tabName}}for(var i=0;i<tabs.length;i++){var td_div=this.childRoot.querySelector(".top-tablayout-tab.tab_"+i);var td_span=td_div.querySelector(".tab_text");td_span.innerHTML=this.__i18n(this.tabs[i].text)}},createTab:function(containerElement,thisTabLayout){var tab_table=document.createElement("table");tab_table.cellspacing="0";tab_table.cellpadding="1";tab_table.classList.add("top-tablayout-table");tab_table.width="100%";var tab_tbody=document.createElement("tbody");var tab_tr=document.createElement("tr");var selectedId=typeof this.selected!=="string"?["0"]:this.selected.split("_");var selectedTabIndex=parseInt(selectedId[selectedId.length-1]);this.tabClickFuct=[];var _this=this;for(var i=0;i<this.tabs.length;i++){var tab_td=document.createElement("td");tab_td.id=this.tabs[i].id;var _this=this;tab_td.classList.add("top-tablayout-tab-wrapper");tab_td.classList.add("tabs");tab_td.classList.add(this.tabClassName);if(this.tabs[i].disabled===true){tab_td.classList.add("tab-disabled")}var td_div=document.createElement("div");td_div.classList.add("top-tablayout-tab");td_div.classList.add("tab_"+i);td_div.classList.add(this.tabClassName);var td_span=document.createElement("span");td_span.classList.add("tab_text");td_span.classList.add(this.tabClassName);td_span.innerHTML=this.__i18n(this.tabs[i].text);td_div.appendChild(td_span);if(this.tabs[i].closable===true||this.tabs[i].closable==="true"){var td_close=document.createElement("span");td_close.classList.add("close_btn");td_close.classList.add(this.tabClassName);td_div.appendChild(td_close)}if(_this.custommenu!==undefined){var td_menu=document.createElement("span");td_menu.classList.add("td_menu");td_menu.classList.add(this.tabClassName);td_menu.id=this.tabs[i].id+"_menuBtn";td_div.appendChild(td_menu);if(this.tabs[i].closable===true||this.tabs[i].closable==="true")td_menu.style.marginRight="-25%";if(this.menuFocus==="true"||this.menuFocus===true){td_menu.style.display="none"}}tab_td.appendChild(td_div);tab_tr.appendChild(tab_td)}if(this.paginate===true||this.paginate==="true"){var nextSpan=document.createElement("td");nextSpan.classList.add("top-tablayout-tab-wrapper");nextSpan.classList.add("top-tablayout-tab-btn");nextSpan.classList.add(this.tabClassName);nextSpan.style.display="none";var div=document.createElement("div");div.classList.add("top-tablayout-next");div.classList.add(this.tabClassName);var span=document.createElement("span");span.classList.add("list");span.classList.add(this.tabClassName);span.style.marginLeft="-8px";div.appendChild(span);nextSpan.appendChild(div);if(tab_tr.children.length)tab_tr.children[tab_tr.children.length-1].insertAdjacentElement("afterend",nextSpan);else tab_tr.appendChild(nextSpan);var prevSpan=document.createElement("td");prevSpan.classList.add("top-tablayout-tab-wrapper");prevSpan.classList.add("top-tablayout-tab-btn");prevSpan.classList.add(this.tabClassName);prevSpan.style.display="none";var div=document.createElement("div");div.classList.add("top-tablayout-prev");div.classList.add(this.tabClassName);var span=document.createElement("span");span.classList.add("list");span.classList.add(this.tabClassName);span.style.marginLeft="-8px";div.appendChild(span);prevSpan.appendChild(div);tab_tr.children[0].insertAdjacentElement("beforeBegin",prevSpan);var plusSpan=document.createElement("td");plusSpan.classList.add("top-tablayout-tab-wrapper");plusSpan.classList.add(this.tabClassName);var plusDiv=document.createElement("div");plusDiv.classList.add("top-tablayout-plus");plusDiv.classList.add(this.tabClassName);var span=document.createElement("span");span.style.marginLeft="-8px";plusDiv.appendChild(span);plusSpan.appendChild(plusDiv);tab_tr.children[tab_tr.children.length-1].insertAdjacentElement("afterend",plusSpan);if(this.plusbutton===false||this.plusbutton==="false"){plusSpan.style.display="none"}var container=this.getElementsByClassName("top-tablayout-container")[0];var prev_paginateList=document.createElement("div");prev_paginateList.classList.add("tap_paginate-prev-list");prev_paginateList.classList.add(this.tabClassName);prev_paginateList.style.display="none";var paginatePrevContainer=document.createElement("div");paginatePrevContainer.classList.add("tab_paginate-prev-container");paginatePrevContainer.classList.add(this.tabClassName);paginatePrevContainer.appendChild(prev_paginateList);container.appendChild(paginatePrevContainer);var paginateContainer=document.createElement("div");paginateContainer.classList.add("tab_paginate-container");paginateContainer.classList.add(this.tabClassName);var paginateList=document.createElement("div");paginateList.classList.add("tap_paginate-next-list");paginateList.classList.add(this.tabClassName);paginateList.style.display="none";paginateContainer.appendChild(paginateList);container.appendChild(paginateContainer)}var tab_td=document.createElement("td");tab_td.id=this.id+"_right";tab_td.width="100%";var td_div=document.createElement("div");td_div.classList.add("top-tablayout-tab");td_div.classList.add(this.tabClassName);td_div.classList.add("last");tab_td.appendChild(td_div);tab_tr.appendChild(tab_td);tab_tbody.appendChild(tab_tr);tab_table.appendChild(tab_tbody);containerElement.appendChild(tab_table);if(this.__isIDETab){var selectedId=typeof this.selected!=="string"?["0"]:this.selected.split("_");var selectedTabIndex=parseInt(selectedId[selectedId.length-1]);var child=this.childRoot.children[selectedTabIndex+1];var layoutRoot=this.childRoot;layoutRoot.style.overflow="hidden";for(var k=1;k<thisTabLayout.childRoot.children.length;k++){if(TopRuntime.topWidgets[thisTabLayout.childRoot.children[k].tagName.toLowerCase()]!==undefined){thisTabLayout.childRoot.children[k].style.display="none"}}}if(this.custommenu){this.makeCustomMenu()}},renderLayout:function(hasNewChild){var containerElement=this.querySelector("#"+this.tabId+".top-tablayout-container");var root=this.childRoot;if(containerElement==null){containerElement=document.createElement("div");containerElement.className="top-tablayout-container "+this.tabClassName;containerElement.id=this.tabId;root.insertBefore(containerElement,root.firstChild)}if(hasNewChild){while(containerElement.firstChild){containerElement.removeChild(containerElement.firstChild)}}if(typeof this.tabs==="string"){this.tabs=Top.Util.namespace(this.tabs,this)}else if((!this.tabs||hasNewChild)&&Top.App.__compatibleWithTOP()){this.tabs=[];for(var i=1;i<root.children.length;i++){var child=root.children[i];if(child.getAttribute("layout-tab-name")){var tabName=this.__i18n(child.getAttribute("layout-tab-name"));var tabDisabled=child.getAttribute("layout-tab-disabled")==="true"||child.getAttribute("layout-tab-disabled")===true?true:false;var current_id=this.id+"_"+tabName.replace(/ /g,"")+"_"+(i-1);if(child.getAttribute("layout-tab-id")!==undefined&&child.getAttribute("layout-tab-id")!==null)current_id=child.getAttribute("layout-tab-id");var closable=false;if(child.attributes["layout-closable"]){closable=child.attributes["layout-closable"].nodeValue}var image=null;if(child.attributes["layout-tab-icon"]){image=child.attributes["layout-tab-icon"].nodeValue}var firstLayout=null;if(this.childString!==undefined)firstLayout=this.childString[i-1];this.tabs.push({id:current_id,text:tabName,layout:child,disabled:tabDisabled,__isCalled:false,firstLayout:firstLayout,closable:closable,image:image,isLineHeightSet:false})}}this.__isIDETab=true}var len=this.tabs.length;this.objTabs={};for(var i=0;i<len;i++){this.objTabs[this.tabs[i].id]=this.tabs[i]}if(typeof this.onSelect=="string"){this.select=Top.Util.namespace(this.onSelect,this)}if(typeof this.onDeselect=="string"){this.deselect=Top.Util.namespace(this.onDeselect,this)}if(!this.beforeTabId){this.beforeTabId=this.selected}if(typeof this.custommenu==="string"){this.custommenu=Top.Util.namespace(this.custommenu,this)}this.createTab(containerElement,this)},__disableTab:function(tabId,trueOrFalse){var _this=this;var tabID=("#"+tabId).replace(/&/gi,"\\&").replace("/","\\/");var tab=this.querySelector(tabID);var flag=false;var index=0;if(tab&&(trueOrFalse===true||trueOrFalse==="true")){tab.classList.add("tab-disabled");for(var i=0;i<this.tabs.length;i++){if(this.tabs[i].id===tabId){this.tabs[i].disabled=true;if(tab.querySelector(".active"))tab.querySelector(".active").classList.remove("active");index=i}if(flag===false&&!this.tabs[i].disabled==true){this.selectTab(this.tabs[i].id);flag=true}}if(flag===false&&this.childRoot.children.length>1){this.childRoot.children[index+1].style.display="none"}}else if(tab&&!trueOrFalse){tab.classList.remove("tab-disabled");for(var i=0;i<this.tabs.length;i++){if(this.tabs[i].id===tabId){this.tabs[i].disabled=false;break}}}},updateTab:function(tabId,tabInfo){var tabs=this.tabs;var changedId=false;var changedText=false;var changedDisabled=false;for(var i=0;i<tabs.length;i++){if(tabs[i].id===tabId){Object.keys(tabInfo).forEach(function(key){if(key==="id")changedId=tabInfo[key];if(key==="text")changedText=tabInfo[key];if(key==="disabled")changedDisabled=tabInfo[key];tabs[i][key]=tabInfo[key]});break}}var tabID=("#"+tabId).replace(/&/gi,"\\&").replace("/","\\/");var table=this.querySelector(".top-tablayout-table");var tab=table.querySelector(tabID);this.__disableTab(tabId,changedDisabled);if(changedId){tab.id=changedId}if(changedText){tab.querySelector(".tab_text").innerText=changedText}},add:function(tab){this.tabs.push(tab);this.__updateTabs()},insert:function(index,tab){this.tabs.splice(index,0,tab);this.__updateTabs()},remove:function(id,startIndex,count){var index=-1;if(id){for(var i=0,len=this.tabs.length;i<len;i++){if(this.tabs[i].id===id){index=i;break}}if(index>-1){var removedTab=this.querySelector("#"+id);var layout=this.tabs[index].layout;removedTab.remove();if(layout){var removedLayout=this.querySelector("#"+layout.id);removedLayout.remove()}this.tabs.splice(index,1)}}else{var cnt=count?count:this.tabs.length;var startIndex=startIndex?startIndex:0;var endIndex=startIndex+cnt;var tabs=this.querySelector(".top-tablayout-table").querySelectorAll(".tabs");for(var i=startIndex;i<endIndex;i++){if(!tabs[i])break;tabs[i].remove();layout=this.tabs[i].layout;if(layout){var removedLayout=this.querySelector("#"+layout.id);removedLayout.remove()}}this.tabs.splice(startIndex,cnt)}var detail={detail:{id:this.closedTabId}};if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("close",detail))}else{this.__dispatchEvent(new CustomEvent("close",detail))}},current:function(){return this.selected},selectTab:function(tabId){var selected=tabId?tabId:this.selected;if(!selected)return;var tabWrapper=this.childRoot.querySelector("#"+selected.replace(/\//g,"\\/").replace(/\&/g,"\\&"));if(selected&&tabWrapper)this.__tabChangeEvent(tabWrapper.children[0])},selectTabByIndex:function(index){if(this.tabs[index]!==undefined)this.selectTab(this.tabs[index].id)},focus:function(tabId){if(this.isLoaded()){if(this.selected&&this.childRoot.querySelector("#"+this.selected.replace(/\//g,"\\/").replace(/\&/g,"\\&")))this.childRoot.querySelector("#"+this.selected.replace(/\//g,"\\/").replace(/\&/g,"\\&")).children[0].classList.remove("active");this.selected=tabId;this.childRoot.querySelector("#"+this.selected.replace(/\//g,"\\/").replace(/\&/g,"\\&")).children[0].classList.add("active")}else{var _this=this;this.onLoad(function(){if(this.selected&&_this.childRoot.querySelector("#"+_this.selected.replace(/\//g,"\\/").replace(/\&/g,"\\&")))_this.childRoot.querySelector("#"+_this.selected.replace(/\//g,"\\/").replace(/\&/g,"\\&")).children[0].classList.remove("active");_this.selected=tabId;_this.childRoot.querySelector("#"+_this.selected.replace(/\//g,"\\/").replace(/\&/g,"\\&")).children[0].classList.add("active")})}},blur:function(){this.selected=undefined;this.childRoot.querySelector("div.active").classList.remove("active")},append:function(tab,htmlString,layoutTabInfo,callback){if(tab!==null)this.tabs.push(tab);var _this=this;if(Top.Util.getFileExtension(htmlString)==="html"){Top.Ajax.execute(htmlString,{success:function(data){_this.appendHtmlString(data);_this.initialChilds();TopRuntime._insertedNodesCallback();if(typeof callback==="function")callback();var appendedWidget=_this.childRoot.children[_this.childRoot.children.length-1];appendedWidget.appendedByTab=true;TopRuntime._srcRootNodesAttachedCallback();data=null;if(layoutTabInfo!==undefined){if(layoutTabInfo.layoutTabName!==undefined)appendedWidget.setAttribute("layout-tab-name",layoutTabInfo.layoutTabName);if(layoutTabInfo.layoutTabId!==undefined)appendedWidget.setAttribute("layout-tab-id",layoutTabInfo.layoutTabId);if(layoutTabInfo.layoutClosable!==undefined)appendedWidget.setAttribute("layout-closable",layoutTabInfo.layoutClosable)}_this.childString.push(appendedWidget.outerHTML);_this.renderLayout(true);_this.selectTab(_this.tabs[_this.tabs.length-1].id);if(typeof callback==="function")callback()}})}else{this.appendHtmlString(htmlString);this.initialChilds();TopRuntime._insertedNodesCallback();TopRuntime._srcRootNodesAttachedCallback();var appendedWidget=_this.childRoot.children[_this.childRoot.children.length-1];if(layoutTabInfo!==undefined){if(layoutTabInfo.layoutTabName!==undefined)appendedWidget.setAttribute("layout-tab-name",layoutTabInfo.layoutTabName);if(layoutTabInfo.layoutTabId!==undefined)appendedWidget.setAttribute("layout-tab-id",layoutTabInfo.layoutTabId);if(layoutTabInfo.layoutClosable!==undefined)appendedWidget.setAttribute("layout-closable",layoutTabInfo.layoutClosable)}_this.childString.push(appendedWidget.outerHTML);this.renderLayout(true);_this.selectTab(_this.tabs[_this.tabs.length-1].id);if(typeof callback==="function")callback()}},clear:function(tab){},setTitle:function(title){},attachTooltip:function(){},__updateSelected:function(){if(!isNaN(this.selected)){var selctedIndex=Number(this.selected);this.selectTabByIndex(selctedIndex)}else if(this.selected&&this.tabs!==undefined&&this.tabs.length>0){this.selectTab(this.selected)}},__updateTabs:function(){this.__isIDETab=false;var containerElement=this.querySelector("#"+this.tabId+".top-tablayout-container");while(containerElement.firstChild){containerElement.removeChild(containerElement.firstChild)}this.createTab(containerElement,this);if(this.paginate===true||this.paginate==="true"){this.tabPaginate()}},__updateTabMaxWidth:function(){},__refreshTab:function(tabId){for(var i=1;i<this.childRoot.children.length;i++){var layoutTabId=this.childRoot.children[i].getAttribute("layout-tab-id");if(layoutTabId===null){layoutTabId=this.id+"_"+this.childRoot.children[i].getAttribute("layout-tab-name")}if(tabId.startsWith(layoutTabId)){this.childRoot.children[i].remove();this.__insertAdjacentHTML(this.childRoot.children[i-1],this.childString[i-1]);this.initialChilds();TopRuntime._insertedNodesCallback();TopRuntime._srcRootNodesAttachedCallback();this.renderLayout(true);this.selectTab(this.selected)}}},__insertAdjacentHTML:function(dom,htmlString){var wrapper=document.createElement("div");wrapper.innerHTML=htmlString;this.initializeHtmlObjects(wrapper);while(wrapper.firstChild){if(wrapper.firstChild.tagName&&TopRuntime.topWidgets[wrapper.firstChild.tagName.toLowerCase()]!==undefined)TopRuntime.srcRootNode.push(wrapper.firstChild);dom.insertAdjacentElement("afterend",wrapper.firstChild)}},__setSelectedWidgetSize:function(selected){var layoutRoot=this.childRoot;var layoutContainer=this.childRoot.querySelector(".top-tablayout-container");var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto";var pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var ret=new Array;if(selected.getAttribute("layout-width")==="match_parent"){if(pWrapWidth){ret[0]=selected.setThisWidgetWidth(parseInt(selected.marginRight)+parseInt(selected.marginLeft)+"px")}else{ret[0]=selected.setThisWidgetWidth("100%")}}else{ret[0]=selected.layoutWidth}if(selected.layoutHeight==="match_parent"){if(pWrapHeight){ret[1]=selected.setThisWidgetHeight(parseInt(selected.marginTop)+parseInt(selected.marginBottom)+"px")}else{var spaceSize=layoutContainer.offsetHeight;var layoutHeight="100% - "+spaceSize+"px";ret[1]=selected.setThisWidgetHeight(layoutHeight)}}else{ret[1]=selected.layoutHeight}if(typeof selected.adjustSize==="function"){selected.adjustSize()}if(ret)return ret},__setWidgetSize:function(){return;var layoutRoot=this.childRoot;var layoutContainer=this.childRoot.querySelector(".top-tablayout-container");var pWrapWidth=!this.getAttribute("layout-width")||this.getAttribute("layout-width")==="auto";var pWrapHeight=!this.getAttribute("layout-height")||this.getAttribute("layout-height")==="auto";var root=this.childRoot;for(var i=1;i<root.children.length;i++){var item=root.children[i];if(item.getAttribute("layout-width")==="match_parent"){if(pWrapWidth){item.setThisWidgetWidth(parseInt(item.marginRight)+parseInt(item.marginLeft)+"px")}else{item.setThisWidgetWidth("100%")}}if(item.layoutHeight==="match_parent"){if(pWrapHeight){item.setThisWidgetHeight(parseInt(item.marginTop)+parseInt(item.marginBottom)+"px")}else{var spaceSize=layoutContainer.offsetHeight;var layoutHeight="100% - "+spaceSize+"px";item.setThisWidgetHeight(layoutHeight)}}}},__updateOnTabchange:function(){this.__addEventByAttr("tabchange")},__updateOnTabclick:function(){this.__addEventByAttr("tabclick")},__updateOnClose:function(){this.__addEventByAttr("close")},__updateOnPlusclick:function(){this.__addEventByAttr("plusclick")},__updatePaginate:function(){},__updateVerticalAlignment:function(){var vertical_align=this.getAttribute("vertical-alignment")||"top";if(this.getAttribute("vertical-alignment")||this.hasVerticalAlign){var layoutRoot=this.childRoot;var layoutContainer=this.childRoot.querySelector(".top-tablayout-container");if(layoutRoot.style.paddingTop==="")layoutRoot.style.paddingTop=0;if(layoutRoot.style.paddingBottom==="")layoutRoot.style.paddingBottom=0;this.removeTopStyle("line-height");this.setTopStyle("line-height",layoutRoot.clientHeight-layoutContainer.offsetHeight-parseInt(layoutRoot.style.paddingTop)-parseInt(layoutRoot.style.paddingBottom)+"px");layoutContainer.style.lineHeight="normal";for(var i=1;i<this.children.length;i++){var child=this.children[i];if(!child.getAttribute("layout-vertical-alignment")){child.setTopStyle("line-height","normal");child.setTopStyle("vertical-align",vertical_align)}}}},__updateTabIndex:function(){var td_list=this.querySelectorAll("td.top-tablayout-tab-wrapper");var tab_idx=this.tabIndex;td_list.forEach(function(td){if(tab_idx==="-1"||tab_idx===-1){td.removeAttribute("tabindex")}else{td.setAttribute("tabindex",tab_idx)}})},getChildren:function(selector){var topElements=[];if(selector){var elements=this.childRoot.querySelectorAll(selector)}else{var elements=this.childRoot.children}var len=elements.length;for(var i=0;i<len;i++){var item=elements[i];if(item.classList.contains("top-tablayout-container"))continue;topElements.push(Top.Dom.__selectImpl(item))}return topElements},hasChild:function(child){if(typeof child=="string"){var childId=child}else{var childId=child.id}if(this.childRoot.querySelector("#"+childId))return true;return false},addWidget:function(widget){var child=widget.template;if(child.getAttribute("layout-tab-name")){var tabName=child.getAttribute("layout-tab-name");var tab={id:this.id+"_"+tabName.replace(/ /g,"")+"_"+this.tabs.length,text:tabName,layout:child,__isCalled:false};if(child.attributes["layout-tab-icon"]){tab.image=child.getAttribute("layout-tab-icon")}this.tabs.push(tab);this.childRoot.appendChild(child)}},removeWidget:function(widget){var widgetId=typeof widget==="string"?widget:widget.id;var root=this.childRoot;for(var i=1;i<root.children.length;i++){var child=root.children[i];if(widgetId==child.id){var tab=root.querySelectorAll("td.top-tablayout-tab-wrapper")[i-1];tab.parentNode.removeChild(tab);if(this.selected===this.tabs[i-1].id){this.tabs.splice(i-1,1);this.clearDeepChilds(child);root.removeChild(child);if(this.tabs.length>1)this.focus(this.tabs[0].id);break}else{this.tabs.splice(i-1,1);this.clearDeepChilds(child);root.removeChild(child);break}}}},getTopStyle:function(){this.topstyle=this.querySelector(".top-tablayout-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-tablayout-root").style[key]=value;this.topstyle=this.querySelector(".top-tablayout-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-tablayout-root").style.cssText=this.topstyle},__detached:function(){for(var i=0;i<this.tabs.length;i++){this.tabClickFuct[i]=null}this.tabClickFuct=undefined}};Top.Widget.Layout.Tablayout=function(){Tablayout.prototype=Object.create(Top.Widget.Layout.prototype);Tablayout.prototype.constructor=Tablayout;function Tablayout(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-tablayout");this.template.innerHTML='<div class="top-tablayout-root"></div>'}this.id=this.template.id}Tablayout.create=function(element){return new Tablayout(element)};Tablayout.prototype.add=function(tab){this.template.add(tab)};Tablayout.prototype.insert=function(index,tab){this.template.insert(index,tab)};Tablayout.prototype.close=function(id,startIndex,count){this.template.remove(id,startIndex,count)};Tablayout.prototype.current=function(){return this.template.current()};Tablayout.prototype.select=function(tabId){if(typeof tabId==="number"){this.template.selectTabByIndex(tabId)}else{this.template.selectTab(tabId)}};Tablayout.prototype.focus=function(tabId){this.template.focus(tabId)};Tablayout.prototype.blur=function(){this.template.blur()};Tablayout.prototype.append=function(tab,html,layoutTabInfo,callback){this.template.append(tab,html,layoutTabInfo,callback)};Tablayout.prototype.updateTab=function(tabId,tabInfo){this.template.updateTab(tabId,tabInfo)};Tablayout.prototype.clear=function(tab){this.template.clear(tab)};Tablayout.prototype.setTitle=function(title){this.template.setTitle(title)};Tablayout.prototype.setImage=function(tab,src){this.template.setImage(tab,src)};Tablayout.prototype.getSelectedTab=function(){if(typeof this.template.tabs==="object"){var tabs=this.template.tabs;var selectedTabId=this.template.selected;for(var i=0,len=tabs.length;i<len;i++){if(tabs[i].id===selectedTabId){return tabs[i]}}return selectedTabId}else{return this.template.selected}};Tablayout.prototype.addTab=function(tab){this.template.__tabPlusEvent(this.template,tab)};Tablayout.prototype.getTabs=function(){return this.template.tabs};Tablayout.prototype.getSelectedTabIndex=function(){if(typeof this.template.tabs==="object"){var tabs=this.template.tabs;var selectedTabId=this.template.selected;for(var i=0,len=tabs.length;i<len;i++){if(tabs[i].id===selectedTabId){return i}}}};Tablayout.prototype.getClosedTabId=function(){return this.template.closedTabId};Tablayout.prototype.disableTab=function(tabId,trueOrFalse){this.template.__disableTab(tabId,trueOrFalse)};Tablayout.prototype.refreshTab=function(tabId){this.template.__refreshTab(tabId)};Tablayout.prototype.hiddenTab=function(tabId){var tr=this.template.querySelector("tr");var display_tabs=new Array;for(var i=0;i<tr.children.length;i++){if(tr.children[i].classList[1]==="tabs"&&tr.children[i].style.display!=="none"){display_tabs.push(tr.children[i])}}for(var i=0;i<display_tabs.length;i++){if(display_tabs[i].id===tabId){display_tabs[i].style.display="none";if(this.template.hiddenTabArray===undefined)this.template.hiddenTabArray=new Array;this.template.hiddenTabArray.push(display_tabs[i].id);if(display_tabs.length===1){for(var j=1;j<this.template.childRoot.children.length;j++){this.template.childRoot.children[j].style.display="none"}}else if(display_tabs[i+1]===undefined)display_tabs[i-1].click();else display_tabs[i+1].click()}}};Tablayout.prototype.hiddenTabByIndex=function(index){var tr=this.template.querySelector("tr");if(this.template.paginate==="true"||this.template.paginate===true){index++}var display_tabs=new Array;for(var i=0;i<tr.children.length;i++){if(tr.children[i].classList[1]==="tabs"&&tr.children[i].style.display!=="none"){display_tabs.push(tr.children[i])}}if(tr.children[index]!==undefined){tr.children[index].style.display="none";if(this.template.hiddenTabArray===undefined)this.template.hiddenTabArray=new Array;this.template.hiddenTabArray.push(tr.children[index].id)}if(this.template.selected===tr.children[index].id){
for(var i=0;i<display_tabs.length;i++){if(display_tabs[i].id===tr.children[index].id){if(display_tabs.length===1){for(var j=1;j<this.template.childRoot.children.length;j++){this.template.childRoot.children[j].style.display="none"}}else if(display_tabs[i+1]===undefined)display_tabs[i-1].click();else display_tabs[i+1].click()}}}};Tablayout.prototype.removeHiddenTab=function(tabId){if(this.template.hiddenTabArray!==undefined){for(var i=0;i<this.template.hiddenTabArray.length;i++){if(tabId===this.template.hiddenTabArray[i]){this.template.hiddenTabArray.splice(i,1);break}}if(this.template.hiddenTabArray.length===0)this.template.hiddenTabArray=undefined}if(this.template.paginate==="true"||this.template.paginate===true){this.template.tabPaginate()}else{var tr=this.template.querySelector("tr");for(var i=0;i<tr.children.length;i++){if(tr.children[i].id===tabId)tr.children[i].style.display="table-cell"}}};Tablayout.prototype.removeHiddenTabByIndex=function(index){var tr=this.template.querySelector("tr");var tabs=new Array;for(var i=0;i<tr.children.length;i++){if(tr.children[i].classList[1]==="tabs"){tabs.push(tr.children[i])}}for(var j=0;j<tabs.length;j++){if(j===index){var tabId=tabs[j].id;if(this.template.hiddenTabArray!==undefined){for(var i=0;i<this.template.hiddenTabArray.length;i++){if(tabId===this.template.hiddenTabArray[i]){this.template.hiddenTabArray.splice(i,1);break}}if(this.template.hiddenTabArray.length===0)this.template.hiddenTabArray=undefined}if(this.template.paginate==="true"||this.template.paginate===true){this.template.tabPaginate()}else{tabs[j].style.display="table-cell"}break}}};return Tablayout}();TopTableview={is:"top-tableview",behaviors:[TopWidgetBehavior,TopContainerBehavior],properties:{dataTable:{type:Object},paginate:{type:String,value:false},pageLength:{type:Number,value:-1},lengthMenu:{type:Object,value:[{text:"10",value:10},{text:"25",value:25},{text:"50",value:50},{text:"ALL",value:"ALL"}]},lengthChange:{type:String,value:false},pagerType:{type:String,value:"basic"},pagerMaxVisible:{type:String,value:20},pagerLocation:{type:String,value:"bc"},showresult:{type:String,value:true},orientation:{type:String,value:"horizontal"},rowSelected:{type:String,reflectToAttribute:true},rowDblclicked:{type:String,reflectToAttribute:true},onCellSelect:String,onEmpty:String,sortable:{type:String,value:true},editable:String,order:{type:Object,value:[]},checkable:{type:String,value:false},checked:{type:String,value:false},onCheck:{type:String,reflectToAttribute:true},onCheckhead:{type:String,reflectToAttribute:true},column:{type:Object,reflectToAttribute:true},columnOption:{type:String,reflectToAttribute:true},columnName:{type:String,reflectToAttribute:true},columnReorder:{type:String,value:false},columnResize:{type:String,value:false},cellOption:{type:String,reflectToAttribute:true},headerOption:{type:String,reflectToAttribute:true},readonly:{type:String,value:true,reflectToAttribute:true},emptyMessage:{type:String,value:"No data available in table",reflectToAttribute:true},scrollBodyHeight:{type:String,value:"",reflectToAttribute:true},horizontalScroll:false,selectedIndex:{type:Number,value:-1},selectType:{type:String,value:"row"},onScrollend:String,onRowclick:String,onRowdblclick:String,onRowcontextmenu:String,onCellclick:String,onCelldblclick:String,onCellcontextmenu:String,onRowcheck:String,onHeadercheck:String,onNodata:String,checkOption:String,indexOption:String,indexable:String,onIndexclick:String,dataLength:Number,onPagechange:String,onLengthchange:String,onUpdate:String,onEdit:String,onHeaderclick:String,onHeaderdbclick:String,storeColumn:String,storeKey:String,headerContextMenu:{type:String,value:false},multiSortable:{type:String,value:false},autoHeight:String},appendTemplate:function(){this.innerHTML='<div class="top-tableview" id="'+this.id+'">'+this.innerHTML+"</div>"},expectedTemplateClassName:function(){return"top-tableview"},__ready:function(){if(!this.layoutVerticalAlignment){this.layoutVerticalAlignment="top"}this.__updateId();this.__updateName();this.initialChilds();this.initialLayout();this.__initialClassname();this.__initI18n("column");this.__initI18n("emptyMessage");this.__initialized=true;if(Top.App.isLoaded()){this.renderLayout()}else{var _this=this;Top.App.onLoad(function(){_this.renderLayout()})}},__updateId:function(){if(this.id){this.childRoot.id=this.id}},__updateName:function(){if(this.name){this.childRoot.setAttribute("name",this.name)}},__eventBindingList:function(){var div=this.querySelector("div");return{__eventMouseClick:function(func){div.onclick=func},__eventMouseEnter:function(func){div.onmouseenter=func},__eventMouseExit:function(func){div.onmouseleave=func},__eventMouseMove:function(func){div.onmousemove=func},__eventMousePressed:function(func){div.onmousedown=func},__eventMouseReleased:function(func){div.onmouseup=func},__eventMouseDblclick:function(func){div.ondblclick=func},__eventKeyPressed:function(func){div.onkeydown=func},__eventKeyTyped:function(func){div.onkeypress=func},__eventKeyReleased:function(func){div.onkeyup=func},__eventFocused:function(func){div.onfocus=func},__eventLostFocused:function(func){div.onblur=func},__eventSecondaryClick:function(func){div.oncontextmenu=func}}},__initEventInternal:function(){this.__addEventByAttr("scrollend");this.__addEventByAttr("rowclick");this.__addEventByAttr("rowdblclick");this.__addEventByAttr("rowcontextmenu");this.__addEventByAttr("cellclick");this.__addEventByAttr("celldblclick");this.__addEventByAttr("cellcontextmenu");this.__addEventByAttr("rowcheck");this.__addEventByAttr("headercheck");this.__addEventByAttr("nodata");this.__addEventByAttr("pagechange");this.__addEventByAttr("lengthchange");this.__addEventByAttr("update");this.__addEventByAttr("edit");this.__addEventByAttr("headerclick");this.__addEventByAttr("headerdbclick")},__attached2:function(){var thisTable=this;this.setPageInfo();this.setColWidget();this.attachTooltip();var root=this.childRoot;if(this.separatorVisible){if(this.separatorVisible===true||this.separatorVisible==="true"){var addRule=function(sheet,selector,styles){if(sheet.insertRule)return sheet.insertRule(selector+" {"+styles+"}",sheet.cssRules.length);if(sheet.addRule)return sheet.addRule(selector,styles)};if(this.separatorSize&&parseInt(this.separatorSize)!==1){var separatorSize=parseInt(this.separatorSize);top$(root.querySelectorAll(".body-row:not(:last-child) .body-cell")).css("border-bottom-width",separatorSize+"px");addRule(document.styleSheets[0],"#"+this.id+" .body-cell:not(:last-child):before","border-right-width: "+separatorSize+"px")}if(this.separatorColor){top$(root.querySelectorAll(".body-row:not(:last-child) .body-cell")).css("border-bottom-color",this.separatorColor);addRule(document.styleSheets[0],"#"+this.id+" .body-cell:not(:last-child):before","border-right-color: "+this.separatorColor)}}else{top$(root.querySelectorAll(".body-row:not(:last-child) .body-cell")).css("border-bottom","none");top$(root.querySelectorAll(".body-cell")).addClass("no_separator")}}},attached:function(){},initializeChildRoot:function(){return this.firstElementChild},__indexOverflown:function(element){var _this=this;var cell_exam=top$(element);var res;var vwidth;var text=element.getAttribute("value");if(text==undefined||text==""){return 0}var cont=top$("<div>"+text+"</div>").css("display",cell_exam.css("none")).css("z-index","-50").css("position","absolute").css("padding",cell_exam.css("padding-right")).css("padding",cell_exam.css("padding-left")).css("font-family",cell_exam.css("font-family")).css("font-size",cell_exam.css("font-size")).css("font-weight",cell_exam.css("font-weight")).appendTo("body");vwidth=cont.outerWidth();cont.remove();res=vwidth+15;return res},renderLayoutAsync:function(){var _this=this;if(this.__isAttached===false)return;var root=this.childRoot.querySelector("#"+this.id+" .top-tableview-root");this.sortable=this.sortable==="true"||this.sortable===true;this.checkable=this.checkable==="true"||this.checkable===true;this.checked=this.checked==="true"||this.checked===true;this.paginate=this.paginate==="true"||this.paginate===true;this.showresult=this.showresult==="true"||this.showresult===true;this.columnReorder=this.columnReorder==="true"||this.columnReorder===true;this.columnResize=this.__getColumnResizeValue(this.columnResize);this.lengthChange=this.lengthChange==="true"||this.lengthChange===true;this.editable=this.editable==="true"||this.editable===true;this.horizontalScroll=this.horizontalScroll==="true"||this.horizontalScroll===true;this.indexable=this.indexable==="true"||this.indexable===true;this.storeColumn=this.storeColumn==="true"||this.storeColumn===true;this.sequence=this.sequence==="true"||this.sequence===true;this.virtualScroll=true;this.wheelState=false;this.soneFlag=Top.getClient()===Top.clientEnum.SONE;this._isTreetable();if(top$(this).find("top-headercolumn[type='swap']").length!==0)this.swappable=true;if(this.querySelector(".fixed_frame")){this.querySelector(".fixed_frame").remove()}else{this.fixed_pivot_num=0}this.__fixed_table_01_create();if(this.columnReorder){this.columnResize="auto"}if(this.data==undefined){this.data=[];this.items=[]}this.pagerange=undefined;_this.pagestartnum=0;if(this.columnResize)this.horizontalScroll=true;this.horizontalScroll=!(this.horizontalScroll==="false"||this.horizontalScroll===false);this.scrollBodyHeight=!(this.scrollBodyHeight==="false"||this.scrollBodyHeight===false);if(this.scrollBodyHeight||this.horizontalScroll)this.scrollTable=true;this.columnDefs=[];this.columnOptiontoTable=[];if(typeof this.order==="object"){this.order=JSON.parse(JSON.stringify(this.order))}else if(typeof this.order==="string"){this.order=Top.Util.namespace(this.order,this)}if(!this.pageLength)this.pageLength=-1;this.__columnOption=typeof this.columnOption==="string"?Top.Util.namespace(this.columnOption,this):this.columnOption;this.__multiColumnOption=typeof this.multiColumnOption==="string"?Top.Util.namespace(this.multiColumnOption,this):this.multiColumnOption;this.__column=typeof this.column==="string"?Top.Util.namespace(this.column,this):this.column;this.__columnName=typeof this.columnName==="string"?Top.Util.namespace(this.columnName,this):this.columnName;this.__swapOption=typeof this.swapOption==="string"?Top.Util.namespace(this.swapOption,this):this.swapOption;this.__checkOption=typeof this.checkOption==="string"?Top.Util.namespace(this.checkOption,this):this.checkOption;this.__indexOption=typeof this.indexOption==="string"?Top.Util.namespace(this.indexOption,this):this.indexOption;if(typeof Object.values==="undefined"){Object.values=function(obj){var array=new Array;for(var key in obj){array.push(obj[key])}return array}}if(this.__column){this.itemKeys=Object.values(this.__column);this.itemText=Object.keys(this.__column)}else{if(this.data&&this.data[0]){this.itemKeys=Object.keys(this.data[0]);this.itemText=Object.keys(this.data[0])}else{this.itemKeys=[];this.itemText=[]}}var columnsLen=this.itemKeys.length;columnsLen=this.itemKeys.length;if(this.__columnOption){for(var columnNameKey in this.__columnOption){if(this.__columnOption[columnNameKey]!==undefined&&this.__columnOption[columnNameKey].hasOwnProperty("order")){for(var i=0;i<columnsLen;i++){if(this.__column&&this.__column[this.itemKeys[i]]===columnNameKey){var newValue=this.itemKeys[i];this.itemKeys.splice(i,1);this.itemKeys.splice(this.__columnOption[columnNameKey]["order"],0,newValue)}else if(this.itemKeys[i]===columnNameKey){this.itemKeys.splice(i,1);this.itemKeys.splice(this.__columnOption[columnNameKey]["order"],0,columnNameKey)}}}}}if(this.soneFlag){this.columnReorder=false}var isIDE=false;if(this.itemLayoutDom){for(var i=0;i<this.itemLayoutDom.length;i++){if(this.itemLayoutDom[i].tagName=="TOP-TABLEHEADER"){isIDE=true}if(this.itemLayoutDom[i].tagName=="TOP-ROWITEM"){}}}this.isIDETableview=isIDE;if(!isIDE||this.column){this.changeItemLayoutDom()}if(this.itemLayoutDom){for(var i=0;i<this.itemLayoutDom.length;i++){if(this.itemLayoutDom[i].tagName=="TOP-ROWITEM"){var tablerows=document.createElement("TOP-TABLEITEM");tablerows.appendChild(this.itemLayoutDom[i]);this.itemLayoutDom[i]=tablerows;isIDE=true}}}this.virtualtable01_splitdata();if(this.children.length==0){return}this.renderIDETableByItems();top$("td.body-cell:has(top-button, top-checkbox, top-spinner, top-datepicker, top-selectbox, top-menu)").css("text-overflow","clip");top$("th.head-cell:has(top-button, top-checkbox, top-spinner, top-datepicker, top-selectbox, top-menu)").css("text-overflow","clip");this.virtualtable02_makeviewport();if(this.soneFlag){this.forsone()}if(Top.Util.Browser.isIE()){this.IEborwser()}this.onScroll();this.timer=null;this.__callRenderLayoutListeners();this.__initHeaderSortState()},_isTreetable:function(){this.treetable=this.outerHTML.includes("js::open");if(this.outerHTML.includes("level=")){var levelstr=this.outerHTML.split("level=")[1];this.levelbind=levelstr.substring(2,levelstr.indexOf("}"))}if(this.treetable){this.sortable=false}},_setLevelbind:function(levelbind){this.treetable=true;this.levelbind=levelbind},IEborwser:function(){var flu_body=this.querySelector(".top-tableview-scrollBody .body");flu_body.style.width=flu_body.offsetWidth+"px"},forsone:function(){var _this=this;_this.viewport.css({height:this.viewport_height});var headsetting=Array.from(_this.querySelectorAll("th.last-head:not(.ui-draggable-dragging):not(.incapable_header)")).sort(this.sortByHeadIndex);var hcolgroup=_this.querySelector(".head_colgroup");var bcolgroup=_this.querySelector(".body_colgroup");if(headsetting.length==1){hcolgroup.children[0].style.width="0px";bcolgroup.children[0].style.width="0px"}else{hcolgroup.children[headsetting.length].style.width="0px";bcolgroup.children[headsetting.length].style.width="0px"}var thirdheads=_this.querySelectorAll(".top-tableview-resizer");if(thirdheads.length<1){return}for(var j=0;j<headsetting.length-1;j++){if(headsetting[j].getAttribute("colspan")==="1"){var headCellLeft=headsetting[j+1].offsetLeft-5+"px";thirdheads[j].style.left=headCellLeft}}var lasthead=this.querySelector(".incapable_header");if(lasthead.getAttribute("colspan")==="1"){var headCellLeft=lasthead.offsetLeft-5+"px";thirdheads[headsetting.length-1].style.left=headCellLeft}if(this.checkableHead=="false"||this.checkableHead==false){this.disableCheckAll();this.checkableHeadCheckbox.setProperties({visible:false})}},changeItemLayoutDom:function(){if(this.sortStates===undefined)this.sortStates=new Object;var _this=this;var childRootDom=createChildRootDom();var tableHeaderDom=createTableHeaderDom();var rowItemDom=createRowItemDom();if(rowItemDom)childRootDom.appendChild(rowItemDom);childRootDom.appendChild(tableHeaderDom);_this.itemLayout=top$(childRootDom).html();_this.itemLayoutDom=top$(childRootDom).children();function createChildRootDom(){var childRootDom=document.createElement("div");childRootDom.classList.add("top-tableview");childRootDom.id=_this.id;return childRootDom}function createRowItemDom(){var tableitem=document.createElement("top-tableitem");if(_this.__multiColumnOption){var rowitemCount=Object.keys(_this.__multiColumnOption).length}else{var rowitemCount=1}for(var u=0;u<rowitemCount;u++){if(_this.__multiColumnOption){var columnop=_this.__multiColumnOption[u]}else{var columnop=_this.__columnOption}var rowItemDom=document.createElement("top-rowitem");var StringBuffer=function(){this.buffer=new Array};StringBuffer.prototype.append=function(str){this.buffer[this.buffer.length]=str};StringBuffer.prototype.toString=function(){return this.buffer.join("")};var itemKeys=_this.itemKeys;var bufBodyrow=new StringBuffer;if(_this.headerOption){var headlen=Object.keys(_this.headerOption).length;var lastcolnum=0;for(var i=0;i<headlen;i++){var num=Object.keys(_this.headerOption[i]).pop();if(num>lastcolnum){lastcolnum=num}}var headerkeys=[];for(var k=0;k<=lastcolnum;k++){headerkeys.push(k)}}else{var headerkeys=_this.itemKeys}if(columnop){headerkeys.forEach(function(item){if(!columnop[item]&&!_this.multiColumnOption){columnop[item]={}}});var bodykeys=Object.keys(columnop)}else{var bodykeys=_this.itemKeys}for(var i=0;i<bodykeys.length;i++){var bdx=bodykeys[i];if(columnop){if(!columnop[bdx]){continue}}var bufBody=new StringBuffer;var currentColumn=_this.itemKeys[i]?_this.itemKeys[i]:"";var currentOption={};if(columnop){if(isNaN(currentColumn)&&columnop[currentColumn]){currentOption=columnop[currentColumn];currentOption["text"]="{"+currentColumn+"}"}else if(columnop[bdx]){currentOption=columnop[bdx]}}bufBody.append("<top-columnitem");var bindingprop="";if(currentOption["type"]){if(currentOption["value"]=="js::check"){currentOption["class"]="checkable";currentOption["property"]["className"]="adv_body checkBox";currentOption["property"]["checked"]="js::check"}var propstr=currentOption["property"]?JSON.stringify(currentOption["property"]):"";var matches=JSON.parse(propstr);if(matches){var propKeys=Object.keys(matches);for(var k=0;k<propKeys.length;k++){if(propKeys[k]=="className"||propKeys[k]=="class"||propKeys[k]=="nodes"){continue}bindingprop+=propKeys[k]+'="'+matches[propKeys[k]]+'" '}}else{bindingprop=""}}else{if(columnop&&currentOption["value"]){bindingprop=currentOption["value"];bufBody.append(" value=");bufBody.append(bindingprop);if(bindingprop=="js::open"){_this._setLevelbind(currentOption["level"].replace("{","").replace("}",""));bufBody.append(" level="+currentOption["level"]);bufBody.append(" levelWeight="+currentOption["levelWeight"])}}if(columnop&&currentOption["text"]){bindingprop=currentOption["text"];bufBody.append(" text=");bufBody.append(bindingprop)}if(!columnop||!columnop.text){bufBody.append(" text=");currentColumn=currentColumn.replace("\n","&#10;");bufBody.append("{"+currentColumn+"}")}}if(currentOption["rowspan"]){var rowspan=currentOption["rowspan"];bufBody.append(" rowspan=");bufBody.append(rowspan)}if(currentOption["colspan"]){var colspan=currentOption["colspan"];bufBody.append(" colspan=");bufBody.append(colspan)}if(currentOption&&currentOption["event"]){var events=currentOption["event"];var eventKeys=Object.keys(events);for(var k=0;k<eventKeys.length;k++){switch(eventKeys[k]){case"onCreated":{bufBody.append(" on-created=");bufBody.append("::unnamed_oncreated()")}break;case"onCelldblclick":{bufBody.append(" on-celldblclick=");bufBody.append("::unnamed_oncelldblclick()")}break}}}bufBody.append(">");if(currentOption.sortState){if(_this.sortStates[bdx]===undefined)_this.sortStates[bdx]=currentOption.sortState}if(currentOption["type"]=="selectbox"){var bindtype="selected-text";var sidx="0";var stext="";var svalue="";if(currentOption.property){if(currentOption["property"]["nodes"]){var option=currentOption["property"]["nodes"];bufBody.append("<top-"+currentOption["type"]+" "+bindingprop+">");for(var k=0;k<option.length;k++){bufBody.append("<top-widgetitem"+" id=op"+i+' border-width="0px" text='+option[k].text+" value="+option[k].value+' selected="false">');bufBody.append("</top-widgetitem>")}}else if(currentOption["property"]["data-model"]){var dataModel=currentOption["property"]["data-model"];bufBody.append("<top-"+currentOption["type"]+' data-model=\'{"nodes":"'+dataModel["nodes"]+"\"}'"+" "+bindingprop+">")}}else{bufBody.append("<top-"+currentOption["type"]+" "+bindingprop+"></top-"+currentOption["type"]+">")}bufBody.append("")}else if(currentOption["type"]){bufBody.append("<top-"+currentOption["type"]+" "+bindingprop+"></top-"+currentOption["type"]+">")}bufBody.append("</top-columnitem>");bufBodyrow.append(bufBody.toString())}if(Top.Util.Browser.isChrome()){rowItemDom.innerHTML=bufBodyrow.toString()}else{for(var q=0;q<bufBodyrow.buffer.length;q++){rowItemDom.innerHTML+=bufBodyrow.buffer[q]}}tableitem.append(rowItemDom)}return tableitem}function createTableHeaderDom(){var tableHeaderDom=document.createElement("top-tableheader");var StringBuffer=function(){this.buffer=new Array};StringBuffer.prototype.append=function(str){this.buffer[this.buffer.length]=str};StringBuffer.prototype.toString=function(){return this.buffer.join("")};var itemKeys=_this.itemKeys;var itemText=_this.itemText;var columnsLen=itemText.length;_this.sumOfColspan=0;var bufHead=new StringBuffer;if(_this.headerOption){var headerOptionKeys=Object.keys(_this.headerOption);var headOptionLen=headerOptionKeys.length;var lastIndex=parseInt(headerOptionKeys[headOptionLen-1])}else{var headerOptionKeys=["0"];var headOptionLen=1;var lastIndex=parseInt(headerOptionKeys[headOptionLen-1])}var rowsCount=headOptionLen;if(Top.Util.Browser.isChrome()){rowsCount=""}while(true){lastIndex--;if(lastIndex===-1)break;if(_this.headerOption&&!_this.headerOption[lastIndex])_this.headerOption[lastIndex]={}}for(var i=headOptionLen-1;i>=0;i--){if(_this.headerOption){var headnums=Object.keys(_this.headerOption[i]);var columnsLen=headnums.length}else{var headnums=_this.itemKeys;var columnsLen=headnums.length}if(headOptionLen>0){bufHead.append("<top-headerrow>")}if(_this.swappable){var text=_this.__swapOption&&_this.__swapOption.text?_this.__i18n(_this.__swapOption.text):"Position";var str=_this.createHeaderColumn(text,rowsCount,_this.__swapOption,"swap");bufHead.append(str)}if(_this.headerOption&&_this.headerOption[i]){if(_this.headerOption[i]["index"]){var indextype="index";_this.__indexOption=_this.headerOption[i]["index"];_this.indexable=true}if(_this.headerOption[i]["index_r"]){var indextype="index_r";_this.__indexOption=_this.headerOption[i]["index_r"];_this.indexable=true}if(_this.headerOption[i]["check"]){_this.__checkOption=_this.headerOption[i]["check"];_this.checkable=true}}if(!_this.__indexOption){_this.__indexOption={visible:_this.indexable?"visible":"none"}}if(!_this.__checkOption){_this.__checkOption={visible:_this.checkable?"visible":"none"}}if(_this.checkable){var strchk=_this.createHeaderColumn("",rowsCount,_this.__checkOption,"check");bufHead.append(strchk)}if(_this.indexable){if(!indextype){indextype="index"}var text=_this.__indexOption&&_this.__indexOption.text?_this.__i18n(_this.__indexOption.text):"NO";var strindx=_this.createHeaderColumn(text,rowsCount,_this.__indexOption,indextype);bufHead.append(strindx)}if(_this.data.length===0&&_this.headerOption){columnsLen=Object.keys(_this.headerOption[i]).length;var needToBeCalcedByHO=true}var sumOfColspanForRow=0;for(var j=0;j<columnsLen;j++){var cdx=headnums[j];if(_this.headerOption){if(!_this.headerOption[i]||!_this.headerOption[i][cdx]){continue}}var styleStr="";if(sumOfColspanForRow===columnsLen)break;var headerText=_this.__i18n(itemText[j]);if(_this.headerOption&&_this.headerOption[i]&&_this.headerOption[i][cdx]&&_this.headerOption[i][cdx]["layout"]){if(typeof _this.headerOption[i][cdx]["layout"]==="string"){headerText=_this.__i18n(_this.headerOption[i][cdx]["layout"])}else if(typeof _this.headerOption[i][cdx]["layout"]==="function"){headerText=_this.headerOption[i][cdx]["layout"](itemText[cdx])}}var headerOpt=_this.headerOption&&_this.headerOption[i]&&_this.headerOption[i][cdx]?headerOpt=_this.headerOption[i][cdx]:{};var str=_this.createHeaderColumn(headerText,rowsCount,headerOpt,"normal");bufHead.append(str)}bufHead.append("</top-headerrow>")}tableHeaderDom.innerHTML=bufHead.toString();return tableHeaderDom}},createHeaderColumn:function(text,rc,option,type){var str="";var visibility="visible";rc=rc?rc:null;var id=option&&option.id?option.id:"";text=option&&option.text?option.text:text;singlecheck=option&&option.single?option.single:false;colSpan=option&&option.colspan?option.colspan:1;rowSpan=option&&option.rowspan?option.rowspan:1;headerfilter=option&&option.headerfilter?option.headerfilter:false;headerControl=option&&option["header-control"]?option["header-control"]:"";headerControlVisible=option&&option["header-control-visible"]!=undefined?option["header-control-visible"]:true;fixedColumnPivot=option&&option["fixed-column-pivot"]?option["fixed-column-pivot"]:false;if(option&&option["checkable-head"]!=undefined){checkablehead=option["checkable-head"]}else{checkablehead=true}if(option["visible"]=="none"||option["visible"]=="false"||option["visible"]==false){visibility="none"}else{visibility="visible"}if(type!="normal"){layoutwidth="";if(type=="check"&&option["layout-width"]){layoutwidth=option["layout-width"]}if(type=="index"&&option["layout-width"]){layoutwidth=option["layout-width"]}if(type=="check"||type=="index"){if(option["textposition"]=="left"){textposition="left"}else{textposition="right"}if(option["checked"]==true){checkbool=true}else{checkbool=false}}}else{layoutwidth=option&&option["layout-width"]?option["layout-width"]:"match_parent"}str+="<top-headercolumn";str+=" id='"+id+"'";if(type=="check"){str+=" textposition='"+textposition+"'";str+=" checked='"+checkbool+"'"}str+=" headerfilter="+headerfilter;str+=" fixed-column-pivot="+fixedColumnPivot;str+=" header-control="+headerControl;str+=" header-control-visible="+headerControlVisible;str+=" checkable-head="+checkablehead;str+=" text='"+text+"'";str+=" single='"+singlecheck+"'";str+=" colspan='"+colSpan+"'";str+=" rowspan='"+rowSpan+"'";str+=" type='"+type+"'";str+=" visible='"+visibility+"'";str+=" layout-width='"+layoutwidth+"'";if(rc)str+=" rowsCount='"+rc+"'";str+="></top-headercolumn>";return str},renderIDETableByItems:function(){this.isIDETableview=true;if(!this.__indexOption)this.__indexOption={};if(!this.__checkOption)this.__checkOption={};var _this=this;if(this.itemLayoutDom[1]&&!this.itemLayoutDom[1].innerHTML.includes("incapable")){this.headrowNum=1;this.itemrowNum=1;for(var i=0;i<this.itemLayoutDom.length;i++){if(this.itemLayoutDom[i].children[0]&&this.itemLayoutDom[i].tagName=="TOP-TABLEHEADER"){this.headrowNum=this.itemLayoutDom[i].children.length;var headerColumnStr="<top-headercolumn id='incapable_header' class='incapable_header' rowspan='"+this.headrowNum+"' type='incapable' visible='visible' layout-width=''></top-headercolumn>";if(this.itemLayoutDom[i].children[0].tagName=="TOP-HEADERROW")this.itemLayoutDom[i].children[0].innerHTML+=headerColumnStr;else this.itemLayoutDom[i].innerHTML+=headerColumnStr}if(this.itemLayoutDom[i].children[0]&&this.itemLayoutDom[i].tagName=="TOP-TABLEITEM"){this.itemrowNum=this.itemLayoutDom[i].children.length;var columnItemStr="<top-columnitem  class='incapable_column' rowspan='"+this.itemrowNum+"' type='incapable' visible='visible' layout-width=''></top-columnitem>";if(this.itemLayoutDom[i].children[0].tagName=="TOP-ROWITEM")this.itemLayoutDom[i].children[0].innerHTML+=columnItemStr;else this.itemLayoutDom[i].innerHTML+=columnItemStr}}}if(!this.rowItemArray){this.originalRowItemArray=[];this.rowItemArray=[]}if(!this.tableHeaderArray)this.tableHeaderArray=[];if(this.rowItemArray.length===0||this.tableHeaderArray.length===0){for(var i=0;i<this.itemLayoutDom.length;i++){var itemDom=Top.Util.Browser.isIE()?this.itemLayoutDom[i].cloneNode(true):this.itemLayoutDom[i];if(itemDom.children.length==0){break}if(this.itemLayoutDom[i].tagName=="TOP-TABLEITEM"){this.originalRowItemArray=Array.from(itemDom.children);this.rowitems=Array.from(itemDom.children)}else if(this.itemLayoutDom[i].tagName=="TOP-TABLEHEADER"){var newHeaderArray=[];if(this.tableHeaderArray.length!=0){continue}if(itemDom.children[0].tagName==="TOP-HEADERROW"){this.tableHeaderHeight=new Array(itemDom.children.length);this.tableHeaderRowClass=new Array(itemDom.children.length);newHeaderArray=new Array(itemDom.children.length);for(var j=0;j<itemDom.children.length;j++){this.tableHeaderHeight[j]=itemDom.children[j].getAttribute("layout-height");this.tableHeaderRowClass[j]=itemDom.children[j].getAttribute("class");newHeaderArray[j]=Array.from(itemDom.children[j].children)}}else{this.tableHeaderHeight=new Array(1);this.tableHeaderRowClass=new Array(1);this.tableHeaderHeight.push(itemDom.children[0].getAttribute("layout-height"));this.tableHeaderRowClass.push(itemDom.children[0].getAttribute("class"));newHeaderArray=new Array(1);newHeaderArray[0]=Array.from(itemDom.children)}this.tableHeaderArray=newHeaderArray}}this.headerOptionCount=0;for(var i=0;i<_this.tableHeaderArray.length;i++){for(var j=0;j<_this.tableHeaderArray[i].length;j++){var headerType=_this.tableHeaderArray[i][j].getAttribute("type");var visible=_this.tableHeaderArray[i][j].getAttribute("visible");if(headerType=="check"||headerType==="index"||headerType==="index_r"){this.headerOptionCount++}if(headerType==="check"&&visible!="none"){_this.checkable=true}if((headerType==="index"||headerType==="index_r")&&visible!="none"){_this.indexable=true}_this.tableHeaderArray[i][j].setAttribute("originRowspan",_this.tableHeaderArray[i][j].getAttribute("rowspan"));_this.tableHeaderArray[i][j].setAttribute("originColspan",_this.tableHeaderArray[i][j].getAttribute("colspan"))}}}if(this.storeColumn){var name=this.storeKey||this.id;var cookie_value=_this.getLocalStorage(name);if(cookie_value){_this.setTableheaderByTree(cookie_value)}}else if(this.__changedColumns){_this.setTableheaderByTree(this.__changedColumns)}if(this.__setDataLengthCalled!==true)this.dataLength=this.data?this.data.length:0;var tableTag=document.createElement("table",this.tableHeaderArray.length>1?"multiple-header":"");tableTag.classList.add("top-tableview");tableTag.setAttribute("cellpadding",0);tableTag.setAttribute("cellspacing",0);tableTag.setAttribute("border",0);var headTag=this.__makeTHeadTag();var colgroupTag=this.__makeHeaderColgroup();var bodyTag=document.createElement("tbody");bodyTag.classList.add("body");tableTag.appendChild(colgroupTag);tableTag.appendChild(headTag);tableTag.appendChild(bodyTag);var root=this.childRoot;root.innerHTML="";root.appendChild(tableTag);_this.__makeHeaderCheckable(root);if(this.layoutWidth=="auto"&&this.totalwidth===undefined){this.totalwidth=0;var headsetting=Array.from(_this.querySelectorAll("th.last-head:not(.ui-draggable-dragging):not(.incapable_header)"));for(var i=0;i<headsetting.length;i++){var curhead=headsetting[i];if(curhead.offsetWidth){this.totalwidth+=parseInt(curhead.offsetWidth)}}top$(this).width(this.totalwidth)}else if(this.layoutWidth=="match_parent"){var parentwidth=this.parentElement.offsetWidth;top$(this).width(parentwidth)}else if(this.layoutWidth&&this.layoutWidth.endsWith("px")){top$(this).width(this.layoutWidth)}for(var i=0;i<this.columnDefs.length;i++){var item=this.columnDefs[i];if(item["width"]==="wrap_content"){var columnIndex=parseInt(item.getAttribute("col"));var th=root.querySelector("th#"+this.headerColumnArray[_this.mainColumnIndex][columnIndex].id);var headerWidth;if(this.headerColumnArray[_this.mainColumnIndex][columnIndex].children.length==0){var headerText=th.innerText;var headerTextSize=window.getComputedStyle(th,null).getPropertyValue("font-size");var headerTextStyle=window.getComputedStyle(th,null).getPropertyValue("font-style");headerWidth=Top.Util.__measureTextSize(headerText,headerTextSize,headerTextStyle).width}else if(this.headerColumnArray[_this.mainColumnIndex][columnIndex].children.length>0){var headerLayout=this.headerColumnArray[_this.mainColumnIndex][columnIndex].children[0];headerWidth=headerLayout.getAttribute("layout-width");if(headerWidth==="auto"){headerWidth=root.querySelector("th#"+this.headerColumnArray[_this.mainColumnIndex][columnIndex].id).querySelector("#"+headerLayout.id)[0].getElement().offsetWidth}}item["width"]=typeof headerWidth==="number"?headerWidth+"px":headerWidth}else if(item["width"]==="match_parent"){item["width"]=undefined}}_this.editableHead=[];_this.nonTooltipHead=[];var allThs=root.querySelectorAll(".head-row .head-cell:not(.checkable)");for(var i=0;i<allThs.length;i++){var item=allThs[i];if(this.data&&this.data.length>0){item.columnName=item.getAttribute("value")}if(item.classList.contains("editable")){_this.editableHead.push(item.cellIndex);item.classList.remove("editable")}if(item.classList.contains("non-tooltip")){_this.nonTooltipHead.push(item.cellIndex);item.classList.remove("non-tooltip")}if(item.previousSibling===null){if(item.offsetLeft!==0){item.classList.add("no-border-left")}}}var bodyRoot=this.querySelector(".top-tableview .body");if(bodyRoot){this.__makeTBodyTag(this.data,undefined,bodyRoot);
}this.createdItemWidgetAttachedCallback();this.__headerControl_make();if(_this.checkable){var checkableTd=_this.childRoot.querySelectorAll(".checkable.body-cell");var checked=root.querySelector("th.head-cell.checkable").getAttribute("checked");for(var i=0;i<checkableTd.length;i++){var checkableCheckbox=Top.Widget.create("top-checkbox").template;checkableCheckbox.classList.add("checkable-body");checkableCheckbox.givenidx=i;checkableTd[i].appendChild(checkableCheckbox);TopRuntime._callCallback(checkableCheckbox,"attached");checkableCheckbox.checked=checked;checkableCheckbox.__updateProperties("checked");_this.checkIndexInfo[i].checkbool=checked}}this.__makeTopTablesObj()},__headerControl_make:function(){var _this=this;var advchkfunc=function(event,widget){var df=this.parentNode.dataField;var col=this.parentNode.getAttribute("col");var checkall=true;for(var q=0;q<_this.backupdata.length;q++){var bool=Top.Util.__isBooleanTrue(_this.backupdata[q][df]);if(bool==false){checkall=false;break}}Top.Dom.select(".adv_head.checkBox.head_"+col+",.adv_head.checkbox.head_"+col)[0].setProperties({checked:checkall})};var prop;for(var k=0;k<this.lastHeader.length;k++){var xmlRow=this.lastHeader[k].xmlRow;var xmlCol=this.lastHeader[k].xmlCol;if(this.headerOption&&this.headerOption[xmlRow]&&this.headerOption[xmlRow][xmlCol]&&this.headerOption[xmlRow][xmlCol]["property"]){prop=this.headerOption[xmlRow][xmlCol]["property"]}else{prop={}}if(this.lastHeader[k]["visible"]=="none"){continue}if(this.lastHeader[k]["adv_widget"]==null){continue}var htype=this.lastHeader[k]["header-control"];if(htype!="null"&&htype!=null){var cls=this.lastHeader[k]["class"];var old_id=this.lastHeader[k]["adv_widget"].getAttribute("id");var bodyidx=this.lastHeader[k]["lastHeadNum"];var hdctl=this.lastHeader[k]["header-control"];var result="";var eventtype="";prop["bodyidx"]=bodyidx;if(htype=="selectbox"){prop["nodes"]=this.bindingarray[0][bodyidx][0].template.nodes;eventtype="on-change"}else if(htype=="checkbox"){for(var j=0;j<this.data.length;j++){this.bindingarray[j][bodyidx][0].template.querySelector("label").removeEventListener("click",advchkfunc);this.bindingarray[j][bodyidx][0].template.querySelector("label").addEventListener("click",advchkfunc)}function chk_event(event){var bodyidx=this.parentNode.bodyidx;var dp="checked";var dp_idx=_this.bindingarray[0][bodyidx][0].template.boundProperties.indexOf(dp);var df=_this.bindingarray[0][bodyidx][0].template.fieldProperties[dp_idx];if(!dp){return}result=this.parentNode.isChecked();setDataAll(df,result)}var headerControlWidget=Top.Dom.selectById(old_id);headerControlWidget.setProperties(prop);headerControlWidget.template.bodyidx=bodyidx;headerControlWidget.template.classList.add("head_"+bodyidx);headerControlWidget.template.querySelector("label").removeEventListener("click",chk_event);headerControlWidget.template.querySelector("label").addEventListener("click",chk_event);continue}else if(htype=="textfield"){eventtype="on-blur"}else if(htype=="datepicker"){eventtype="on-select"}else if(htype=="spinner"){eventtype="on-change"}else if(htype=="js::check"){eventtype="on-click";_this.singlecheck=this.lastHeader[k]["single"]=="true"?true:false;_this.checkableHead=this.lastHeader[k]["checkable-head"]=="false"?false:true;var disabled=this.lastHeader[k]["disabled"]=="true"?true:"";if(_this.singlecheck){disabled=true}var visible=Top.Util.__isBooleanTrue(_this.checkableHead)}else{continue}if(htype=="js::check"){prop[eventtype]=function(event,widget){var __checked=widget.getProperties("checked");_this.checkAll(__checked);if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("headercheck"))}else{_this.__dispatchEvent(new Event("headercheck"))}};prop["class"]="checkable-head";if(visible==false){prop["visible"]=false}if(disabled==true){prop["disabled"]=true}}else{prop[eventtype]=function(event,widget){var bodyidx=widget.getProperties("bodyidx");var dp="text";var dp_idx=_this.bindingarray[0][bodyidx][0].template.boundProperties.indexOf(dp);var df=_this.bindingarray[0][bodyidx][0].template.fieldProperties[dp_idx];if(!dp){return}result=widget.getProperties(dp);setDataAll(df,result)}}var headerControlWidget=Top.Dom.selectById(old_id).setProperties(prop);Top.Dom.selectById(old_id).template.classList.add("head_"+bodyidx)}}function setDataAll(dataField,result){for(var p=0;p<_this.backupdata.length;p++){_this.backupdata[p][dataField]=result}_this.onScroll()}},__fixed_table_01_create:function(){this.fixedframe=document.createElement("div");this.fixedframe.className="fixed_frame";this.fixedheadframe=document.createElement("table");this.fixedheadframe.className="";this.fixedthead=document.createElement("thead");this.fixedthead.classList.add("head");this.fixedTr=document.createElement("tr");this.fixedTr.classList.add("head-row");this.fixedheadcolgroup=document.createElement("colgroup");this.fixedheadcolgroup.classList.add("fixedheadcolgroup");this.fixedthead.append(this.fixedTr);this.fixedheadframe.append(this.fixedthead);this.fixedheadframe.prepend(this.fixedheadcolgroup);this.fixedbodyframe=document.createElement("table");this.fixedbodyframe.className="";this.fixedtbody=document.createElement("tbody");this.fixedtbody.classList.add("body");this.fixedbodyframe.append(this.fixedtbody);this.fixedframe.append(this.fixedheadframe);this.fixedframe.append(this.fixedbodyframe);this.prepend(this.fixedframe)},__fixed_table_02_calwidth:function(){if(this.fixed_pivot_num>0){var fix_width=0;var flu_width=0;var marginLR=parseInt(this.marginLeft)+parseInt(this.marginRight);var borderLR=parseInt(this.borderLeftWidth)+parseInt(this.borderRightWidth);var fixhead=this.querySelector(".fixedheadcolgroup").childNodes;for(var i=0;i<fixhead.length;i++){var curhead=fixhead[i];var c_width=curhead.style.width;if(c_width.includes("px")){fix_width+=parseInt(c_width)}else if(c_width.includes("%")){fix_width+=parseInt(this.offsetWidth)/parseInt(c_width)}else{fix_width+=parseInt(curhead.offsetWidth)}}if(this.layoutWidth.includes("px")){flu_width=parseInt(this.layoutWidth)-fix_width-marginLR-borderLR}else{flu_width=this.childRoot.offsetWidth-fix_width-marginLR-borderLR}top$(this.querySelector(".top-tableview-scroll")).width(flu_width-1);top$(this.querySelector(".fixed_frame")).width(fix_width+1)}else{this.querySelector(".fixed_frame").style.display="none"}},__makeTempRowItem:function(len){var rowItem=document.createElement("top-rowitem");for(var i=0;i<len;i++){var columnItem=document.createElement("top-columnitem");rowItem.appendChild(columnItem)}return[rowItem]},__makeHeaderColgroup:function(){var root=this.childRoot;var _this=this;var colgroup=document.createElement("colgroup");colgroup.classList.add("head_colgroup");for(var i=0;i<_this.lastHeader.length;i++){if(_this.lastHeader[i]["visible"]=="none"){continue}var col=document.createElement("col");var dataIndex=" data-index='"+_this.lastHeader[i]["lastHeadNum"]+"'";if(_this.headerOptionCount<=i){col.classList.add("last-head_"+parseInt(i-_this.headerOptionCount));col.classList.add("hcol")}col.classList.add("hcol");col.setAttribute("data-index",_this.lastHeader[i]["lastHeadNum"]);col.setAttribute("span",1);if(i<_this.fixed_pivot_num){_this.fixedheadcolgroup.appendChild(col);continue}colgroup.appendChild(col)}return colgroup},__makeTHeadTag:function(){var root=this.childRoot;var _this=this;var headerRowArrayLen=this.tableHeaderArray.length;var rowcountStr=Top.Util.Browser.isIE()?" rowcount_"+headerRowArrayLen:"";this.sumOfColspan=0;this.headerColumnArray=new Array;this.bodyItemOrder=new Array;var theadTag=document.createElement("thead");theadTag.classList.add("head");if(this.rowItemArray.length===0&&this.tableHeaderArray[0]){this.originalRowItemArray=Array.from(this.rowitems[this.rowitems.length-1].children);this.rowItemArray=Array.from(this.rowitems[this.rowitems.length-1].children)}if(!_this.headerInfoArray){makeHeaderInfoArray(_this,_this.headerOptionCount);_this.lastHeader=new Array;for(var i=0;i<_this.headerInfoArray.length;i++){if(_this.headerInfoArray[i]["isLastHead"]==true){_this.headerInfoArray[i]["class"]="headIndex_"+_this.headerInfoArray[i]["class"];_this.lastHeader.push(top$.extend({},_this.headerInfoArray[i]))}}_this.lastHeader.sort(sortCompare);for(var i=0;i<_this.lastHeader.length;i++){var row=_this.lastHeader[i]["xmlRow"];var col=_this.lastHeader[i]["xmlCol"];var index=_this.lastHeader[i]["index"];var headerType=_this.tableHeaderArray[row][col].getAttribute("type");var str=headerType==="check"||headerType==="index"||headerType==="index_r"?headerType:i-_this.headerOptionCount;_this.lastHeader[i]["lastHeadNum"]=str;_this.lastHeader[i]["class"]+=" last-head";_this.headerInfoArray[index]["lastHeadNum"]=str;_this.headerInfoArray[index]["class"]+=" last-head";if(!_this.tableHeaderArray[row][col].getAttribute("body-mapping-index")){_this.tableHeaderArray[row][col].setAttribute("body-mapping-index",str)}else{str=_this.tableHeaderArray[row][col].getAttribute("body-mapping-index")}_this.lastHeader[i]["body-mapping-index"]=str;_this.headerInfoArray[index]["body-mapping-index"]=str;if(_this.lastHeader[i]["fixed-column-pivot"]){this.fixed_pivot_num=_this.lastHeader[i]["lastHeadNum"]+1}}for(var i=0;i<_this.headerInfoArray.length;i++){var currentCell=_this.headerInfoArray[i];var visible=currentCell["visible"];var colspan=currentCell["colspan"]||1;var lastHeadNum=currentCell["lastHeadNum"];if(visible!="none"){continue}}}if(this.Columns_info){for(var i=0;i<this.Columns_info.length;i++){for(var j=0;j<this.lastHeader.length;j++){if(this.lastHeader[j]["body-mapping-index"]==this.Columns_info[i].index){var colIndex=j;break}}var colVisible=this.Columns_info[i].visible;if(this.Columns_info[i].index=="check"){colIndex=_this.headerCheckableIndex}else if(this.Columns_info[i].index=="index"||this.Columns_info[i].index=="index_r"){colIndex=_this.headerIndexableIndex}if(_this.lastHeader[colIndex]){var defaultVisible=_this.lastHeader[colIndex]["visible"]||"visible";var lastHeadNum=_this.lastHeader[colIndex]["body-mapping-index"];if(this.Columns_info[i].index!="check"&&this.Columns_info[i].index!="index"&&this.Columns_info[i].index!="index_r"){_this.originalRowItemArray[lastHeadNum].setAttribute("visible",colVisible)}if(colVisible==defaultVisible){continue}setParentColspan(_this,_this.lastHeader[colIndex]["index"],colVisible=="none"?-1:1);setChildrenVisible(_this,_this.lastHeader[colIndex]["index"],colVisible,colVisible=="none"?-1:1)}}}if(_this.headerChangeByTree){var BeforeRowItemArray=_this.originalRowItemArray.slice(0);var newRowItemArray=Array(_this.rowItemArray.length);var newColumnOption={};for(var i=0;i<_this.lastHeader.length;i++){var bmi=_this.lastHeader[i]["body-mapping-index"];if(bmi!="check"&&bmi!="index"&&bmi!="index_r"){newRowItemArray[i-this.headerOptionCount]=BeforeRowItemArray[bmi]}if(_this.columnOption!=null&&_this.columnOption[bmi]!=null){newColumnOption[i-this.headerOptionCount]=_this.columnOption[bmi]}}_this.rowItemArray=newRowItemArray;columnop=newColumnOption;_this.headerChangeByTree=false}var rowNum=-1;var tableTr=document.createElement("tr");tableTr.style.height=this.heightarray[0]+"px";_this.fixedTr.style.height=this.heightarray[0]+"px";for(var i=0;i<_this.headerInfoArray.length;i++){var currentCell=_this.headerInfoArray[i];var row=currentCell["xmlRow"];var col=currentCell["xmlCol"];var xmlCell=this.tableHeaderArray[row][col];var userClass=currentCell["class"]+" "+xmlCell.className;var sumOfColspanForRow=0;var headerHeightStyle=!isNaN(parseInt(this.tableHeaderHeight[row]))?this.tableHeaderHeight[row]:"";var headerType=currentCell["type"];var editClass=xmlCell.getAttribute("editable")===true||xmlCell.getAttribute("editable")==="true"?" editable":"";var tooltipClass=xmlCell.getAttribute("tooltip")===false||xmlCell.getAttribute("tooltip")==="false"?" non-tooltip":"";var rowSpan=currentCell["rowspan"];var colSpan=currentCell["colspan"];var headerId=currentCell["id"];var headerStyle=getHeaderStyle(xmlCell);var headerWidth=xmlCell.getAttribute("layout-width");var headerValue=_this.__i18n(xmlCell.getAttribute("value"))||_this.__i18n(xmlCell.getAttribute("text"))||"";var headerSortable=xmlCell.getAttribute("sortable")||this.sortable;var tableSortable=headerId!="incapable_header"&&(this.sortable||headerSortable==true||headerSortable=="true")?" sorting":" sorting_disable";var headerFilterable=currentCell["headerFilter"];var tableFilterable=headerId!="incapable_header"&&(headerFilterable==true||headerFilterable=="true")?" headerfilter":" headerfilter_disable";var textposition=xmlCell.getAttribute("textposition")||"right";var checked=xmlCell.getAttribute("checked")||false;var disabled=xmlCell.getAttribute("disabled")||false;var headerRowClass=this.tableHeaderRowClass[row];var i18n="";if(xmlCell.getAttribute("text")!==null&&xmlCell.getAttribute("text").match(/\{\{(.*?)\}\}/)!==null){var i18n=xmlCell.getAttribute("text").match(/\{\{(.*?)\}\}/)[1];Top.i18n.__addBoundWidget(this)}var visible=currentCell["visible"]=="none"?false:true;var requiredSpan=document.createElement("span");requiredSpan.classList.add("header_required");requiredSpan.innerHTML="*";var cellWidget=undefined;var headerText="";if(xmlCell.attributes.text){headerText=_this.__i18n(currentCell["text"])||""}if(xmlCell.innerHTML.includes("top-")){headerText=xmlCell.innerHTML;var dataFieldRegExp=new RegExp("([-\\w]+)=[\"|']({[\\w.]+})[\"|']","g");var startsWithString=/^\s+/;var matches=[];var newCellText="";if(headerText.includes("top-widgetitem")){var cellTextSplitArr=headerText.split("<");for(var l=1;l<cellTextSplitArr.length;l++){if(!(cellTextSplitArr[l].startsWith("/")||cellTextSplitArr[l].startsWith("top-widgetitem"))){if(cellTextSplitArr[l].match(dataFieldRegExp)!==null){}}newCellText+=startsWithString.test(cellTextSplitArr[l])?cellTextSplitArr[l]:"<"+cellTextSplitArr[l]}headerText=newCellText}cellWidget=document.createElement("div");cellWidget.innerHTML=headerText;for(var k=0;k<cellWidget.children.length;k++){this.createHtmlObjects(cellWidget.children[k],false)}}if(headerType=="incapable"&&!userClass.includes("incapable_header")){userClass+=" incapable_header"}var tableTh=document.createElement("th");tableTh.id=headerId;classAdd(tableTh,["head-cell",rowcountStr,userClass]);tableTh.setAttribute("style",headerStyle);tableTh.setAttribute("rowspan",rowSpan);tableTh.setAttribute("colspan",colSpan);tableTh.setAttribute("headernum",i);if(rowNum<row){if(headerHeightStyle.length>0){tableTr.style.height=headerHeightStyle}var offsetByColspan=0;var sumHeaderLayoutWidth=0;var sumOptionCount=0;var headerRowClass=this.tableHeaderRowClass[i];rowNum=row}var columnNum=col-sumOptionCount;if(headerType==="check"){this.checkable=visible;if(!visible){continue}tableTh.classList.add("checkable");tableTh.setAttribute("textposition",textposition);tableTh.setAttribute("actualdx",headerType);tableTh.setAttribute("checked",checked);tableTh.setAttribute("disabled",disabled);sumOfColspanForRow+=parseInt(colSpan);sumOptionCount++}else if(headerType==="index"||headerType==="index_r"){this.indexable=visible;if(!visible){continue}if(headerType==="index_r"){this.__indexOption["reverse"]=visible}var indexColumnText=_this.__i18n(xmlCell.getAttribute("text"))||"NO";classAdd(tableTh,["indexable",tableSortable]);tableTh.setAttribute("value",indexColumnText);tableTh.setAttribute("actualdx",headerType);sumOfColspanForRow+=parseInt(colSpan);sumOptionCount++}else{if(!this.headerColumnArray[i])this.headerColumnArray[i]=new Array;this.headerColumnArray[i].push(xmlCell);sumOfColspanForRow+=colSpan;if(parseInt(colSpan)>1)offsetByColspan+=parseInt(colSpan)-1;if(!visible){setColumnDefsFromHeader(columnNum,"visible",false);if(!_this.tHeadsColspanOne)_this.tHeadsColspanOne=[];_this.tHeadsColspanOne.push(xmlCell)}tableTh.setAttribute("value",headerValue);tableTh.setAttribute("actualdx",currentCell["lastHeadNum"]);tableTh.setAttribute("data-i18n",i18n);var lastHeadNum=currentCell["lastHeadNum"];var headerControl=currentCell["header-control"];if(headerControl=="js::check"){tableSortable="sorting_disabled"}if(headerControl=="js::open"){headerSortable="true";tableSortable="sorting";tableTh.addClass("headcolumn_tree")}classAdd(tableTh,[editClass,tooltipClass,tableSortable]);if(lastHeadNum!=="check"&&lastHeadNum!=="index"&&lastHeadNum!=="index_r"&&lastHeadNum!==null&&currentCell["type"]!="incapable"&&currentCell["isLastHead"]==true&&currentCell["type"]!=="undefined"&&headerControl!=="js::index"&&headerControl!=="js::check"&&headerControl!=="js::status"&&headerControl!=="js::open"&&headerControl!=="selectbox"&&headerControl!=="textfield"){classAdd(tableTh,[tableFilterable]);createFilterBtn(tableTh);function createFilterBtn(th){var filterBtn=Top.Widget.create("top-button",{id:th.id+"-button",className:"headerfilter-common",icon:"icon-filter",float:"right"});th.appendChild(filterBtn.template);setTimeout(function(){if(document.getElementById(th.id+"-button")){document.getElementById(th.id+"-button").querySelector(".top-button-root").classList.add("header-filter");document.getElementById(th.id+"-button").querySelector(".top-button-icon").classList.add("header-filter");top$("#"+th.id+"-button div").remove()}})}}if(colSpan=="1"){_this.mainColumnIndex=columnNum;if(!_this.tHeadsColspanOne)_this.tHeadsColspanOne=[];_this.tHeadsColspanOne.push(xmlCell);if(headerSortable!==null){headerSortable=headerSortable==="true"?true:false;setColumnDefsFromHeader(i,"orderable",headerSortable)}if(headerWidth!==null&&userClass.includes("last-head")){if(isNaN(parseInt(headerWidth))&&headerWidth==="auto")headerWidth="wrap_content";if(i===0)setColumnDefsFromHeader(columnNum+offsetByColspan,"width",headerWidth)}}}if(headerType=="required"){tableTh.appendChild(requiredSpan)}if(cellWidget===undefined){tableTh.innerHTML+=headerText}else{while(cellWidget.firstChild){tableTh.appendChild(cellWidget.firstChild)}headTagAttached(tableTh)}var search_last=_this.headerInfoArray[i];var lastidx;while(true){if(search_last.children.length>0){search_last=_this.headerInfoArray[search_last.children.slice(-1).pop()]}else{lastidx=search_last.lastHeadNum;break}}if(lastidx<this.fixed_pivot_num){this.fixedTr.appendChild(tableTh);if(lastidx+1>=this.fixed_pivot_num){this.fixedthead.appendChild(this.fixedTr);this.fixedTr=document.createElement("tr");this.fixedTr.style.height=this.heightarray[this.headerInfoArray[i].xmlRow+1]+"px"}}else{if(visible)tableTr.appendChild(tableTh);top$(tableTr).addClass("head-row");if(i+1<_this.headerInfoArray.length&&rowNum<_this.headerInfoArray[i+1]["xmlRow"]){if(_this.sumOfColspan<sumOfColspanForRow)_this.sumOfColspan=sumOfColspanForRow;theadTag.appendChild(tableTr);tableTr=document.createElement("tr");tableTr.style.height=this.heightarray[this.headerInfoArray[i].xmlRow+1]+"px";top$(tableTr).addClass("head-row")}}}theadTag.appendChild(tableTr);return theadTag;function headTagAttached(item){var _this=this;var thChildren=item.querySelectorAll("*");var topWidget=/^TOP-[a-zA-Z]*/;var topWidgets=[];var len=thChildren.length;while(len--){if(topWidget.test(thChildren[len].tagName)){topWidgets.push(thChildren[len])}}for(var i=0;i<topWidgets.length;i++){var _item=topWidgets[i];if(typeof _item.__renderedImpl==="function"){_item.__renderedImpl()}if(typeof _item.__adjustWidgets==="function"){_item.__adjustWidgets()}if(typeof _item.__attachedImpl==="function"){_item.__attachedImpl()}_item.tabIndex="-1";if(typeof _item.__updateTabIndex==="function")_item.__updateTabIndex()}}function classAdd(element,classListArr){for(var i=0;i<classListArr.length;i++){if(classListArr[i]==null){continue}var curClass=classListArr[i].split(" ");for(var j=0;j<curClass.length;j++){if(curClass[j].length>0){element.classList.add(curClass[j])}}}}function checkParent(parent,child){if(parent["xmlRow"]+parent["rowspan"]>child["xmlRow"]){return false}if(parent["countColspan"]>=child["countColspan"]){return true}return false}function makeHeaderInfoArray(_this,headerOptionCount){_this.headerInfoArray=[];var beforeLength=0;var idIndex=0;for(var i=0;i<_this.tableHeaderArray.length;i++){beforeLength=_this.headerInfoArray.length;for(var j=0;j<_this.tableHeaderArray[i].length;j++){var currentCell=_this.tableHeaderArray[i][j];var rowSpan=parseInt(currentCell.getAttribute("rowspan")||"1");var colSpan=parseInt(currentCell.getAttribute("colspan")||"1");var originColSpan=parseInt(currentCell.getAttribute("originColspan"))||1;var id=currentCell.getAttribute("id")||"header"+i+"_"+j;var headerType=currentCell.getAttribute("type")||"normal";var width=currentCell.getAttribute("layout-width");var headerControl=currentCell.getAttribute("header-control");var single=currentCell.getAttribute("single");var checkableHead=currentCell.getAttribute("checkable-head");var headerControlVisible=currentCell.getAttribute("header-control-visible");var headerFilter=currentCell.getAttribute("headerfilter");var text=currentCell.getAttribute("text")||"";var visible=currentCell.getAttribute("visible")||"visible";var classStr=String(idIndex-headerOptionCount);if(headerType=="check"){classStr="check"}else if(headerType=="index"||headerType=="index_r"){classStr="index"}if(width==null&&headerType!="incapable"){width="150px"}var headinwidget=currentCell.innerHTML.includes("top-");var fixed_column_pivot=currentCell.getAttribute("fixed-column-pivot")=="true"?true:false;if(headerControl){if(headinwidget){var adv_widget=currentCell.querySelector(".adv_head")}else if(headerControl.includes("js::check")&&headerControlVisible=="true"){var checkprop={className:"adv_head checkbox"};var checkwidget=Top.Widget.create("top-checkbox",checkprop).template;currentCell.append(checkwidget);headinwidget=true;var adv_widget=checkwidget}else if(headerControl.includes("js::index")||headerControl.includes("js::open")){}else if(headerControlVisible=="true"&&headinwidget!=true){var checkprop={className:"adv_head "+headerControl};var checkwidget=Top.Widget.create("top-"+headerControl,checkprop).template;currentCell.append(checkwidget);headinwidget=true;var adv_widget=checkwidget}else{var adv_widget=null}}var headerInfo={xmlRow:i,xmlCol:j,isLastHead:true,lastHeadNum:null,parent:null,children:[],rowspan:rowSpan,colspan:colSpan,countColspan:originColSpan,originColspan:originColSpan,index:idIndex,class:classStr,type:headerType,width:width,id:id,text:text,visible:visible,"header-control":headerControl,headerFilter:headerFilter,single:single,"checkable-head_":checkableHead,"header-control-visible":headerControlVisible,"fixed-column-pivot":fixed_column_pivot,"header-widgets":headinwidget,adv_widget:adv_widget};if(i>0){var flag=false;for(var k=0;k<beforeLength;k++){var parent=_this.headerInfoArray[k];if(checkParent(parent,headerInfo)){headerInfo["parent"]=_this.headerInfoArray[k]["index"];headerInfo["class"]=_this.headerInfoArray[k]["class"]+"_"+_this.headerInfoArray[k]["children"].length;_this.headerInfoArray[k]["isLastHead"]=false;_this.headerInfoArray[k]["children"].push(idIndex);_this.headerInfoArray[k]["countColspan"]-=originColSpan;break}else{for(var l=0;l<parent["children"].length;l++){if(parent["children"][l]>=beforeLength){break}var parent2=_this.headerInfoArray[parent["children"][l]];if(checkParent(parent2,headerInfo)){headerInfo["parent"]=parent2["index"];headerInfo["class"]=_this.headerInfoArray[parent["children"][l]]["class"]+"_"+_this.headerInfoArray[parent["children"][l]]["children"].length;_this.headerInfoArray[parent["children"][l]]["isLastHead"]=false;_this.headerInfoArray[parent["children"][l]]["children"].push(idIndex);_this.headerInfoArray[parent["children"][l]]["countColspan"]-=originColSpan;flag=true;break}}if(flag)break}}}headerInfo["header-array-index"]=idIndex;_this.headerInfoArray.push(headerInfo);if(headerType=="check"){_this.headerCheckableIndex=idIndex}else if(headerType=="index"||headerType=="index_r"){_this.headerIndexableIndex=idIndex}idIndex++}}}function sortCompare(a,b){var aList=a["class"].split("_");var bList=b["class"].split("_");for(var i=1;i<Math.min(aList.length,bList.length);i++){var aNum=aList[i]=="check"?-2:aList[i]=="index"?-1:parseInt(aList[i]);var bNum=bList[i]=="check"?-2:bList[i]=="index"?-1:parseInt(bList[i]);if(aNum==bNum){continue}return aNum-bNum}return false}function setParentColspan(_this,headerArrayIndex,appendix){var parentIndex=_this.headerInfoArray[headerArrayIndex]["parent"];if(parentIndex==null||_this.headerInfoArray[parentIndex]["visible"]=="none"&&appendix<0){return}_this.headerInfoArray[parentIndex]["colspan"]+=appendix;_this.headerInfoArray[parentIndex]["visible"]=_this.headerInfoArray[parentIndex]["colspan"]<=0?"none":"visible";if(_this.headerInfoArray[parentIndex]["colspan"]<0)_this.headerInfoArray[parentIndex]["colspan"]=0;setParentColspan(_this,parentIndex,appendix)}function setChildrenVisible(_this,headerArrayIndex,visible,appendix){_this.headerInfoArray[headerArrayIndex]["colspan"]+=appendix;_this.headerInfoArray[headerArrayIndex]["visible"]=visible;if(_this.headerInfoArray[headerArrayIndex]["colspan"]<0)_this.headerInfoArray[headerArrayIndex]["colspan"]=0;if(_this.headerInfoArray[headerArrayIndex]["isLastHead"]){for(var i=0;i<_this.lastHeader.length;i++){if(_this.lastHeader[i]["id"]==_this.headerInfoArray[headerArrayIndex]["id"]){_this.lastHeader[i]["colspan"]+=appendix;_this.lastHeader[i]["visible"]=visible;if(_this.lastHeader[i]["colspan"]<0)_this.lastHeader[i]["colspan"]=0;break}}}var children=_this.headerInfoArray[headerArrayIndex]["children"];for(var i=0;i<children.length;i++){setChildrenVisible(_this,children[i],visible,appendix)}}function getHeaderStyle(item){var headerTextColor=item.getAttribute("text-color")||"";var headerTextStyle=item.getAttribute("text-style")||"";var headerTextSize=item.getAttribute("text-size")||"";var headerBgColor=item.getAttribute("background-color")||"";var headerBgImage=item.getAttribute("background-image")||"";var headerTileMode=item.getAttribute("tile-mode")||"";var headerOpacity=item.getAttribute("opacity")||"";var headerWidth=item.getAttribute("layout-width")||"";var align=item.getAttribute("horizontal-alignment")||"";var headerStyle="";headerStyle+=headerTextColor?"color:"+headerTextColor+";":"";headerStyle+=headerTextSize?" font-size:"+headerTextSize+";":"";headerStyle+=headerBgColor?" background-color:"+headerBgColor+";":"";headerStyle+=headerBgImage?" background-image: url("+headerBgImage+");":"";headerStyle+=headerOpacity?" opacity:"+headerOpacity+";":"";headerStyle+=align?" text-align:"+align+";":"";if(headerTileMode!==""){headerStyle+=headerTileMode==="stretch"?" background-size: cover;":" background-repeat: "+headerStyle+";"}if(headerTextStyle!==""){var textStyleArray=headerTextStyle.split("|");for(var j=0;j<textStyleArray.length;j++){textStyleArray[j]=textStyleArray[j].replace(/ /g,"");if(textStyleArray[j]==="bold"){headerStyle+=" font-weight:bold;"}else if(textStyleArray[j]==="italic"){headerStyle+=" font-style:italic;"}else if(textStyleArray[j]==="underline"){headerStyle+=" text-decoration:underline;"}}}return headerStyle}function setColumnDefsFromHeader(index,key,value){var obj={};obj["targets"]=index+_this.__getColumnIndexByLabel();obj[key]=value;if(_this.columnDefs.length==0){_this.columnDefs.push(obj)}else{var len=_this.columnDefs.length;while(len--){var item=_this.columnDefs[len];if(item["targets"]==index+_this.__getColumnIndexByLabel()){item[key]=value}if(item["targets"]!=index+_this.__getColumnIndexByLabel()&&len===0){_this.columnDefs.push(obj)}}}}},__makeHeaderCheckable:function(root){var checkhead=root.querySelector("th.head-cell.checkable");if(this.checkable&&checkhead){this.singlecheck=this.tableHeaderArray[0][0].getAttribute("single")=="true"?true:false;this.checkableHead=this.tableHeaderArray[0][0].getAttribute("checkable-head")=="false"?false:true;var disabled=checkhead.getAttribute("disabled")=="true"?true:false;var visible=this.checkableHead;if(this.singlecheck){disabled=true}var chprop={visible:visible,disabled:disabled};var checkableHeadCheckbox=Top.Widget.create("top-checkbox",chprop);this.checkableHeadCheckbox=checkableHeadCheckbox;checkableHeadCheckbox.template.classList.add("checkable-head");var leftorRight=checkhead.getAttribute("textposition");if(leftorRight=="left"){checkhead.appendChild(checkableHeadCheckbox.template)}else{top$(checkhead).prepend(checkableHeadCheckbox.template)}TopRuntime._callCallback(checkableHeadCheckbox.template,"attached");checkableHeadCheckbox.template.checked=checkhead.getAttribute("checked");checkableHeadCheckbox.template.__updateProperties("checked")}},__makeTBodyTag:function(data,startIndex,bodyRoot,scrolled){var root=this.childRoot;var _this=this;_this.createdItemWidgets=[];this.bindingarray=[];this.bindingtd=[];if(startIndex===undefined)startIndex=0;var StringBuffer=function(){this.buffer=new Array};StringBuffer.prototype.append=function(str){this.buffer[this.buffer.length]=str};StringBuffer.prototype.toString=function(){return this.buffer.join("")};var columnOption=this.__columnOption;var bufBody=new StringBuffer;if(_this.headerOption&&_this.bodyItemOrder.length==this.rowItemArray.length){var rowItemNewArr=this.rowItemArray.slice()}var row_array=[];for(var o=0;o<this.rowitems.length;o++){row_array[o]=[]}for(var p=0;p<this.rowitems.length;p++){var cArray=this.rowitems[p].children;for(var j=0;j<cArray.length;j++){var count=0;while(true){if(row_array[p][j+count]!=undefined){count++}else{row_array[p][j+count]=cArray[j];var colSpan=cArray[j].getAttribute("colspan");var rowSpan=cArray[j].getAttribute("rowspan");for(var c=1;c<colSpan;c++){row_array[p][j+count+c]="merged"}for(var r=1;r<rowSpan;r++){row_array[p+r][j+count]="merged"}break}}}}if(!data){return bufBody}else if(data.length===0||!this.items){}else if(data.length>0){var switchedItem=this.getSwitchedItem();if(this.itemSwitchLogic){rowItemArray=switchedItem}for(var i=0;i<data.length;i++){var bodyRowHeightStyle="";if(this.ih){bodyRowHeightStyle="height:"+parseInt(this.ih/this.rowitems.length)+"px;"}for(var p=0;p<row_array.length;p++){var rowItemArray=row_array[p];var tableTr=document.createElement("tr");tableTr.setAttribute("style",bodyRowHeightStyle);tableTr.classList.add("body-row");tableTr.classList.add("row_"+(i+startIndex));if(!isNaN(parseInt(this.rowItemHeight))){tableTr.style.height=this.rowItemHeight}if(this.checkable){var tableTd=document.createElement("td");tableTd.classList.add("checkable");tableTd.classList.add("body-cell");tableTr.appendChild(tableTd)}if(this.indexable){var tableTd=document.createElement("td");tableTd.classList.add("indexable");tableTd.classList.add("body-cell");tableTd.setAttribute("col","index");tableTr.appendChild(tableTd)}var tempTr=document.createElement("tr");tempTr.classList.add("body-row");tempTr.style.height=this.ih/this.rowitems.length+"px";for(var j=0;j<rowItemArray.length;j++){if(this.bindingtd[j]==undefined){this.bindingtd[j]=[]}var columnItem=rowItemArray[j];if(columnItem=="merged"){continue}var cellText="";var cellWidget=undefined;var columnValue="";var columnText="";var count=0;if(this.checkable){count++}if(this.indexable){count++}if(columnItem===undefined||this.lastHeader[j+count]["visible"]=="none"){continue}if(columnItem.getAttribute("value")){columnValue=columnItem.getAttribute("value");if(columnValue.startsWith("{")){columnValue=columnValue.substring(1,columnValue.indexOf("}"))}}if(columnItem.getAttribute("text")){columnText=columnItem.getAttribute("text");if(columnText.startsWith("{")){columnText=columnText.substring(1,columnText.indexOf("}"))}if(!this.__columnFieldTextMatch)this.__columnFieldTextMatch={};if(columnText){this.__columnFieldTextMatch[columnText]=_this.tHeadsColspanOne[j].getAttribute("text")}}var thisColumnOption=null;if(columnOption){for(var k=0;k<Object.keys(columnOption).length;k++){var objKey=Object.keys(columnOption)[k];if(!isNaN(objKey.charAt(0))){if(parseInt(objKey)==j){thisColumnOption=columnOption[j]}}else{if(objKey==columnText){thisColumnOption=columnOption[objKey]}else if(columnOption[objKey]){thisColumnOption=columnOption[objKey]}}}}var bodyValue,bodyBoundField;if(columnText){if(data[i][columnText]!==undefined){bodyValue=data[i][columnText];
}else if(data[i][this.__columnFieldTextMatch[columnText]]!==undefined){bodyValue=data[i][this.__columnFieldTextMatch[columnText]]}else{bodyValue=""}bodyBoundField=columnText||this.__columnFieldTextMatch[columnText]}else{bodyValue=bodyBoundField=""}if(columnItem.attributes.text){var boundField=columnItem.attributes.text.nodeValue;var fixvalue=true;if(boundField.startsWith("{")){fixvalue=false;boundField=boundField.substring(1,boundField.indexOf("}"));if(columnItem.attributes.level){var boundLevel=columnItem.attributes.level.nodeValue;if(boundLevel.startsWith("{")){boundLevel=boundLevel.substring(1,boundLevel.indexOf("}"))}this.treetable=true;this.paginate=false;this.Draggable=Top.Util.__isBooleanTrue(columnItem.getAttribute("Draggable"))?true:true;this.levelweight=columnItem.getAttribute("level-weight")?parseInt(columnItem.getAttribute("level-weight")):10;this.treeicon={};this.treeicon["open"]=columnItem.getAttribute("icon-open")||" icon-minus_square";this.treeicon["close"]=columnItem.getAttribute("icon-close")||" icon-plus_square";this.treeicon["leaf"]=columnItem.getAttribute("icon-leaf")||"icon-check";this.levelbind=boundLevel;this.textbind=boundField}}else if(boundField.includes("js::")){fixvalue=false}}else if(thisColumnOption&&thisColumnOption["layout"]){}else{cellText=columnItem.innerHTML;var dataFieldRegExp=new RegExp("([-\\w]+)=[\"|']({[\\w.]+})[\"|']","g");var startsWithString=/^\s+/;var matches=[];var newCellText="";matches=cellText.match(dataFieldRegExp);function changeEditHtml(cellText,matches,i){var data=_this.backupdata;if(matches===null)return cellText;matches.sort();var boundProperties=[];var fieldProperties=[];for(var k=0;k<matches.length;k++){var attributeName=matches[k].split("=")[0];var fieldName=matches[k].split("=")[1];fieldName=fieldName.substring(2,fieldName.indexOf("}"));var convertedData;if(data[i][fieldName]!==undefined){convertedData=data[i][fieldName]}else if(_this.__columnFieldTextMatch!==undefined&&data[i][_this.__columnFieldTextMatch[fieldName]]!==undefined){convertedData=data[i][_this.__columnFieldTextMatch[fieldName]]}else if(fieldName.includes(".")){var __fieldPaths=fieldName.split(".");var __baseObject=data[i];for(var m=0;m<__fieldPaths.length;m++){__baseObject=__baseObject[__fieldPaths[m]]}convertedData=__baseObject}else{convertedData=fieldName}if(typeof bodyValue==="object"){convertedData=_this.itemsString+"."+(i+startIndex)+"."+fieldName}cellText=cellText.replace(matches[k]," "+attributeName+"='"+convertedData+"'");boundProperties.push(attributeName);fieldProperties.push(fieldName)}return[cellText,boundProperties,fieldProperties]}cellWidget=document.createElement("div");cellWidget.innerHTML=cellText}var align=columnItem.getAttribute("horizontal-alignment")?columnItem.getAttribute("horizontal-alignment"):"";var cellClassName=columnItem.getAttribute("class");var rowSpan=columnItem.getAttribute("rowspan")||"1";var colSpan=columnItem.getAttribute("colspan")||"1";if(colSpan>1){textAlign="center"}else{textAlign=""}var editClass=this.editable?"editable":"";if(thisColumnOption&&(thisColumnOption["editable"]||thisColumnOption["editable"]===false)){editClass=thisColumnOption["editable"]===true||thisColumnOption["editable"]==="true"?"editable":""}var tooltipClass="non-tooltip";if(!thisColumnOption||thisColumnOption&&(thisColumnOption["tooltip"]===undefined||thisColumnOption["tooltip"]))tooltipClass=undefined;var tableTd=document.createElement("td");if(columnItem.outerHTML.includes("js::check")){tableTd.classList.add("checkable")}else if(columnItem.outerHTML.includes("js::index")){tableTd.classList.add("indexable")}tableTd.classList.add("body-cell");if(editClass!==undefined||editClass!==null||editClass!=="")top$(tableTd).addClass(editClass);tableTd.classList.add("column_"+j);tableTd.setAttribute("col",j);if(cellClassName!==undefined||cellClassName!==null||cellClassName!=="")top$(tableTd).addClass(cellClassName);if(tooltipClass!==undefined||tooltipClass!==null||tooltipClass!=="")top$(tableTd).addClass(tooltipClass);if(fixvalue){}else{if(columnItem.attributes.value){tableTd.setAttribute("value-field",columnValue)}else if(columnText!=""){tableTd.setAttribute("value-field",columnText)}}tableTd.style.textAlign=align;tableTd.setAttribute("rowspan",rowSpan);tableTd.setAttribute("colspan",colSpan);tableTd.style.textAlign=textAlign;if(cellWidget===undefined){tableTd.innerHTML=cellText;this.bindingtd[j].push(tableTd);if(fixvalue){tableTd.textContent=bodyBoundField}else{tableTd.setAttribute("data-field",bodyBoundField)}}else if(columnItem.getAttribute("edit-trigger")){tableTd.colidx=j;tableTd.rowitemidx=p;var makeedit=function(event){if(this.children.length!=0){return}var cidx=this.colidx;var ridx=this.rowitemidx;var cellText=_this.rowitems[ridx].children[cidx].innerHTML;var dataFieldRegExp=new RegExp("([-\\w]+)=[\"|']({[\\w.]+})[\"|']","g");var startsWithString=/^\s+/;var matches=[];matches=cellText.match(dataFieldRegExp);var edits=changeEditHtml(cellText,matches,this.dataIndex);cellText=edits[0];this.innerHTML=cellText;this.children[0].roottable=_this;var edited={index:this.dataIndex,column:this.colidx};this.children[0].edited=edited;this.children[0].boundProperties=edits[1];this.children[0].fieldProperties=edits[2];_this.__dispatchEvent(new CustomEvent("edit"))};var triggertype=columnItem.getAttribute("edit-trigger");if(triggertype=="blur"){tableTd.addEventListener("blur",makeedit)}else if(triggertype=="click"){tableTd.addEventListener("click",makeedit)}else{tableTd.addEventListener("dblclick",makeedit)}if(columnItem.innerHTML.match(dataFieldRegExp)){var bindstr=columnItem.innerHTML.match(dataFieldRegExp)[0];bindstr=bindstr.split("=")[1];bodyBoundField=bindstr.substring(2,bindstr.indexOf("}"))}tableTd.setAttribute("data-field",bodyBoundField);this.bindingtd[j]=tableTd}else{_this.__initChildWidgetId(cellWidget,i,j);for(var k=0;k<cellWidget.children.length;k++){this.createHtmlObjects(cellWidget.children[k],false)}while(cellWidget.firstChild){if(cellWidget.firstChild.tagName=="TOP-LINEARLAYOUT"){var layoutHeight=cellWidget.firstChild.getAttribute("layout-height");layoutHeight=layoutHeight=="match_parent"?"100%":layoutHeight;cellWidget.firstChild.style.height=layoutHeight;cellWidget.firstChild.style.display="block";if(cellWidget.firstChild.getAttribute("orientation")=="horizontal"){cellWidget.firstChild.childRoot.style.lineHeight=this.ih+"px"}}tableTd.appendChild(cellWidget.firstChild)}tableTd.style.textOverflow="clip"}if(!tableTd.classList.contains("incapable_column"))tableTd.setAttribute("tabindex","0");if(j<this.fixed_pivot_num){tempTr.addClass("row_"+i);tempTr.appendChild(tableTd)}else{tableTr.appendChild(tableTd)}if(Top.Util.Browser.isIE()&&tableTd.children[0]&&Top.Util.__isTopWidget(tableTd.children[0].tagName)&&tableTd.children[0].tagName!=="TOP-IMAGEVIEW"){var rootChild=tableTd.children[0].getElement();tableTd.children[0].style.width=rootChild.style.width;tableTd.children[0].style.height=rootChild.style.height;tableTd.children[0].style.display="inline-block"}if(i===0){var headerIndex=j+this.__getColumnIndexByLabel();if(this.lastHeader[headerIndex]){var th=this.childRoot.querySelector("#"+this.lastHeader[headerIndex].id);if(th)th.dataField=bodyBoundField}}}this.fixedtbody.appendChild(tempTr);bodyRoot.appendChild(tableTr)}this.bindingarray.push(this.bindingtd);this.bindingtd=[]}}var thisColumnOption=this.__columnOption;var ckey=this.tableHeaderArray[0];var clength=ckey.length;if(this.checkable){clength--}if(this.indexable){clength--}for(var k=0;k<this.bindingarray.length;k++){for(var i=0;i<clength;i++){if(this.lastHeader[i]&&this.lastHeader[i]["visible"]=="none"){continue}if(this.__columnOption){if(this.__columnOption[i]){var columnName=i}else{continue}if(this.__columnOption[columnName].property){var str=".column_"+columnName;var cells=this.querySelectorAll(str);var wgt=Top.Dom.__selectImpl(cells[k].firstChild);var prop=this.__columnOption[columnName].property;wgt.setProperties(prop)}}}}return bufBody},__changeInnerHTML:function(cellText,matches){if(matches===null||this.data.length===0)return cellText;for(var k=0;k<matches.length;k++){var attributeName=matches[k].split("=")[0];var fieldName=matches[k].split("=")[1];fieldName=fieldName.substring(2,fieldName.indexOf("}"));var convertedData;if(bodyBoundField===""&&bodyValue===""){if(data[i][fieldName]!==undefined){bodyValue=data[i][fieldName]}else if(_this.__columnFieldTextMatch!==undefined&&data[i][_this.__columnFieldTextMatch[fieldName]]!==undefined){bodyValue=data[i][_this.__columnFieldTextMatch[fieldName]]}else if(fieldName.includes(".")){var __fieldPaths=fieldName.split(".");var __baseObject=data[i];for(var m=0;m<__fieldPaths.length;m++){__baseObject=__baseObject[__fieldPaths[m]]}bodyValue=__baseObject}else{bodyValue=fieldName}bodyBoundField=fieldName}if(typeof bodyValue!=="object"){convertedData=_this.__getValueByDataConverter(bodyValue,{dataIndex:i+startIndex,columnIndex:j,columnName:fieldName})}else{convertedData=_this.itemsString+"."+(i+startIndex)+"."+fieldName}if(k<1){cellText=cellText.replace(matches[k],"data-field="+fieldName+" "+attributeName+"='"+convertedData+"' data-boundproperties='"+attributeName+"'")}else{cellText=cellText.replace(matches[k],"data-field"+k+"="+fieldName+" "+attributeName+"='"+convertedData+"' data-boundproperties"+k+"='"+attributeName+"'")}}return cellText},__rowInfoClasssync:function(){var _this=this;var onc=_this.itemLayoutDom[0].getAttribute("on-created");if(typeof onc==="string"){onc=Top.Util.namespace(onc,_this)}var brow=this.querySelector(".top-tableview-scroll").querySelectorAll(".body-row");var fixbrow=this.querySelector(".fixed_frame").querySelectorAll(".body-row");for(var i=0;i<brow.length;i++){if(i%this.itemrowNum>0){}var index=parseInt(i/this.itemrowNum);var trow=brow[i];if(!trow.originclass){trow.originclass=trow.getAttribute("class")}else{trow.setAttribute("class",trow.originclass)}if(!trow.originstyle){trow.originstyle=trow.getAttribute("style")}else{trow.setAttribute("style",trow.originstyle)}if(onc){onc(index+_this.startRowNum,_this.backupdata[index+_this.startRowNum],trow)}var status=_this.checkIndexpointer[index+_this.startRowNum]["status"];var status_str="read";if(status=="C"){status_str="create"}else if(status=="U"){status_str="update"}else if(status=="D"){status_str="delete"}trow.addClass(status_str);var real_idx=_this.checkIndexpointer[index+_this.startRowNum]["linkidx"];trow.addClass("dataIndex_"+real_idx);var odd_even=real_idx%2===0?"even":"odd";trow.addClass(odd_even);var selected=_this.checkIndexpointer[index+_this.startRowNum]["selected"];if(selected==true){trow.addClass("selected")}trow.dataIndex=real_idx}for(var i=0;i<fixbrow.length;i++){if(i%this.itemrowNum>0){}var trow=fixbrow[i];var index=parseInt(i/this.itemrowNum);if(!trow.originclass){trow.originclass=trow.getAttribute("class")}else{trow.setAttribute("class",trow.originclass)}if(!trow.originstyle){trow.originstyle=trow.getAttribute("style")}else{trow.setAttribute("style",trow.originstyle)}if(onc){onc(i+_this.startRowNum,_this.backupdata[index+_this.startRowNum],trow)}var status=_this.checkIndexpointer[index+_this.startRowNum]["status"];var status_str="read";if(status=="C"){status_str="create"}else if(status=="U"){status_str="update"}else if(status=="D"){status_str="delete"}trow.addClass(status_str);var real_idx=_this.checkIndexpointer[index+_this.startRowNum]["linkidx"];trow.addClass("dataIndex_"+real_idx);var odd_even=real_idx%2===0?"even":"odd";trow.addClass(odd_even);var selected=_this.checkIndexpointer[index+_this.startRowNum]["selected"];if(selected==true){trow.addClass("selected")}trow.dataIndex=real_idx}},__postBodyAppend:function(nTds,data,startIndex,__hasParent){var _this=this;var allTds=nTds;var columnOption=this.__columnOption;if(startIndex===undefined)startIndex=0;_this.__rowInfoClasssync();var bodyRoot=_this.querySelectorAll(".body");var objColumn=this.__column;var itemKeys=[];if(_this.bindingarray[0]){var bindkeys=Object.keys(_this.bindingarray[0]);for(var k=0;k<bindkeys.length;k++){var key=bindkeys[k];if(!_this.bindingarray[0][key].length>0){continue}var dld=null;if(this.bindingarray[0][key][0].tagName=="TD"){dld=_this.bindingarray[0][key][0].getAttribute("data-field")}else if(_this.bindingarray[0][key][0].template){dld=_this.bindingarray[0][key][0].template.boundProperties[0]}itemKeys[key]=dld}}for(var i=0;i<data.length+startIndex;i++){if(columnOption==undefined){break}var real_idx=_this.checkIndexpointer[i+_this.startRowNum]["linkidx"];for(var j=0;j<this.rowItemArray.length;j++){if(j<this.fixed_pivot_num){var targetRow=bodyRoot[0].children[i]}else{var targetRow=bodyRoot[1].children[i]}var count=0;if(this.checkable){count++}if(this.indexable){count++}if(this.lastHeader[j+count]["visible"]=="none"){continue}if(columnOption[itemKeys[j]]){var columnName=itemKeys[j]}else if(columnOption[j]){var columnName=j}else{continue}if(columnOption[columnName]==undefined){continue}var bindProperty=columnOption[columnName]["bindProperty"];var cell=targetRow.querySelector(".column_"+j);var cell_parent=cell;var convertedData=_this.__getValueByDataConverter(data[i][itemKeys[j]],{viewIndex:i,dataIndex:real_idx,columnIndex:j,columnName:columnName});if(_this.soneFlag){var convertedData=_this.__getValueByDataConverter(data[i],{viewIndex:i,dataIndex:real_idx,columnIndex:j,columnName:columnName})}if(columnOption[columnName]["layout"]==undefined){continue}if(typeof columnOption[columnName]["layout"]==="function"){cell.innerHTML="";var fnLayout=columnOption[columnName].layout;var strLayout=fnLayout(convertedData,i)||"";var cellWidget=document.createElement("div");cellWidget.innerHTML=strLayout;for(var k=0;k<cellWidget.children.length;k++){this.createHtmlObjects(cellWidget.children[k])}while(cellWidget.firstChild){cell.appendChild(cellWidget.firstChild)}this.createdItemWidgetAttachedCallback();cell.classList.remove("body-cell");cell.classList.add("body-cell");cell.classList.add("body-cell-custom");var children=cell.children;for(var k=0,len=children.length;k<len;k++){children[k].dataIndex=i;if(typeof children[k].__widgetAttached==="function")children[k].__widgetAttached()}bindProperty=bindProperty?bindProperty:"value";cell.setAttribute(bindProperty,data[i-startIndex][columnName]);cell.boundProperties=[bindProperty]}}}for(var allTdsIndex=0;allTdsIndex<allTds.length;allTdsIndex++){var item=allTds[allTdsIndex];var rowClassName=item.parentNode.className.match(/row_[0-9]+/)[0];var row=parseInt(rowClassName.replace("row_",""));var col=parseInt(item.getAttribute("col"));item.pos={row:row,col:col};item.dataIndex=_this.checkIndexpointer[row+_this.startRowNum]["linkidx"];if(data.length>0){var columnName=item.getAttribute("data-field")||_this.getElementsByClassName("head-cell")[item.cellIndex].getAttribute("value");item.columnName=columnName;item.dataObj=data[row-startIndex]}else if(data.length===0&&!_this.items){var thValue=_this.getElementsByClassName("head-cell")[item.cellIndex].getAttribute("value");item.columnName=thValue}if(columnOption){var thisColumnOption=columnOption[col]==undefined?columnOption[columnName]:columnOption[col]}if(!item.originclass){item.originclass=item.getAttribute("class")}else{item.setAttribute("class",item.originclass)}if(!item.originstyle){item.originstyle=item.getAttribute("style")}else{item.setAttribute("style",item.originstyle)}var thisRowColumn=_this.rowItemArray[col];if(thisRowColumn&&thisRowColumn.getAttribute("on-created")){var funcName=thisRowColumn&&thisRowColumn.getAttribute("on-created");if(funcName.includes("::unnamed_")){var onCreated=thisColumnOption["event"]["onCreated"]}else{var onCreated=funcName;if(typeof onCreated==="string"){onCreated=Top.Util.namespace(onCreated,_this)}}if(typeof events==="string")onCreated=Top.Util.namespace(events,_this);onCreated(row+_this.startRowNum,data[row-startIndex][columnName],item,_this.bindingarray[row][col])}else if(thisColumnOption&&thisColumnOption["event"]){var events=thisColumnOption["event"];var eventKeys=Object.keys(events);for(var k=0;k<eventKeys.length;k++){switch(eventKeys[k]){case"onCreated":{var onCreated=events["onCreated"];if(typeof events["onCreated"]==="string")onCreated=Top.Util.namespace(events["onCreated"],_this);onCreated(_this.checkIndexpointer[row]["linkidx"],data[row-startIndex][columnName],item,_this.bindingarray[row][col])}break;case"onCelldblclick":{_this["onCelldblclick_"+col]=events.onCelldblclick;_this.__addEventByAttr("celldblclick_"+col)}break}}}for(var index=0;index<_this.editableHead.length;index++){if(_this.editableHead[index]===item.cellIndex)item.classList.add("editable")}for(var index=0;index<_this.nonTooltipHead.length;index++){if(_this.nonTooltipHead[index]===item.cellIndex)item.classList.add("non-tooltip")}}},__initChildWidgetId:function(item,row,col){var _this=this;var tdChildren=item.querySelectorAll("*");var topWidget=/^TOP-[a-zA-Z]*/;var topWidgets=[];var len=tdChildren.length;while(len--){if(tdChildren[len].tagName=="TOP-WIDGETITEM"){continue}if(topWidget.test(tdChildren[len].tagName)){topWidgets.push(tdChildren[len])}}item.pos={row:row,col:col};initChildWidgetId();var matches;var dataFieldRegExp=new RegExp("([-\\w]+)=[\"|']({[\\w.]+})[\"|']","g");if(this.data.length>0){for(var index=0;index<topWidgets.length;index++){var wname=topWidgets[index].tagName;topWidgets[index].roottable=_this;topWidgets[index].boundProperties=[];topWidgets[index].fieldProperties=[];var widgethtml=topWidgets[index].outerHTML;widgethtml=widgethtml.replace(" linear-child-horizontal","");matches=widgethtml.match(dataFieldRegExp);if(matches==null){if(topWidgets[index].getAttribute("checked")=="js::check"){this.bindingtd[col].push(Top.Dom.__selectImpl(topWidgets[index]))}continue}else{switch(wname){case"TOP-LINEARLAYOUT":break;default:this.bindingtd[col].push(Top.Dom.__selectImpl(topWidgets[index]));break}}for(var z=0;z<matches.length;z++){var bound=matches[z].split("=")[0];var field=matches[z].split("=")[1];field=field.substring(2,field.indexOf("}"));topWidgets[index].boundProperties.push(bound);topWidgets[index].fieldProperties.push(field)}}}function initChildWidgetId(){for(var i=0;i<topWidgets.length;i++){var _item=topWidgets[i];if(_item.tagName==="TOP-RADIOBUTTON"){if(!_item.getAttribute("group-Id")){_item.groupId=Top.Util.guid()}else{_item.groupId=_item.getAttribute("group-Id")}_item.groupId=_item.groupId+"_"+row+"_"+col;_item.setAttribute("group-id",_item.groupId)}if(!_item.id)_item.id=Top.Util.guid();if(_item.tagName==="TOP-LINEARLAYOUT"){}_item.id=_item.id+"_"+row+"_"+col;_item.setAttribute("row",item.pos.row);_item.setAttribute("col",item.pos.col);if(typeof _item.__updateId==="function")_item.__updateId();_item.layoutParent=_this;if(typeof _item.__renderedImpl==="function"){_item.__renderedImpl()}if(typeof _item.__adjustWidgets==="function"){_item.__adjustWidgets()}if(typeof _item.__attachedImpl==="function"){_item.__attachedImpl()}_item.tabIndex="-1";if(typeof _item.__updateTabIndex==="function")_item.__updateTabIndex()}}},sortByHeadIndex:function(a,b){var aClassList=a.className.split(" ");var bClassList=b.className.split(" ");var aClassStr="";var bClassStr="";for(var i=0;i<a.classList.length;i++){if(a.classList[i].includes("headIndex_"))aClassStr=a.classList[i].substring("headIndex_".length,a.classList[i].length).split("_")}for(var i=0;i<b.classList.length;i++){if(b.classList[i].includes("headIndex_"))bClassStr=b.classList[i].substring("headIndex_".length,b.classList[i].length).split("_")}for(var i=0;i<Math.min(aClassStr.length,aClassStr.length);i++){var aCurStr=aClassStr[i]=="check"?-2:aClassStr[i]=="index"?-1:parseInt(aClassStr[i]);var bCurStr=bClassStr[i]=="check"?-2:bClassStr[i]=="index"?-1:parseInt(bClassStr[i]);if(aCurStr==bCurStr){continue}return aCurStr-bCurStr}return false},_colwidthsync:function(){var _this=this;var vi_none=[];for(var i=0;i<this.lastHeader.length;i++){if(this.lastHeader[i]["visible"]=="none"){vi_none.push(this.lastHeader[i]["lastHeadNum"])}}var headsetting=this.lastHeader;var default_width=_this.childRoot.offsetWidth/(headsetting.length-vi_none.length-1);if(default_width===0)default_width=150;var hcolgroup=_this.querySelectorAll("col");var fix=0;for(var i=0;i<headsetting.length-1;i++){if(i==this.fixed_pivot_num-1){}if(headsetting[i]["visible"]=="none"){fix++;continue}if(!headsetting[i].width||headsetting[i].width=="match_parent"){if(Top.Util.Browser.isIE()){if(i==headsetting.length-2){default_width=default_width-.5}}hcolgroup[i-fix].style.width=default_width+"px"}else{hcolgroup[i-fix].style.width=headsetting[i].width}}},_adjustcolumn:function(){var _this=this;var hcolgroup=_this.querySelector(".head_colgroup");var bcolgroup=_this.querySelector(".body_colgroup");for(var i=0;i<hcolgroup.children.length;i++){bcolgroup.children[i].style.width=hcolgroup.children[i].style.width}return},_makeTableshtml:function(){var _this=this;function _fnStringToCss(s){if(s===null){return"0px"}if(typeof s=="number"){return s<0?"0px":s+"px"}return s.match(/\d$/)?s+"px":s}var root=this.childRoot;var table=top$(this.querySelector("#"+this.id+" table.top-tableview"));table.attr("role","grid");var scroll={sX:this.layoutWidth,sY:this.layoutHeight,sXInner:""};var scrollX=scroll.sX;var scrollY=scroll.sY;var classes={sScrollId:"TopTables_Table_"+this.id+"_wrapper",sScrollWrapper:"top-tableview-wrapper no-footer",sScrollHead:"top-tableview-scrollHead",sScrollHeadInner:"top-tableview-scrollHeadInner",sScrollBodyBorder:"top-tableview-scrollBody-border",sScrollBody:"top-tableview-scrollBody",sScrollFoot:"",sScrollFootInner:""};var caption=table.children("caption");var captionSide=caption.length?caption[0]._captionSide:null;var headerClone=top$(table[0].cloneNode(false));var footerClone=top$(table[0].cloneNode(false));var colgroupClone=this.querySelector(".head_colgroup").cloneNode(true);colgroupClone.className="body_colgroup";var fixedolgroupClone=this.querySelector(".fixedheadcolgroup").cloneNode(true);fixedolgroupClone.className="fixedbodycolgroup";this.fixedbodyframe.append(fixedolgroupClone);var footer=table.children("tfoot");var _div="<div/>";var size=function(s){return!s?null:_fnStringToCss(s)};if(!footer.length){footer=null}var scrollbox=top$(_div,{id:classes.sScrollId,class:classes.sScrollWrapper});var scroller=top$(_div,{class:"top-tableview-scroll"}).append(top$(_div,{class:classes.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:scroll.sXInner||"100%"}).append(top$(_div,{class:classes.sScrollHeadInner}).css({"box-sizing":"border-box",width:scroll.sXInner||"100%"}).append(headerClone.removeAttr("id").css("margin-left",0).append(captionSide==="top"?caption:null).append(table.children("colgroup")).append(table.children("thead"))))).append(top$(_div,{class:classes.sScrollBodyBorder}).css({position:"relative",width:"100%",height:"auto"}).append(top$(_div,{class:classes.sScrollBody}).css({position:"relative",overflowX:this.virtualScroll?"unset":"auto",overflow:this.virtualScroll?"unset":"auto",width:"100%"}).append(table.prepend(colgroupClone))));if(footer){scroller.append(top$(_div,{class:classes.sScrollFoot}).css({overflow:"hidden",border:0,width:scrollX?size(scrollX):"100%"}).append(top$(_div,{class:classes.sScrollFootInner}).append(footerClone.removeAttr("id").css("margin-left",0).append(captionSide==="bottom"?caption:null).append(table.children("tfoot")))))}var children=scroller.children();var scrollHead=children[0];var scrollBody=children[1].children[0];var scrollFoot=footer?children[2]:null;if(scrollX){top$(scrollBody).on("scroll.DT",function(e){var scrollLeft=this.scrollLeft;scrollHead.scrollLeft=scrollLeft;if(footer){scrollFoot.scrollLeft=scrollLeft}})}if(Top.Util.Browser.isIE()){top$(scrollBody).css("height","100%")}this.nScrollHead=scrollHead;this.nScrollBody=scrollBody;this.nScrollFoot=scrollFoot;scrollbox.append(this.fixedframe);var autopage=document.createElement("div");autopage.className="auto-pagination";scrollbox.append(scroller[0]);if(this.pagerLocation.startsWith("t")){scrollbox.prepend(autopage)}else{scrollbox.append(autopage)}if(Top.Util.Browser.isIE()){top$(root).append(scrollbox[0])}else{root.append(scrollbox[0])}},__makeTopTablesObj:function(){var _this=this;var root=this.childRoot;var nTable=root.querySelector("#"+this.id+" table");this.pageLength=parseInt(this.pageLength);var dom=this.pagerLocation.startsWith("t")?"<l>t":"t<l>";var thisTable=this;this.Toptablerendered=true;this._colwidthsync();this._makeTableshtml();this.__fixed_table_02_calwidth();if(_this.paginate){_this.virtualmakePage()}if(_this.checkable){_this.checkboxes=top$("#"+this.id+" .top-tableview-scrollBody"+" table").find(".checkable-body");_this.showedCheckboxes=[];if(!_this.paginate)_this.showedCheckboxes=_this.checkboxes}if(_this.columnResize){var gripsElement=this.getElementsByClassName("top-tableview-grips")[0];gripsElement=undefined;if(!gripsElement){_this.makeColResizer()}}var order=this.order;var colReorder=this.columnReorder;if(this.columnReorder&&!this.checkable&&!this.indexable&&!this.fixed_pivot_num!=0){_this.makeColReorder()}if(this.sequence){_this.makesequence()}if(nTable.classList.contains("multiple-header")&&this.scrollTable&&(this.layoutWidth!==undefined&&(_this.layoutWidth.indexOf("%")!==-1||_this.layoutWidth==="match_parent"))||this.layoutWidth===undefined){if(this.windowResizeEvent===undefined)this.windowResizeEvent=function(){};window.removeEventListener("resize",this.windowResizeEvent);window.addEventListener("resize",this.windowResizeEvent)}this.filterColumnList=new Object;this.filterCheckedList=new Object;this.filterNodeList=new Object;this.filterOriginList=new Object;this.filterSearchColumnList=new Object;this.filterCount=0;this.__pushFilterData=function(column,checkedData,nodeData,headerId){_this.filterColumnList[_this.filterCount]=column;_this.filterCheckedList[_this.filterCount]=checkedData;_this.filterNodeList[_this.filterCount]=nodeData;var filterState=document.getElementById(headerId+"-button").querySelector(".top-button-icon").classList;if(!filterState.contains("icon-filter_setting")){filterState.add("icon-filter_setting");filterState.remove("icon-filter")}_this.filterCount++};this.__popFilterData=function(selectedColumn,headerId){if(_this.filterCount===0){return undefined}if(selectedColumn!==undefined&&selectedColumn!==null&&_this.filterOriginList[selectedColumn]!==undefined&&_this.filterOriginList[selectedColumn].length>0){delete _this.filterOriginList[selectedColumn]}_this.filterCount--;delete _this.filterColumnList[_this.filterCount];delete _this.filterCheckedList[_this.filterCount];delete _this.filterNodeList[_this.filterCount];var filterState=document.getElementById(headerId+"-button").querySelector(".top-button-icon").classList;if(filterState.contains("icon-filter_setting")){filterState.add("icon-filter");filterState.remove("icon-filter_setting")}};this.defaultbindEvent()},makesequence:function(){var sequencestr='<div class="seqbox">'+"[ "+"0"+"/"+this.backupdata.length+" ]"+"</div>";if(this.querySelector(".seqbox")==null){top$(this.querySelector(".top-tableview-root")).append(sequencestr)}},updatesequence:function(){var actrow=0;if(document.activeElement.pos){actrow=document.activeElement.pos.row+this.startRowNum+1}var nownum=actrow;var str="[ "+nownum+"/"+this.backupdata.length+" ]";top$(this.querySelector(".seqbox")).text(str)},checknodata:function(){if(this.data.length===0||!this.items){this.startRowNum=0;this.scrollbar_height();this.querySelector("div").style["overflow-y"]="hidden";var table=this.querySelector(".top-tableview-scrollBody table");var headdom=this.querySelector(".top-tableview-scrollHeadInner table");if(!this.h_total){this.h_total="100%"}top$(table).css("width",this.h_total);var body=this.querySelector(".top-tableview-scrollBody table .body");var fixbody=this.fixedframe.querySelector(".body");var headers=this.getHeaders();var sum=0;for(var i=0,len=headers.length;i<len;i++){sum+=parseInt(headers[i].getAttribute("colspan"))}var checkHead=Top.Dom.__selectImpl(this.querySelector(".checkable-head"));if(checkHead){checkHead.setProperties({checked:false})}top$(body).append("<tr class='body-row row_0 empty'><td colspan="+sum+" class='body-cell empty'>"+this.emptyMessage+"</td></tr>");top$(fixbody).append("<tr class='body-row row_0'><td colspan="+this.fixed_pivot_num+" class='body-cell'>"+"</td></tr>");this.__dispatchEvent(new CustomEvent("nodata",{detail:{}}))}},bindDTEvent:function(){var _this=this;var root=this.childRoot;var nDataTable=root.querySelector("#"+this.id+" .top-tableview-scrollBody"+" table");top$(nDataTable).on("order.dt",function(e){_this.setColWidget();var pageInfo=_this.getPageInfo();if(pageInfo&&pageInfo.page!==1){var pager=root.querySelector("top-pagination");if(!pager)return;pager.setAttribute("page",1);pager.page=1;_this.pagerType==="input"?pager.renderInput():pager.renderBasic();var dataLength=_this.dataLength!==undefined?_this.dataLength:_this.data.length;var len=_this.pageLength;var end=len===-1||len>dataLength?dataLength-1:len-1;_this.setPageInfo({start:0,end:end,page:1})}}).off("draw.dt").on("draw.dt",function(e,settings){if(_this.data.length===0&&_this.items){if(typeof _this.onEmpty==="function"){_this.onEmpty(Top.Dom.selectById(_this.id))}_this.__dispatchEvent(new CustomEvent("nodata"))}if(_this.itemClicktype==="select"&&_this.selectedItemIndex!==undefined){var previousRow=root.querySelector(".previous");var selectedRow=root.querySelector(".body-row.selected");if(selectedRow)var newPrevRow=selectedRow.previousSibling||selectedRow.parentNode.previousSibling.querySelector(".head-row");if(previousRow)previousRow.classList.remove("previous");if(newPrevRow)newPrevRow.classList.add("previous")}if(_this.checkable){_this.showedCheckboxes=[];_this.showedCheckboxes=Array.prototype.slice.call(root.querySelectorAll(".body-row .checkable .checkable-body"));_this.checkCallback()}_this.__renderDummyView();setRowIndex()}).off("column-reorder.dt").on("column-reorder.dt",function(){var allTrs=_this.getElementsByClassName("body-row");for(var trIndex=0;trIndex<allTrs.length;trIndex++){var item=allTrs[trIndex];var columnElem=item.querySelectorAll('[class*="column_"]');for(var i=0;i<columnElem.length;i++){var columnClassName=columnElem[i].className.match(/column_[0-9]+/)[0];columnElem[i].classList.remove(columnClassName);columnElem[i].classList.add("column_"+i);columnElem[i].pos["col"]=i;if(columnElem[i].tagName!=="TD")columnElem[i].parentNode.pos["col"]=i}}});function setRowIndex(){var pageInfo={start:this.startRowNum};var allTrs=_this.getElementsByClassName("body-row");for(var trIndex=0;trIndex<allTrs.length;trIndex++){var item=allTrs[trIndex];var rowClassName=item.className.match(/row_[0-9]+/)[0];var prevRowIndex=rowClassName.replace("row_","");var rowIndex=trIndex+pageInfo.start;if(rowIndex%2===0){item.classList.add("even");item.classList.remove("odd")}else{item.classList.add("odd");item.classList.remove("even")}item.classList.remove(rowClassName);item.classList.add("row_"+rowIndex);if(item.hasOwnProperty("childrenRows")){top$(item.childrenRows).attr("parent-index",rowIndex)}var Tds=item.getElementsByClassName("body-cell");for(var i=0;i<Tds.length;i++){var _item=Tds[i];if(_item.pos)_item.pos["row"]=rowIndex;if(_item.firstChild&&_item.firstChild.pos)_item.firstChild.pos["row"]=rowIndex}}}},defaultbindEvent:function(){var _this=this;var root=this.childRoot;var delay=200;var clicks=0;var timer=null;if(this.onHeaderdbclick){top$(this.querySelectorAll("thead")).find(".head-row .head-cell:not(.checkable)").on("click",function(e){clicks++;var __this=this;if(clicks===1){timer=setTimeout(function(){clicks=0;clickFunc(_this,__this)},delay)}else{clearTimeout(timer);clicks=0;dbclickFunc(_this,__this)}}).on("dbclick",function(e){e.preventDefault()})}else{top$(this.querySelectorAll("thead")).find(".head-row .head-cell:not(.checkable)").on("click",function(e){if(e.target.classList.contains("header-filter")){openFilterLayout(e,_this);return}clickFunc(_this,this)})}var sortDirectArray=[];var sort_dom=_this.querySelectorAll(".head-cell:not(.checkable)");for(var i=0;i<sort_dom.length;i++){
sort_dom[i].origintxt=sort_dom[i].textContent}var appendSortDirectArray=function(key,value,headernum){sortDirectArray.push({key:key,order:value,headernum:headernum});var len=Top.Util.__isBooleanTrue(_this.multiSortable)?3:1;if(sortDirectArray.length>len){__this=_this.querySelector(".head-cell#"+_this.headerInfoArray[sortDirectArray[0]["headernum"]]["id"]);sortDirectArray.shift();__this.classList.remove("sorting_asc");__this.classList.remove("sorting_desc")}return sortDirectArray.length-1};var getSortIndex=function(key){for(var i=0;i<sortDirectArray.length;i++){if(sortDirectArray[i]["key"]==key){return i}}return-1};var updateSortTextContent=function(_this){for(var i=0;i<sortDirectArray.length;i++){__this=_this.querySelector(".head-cell#"+_this.headerInfoArray[sortDirectArray[i]["headernum"]]["id"]);if(sortDirectArray[i]["order"]==true){__this.classList.remove("sorting_desc");__this.classList.add("sorting_asc")}else{__this.classList.remove("sorting_asc");__this.classList.add("sorting_desc")}}};function openFilterLayout(event,_this){event.stopPropagation();var filter=Top.Data.create({items:[{id:"selectAll",text:"Select All",children:[]}],selectedColumn:null});if(!Top.Dom.selectById("header_filterLayout")){createFilterLayout(event,_this,filter)}else{showFilterLayout(event,_this,filter)}_this.filterSearchColumnList[filter.selectedColumn]=false;var debouncingTimer;Top.Dom.selectById("headerfilter_input").setProperties({onKeyup:function(event,widget){if(event.keyCode===38||event.keyCode===40||event.keyCode===37||event.keyCode===39||event.keyCode===13){return}if(widget.getText().length>0){if(debouncingTimer){clearTimeout(debouncingTimer)}if(!_this.filterSearchColumnList[filter.selectedColumn]){_this.filterOriginList[filter.selectedColumn]=Top.Dom.selectById("header_filterList").template.nodes[0].children;_this.filterSearchColumnList[filter.selectedColumn]=true}debouncingTimer=setTimeout(function(){searchFilterNode(_this,filter)},500)}else{clearTimeout(debouncingTimer);_this.filterSearchColumnList[filter.selectedColumn]=false;getFilterItem(null,_this,filter)}}});Top.Dom.selectById("saveFilter_btn").setProperties({onClick:function(){var checkNodeList=Top.Dom.selectById("header_filterList").getCheckedNode();var nodeList=Top.Dom.selectById("header_filterList").template.nodes[0].children;if(_this.filterCount>=0&&filter.selectedColumn!==_this.filterColumnList[_this.filterCount-1]&&checkNodeList[0].id==="selectAll"&&!_this.filterSearchColumnList[filter.selectedColumn]){Top.Dom.selectById("header_filterLayout").setVisible("none");return}_this.rowidxconnecting();var searchArr;if(_this.filterCount===0||filter.selectedColumn===_this.filterColumnList[_this.filterCount-1]){searchArr=_this.backupdata}else{searchArr=_this.datapointer}if(_this.filterCount>0&&filter.selectedColumn===_this.filterColumnList[_this.filterCount-1]&&(checkNodeList[0].id!=="selectAll"||_this.filterSearchColumnList[filter.selectedColumn])){_this.__popFilterData(null,event.currentTarget.id)}var resultArr=new Array;if(_this.filterCount>0&&filter.selectedColumn===_this.filterColumnList[_this.filterCount-1]&&checkNodeList[0].id==="selectAll"){_this.__popFilterData(filter.selectedColumn,event.currentTarget.id);var tempArr=searchArr;for(key in _this.filterCheckedList){var copyArr=new Array;for(var j=0,length=_this.filterCheckedList[key].length;j<length;j++){if(_this.filterCheckedList[key][j].id==="selectAll")continue;var result=tempArr.filter(function(item){return _this.filterCheckedList[key][j].text===item[_this.filterColumnList[key]]});copyArr=copyArr.concat(result)}tempArr=copyArr}resultArr=tempArr}else{if(checkNodeList[0].id==="selectAll"){checkNodeList=checkNodeList[0].children}for(var i=0,checkLength=checkNodeList.length;i<checkLength;i++){var mergeArr=searchArr.filter(function(item){return checkNodeList[i].text===item[filter.selectedColumn]});resultArr=resultArr.concat(mergeArr)}_this.__pushFilterData(filter.selectedColumn,checkNodeList,nodeList,event.currentTarget.id)}_this.datapointer=null;_this.datapointer=resultArr;if(_this.paginate){_this.virtualmakePage();_this.virtualgoToPage(_this.currentPage,_this.getPageInfo())}_this.onScroll();_this.scrollbar_height();_this.checkCallback();Top.Dom.selectById("header_filterLayout").setVisible("none")}});Top.Dom.selectById("cancelFilter_btn").setProperties({onClick:function(){Top.Dom.selectById("header_filterLayout").setVisible("none")}})}function createFilterLayout(e,__this,filterData){var top=e.clientY+5;var left=e.clientX-5;var treeOption={node:{checkable:true,editable:false,deletable:false,draggable:false,checkInherit:true},view:{expand:true},event:{onNodeclick:null,onNodehover:null,onNodecheck:function(event,widget,nodeObj){var checkedData=widget.getCheckedNode();if(checkedData.length===0){Top.Dom.selectById("saveFilter_btn").setDisabled(true)}else{Top.Dom.selectById("saveFilter_btn").setDisabled(false)}},onNodedrag:null,onNodedrop:null}};var filterLayout='<top-linearlayout id="header_filterLayout" orientation="vertical" position="absolute"'+'                  layout-width="200px" layout-height="300px" layout-top="'+top+'px" layout-left="'+left+'px"'+'                  border-width="1px" border-style="solid" border-color="#0175bc"'+'                  background-color="#ffffff" visible="visible">'+'   <top-linearlayout orientation="horizontal" layout-width="100%" layout-height="32px" padding="6px 10px 6px 10px" '+'                       border-width="0px 0px 1px 0px" border-style="solid" border-color="#d8d8d8">'+'       <top-textfield id="headerfilter_input" hint="filter name"></top-textfield>'+"   </top-linearlayout>"+'   <top-linearlayout orientation="horizontal" layout-width="100%" layout-height="calc(100% - 86px)" margin="0px 10px 0px 10px" border-width="0px">'+'       <top-treeview id="header_filterList" item-clicktype="select" horizontal-scroll="false" layout-width="100%" layout-height="214px" virtual-scroll="true"'+'                     border-width="0px 0px 0px 0px" border-color="#d9e0ea" border-style="solid"'+'                     margin="0px" draggable="false"></top-treeview>'+'       <top-linearlayout id="header_filterEmptyLayout" orientation="vertical" horizontal-alignment="center"'+'                         layout-width="100%" layout-height="214px" border-width="0px" visible="none">'+'           <top-textview id="header_filterEmpty_title" text="No data match your search." margin="105px 0px 0px 0px"></top-textview>'+"       </top-linearlayout>"+"   </top-linearlayout>"+'   <top-linearlayout orientation="horizontal" layout-width="100%" layout-height="32px" padding="6px 10px 6px 10px" '+'                      layout-horizontal-alignment="center" border-width="1px 0px 0px 0px" border-style="solid" border-color="#d8d8d8">'+'       <top-button id="saveFilter_btn" class="headerfilter_ok" text="OK" margin="0px 10px 0px 0px"></top-button>'+'       <top-button id="cancelFilter_btn" class="headerfilter_cancel" text="Cancel"></top-button>'+"   </top-linearlayout>"+"</top-linearlayout>";Top.App.getCurrentPage().append(filterLayout);Top.Dom.selectById("header_filterList").setProperties({option:treeOption});getFilterItem(e,__this,filterData)}function showFilterLayout(e,__this,filterData){var top=e.clientY+5;var left=e.clientX-5;var layout=Top.Dom.selectById("header_filterLayout");Top.Dom.selectById("headerfilter_input").setText(null);Top.Dom.selectById("saveFilter_btn").setDisabled(false);if(layout.getVisible()==="visible"){layout.setVisible("none")}else{layout.setProperties({"layout-top":top+"px","layout-left":left+"px",visible:"visible"});getFilterItem(e,__this,filterData)}}function getFilterItem(event,_this,data){if(event!==null){var selectedColumn=event.currentTarget.dataField;data.setValue("selectedColumn",selectedColumn)}var searchArr;var resultArr=new Array;if(_this.filterCount===0||data.selectedColumn===_this.filterColumnList[_this.filterCount-1]){searchArr=_this.backupdata}else{searchArr=_this.datapointer}if(data.selectedColumn===_this.filterColumnList[_this.filterCount-1]&&_this.filterOriginList[data.selectedColumn]===undefined){resultArr=_this.filterNodeList[_this.filterCount-1]}else if(_this.filterOriginList[data.selectedColumn]!==undefined&&_this.filterOriginList[data.selectedColumn].length>0&&data.selectedColumn===_this.filterColumnList[_this.filterCount-1]){resultArr=_this.filterOriginList[data.selectedColumn]}else{searchArr.map(function(obj){obj[data.selectedColumn]=String(obj[data.selectedColumn]);var convertData=obj[data.selectedColumn].replace(/(\s*)/g,"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var duplicateCheck=resultArr.map(function(data){return data.id}).indexOf(convertData);if(duplicateCheck===-1){var resultObj=new Object;resultObj["id"]=convertData;resultObj["text"]=obj[data.selectedColumn];resultArr.push(resultObj)}})}setFilterItem(resultArr,_this,data,getBeforeFilterItem)}function setFilterItem(result,__this,filterData,callback){if(result.length>0){Top.Dom.selectById("header_filterList").setVisible("visible");Top.Dom.selectById("header_filterEmptyLayout").setVisible("none");Top.Dom.selectById("saveFilter_btn").setDisabled(false);filterData.setValue("items.0.children",result);Top.Dom.selectById("header_filterList").setProperties({nodes:filterData.items});Top.Dom.selectById("header_filterList").expandAll();if(typeof callback==="function"){callback(filterData,__this)}}else{Top.Dom.selectById("header_filterList").setVisible("none");Top.Dom.selectById("header_filterEmptyLayout").setVisible("visible");Top.Dom.selectById("saveFilter_btn").setDisabled(true)}}function getBeforeFilterItem(_filterData,_this){var filterList=Top.Dom.selectById("header_filterList");if(_filterData.selectedColumn===_this.filterColumnList[_this.filterCount-1]){if(filterList.template.nodes[0].children.length===_this.filterCheckedList[_this.filterCount-1].length){filterList.checkNode("selectAll",true);return}filterList.checkAll(false);for(var i=0,length=_this.filterCheckedList[_this.filterCount-1].length;i<length;i++){var nodeId=_this.filterCheckedList[_this.filterCount-1][i].id.replace(/[.*+?^${}()|[\]\\]/g,"$&");filterList.checkNode(nodeId,true)}}else{filterList.checkNode("selectAll",true)}}function searchFilterNode(_table,_filterData){var searchText=Top.Dom.selectById("headerfilter_input").getText();if(searchText!==""&&searchText!==null){var filterTree=Top.Dom.selectById("header_filterList");var searchArr=_table.filterOriginList[_filterData.selectedColumn];var resultArr=searchArr.filter(function(data){var reg=new RegExp(searchText);return reg.test(data.text)});filterTree.checkNode("selectAll",true);setFilterItem(resultArr,_table,_filterData)}else{getFilterItem(null,_table,_filterData)}}var clickFunc=function(_this,__this){var columnName=__this.getAttribute("value")||"";var headernum=__this.getAttribute("headernum");var columnIndex=headernum-_this.__getColumnIndexByLabel();var headerType=_this.headerInfoArray[headernum]["type"];var headerControl=_this.headerInfoArray[headernum]["header-control"];if(headerType=="check"||headerType=="index"||headerType=="index_r"){columnIndex=""}var callbackParams={headerType:headerType,columnIndex:columnIndex,columnName:columnName,target:__this};if(headerType==="normal"){if(!__this.classList.contains("sorting_disabled")){callbackParams.asc=__this.classList.contains("sorting_asc");callbackParams.desc=!callbackParams.asc}if(__this.classList.contains("sorting_asc")){callbackParams.sortState="asc"}else if(__this.classList.contains("sorting_desc")){callbackParams.sortState="desc"}else{callbackParams.sortState="initial"}__this.changeState=function(state){if(_this.sortStates===undefined)_this.sortStates=new Object;_this.sortStates[columnIndex]=state;_this.__setHeaderSortState(__this,state)};_this.__initHeaderSortState()}var sortable=_this.__dispatchEvent(new CustomEvent("headerclick",{detail:callbackParams}));if(sortable!==false&&__this.classList.contains("sorting")==true&&!(_this.data.length===0||!_this.items)){if(headerType=="check"){return}if(headerType=="index"){_this.__indexOption={}}if(headerControl=="js::open"){var columname=_this.textbind}else{var columname=headerType=="index"?"index":__this.dataField?__this.dataField:__this.innerText}var sortIdx=getSortIndex(columname);if(sortIdx<0){sortIdx=appendSortDirectArray(columname,true,headernum)}sortDirectArray[sortIdx]["order"]=!sortDirectArray[sortIdx]["order"];if(headerType=="index"||headerType=="index_r"||headerControl=="js::index"||headerControl=="js::index_r"){_this.index_reverse_sort(sortDirectArray[sortIdx]["order"])}else{_this.virtualsort(sortDirectArray)}updateSortTextContent(_this)}};var dbclickFunc=function(_this,__this){var columnName=__this.getAttribute("value")||"";var headerType="normal";var headernum=__this.getAttribute("headernum");var columnIndex=headernum-_this.__getColumnIndexByLabel();if(top$(__this).hasClass("checkable")){headerType="check";columnIndex=""}if(top$(__this).hasClass("indexable")){headerType="index";columnIndex=""}_this.__dispatchEvent(new CustomEvent("headerdbclick",{detail:{headerType:headerType,columnIndex:columnIndex,columnName:columnName,target:__this}}))};var scrollHead=root.querySelector(".top-tableview-scrollHead");var gripresizer=root.querySelector(".top-tableview-grips");this.__moveHeaderScroll=function(){scrollHead.scrollLeft=this.scrollLeft;if(gripresizer){gripresizer.style.right=this.scrollLeft+"px"}};var scrollBodyBorder=root.querySelector(".top-tableview-scrollBody-border");scrollBodyBorder.removeEventListener("scroll",this.__moveHeaderScroll);scrollBodyBorder.addEventListener("scroll",this.__moveHeaderScroll)},bindEvent:function(){var _this=this;var root=this.childRoot;var data=this.data;var before_tr_idx=0;var before_col_idx=0;var origin_tr_idx=0;var origin_col_idx=0;var tr_idx=0;var col_idx=0;var tr_object=null;var td_object=null;top$(this.querySelectorAll("tbody")).off("mouseover").on("mouseover",function(e){if(_this.e_rowhover||_this.e_cellhover){e.hflag=true;mEventhandler(e)}});top$(this.querySelectorAll("tbody")).off("mousedown").on("mousedown",function(e){mEventhandler(e);_this.addEventListener("mouseover",mEventhandler,false)}).off("scroll").on("drag mousewheel DOMMouseScroll",function(e){_this.removeEventListener("mouseover",mEventhandler,false);top$(_this).off("mouseover")}).off("mouseup").on("mouseup",function(e){for(var j=0;j<_this.checkIndexInfo.length;j++){_this.checkIndexInfo[j]["selected"]=false}var selectrow=_this.querySelector(".top-tableview-scroll").querySelectorAll(".body-row.selected");for(var k=0;k<selectrow.length;k++){var idx=selectrow[k].dataIndex;_this.checkIndexInfo[idx]["selected"]=true}_this.removeEventListener("mouseover",mEventhandler,false);top$(_this).off("mouseover")});top$(this).on("mouseleave",function(e){_this.removeEventListener("mouseover",mEventhandler,false)});top$(this.querySelectorAll("tbody")).off("click contextmenu dblclick").on("click contextmenu dblclick",function(e){_this.removeEventListener("mouseover",mEventhandler,true);mEventhandler(e)});var mEventhandler=function(e){if(e.target.className.includes("empty")){return}var etype=e.type;var begin=e.target;var search=begin;tr_idx=0;col_idx=0;var col_name="";var dataIndex=0;tr_object=null;td_object=null;if(e.type=="click"&&e.target.tagName=="TR"){return}while(true){if(search.tagName==undefined||search.tagName==null||search.tagName=="TBODY"){return}if(search.tagName=="TD"){col_idx=parseInt(search.getAttribute("col"));col_name=search.columnName;td_object=search}if(search.tagName=="TR"&&search.className.includes("body")){tr_idx=parseInt(search.className.match(/row_[0-9]+/)[0].replace("row_",""));dataIndex=search.dataIndex;tr_object=search;break}search=search.parentNode}if(td_object.querySelector(".TOP_tree")){}if(td_object!=null&&td_object.className.includes("incapable")){return}if(e.hflag==true){if(_this.e_rowhover){var r_hover=_this.e_rowhover;if(typeof r_hover==="string"){r_hover=Top.Util.namespace(r_hover,_this)}var trobj={nTr:tr_object,nTd:td_object,dataIndex:dataIndex,rowIndex:dataIndex-_this.startRowNum};r_hover(e,_this,trobj)}if(_this.e_cellhover){var ce_hover=_this.e_cellhover;if(typeof ce_hover==="string"){ce_hover=Top.Util.namespace(ce_hover,_this)}var tdobj={nTd:td_object,dataIndex:dataIndex+_this.startRowNum,rowIndex:dataIndex};ce_hover(e,_this,tdobj)}return}if(_this.itemClicktype==="select"||etype=="mouseover"){multiselect(e)}else if(_this.itemClicktype==="click"){multiselect(e)}_this.clickedItemIndex=[tr_idx+_this.startRowNum,col_idx];var _ClickedRowData=data[tr_idx];var _ClickedCellData=data[tr_idx][col_name];if(etype=="click"){_this.__dispatchEvent(new CustomEvent("rowclick",{detail:{data:_ClickedRowData,dataIndex:dataIndex,rowIndex:dataIndex-_this.startRowNum,beforerowIndex:before_tr_idx,target:begin}}));_this.__dispatchEvent(new CustomEvent("cellclick",{detail:{data:_ClickedRowData,dataIndex:dataIndex,rowIndex:dataIndex-_this.startRowNum,columnIndex:col_idx,columnName:col_name,target:begin}}))}if(etype=="dblclick"){_this.__dispatchEvent(new CustomEvent("rowdblclick",{detail:{data:_ClickedRowData,dataIndex:dataIndex,rowIndex:dataIndex-_this.startRowNum,beforerowIndex:before_tr_idx,target:begin}}));_this.__dispatchEvent(new CustomEvent("celldblclick",{detail:{data:_ClickedRowData,dataIndex:dataIndex,rowIndex:dataIndex-_this.startRowNum,columnIndex:col_idx,columnName:col_name,target:begin}}))}if(etype=="contextmenu"){_this.__dispatchEvent(new CustomEvent("rowcontextmenu",{detail:{data:_ClickedRowData,dataIndex:dataIndex,rowIndex:dataIndex-_this.startRowNum,target:begin}}));_this.__dispatchEvent(new CustomEvent("cellcontextmenu",{detail:{data:_ClickedRowData,dataIndex:dataIndex,rowIndex:dataIndex-_this.startRowNum,columnIndex:col_idx,columnName:col_name,target:begin}}))}before_tr_idx=tr_idx;before_col_idx=col_idx;if(_this.sequence){_this.updatesequence()}};var multiselect=function(e){var etype=e.type;if(e.ctrlKey&&_this.multiSelect!="false"){if(_this.selectType=="row"){tr_object.classList.add("selected")}else{td_object.classList.add("selected")}}else if((e.shiftKey||etype=="mouseover")&&_this.multiSelect!="false"){top$("#"+_this.id+" .selected").removeClass("selected");top$("#"+_this.id+" .previous").removeClass("previous");var fromtr=tr_idx>origin_tr_idx?origin_tr_idx:tr_idx;var totr=tr_idx<origin_tr_idx?origin_tr_idx:tr_idx;var fromcol=col_idx>origin_col_idx?origin_col_idx:col_idx;var tocol=col_idx<origin_col_idx?origin_col_idx:col_idx;if(_this.selectType=="row"){for(var i=fromtr;i<totr+1;i++){var rowstr=".row_"+i;top$("#"+_this.id+" "+rowstr).addClass("selected")}}else{for(var i=fromtr;i<totr+1;i++){var rowstr=".row_"+i;for(var k=fromcol;k<tocol+1;k++){var colstr=".column_"+k;top$("#"+_this.id+" "+rowstr+" "+colstr).addClass("selected")}}}}else{top$("#"+_this.id+" .selected").removeClass("selected");top$("#"+_this.id+" .previous").removeClass("previous");if(_this.selectType=="row"){top$("#"+_this.id+" "+".row_"+tr_idx).addClass("selected");origin_tr_idx=tr_idx;origin_col_idx=col_idx}else{td_object.classList.add("selected");origin_tr_idx=tr_idx;origin_col_idx=col_idx}}};if(this.checkable){var checkableHead=top$("#"+this.id+" .checkable-head .top-checkbox-text");checkableHead.off("click").on("click",function(event){var __checked=this.previousElementSibling.checked;_this.checkAll(__checked,_this.paginate);if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("headercheck"))}else{_this.__dispatchEvent(new Event("headercheck"))}});this.checkboxes=top$("#"+this.id+" .top-tableview-scrollBody"+" table").find(".checkable-body");var len=this.checkboxes.length;var lastChecked=null;var lastCheckedIndex=null;var currentRowNum=this.startRowNum;if(this.__checkClickListener===undefined){this.__checkClickListener=function(event){var widget=Top.Dom.__selectImpl(event.target.parentNode);if(widget===null)widget=Top.Dom.__selectImpl(event.target.parentNode.parentNode);var data=_this.data;if(_this.singlecheck){var __checked=widget.getProperties("checked");_this.checkAll(false);widget.setProperties({checked:__checked})}var __checked=widget.getProperties("checked")==true||widget.getProperties("checked")=="true"?true:false;var idx=widget.template.givenidx;if(_this.connect){_this.datapointer[idx]["temp"].checkbool=__checked}else if(_this.treetable){_this.checkIndexpointer[idx].checkbool=__checked}else{_this.checkIndexInfo[idx].checkbool=__checked}if(!lastChecked){lastChecked=widget.template;lastCheckedIndex=_this.checkboxes.index(lastChecked)+_this.startRowNum}if(event.shiftKey){var first=_this.checkboxes.index(widget.template)+_this.startRowNum;var last=lastCheckedIndex;var start=Math.min(first,last);var end=Math.max(first,last);for(var j=start;j<end+1;j++){_this.checkIndexInfo[j].checkbool=widget.template.checked;if(_this.checkboxes[j-_this.startRowNum])_this.checkboxes[j-_this.startRowNum].querySelector(".top-checkbox-check").checked=widget.template.checked}if(Top.Util.Browser.isIE())document.getSelection().removeAllRanges()}lastChecked=widget.template;lastCheckedIndex=_this.checkboxes.index(lastChecked)+_this.startRowNum;_this.checkCallback(lastCheckedIndex);var fnRowCheck=_this.onRowcheck;if(typeof _this.onRowcheck==="string"){fnRowCheck=Top.Util.namespace(_this.onRowcheck,_this)}if(typeof fnRowCheck==="function"){var detail={detail:{data:data[_this.checkboxes.index(lastChecked)],dataIndex:lastCheckedIndex,rowIndex:_this.checkboxes.index(lastChecked)}};if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("rowcheck",detail))}else{_this.__dispatchEvent(new Event("rowcheck",detail))}}if(typeof _this.onCheckFunc==="function"){var checked=_this.checkIndexInfo[lastCheckedIndex].checkbool;_this.onCheckFunc(lastCheckedIndex,_this.backupdata[lastCheckedIndex],checked)}}}for(var i=0;i<len;i++){var checkbox=Top.Dom.__selectImpl(this.checkboxes[i]);checkbox.template.__isRendered=true;checkbox.template.getElementsByClassName("top-checkbox-text")[0].addEventListener("click",this.__checkClickListener)}top$(root.querySelector("tbody")).on("click","tr.body-row td.checkable",function(e){e.stopPropagation()})}top$(root.querySelector(".top-tableview-scroll tbody")).off("dblclick","td.editable").on("dblclick","td.editable",function(e){var editingCell=this;var rowIndex=parseInt(top$(this).closest("tr")[0].className.match(/row_[0-9]+/)[0].replace("row_",""));var columnName=this.columnName;var columnIndex=this.pos["col"];for(var i=0;i<this.childNodes.length;i++){if(this.childNodes[i].nodeName==="#text"){var thisText=this.childNodes[i].nodeValue||"";var textElement=this.childNodes[i]}if(this.childNodes[i].nodeName==="TOP-TEXTVIEW"){var thisText=this.childNodes[i].getAttribute("text")||"";var textElement=this.childNodes[i];break}}if(!textElement&&this.childNodes.length>0)return;if(textElement){if(textElement.tagName==="TOP-TEXTVIEW")top$(textElement).hide();else top$(textElement).remove()}if(typeof _this.__columnOption==="string"){var objOption=Top.Util.namespace(_this.__columnOption,_this)}else if(typeof _this.__columnOption==="object"){var objOption=_this.__columnOption}var editType="textfield";if(objOption&&objOption[columnName]){editType=objOption[columnName].editType||"textfield";var editProperties=objOption[columnName].editProperty}else if(objOption&&objOption[columnIndex]){editType=objOption[columnIndex].editType||"textfield";var editProperties=objOption[columnIndex].editProperty}if(editProperties===undefined){var editProperties={}}var newEditWidget;switch(editType){case"selectbox":{newEditWidget=Top.Widget.create("top-selectbox");editProperties["selected-text"]=thisText||"";break}case"datepicker":{newEditWidget=Top.Widget.create("top-datepicker");editProperties["date"]=thisText||"";break}case"textfield":{newEditWidget=Top.Widget.create("top-textfield");editProperties["text"]=thisText||"";break}default:{newEditWidget=eval("Top.Widget.create('top-"+editType+"')");editProperties["text"]=thisText||""}}if(editProperties){newEditWidget.setProperties(editProperties)}top$(this).append(newEditWidget.template);TopRuntime._callCallback(newEditWidget.template,"attached");var $editingWidget=top$(this).find("> top-"+editType);if(editType==="textfield"){var input=this.querySelector("top-textfield input");input.addEventListener("blur",function(){$editingWidget.blur()})}if(editProperties){$editingWidget.prop("layoutParent",_this);$editingWidget[0].__boundController=_this.getController();$editingWidget[0].__initBoundData(true,$editingWidget[0].id);$editingWidget[0].__initEvent()}$editingWidget.focus();$editingWidget.on("dblclick",function(e){e.stopPropagation()}).on("mousedown",function(e){e.stopPropagation()});$editingWidget.on("blur keypress change select close",function(e,w,p){_this.removeEventListener("mouseover",mEventhandler,false);var textContentValue="";if(this.tagName==="TOP-TEXTFIELD"){if(!(e.type==="blur"||e.keyCode===13))return;textContentValue=this.text}else if(this.tagName==="TOP-TEXTAREA"){if(!(e.type==="blur"))return;textContentValue=this.text}else if(this.tagName==="TOP-SELECTBOX"){if(!(e.type==="change"||e.type==="close"))return;textContentValue=this.selectedText}else if(this.tagName==="TOP-DATEPICKER"){if(e.type!=="select")return;textContentValue=this.date}if(this.tagName==="TOP-TEXTFIELD"){if(typeof this.validation==="function"){if(!this.validation())return}}var textContent=document.createTextNode(textContentValue);top$(this).remove();if(textElement&&textElement.tagName==="TOP-TEXTVIEW"){textElement.setAttribute("text",textContent.nodeValue);textElement.text=textContent.nodeValue;textElement.__updateProperties("text");top$(textElement).show()}else{editingCell.appendChild(textContent)}var convertedData=_this.__setValueByDataConverter(textContent.nodeValue,{dataIndex:editingCell.dataIndex,rowIndex:rowIndex,columnIndex:columnIndex,columnName:columnName});editingCell.setAttribute("value",convertedData);_this.__dispatchEvent(new CustomEvent("edit",{detail:{dataIndex:editingCell.dataIndex,rowIndex:rowIndex,columnIndex:columnIndex,columnName:columnName,before:thisText,after:textContentValue,target:editingCell}}))})});if(Top.Util.__isBooleanTrue(this.headerContextMenu)){this.__bindHeaderContextMenu()}if(Top.Util.__isBooleanTrue(this.Draggable)){this.__bindTreeDrag()}},__bindHeaderContextMenu:function(){var _this=this;function itemclickListener(event,menu,data){var target=_this.__contextMenuTarget;var sort=function(asc){var num=target.getAttribute("headernum");var type=_this.headerInfoArray[num].type;var key=type==="index"?"index":target.dataField?target.dataField:target.innerText;if(type==="index"){if(_this.__indexOption.reverse===undefined)_this.__indexOption.reverse=false;var desc=!asc;if(_this.__indexOption.reverse!=desc){_this.__indexOption.reverse=desc;_this.__renderIndexForVirtualScroll();_this.index_reverse_sort()}}else{_this.virtualsort([{key:key,order:asc}])}if(asc===true){target.classList.remove("sorting_desc");target.classList.add("sorting_asc")}else{target.classList.remove("sorting_asc");target.classList.add("sorting_desc")}};if(data.selectedItem.id==="sortAscending"){sort(true)}else if(data.selectedItem.id==="sortDescending"){sort(false)}else if(data.selectedItem.id==="hideColumn"){var headerNum=parseInt(target.getAttribute("headernum"));var index=null;for(var i=0;i<_this.lastHeader.length;i++){if(_this.lastHeader[i]["header-array-index"]===headerNum){index=_this.lastHeader[i]["body-mapping-index"];break}}if(index!==null){Top.Dom.selectById(_this.id).setColumnsVisible(index,false)}}else if(data.selectedItem.id==="showAllColumns"){var indexes=[];for(var i=0;i<_this.lastHeader.length;i++){indexes[i]=_this.lastHeader[i]["body-mapping-index"]}Top.Dom.selectById(_this.id).setColumnsVisible(indexes,true)}}var contextMenuId=this.id+"__headerContextMenu";window[contextMenuId]=Top.Data.create({items:[{id:"sortAscending",text:"Sort Ascending",onClick:itemclickListener},{id:"sortDescending",text:"Sort Descending",onClick:itemclickListener},{id:"hideColumn",text:"Hide Column",onClick:itemclickListener},{id:"showAllColumns",text:"Show All Columns",onClick:itemclickListener}]});var obj={};obj[contextMenuId]=contextMenuId+".items";Top.ContextMenu.create(obj);if(this.__headerContextMenuListener===undefined){this.__headerContextMenuListener=function(event){_this.__contextMenuTarget=event.target;Top.Dom.selectById(contextMenuId).open(event);event.preventDefault();event.stopPropagation()}}var head=this.getElementsByClassName("head");for(var i=0;i<head.length;i++){head[i].removeEventListener("contextmenu",this.__headerContextMenuListener);head[i].addEventListener("contextmenu",this.__headerContextMenuListener)}},__bindTreeDrag:function(){var _this=this;var updatedrag;var treeCells=this.getElementsByClassName("column_tree");if(this.__treeDragstartListener===undefined){this.__treeDragstartListener=function(ev){ev.dataTransfer.setData("text",ev.target.dataIndex+"")}}for(var i=0;i<treeCells.length;i++){treeCells[i].draggable=true;treeCells[i].addEventListener("dragstart",this.__treeDragstartListener)}var table=this.querySelector(".top-tableview-wrapper");if(this.__treeDragoverListener===undefined){this.__treeDragoverListener=function(ev){ev.preventDefault();var lastone=treeCells[treeCells.length-1].dataIndex;var oldTarget=_this.querySelector(".same,.super");if(oldTarget)oldTarget.classList.remove("same");if(oldTarget)oldTarget.classList.remove("super");var cellheight=ev.target.offsetHeight;if(ev.offsetY>cellheight-12){ev.target.classList.add("same");if(ev.target.dataIndex==lastone){dragmove("+")}}else{ev.target.classList.add("super")}if(ev.target.tagName!="TD"){if(ev.offsetY<_this.hh){if(_this.startRowNum<=0){return}dragmove("-")}}}}var dragmove=function(up_down){var dic=up_down;if(!updatedrag){if(dic=="+"){_this.startRowNum++}else{_this.startRowNum--}updatedrag=setTimeout(function(){updatedrag=null;_this.onScroll()},200)}};table.removeEventListener("dragover",this.__treeDragoverListener);table.addEventListener("dragover",this.__treeDragoverListener);if(this.__treeDropListener===undefined){var _this=this;this.__treeDropListener=function(ev){var startIndex=parseInt(ev.dataTransfer.getData("text"));var endIndex=parseInt(ev.target.dataIndex);if(isNaN(endIndex)){return}if(ev.target.className.includes("same")){ev.target.classList.remove("same");_this.changeNodePos(startIndex,endIndex,"same");_this.onScroll()}else if(ev.target.className.includes("super")){ev.target.classList.remove("super");_this.changeNodePos(startIndex,endIndex,"super");_this.onScroll()}}}table.removeEventListener("drop",this.__treeDropListener);table.addEventListener("drop",this.__treeDropListener)},__renderDummyView:function(rows){if(this.dummyRow!==true)return;if(rows)this.numOfDummyRows=rows;var dummyRowElement=this.childRoot.querySelectorAll(".body-row-dummy:not(.tree-control)");var columnsLen=this.columnsLen;var fragment=document.createDocumentFragment();var tempTRElement,tempTDElement;if(this.numOfDummyRows){if(this.numOfDummyRows===dummyRowElement.length){return}else if(this.numOfDummyRows>=dummyRowElement.length){for(var i=0;i<this.numOfDummyRows-dummyRowElement.length;i++){tempTRElement=document.createElement("tr");tempTRElement.className="body-row-dummy";for(var j=0;j<columnsLen;j++){tempTDElement=document.createElement("td");tempTDElement.className="body-cell-dummy";tempTRElement.appendChild(tempTDElement)}fragment.appendChild(tempTRElement)}}else if(this.numOfDummyRows<dummyRowElement.length){var len=dummyRowElement.length-this.numOfDummyRows;while(len--){dummyRowElement[len].parentNode.removeChild(dummyRowElement[len])}}}else{if(!this.paginate||this.pageInfo===undefined)return;var startIndex=this.pageInfo.start;var endIndex=this.pageInfo.end;var pageLength=this.pageInfo.length;var showedItems=endIndex-startIndex+1;if(this.data.length===0)showedItems++;if(pageLength>=showedItems){if(pageLength-showedItems===dummyRowElement.length){return}else if(pageLength-showedItems>=dummyRowElement.length){for(var i=0;i<pageLength-showedItems-dummyRowElement.length;i++){tempTRElement=document.createElement("tr");tempTRElement.className="body-row-dummy";
for(var j=0;j<columnsLen;j++){tempTDElement=document.createElement("td");tempTDElement.className="body-cell-dummy";tempTRElement.appendChild(tempTDElement)}fragment.appendChild(tempTRElement)}}else if(pageLength-showedItems<dummyRowElement.length){var len=dummyRowElement.length-(pageLength-showedItems);while(len--){dummyRowElement[len].parentNode.removeChild(dummyRowElement[len])}}}}if(fragment.childNodes.length>0){this.getElementsByClassName("body")[0].appendChild(fragment)}},__renderIndex:function(){this.__renderIndexForVirtualScroll();return},__renderIndexForVirtualScroll:function(){var tds=this.querySelectorAll(".indexable.body-cell");var start=this.startRowNum>0?this.startRowNum:0;if(this.__indexOption&&this.__indexOption.reverse){for(var i=0,len=tds.length;i<len;i++){tds[i].innerHTML=this.backupdata.length-this.checkIndexpointer[start+i]["linkidx"]}}else{for(var i=0,len=tds.length;i<len;i++){tds[i].innerHTML=this.checkIndexpointer[start+i]["linkidx"]+1}}},sync:function(){console.log("sync method")},__syncData:function(editableCells,type){var _this=this;for(var i=0,len=editableCells.length;i<len;i++){var bodyCell=top$(editableCells[i]).closest(".body-cell")[0];var index=bodyCell&&bodyCell.dataIndex!==undefined?bodyCell.dataIndex:editableCells[i].dataIndex;var column=bodyCell&&bodyCell.columnName?bodyCell.columnName:editableCells[i].columnName;var data=editableCells[i].dataObj||{};var updatedValue,convertedData;if(type==="editable"){if(editableCells[i].tagName=="TD"){updatedValue=editableCells[i].innerText||""}convertedData=this.__setValueByDataConverter(updatedValue,{dataIndex:index,columnName:column});data[column]=convertedData;if(bodyCell)bodyCell.setAttribute("value",convertedData)}else if(type==="editable-cell"){if(editableCells[i].hasOwnProperty("boundProperties")){var boundProperties=editableCells[i].boundProperties;for(var j=0;j<boundProperties.length;j++){var _item=boundProperties[j];updatedValue=editableCells[i][_item]!==undefined?editableCells[i][_item]:"";convertedData=_this.__setValueByDataConverter(updatedValue,{dataIndex:index,columnName:column});if(editableCells[i].tagName==="TOP-SELECTBOX"){if(_item!=="value"&&_item!=="selected-text"&&_item!=="selected-index"){updatedValue=editableCells[i].selectedText||"";convertedData=_this.__setValueByDataConverter(updatedValue,{dataIndex:index,columnName:column})}else{data[column]=convertedData}}else{data[column]=convertedData}if(bodyCell)bodyCell.setAttribute("value",convertedData)}}else{if(editableCells[i].tagName=="TOP-SELECTBOX"){updatedValue=editableCells[i].selectedText||""}else if(editableCells[i].tagName=="TOP-CHECKBOX"){updatedValue=editableCells[i].checked?true:false}else if(editableCells[i].tagName=="TOP-DATEPICKER"){updatedValue=editableCells[i].date||""}else{updatedValue=editableCells[i].text||""}convertedData=_this.__setValueByDataConverter(updatedValue,{dataIndex:index,columnName:column});data[column]=convertedData;if(bodyCell)bodyCell.setAttribute("value",convertedData)}}}this.updateData("items")},check:function(index,checked){if(index===undefined){return}if(index>=this.checkIndexInfo.length){return}if(checked===undefined)checked=true;if(this.checkIndexInfo){if(index instanceof Array){for(var i=0;i<index.length;i++){if(!this.checkIndexInfo[index[i]])continue;this.checkIndexInfo[index[i]].checkbool=checked}}else{this.checkIndexInfo[index].checkbool=checked}this.checkboolsync();if(this.showedCheckboxes!==undefined){var _this=this;setTimeout(function(){_this.checkCallback()},0)}var fnRowCheck=this.onRowcheck;var fnCheck=this.onCheckFunc;if(typeof this.onRowcheck==="string"){fnRowCheck=Top.Util.namespace(this.onRowcheck,this)}if(typeof this.onCheckFunc==="string"){fnCheck=Top.Util.namespace(this.onCheckFunc,this)}if(typeof fnRowCheck==="function"){if(Top.Util.Browser.isIE()){fnRowCheck(new CustomEvent("rowcheck"),Top.Dom.selectById(this.id))}else{fnRowCheck(new Event("rowcheck"),Top.Dom.selectById(this.id))}}}},checkAll:function(checked,paginate){if(checked==undefined){checked=true}if(this.connect){for(var i=0;i<this.datapointer.length;i++){this.datapointer[i]["temp"].checkbool=checked}this.checkboolsync();return}if(paginate==undefined){paginate=this.paginate}if(!paginate){for(var i=0;i<this.checkIndexInfo.length;i++){this.checkIndexInfo[i].checkbool=checked}}else{for(var i=this.getPageInfo().start;i<this.getPageInfo().end+1;i++){this.checkIndexInfo[i].checkbool=checked}}this.checkboolsync();this.checkCallback();this.onScroll()},setOnCheck:function(func){this.onCheckFunc=func},checkCallback:function(index){if(!this.paginate&&!this.connect){var isAllChecked=true;var checkableHead=Top.Dom.__selectImpl(this.querySelector(".checkable-head"));if(!checkableHead){return}for(var i=0;i<this.checkIndexInfo.length;i++){if(this.checkIndexInfo[i].checkbool==false||this.checkIndexInfo[i].checkbool=="false"){isAllChecked=false}}checkableHead.setProperties({checked:isAllChecked});return}this.showedCheckboxes=[];this.showedCheckboxes=Array.prototype.slice.call(this.querySelectorAll(".body-row .checkable top-checkbox"));var data=this.data;var len=this.showedCheckboxes.length;var checkedList=[];var isAllChecked=false;for(var i=0;i<len;i++){isAllChecked=true;checkedList[i]=this.showedCheckboxes[i].querySelector("input").checked;if(!checkedList[i]){isAllChecked=false;break}}var checkableHead=Top.Dom.__selectImpl(this.childRoot.querySelector(".checkable-head"));if(isAllChecked&&checkableHead){checkableHead.setProperties({checked:true})}else if(!isAllChecked&&checkableHead){checkableHead.setProperties({checked:false})}},__getColumnNameByIndex:function(column){var root=this.childRoot;if(column===undefined||root.querySelector(".body-row .body-cell.column_"+column)===null)return;var columnName=root.querySelector(".body-row .body-cell.column_"+column).columnName;return columnName},__getColumnIndexByLabel:function(label){var swapNum=this.swappable?1:0;var checkNum=this.checkable?1:0;var indexNum=this.indexable?1:0;if(label=="__swap")return 0;if(label=="__check")return swapNum;if(label=="__index")return swapNum+checkNum;return swapNum+checkNum+indexNum},getClickedIndex:function(){var clickedIndex=[];clickedIndex.push(this.clickedItemIndex[0]);clickedIndex.push(this.clickedItemIndex[1]);return clickedIndex},getClickedData:function(){return this.backupdata[this.clickedItemIndex[0]]},getCheckedIndex:function(){var checkedIndex=[];this.checkIndexInfo.forEach(function(item,index){if(item.checkbool==true||item.checkbool=="true"){checkedIndex.push(index)}});return checkedIndex},getCheckedData:function(){var checkedData=[];for(var i=0;i<this.checkIndexInfo.length;i++){if(this.checkIndexInfo[i].checkbool==true||this.checkIndexInfo[i].checkbool=="true"){checkedData.push(this.backupdata[i])}}return checkedData},selectCells:function(row,column){if(column=="check"){var thisTr=this.querySelectorAll(".checkable")[row]}else if(column=="index"){var thisTr=this.querySelectorAll(".indexable")[row]}else{var thisTr=this.querySelectorAll(".column_"+column)[row]}if(!thisTr){return}if(thisTr.length>1){for(var i=0;i<thisTr.length;i++){top$(thisTr[i]).trigger(top$.Event("click",{ctrlKey:true}))}}else{top$(thisTr).click()}},Cells:function(row,column){if(column){var base=0;if(this.checkable){base++}if(this.indexable){base++}column=column+base}return this.dataTable.cells(row,column).nodes()},selectData:function(index){var _this=this;if(index instanceof Array){for(var i=0;i<index.length;i++){this.checkIndexInfo[index[i]]["selected"]=true}}else{this.checkIndexInfo[index]["selected"]=true}this.__rowInfoClasssync()},deselectData:function(index){var _this=this;if(index instanceof Array){for(var i=0;i<index.length;i++){this.checkIndexInfo[index[i]]["selected"]=false}}else{this.checkIndexInfo[index]["selected"]=false}this.__rowInfoClasssync()},calcPage:function(index){if(index<this.data.length){var pageInfo=this.dataTable.page.info();return parseInt(index/pageInfo.length)}},makeColReorder:function(){var _this=this;_this.beforecol=-1;_this.aftercol=-1;_this.firstHeads=Array.from(_this.querySelectorAll("th.last-head:not(.checkable):not(.indexable):not(.incapable_header)")).sort(_this.sortByHeadIndex);_this.hcolgroup=_this.querySelector(".head_colgroup:not(.incapable_header)");top$(_this.firstHeads).off().draggable({helper:"clone",axis:"x",start:function(e){currentcolumn(e.target.offsetLeft)},drag:function(e,helper){whereisthecolumnposition(helper.offset.left)},stop:function(e){testmove(e);setdefualt(e)}});var resizers=_this.resizers;function setdefualt(){for(var i=0;i<resizers.length;i++){resizers[i].style.backgroundColor=""}}function testmove(e){if(_this.beforecol==_this.aftercol||_this.aftercol<0){return}var after=_this.aftercol;var before=_this.beforecol;var newNodes=_this.getTableHeaderInfoByTree();if(after<before){newNodes.splice(after,0,newNodes[before]);newNodes.splice(before+1,1)}else{newNodes.splice(after,0,newNodes[before]);newNodes.splice(before,1)}_this.__changedColumns=newNodes;if(_this.storeColumn){var name=_this.storeKey||_this.id;_this.setLocalStorage(name,newNodes)}_this.vNoneArr=[];for(var i=0;i<_this.lastHeader.length;i++){if(_this.lastHeader[i]["visible"]=="none"){_this.vNoneArr.push(_this.lastHeader[i]["lastHeadNum"]);_this.lastHeader[i]["visible"]="visible"}}_this.__reRender()}function currentcolumn(tagetpos){var tleft=tagetpos;for(var i=0;i<resizers.length;i++){if(tleft<resizers[i].offsetLeft){_this.beforecol=parseInt(resizers[i].getAttribute("index"));if(_this.beforecol<0){return}return}}}function whereisthecolumnposition(tagetpos){var tleft=tagetpos+_this.viewport[0].scrollLeft;for(var i=0;i<resizers.length;i++){if(i==resizers.length-1){if(tleft>resizers[i].offsetLeft){resizers[i].style.backgroundColor="orange";_this.aftercol=parseInt(resizers[i].getAttribute("index"))+1}else{resizers[i].style.backgroundColor=""}break}if(tleft<resizers[i+1].offsetLeft&&tleft>resizers[i].offsetLeft){_this.aftercol=i+1;if(_this.aftercol<0){resizers[i].style.backgroundColor=""}else{resizers[i].style.backgroundColor="orange";_this.aftercol=parseInt(resizers[i+1].getAttribute("index"))}}else{resizers[i].style.backgroundColor=""}}}},makeColResizer:function(){var root=this.childRoot;var tableElement=root.querySelector("table.top-tableview");if(tableElement===null)return;var gripsElement=this.getElementsByClassName("top-tableview-grips")[0];if(gripsElement)return;var headRows=this.querySelectorAll(".top-tableview-scrollHead .head-row");var _this=this;var tableRoot=root.getElementsByClassName("top-tableview-scroll")[0];var numOfHeader=this.sumOfColspan||this.columnOptiontoTable.length;var tableHeight=tableElement.offsetHeight;this.selectedResizer=null;gripsElement=document.createElement("div");gripsElement.className="top-tableview-grips";tableRoot.insertBefore(gripsElement,tableRoot.firstChild);var firstHeads=Array.from(_this.querySelectorAll("th.last-head:not(.ui-draggable-dragging)")).sort(_this.sortByHeadIndex);if(firstHeads.length==0){return}if(this.scrollTable){if(!this.data.length===0||!this.items){}}var bodyHeight=Math.min(root.querySelector(".top-tableview-scrollBody .top-tableview").offsetHeight,root.querySelector(".top-tableview-scrollBody").offsetHeight);var bodyWidth=Math.min(root.querySelector(".top-tableview-scrollBody .top-tableview").offsetWidth,root.querySelector(".top-tableview-scrollBody").offsetWidth);var resizerHeight=this.querySelector(".incapable_header").offsetHeight;var headCellTop=this.querySelector(".incapable_header").offsetTop;for(var i=0;i<firstHeads.length-1;i++){if(firstHeads[i].getAttribute("colspan")==="1"){var headCell=firstHeads[i];if(i==firstHeads.length-2){if(_this.columnResize!="auto"){}}if(i>_this.fixed_pivot_num-1){var headCellLeft=firstHeads[i+1].offsetLeft-5+"px"}else{var headCellLeft="9999px"}if(this.paginate&&this.pagerLocation.startsWith("t")){headCellTop=0}var resizerElement=document.createElement("div");resizerElement.className="top-tableview-resizer";resizerElement.setAttribute("index",headCell.getAttribute("actualdx"));resizerElement.setAttribute("style","height:"+resizerHeight+"px; left:  "+headCellLeft+"; top: "+headCellTop+"px "+(parseInt(headCellLeft)>tableRoot.offsetWidth?"display:none; ":""));gripsElement.appendChild(resizerElement)}}var prevX;top$(tableRoot.querySelectorAll(".top-tableview-resizer")).off("mousedown").on("mousedown",function(e){_dragInit(this);prevX=e.pageX});tableRoot.removeEventListener("mouseup",this._destroy);tableRoot.addEventListener("mouseup",this._destroy);this.resizers=top$("#"+_this.id+" .top-tableview-resizer");this.resizers.off().draggable({axis:"x",start:function(e){_this.originLeft=e.target.offsetLeft;e.target.style.backgroundColor="#357fd2"},drag:function(e){},stop:function(e){_moveElem(e);e.target.style.backgroundColor="";if(_this.storeColumn){_this.__storeCookieHeaderInfo()}}});var hcolgroup=_this.querySelectorAll(".head_colgroup .hcol,.fixedheadcolgroup .hcol");var bcolgroup=_this.querySelectorAll(".body_colgroup .hcol,.fixedbodycolgroup .hcol");this.resizers.off("dblclick").on("dblclick",function(e){if(_this.checkable||_this.indexable){return}var actidx=e.target.getAttribute("index");var maxWidth=0;var head_cls=".headIndex_"+actidx;var body_cls=".column_"+actidx;var headElement=root.querySelector("#"+_this.lastHeader[actidx].id);var bodyElements=root.querySelectorAll(body_cls);maxWidth=_this.__indexOverflown(headElement);for(var i=0;i<bodyElements.length;i++){var curBody=bodyElements[i];var cellinfo=_this.bindingarray[i][actidx];if(cellinfo.tagName=="TD"){var curWidth=_this.__indexOverflown(curBody);maxWidth=maxWidth>curWidth?maxWidth:curWidth}else if(cellinfo.template.tagName=="TOP-TEXTVIEW"){var curWidth=35+cellinfo.template.offsetWidth;maxWidth=maxWidth>curWidth?maxWidth:curWidth}else{var curWidth=35+cellinfo.template.offsetWidth;maxWidth=maxWidth>curWidth?maxWidth:curWidth}}var originwidth=headElement.offsetWidth;var result=maxWidth-originwidth;var originleft=parseInt(this.style.left);_this.originLeft=originleft;var result2=originleft+result;this.style.left=result2+"px";_moveElem(e)});if(_this.columnResize!="auto"){top$("#"+_this.id+" .top-tableview-resizer:last-child").off()}function _dragInit(elem){_this.selectedResizer=elem}function _moveElem(e){var hcolgroup=_this.querySelectorAll(".head_colgroup .hcol,.fixedheadcolgroup .hcol");var bcolgroup=_this.querySelectorAll(".body_colgroup .hcol,.fixedbodycolgroup .hcol");var selected=e.target;var originLeft=_this.originLeft;var movingValue=parseInt(e.target.style.left)-_this.originLeft;if(movingValue==0)return;if(isNaN(selected.getAttribute("index"))){var activeidx=selected.getAttribute("index")}else{var activeidx=parseInt(selected.getAttribute("index"))}var index=0;for(var k=0;k<hcolgroup.length;k++){var dt=hcolgroup[k].getAttribute("data-index");if(dt==activeidx){index=k;break}}var leftTH=[],rightTH=[];var hcolleft=hcolgroup[index];var bcolleft=bcolgroup[index];leftTH.push(firstHeads[index]);if(firstHeads[index+1]){rightTH.push(firstHeads[index+1]);var hcolright=hcolgroup[index+1];var bcolright=bcolgroup[index+1]}else{rightTH.push(null);var hcolright=null;var bcolright=null}if(_this.scrollTable){secondHeads=_this.querySelector(".body_colgroup");leftTH.push(secondHeads[index]);secondHeads[index+1]?rightTH.push(secondHeads[index+1]):rightTH.push(null)}var leftComputedStyle=window.getComputedStyle(leftTH[0]);var rightComputedStyle=window.getComputedStyle(rightTH[0]);var min=leftTH[0].offsetLeft;if(leftTH[0].nextSibling){var max=leftTH[0].nextSibling.offsetLeft+leftTH[0].nextSibling.offsetWidth}else{var max=min+leftTH[0].offsetWidth}var unitRatio=10;var overMax=false,overMin=false;if(movingValue>0){var movingLeft=parseFloat(originLeft)+movingValue;if(movingLeft>=max-unitRatio&&_this.columnResize!="auto"){top$(selected).css("left",originLeft+"px");return}}else if(movingValue<0){var movingLeft=parseFloat(originLeft)+movingValue;if(movingLeft<=min+unitRatio){top$(selected).css("left",originLeft+"px");return}}if(_this.columnResize=="auto"){rightTH[0]={style:"",colspan:"",auto:true};rightTH[1]={style:"",colspan:"",auto:true}}if(leftTH[0].style.whiteSpace)leftTH[0].style.whiteSpace="";if(leftTH[0].style.wordWrap)leftTH[0].style.wordWrap="";if(rightTH[0].style.whiteSpace)rightTH[0].style.whiteSpace="";if(rightTH[0].style.wordWrap)rightTH[0].style.wordWrap="";var leftTHBoxsizing=leftComputedStyle["boxSizing"];var rigthTHBoxsizing=rightComputedStyle["boxSizing"];if(leftTH[0].style.width&&rightTH[0].style.width){var sumOfWidth=parseInt(rightTH[0].style.width)+parseInt(leftTH[0].style.width)}if(leftTH[0].getAttribute("colspan")==="1"){if(leftTHBoxsizing==="border-box"){leftTH[0].style.width=movingLeft-min+"px";hcolleft.style.width=movingLeft-min+"px";bcolleft.style.width=movingLeft-min+"px"}else{leftTH[0].style.width=movingLeft-min-sumForLeft+"px";hcolleft.style.width=movingLeft-min-sumForLeft+"px";bcolleft.style.width=movingLeft-min-sumForLeft+"px"}}else{leftTH[0].style.width=leftTH[0].clientWidth-movingValue+"px"}if(_this.columnResize!="auto"){if(rightTH[0].getAttribute("colspan")==="1"){if(sumOfWidth){rightTH[0].style.width=sumOfWidth-parseInt(leftTH[0].style.width)+"px";hcolright.style.width=sumOfWidth-parseInt(leftTH[0].style.width)+"px";bcolright.style.width=sumOfWidth-parseInt(leftTH[0].style.width)+"px"}else{if(rigthTHBoxsizing==="border-box"){rightTH[0].style.width=max-movingLeft+"px";hcolright.style.width=movingLeft-min+"px";bcolright.style.width=movingLeft-min+"px"}else{rightTH[0].style.width=max-movingLeft-sumForRight+"px";bcolright.style.width=movingLeft-min-sumForLeft+"px";bcolright.style.width=movingLeft-min-sumForLeft+"px"}}}else{rightTH[0].style.width=rightTH[0].clientWidth-movingValue+"px"}}if(leftTH[1]){leftTH[1].style.width=leftTH[0].style.width;if(leftTH[1].style.whiteSpace)leftTH[1].style.whiteSpace="";if(leftTH[1].style.wordWrap)leftTH[1].style.wordWrap=""}if(_this.columnResize=="auto"){var thirdheads=_this.querySelectorAll(".top-tableview-resizer");for(var j=0;j<firstHeads.length-1;j++){if(firstHeads[j].getAttribute("colspan")==="1"){if(j==firstHeads.length-2){if(_this.columnResize!="auto"){break}}if(j<_this.fixed_pivot_num){continue}var headCellLeft=firstHeads[j+1].offsetLeft-5+"px";thirdheads[j].style.left=headCellLeft}}}if(rightTH[1]){rightTH[1].style.width=rightTH[0].style.width;if(rightTH[1].style.whiteSpace)rightTH[1].style.whiteSpace="";if(rightTH[1].style.wordWrap)rightTH[1].style.wordWrap=""}var bojung=leftTH[0].offsetLeft+leftTH[0].offsetWidth-5;top$(selected).css("left",bojung+"px")}this.setResizerLeft=function(){};this.setResizerHeight=function(){};this.changeFirstHeads=function(){firstHeads=this.scrollTable?root.querySelectorAll(".top-tableview-scrollHeadInner th.head-cell"):root.querySelectorAll("th.head-cell")}},attachTooltip:function(){var thisTable=this;var thisPageId=Top.App.getCurrentPage().id;var tooltipDirection="";var select_dom="td:not(.non-tooltip)";var timer=null;top$(document).off("mouseenter",select_dom).on("mouseenter",select_dom,function(e){clearTimeout(timer);timer=setTimeout(toolhandle.bind(this),500)});var toolhandle=function(){var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");for(var i=0;i<this.children.length;i++){if(this.children[i].tagName!=="TOP-TEXTVIEW")return}if(this.firstChild&&(this.firstChild.nodeName==="#text"||this.firstChild.tagName==="TOP-TEXTVIEW")){if(this.firstChild.tagName==="TOP-TEXTVIEW")var thisTextView=Top.Dom.selectById(this.firstChild.id);var isOverflown=top$(this).hasOverflown();if(isOverflown||thisTextView&&thisTextView.getProperties("ellipsis")){$tooltipText.text(this.getAttribute("value"));$tooltipText.css("display","inline-block");$tooltipArrow.css("display","inline-block");var children=$tooltipText.find("*");for(var i=0,len=children.length;i<len;i++){children[i].layoutParent=thisTable}var thisoffset=top$(this).offset();$tooltipText.css("left",thisoffset.left);var calculatedHeight=top$(document).height()-(thisoffset.top+40);var tooltipHeight=$tooltipText[0].offsetHeight;if(calculatedHeight<tooltipHeight){$tooltipText.css("top",thisoffset.top-tooltipHeight);$tooltipArrow.addClass("top");tooltipDirection="top"}else{top$(thisTable).hasClass("white")?$tooltipText.css("top",thisoffset.top+35):$tooltipText.css("top",thisoffset.top+25);$tooltipArrow.addClass("bottom");tooltipDirection="bottom"}var tooltipoffset=$tooltipText.offset();if(tooltipDirection==="bottom"){top$(thisTable).hasClass("white")?$tooltipArrow.css("left",tooltipoffset.left+6):$tooltipArrow.css("left",tooltipoffset.left+7);$tooltipArrow.css("top",tooltipoffset.top-3)}else if(tooltipDirection==="top"){top$(thisTable).hasClass("white")?$tooltipArrow.css("left",tooltipoffset.left+6):$tooltipArrow.css("left",tooltipoffset.left+7);$tooltipArrow.css("top",tooltipoffset.top+tooltipHeight-4)}}}};top$(document).off("mouseleave",select_dom).on("mouseleave",select_dom,function(){clearTimeout(timer);var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.css("display","none");$tooltipArrow.css("display","none");if(tooltipDirection==="bottom")$tooltipArrow.removeClass("bottom");else if(tooltipDirection==="top")$tooltipArrow.removeClass("top")});top$(document).off("mouseenter","#"+thisPageId+" .top-tooltip-text").on("mouseenter","#"+thisPageId+" .top-tooltip-text",function(){var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");top$(this).css("display","inline-block");$tooltipArrow.css("display","inline-block");if(tooltipDirection==="bottom")$tooltipArrow.addClass("bottom");else if(tooltipDirection==="top")$tooltipArrow.addClass("top")});top$(document).off("mouseleave","#"+thisPageId+" .top-tooltip-text").on("mouseleave","#"+thisPageId+" .top-tooltip-text",function(){var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");top$(this).css("display","none");$tooltipArrow.css("display","none");if(tooltipDirection==="bottom")$tooltipArrow.removeClass("bottom");else if(tooltipDirection==="top")$tooltipArrow.removeClass("top")})},detachTooltip:function(){var thisPageId=Top.App.getCurrentPage().id;var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.css("display","none");$tooltipArrow.css("display","none");if($tooltipArrow.hasClass("bottom"))$tooltipArrow.removeClass("bottom");else if($tooltipArrow.hasClass("top"))$tooltipArrow.removeClass("top")},organizeLengthMenu:function(){if(typeof this.lengthMenu[0]=="number"){for(var i=0;i<this.lengthMenu.length;i++){if(this.pageLength==this.lengthMenu[i])break;if(i==this.lengthMenu.length-1){this.lengthMenu.push(this.pageLength)}}this.lengthMenu.sort(function(a,b){return a-b})}else{for(var i=0;i<this.lengthMenu[0].length;i++){if(this.pageLength==this.lengthMenu[0][i])break;if(i==this.lengthMenu[0].length-1){this.lengthMenu[0].push(this.pageLength);this.lengthMenu[1].push(this.pageLength)}}this.lengthMenu[0].sort(function(a,b){if(b=="-1"&&a>b)return-1;else if(a=="-1"&&a<b)return 1;else return a-b});this.lengthMenu[1].sort(function(a,b){if(typeof a=="number"&&typeof b=="string"){return-1}else if(typeof a=="string"&&typeof b=="number"){return 1}else return a-b})}},setColWidget:function(){var selectBox=Top.Dom.select("#"+this.id+" .body top-selectbox");if(selectBox.length>0){for(var i=0;i<selectBox.length;i++){if(selectBox[i].template.selectedText!==undefined&&selectBox[i].template.selectedText!==null&&typeof selectBox[i].setProperties==="function"){selectBox[i].setProperties({"selected-text":selectBox[i].template.selectedText})}}}var root=this.childRoot;var menu=root.querySelectorAll("top-menu");if(menu.length>0){for(var i=0,len=menu.length;i<len;i++){if(menu[i].type==="dropdown"&&typeof menu[i].setDropdownPosition==="function")menu[i].setDropdownPosition()}}var radiobuttons=root.querySelectorAll("top-radiobutton");for(var i=0,len=radiobuttons.length;i<len;i++){if(typeof radiobuttons[i].__initLabel==="function")radiobuttons[i].__initLabel()}var textfields=root.querySelectorAll("top-textfield");for(var i=0,len=textfields.length;i<len;i++){if(typeof textfields[i].setTitlePosition==="function")textfields[i].setTitlePosition();if(typeof textfields[i].setIconPosition==="function")textfields[i].setIconPosition()}var datepickers=this.querySelectorAll("top-datepicker");for(var i=0,len=datepickers.length;i<len;i++){if(typeof datepickers[i].__updateDate==="function")datepickers[i].__updateDate()}},setPageInfo:function(info){if(this.pageInfo===undefined){this.pageInfo={page:1,length:this.pageLength,start:0,end:this.pageLength-1}}if(typeof info==="object"){var keys=Object.keys(info);for(var i=0,len=keys.length;i<len;i++){this.pageInfo[keys[i]]=info[keys[i]]}}},getPageInfo:function(){return this.pageInfo},filterColumns:function(columnObj){var data=this.data;if(data===undefined)return;var _this=this;var dataKeys=Object.keys(data[0]);var removeColArray=[];var allThs=this.childRoot.querySelectorAll(".head-row .head-cell");var allTds=this.childRoot.querySelectorAll(".body-row .body-cell");for(var key in columnObj){var thElement;allThs.forEach(function(item){if(item.columnName===columnObj[key]){thElement=item}});top$(thElement).text(key);if(thElement.style.display==="none")top$(thElement).css("display","");allTds.forEach(function(item){if(item.columnName===columnObj[key]){if(item.style.display==="none")top$(item).css("display","")}})}dataKeys.forEach(function(item){var willRemove=true;for(var key in columnObj){if(item==columnObj[key]){willRemove=false}}if(willRemove){removeColArray.push(item)}});for(var i=0;i<removeColArray.length;i++){allThs.forEach(function(item){if(item.columnName===removeColArray[i]){top$(item).css("display","none")}});allTds.forEach(function(item){if(item.columnName===removeColArray[i]){top$(item).css("display","none")}})}},onVisibleChanged:function(){if(this.visible==="visible"){this.initialLayout();this.renderLayout()}},src:function(htmlFile){if(this.data.length>0)return;if(Top.Util.getFileExtension(htmlFile)!="html")return;var _this=this.childRoot.querySelector(".top-tableview-empty");Top.Ajax.get(htmlFile,"","",function(data,textStatus,jqXHR){top$(_this).html(data)})},html:function(htmlString){if(this.data.length>0)return;top$(this.childRoot.querySelector(".top-tableview-empty")).html(htmlString)},reset:function(){this.items=[];this.connect=false;this.backupdata=[];this.childRoot.innerHTML="";this.itemLayoutDom=[];this.headerInfoArray=undefined;this.tableHeaderArray=undefined;this.columnOption=undefined;this.headerOption=undefined;this.checkable=false;this.indexable=false;this.treetable=false;this.pageLength=-1;this.paginate=false;return},__updateItems:function(){if(typeof this.items==="string"){this.data=Top.Util.namespace(this.items,this)}else if(typeof this.items==="object"){this.data=this.items}else{this.data=[]}if(this.datapointer){this.datapointer=this.data;this.backupdata=this.data}if(!this.checkIndexInfo){return}if(this.childRoot.innerHTML==""){this.renderLayout();return}var hcolgroup=this.querySelector(".head_colgroup");if(hcolgroup&&hcolgroup.children.length<=1||Top.Util.__isBooleanTrue(this.autoHeight)){this.itemLayoutDom=[];this.rowItemArray=undefined;this.headerInfoArray=undefined;this.tableHeaderArray=undefined;this.renderLayout();return}if(this.data.length!=this.checkIndexInfo.length){for(var i=0;i<this.data.length;i++){if(this.checkIndexInfo[i]){this.checkIndexInfo[i].checkbool=false;this.checkIndexInfo[i].checkDisabled=false;continue}this.checkIndexInfo.push({checkbool:false,status:"C",selected:false,checkDisabled:false,open:false,linkidx:i})}for(var j=0;j<this.checkIndexInfo.length;j++){this.checkIndexInfo[j]["linkidx"]=j}this.checkIndexInfo.length=this.data.length;this.checkCallback()}if(this.paginate=="true"||this.paginate==true){this.virtualmakePage();this.virtualgoToPage(this.currentPage,this.getPageInfo())}if(this.backupdata.length<this.rownum){this.startRowNum=0}if(this.soneFlag){if(this.paginate=="true"||this.paginate==true){}else{this.startRowNum=0}}this.onScroll(event);this.scrollbar_height();this.__dispatchEvent(new CustomEvent("update"))},renderLayout:function(){this.__initProperties();clearTimeout(this.timer);this.timer=setTimeout(this.renderLayoutAsync.bind(this),0)},__initProperties:function(){if(typeof this.items==="string"){this.data=Top.Util.namespace(this.items,this);this.itemsString=this.items}else if(typeof this.items==="object"){this.data=this.items}else if(this.items===undefined){this.data=[]}this.onCheckFunc=typeof this.onCheck==="string"?Top.Util.namespace(this.onCheck,this):this.onCheck;this.onCheckHeadFunc=typeof this.onCheckhead==="string"?Top.Util.namespace(this.onCheckhead,this):this.onCheckhead;this.headerOption=typeof this.headerOption==="string"?Top.Util.namespace(this.headerOption,this):this.headerOption;this.__columnOption=typeof this.columnOption==="string"?Top.Util.namespace(this.columnOption,this):this.columnOption;this.__column=typeof this.column==="string"?Top.Util.namespace(this.column,this):this.column;this.__checkOption=typeof this.checkOption==="string"?Top.Util.namespace(this.checkOption,this):this.checkOption;this.__indexOption=typeof this.indexOption==="string"?Top.Util.namespace(this.indexOption,this):this.indexOption},__onRenderLayout:function(fn){if(this.__onRenderLayoutListeners===undefined){this.__onRenderLayoutListeners=[]}this.__onRenderLayoutListeners.push(fn)},__callRenderLayoutListeners:function(){if(this.__onRenderLayoutListeners===undefined)return;for(var i=0,len=this.__onRenderLayoutListeners.length;i<len;i++){this.__onRenderLayoutListeners[i]()}this.__onRenderLayoutListeners=[]},__reRender:function(){this.__initProperties();if(!this.__initialized===undefined||this.Toptablerendered===undefined)return;var _this=this;if(this.paginate){this.currentPage=this.currentPage>0?this.currentPage:1}if(this.checkable&&this.checkIndexInfo){var checkedIndex=this.getCheckedIndex()}if(this.__setDataLengthCalled!==true&&this.data&&this.data.length===0)this.dataLength=undefined;this.renderLayout();this.__onRenderLayout(function(){if(_this.virtualScroll)return;if(checkedIndex&&checkedIndex.length>0){var l=checkedIndex.length;while(l--){_this.check(checkedIndex[l],true)}}_this.__dispatchEvent(new CustomEvent("update"));if(_this.dragSelection)_this.setDragSelection(true);_this.setColWidget();if(_this.paginate){_this.goToPage(0)}})},__updateSelectType:function(){this.setAttribute("select-type",this.selectType);top$(this.childRoot.querySelectorAll(".selected")).removeClass("selected");top$(this.childRoot.querySelectorAll(".previous")).removeClass("previous");this.selectedItemIndex=[];this.bindEvent()},setRowLayout:function(rowIndex,layout){var tr=this.childRoot.querySelector(".row_"+(rowIndex-this.startRowNum));if(tr==null)return;var tds=tr.children;var uneditableTdNum=0;if(tds[0].classList.contains("checkable")||tds[0].classList.contains("indexable")){uneditableTdNum++}if(tds[1].classList.contains("indexable")){uneditableTdNum++}if(typeof layout==="string")layout=Top.Util.namespace(layout,this);if(typeof layout!=="function")return;for(var i=uneditableTdNum,len=tds.length;i<len;i++){var columnIndex=i-uneditableTdNum;var columnName=this.__getColumnNameByIndex(columnIndex);if(columnName!==undefined&&this.backupdata[rowIndex][columnName]!==undefined){var newLayout=layout({data:this.backupdata[rowIndex][columnName],rowIndex:rowIndex,columnIndex:columnIndex,columnName:columnName,viewIndex:rowIndex-this.startRowNum})||undefined;if(newLayout!==undefined){if(newLayout instanceof Top.Widget){top$(tds[i]).html(newLayout.template);newLayout.template.__attachedImpl();newLayout.template.__initBoundData(true,newLayout.id);if(!Top.Util.Browser.isIE())newLayout.template.__initEvent()}else{tds[i].innerHTML=newLayout}tds[i].style.overflow="visible";tds[i].classList.add("editable")}}top$(tds[i]).find("*").on("mousedown",function(e){
e.stopPropagation()})}},setCellLayout:function(rowIndex,columnIndex,layout){var td=this.childRoot.querySelector(".row_"+(rowIndex-this.startRowNum)+" .column_"+columnIndex);var columnName=this.__getColumnNameByIndex(columnIndex);if(typeof layout==="string")layout=Top.Util.namespace(layout,this);if(typeof layout!=="function")return;if(columnName!==undefined){var childWidgets=[];for(var i=0,len=td.children.length;i<len;i++){childWidgets.push(Top.Dom.selectById(td.children[i].id))}var newLayout=layout({data:this.backupdata[rowIndex][columnName],rowIndex:rowIndex,columnIndex:columnIndex,columnName:columnName,childWidgets:childWidgets})||undefined;if(newLayout!==undefined){if(newLayout instanceof Top.Widget){top$(td).html(newLayout.template);newLayout.template.__attachedImpl();newLayout.template.__initBoundData(true,newLayout.id);if(!Top.Util.Browser.isIE())newLayout.template.__initEvent()}else{td.innerHTML=newLayout}td.classList.add("editable")}}top$(td).find("*").on("mousedown",function(e){e.stopPropagation()})},complete:function(option){var tds=this.childRoot.querySelectorAll(".body-cell.editable");for(var i=0,len=tds.length;i<len;i++){if(typeof option==="object"){if(option.rowIndex===undefined){this.__widgetsToText(tds[i])}else if(option.rowIndex===tds[i].pos.row&&(option.columnIndex===undefined||option.columnIndex===tds[i].pos.col)){this.__widgetsToText(tds[i])}}else{this.__widgetsToText(tds[i])}tds[i].style.overflow=""}if(option===undefined||typeof option==="object"&&option.syncData!==false)this.sync()},__widgetsToText:function(td){var children=td.children;for(var i=0,len=children.length;i<len;i++){if(children[i].tagName=="TOP-SELECTBOX"){td.value=children[i].selectedText;td.innerText=children[i].selectedText}else if(children[i].tagName=="TOP-DATEPICKER"){td.value=children[i].date;td.innerText=children[i].date}else{td.value=children[i].text;td.innerText=children[i].text}}},setDataLength:function(dataLength){this.__setDataLengthCalled=true;this.dataLength=dataLength;if(this.indexable)this.__renderIndex();if(this.paginate){var root=this.childRoot;if(this.showresult){root.querySelector(".top-tableview-result > .number").innerHTML=dataLength}var total=this.pageLength===-1?1:Math.ceil(dataLength/this.pageLength);var pagerElement=root.querySelector(".top-tableview-pager top-pagination");pagerElement.setAttribute("total",total);pagerElement.total=total;pagerElement.__updateProperties("total")}},setDragSelection:function(bool){var _this=this;bool=bool===true||bool==="true";this.dragSelection=bool;if(!this.dataTable)return;var nTable=this.dataTable.table().node();var root=this.childRoot;if(bool){top$(root.querySelectorAll(".body-cell *")).on("mousedown",function(e){e.stopPropagation()});top$(nTable).off("t_dragstart").on("t_dragstart",{distance:1},function(ev,dd){return top$('<div class="drag-selection" />').css("opacity",.65).appendTo(document.body)}).off("t_drag").on("t_drag",function(ev,dd){top$(dd.proxy).css({top:Math.min(ev.pageY,dd.startY),left:Math.min(ev.pageX,dd.startX),height:Math.abs(ev.pageY-dd.startY),width:Math.abs(ev.pageX-dd.startX)})}).off("t_dragend").on("t_dragend",function(ev,dd){top$("div.drag-selection").remove()});top$.drop({multi:true});if(this.selectType==="row"){top$(root.querySelectorAll(".body-row")).drop("t_dropstart",function(){top$(this).trigger(top$.Event("click",{ctrlKey:true}))})}else if(this.selectType==="cell"){top$(root.querySelectorAll(".body-cell")).drop("t_dropstart",function(){top$(this).trigger(top$.Event("click",{ctrlKey:true}))})}}else{top$(this).off("t_dragstart");top$(root.querySelectorAll(".body-row")).off("t_dropstart");top$(root.querySelectorAll(".body-cell")).off("t_dropstart")}},__storeCookieHeaderInfo:function(){var name=this.storeKey||this.id;var nodes=this.getTableHeaderInfoByTree();this.setLocalStorage(name,nodes)},setLocalStorage:function(name,value){window.localStorage.setItem(name,JSON.stringify(value))},getLocalStorage:function(name){return JSON.parse(window.localStorage.getItem(name))},getTableHeaderInfo:function(){var _table=this;var table_id=_table.getAttribute("id");var table_head=_table.querySelectorAll(".top-tableview-scrollHead .head-row .head-cell");var table_head_info=new Object;var cnt=0;var column=_table.column||null;for(var i=0;i<_table.itemKeys.length;i++){var temp={class:table_head[cnt+i].getAttribute("class"),value:table_head[cnt+i].getAttribute("value"),text:table_head[cnt+i].getAttribute("text"),width:table_head[cnt+i].offsetWidth+"px",rowspan:table_head[cnt+i].getAttribute("rowspan"),colspan:table_head[cnt+i].getAttribute("colspan")};table_head_info[_table.itemKeys[i]]=temp}var table_info={id:table_id,"header-option":table_head_info,column:column};return table_info},setTableHeaderInfo:function(value){var _table=this;Top.Dom.selectById(_table.id).setProperties({column:value.column,"header-option":value.headerOption})},recursiveTableToTree:function(index){var className="headIndex_"+this.headerInfoArray[index]["class"];var width=this.headerInfoArray[index]["width"];var row=this.headerInfoArray[index]["xmlRow"];var col=this.headerInfoArray[index]["xmlCol"];var text=this.headerInfoArray[index]["text"]||"";if(this.headerInfoArray[index]["isLastHead"]==true&&this.headerInfoArray[index]["visible"]!="none"&&this.headerInfoArray[index]["type"]!="incapable"){var hcolgroup=this.querySelector(".head_colgroup");for(var i=0;i<hcolgroup.children.length;i++){if(this.headerInfoArray[index]["lastHeadNum"]==hcolgroup.children[i].getAttribute("data-index")){width=hcolgroup.children[i].style.width;break}}}var result={id:this.headerInfoArray[index]["id"],text:text,width:width,colspan:this.headerInfoArray[index]["originColspan"],originColspan:this.headerInfoArray[index]["originColspan"],rowspan:this.headerInfoArray[index]["rowspan"],xmlRow:this.headerInfoArray[index]["xmlRow"],xmlCol:this.headerInfoArray[index]["xmlCol"],parent:this.headerInfoArray[index]["parent"],lastHeadNum:this.headerInfoArray[index]["lastHeadNum"],index:this.headerInfoArray[index]["index"],visible:this.headerInfoArray[index]["visible"],checked:this.headerInfoArray[index]["visible"]=="visible"?true:false,"body-mapping-index":this.headerInfoArray[index]["body-mapping-index"]};var childrenResult=[];for(var i=0;i<this.headerInfoArray[index]["children"].length;i++){childrenResult.push(this.recursiveTableToTree(this.headerInfoArray[index]["children"][i]))}result["children"]=childrenResult;return result},recursiveTreeToTable:function(tree,index,result){if(result.length<=index)return;for(var i=0;i<tree.length;i++){var visible=tree[i].visible?"visible":"none";if(tree[i].checked!==null&&tree[i].checked!=undefined)visible=tree[i].checked?"visible":"none";result[index].push({id:tree[i].id,text:tree[i].text==="check"?"":tree[i].text,colspan:tree[i].colspan,originColspan:tree[i].originColspan,rowspan:tree[i].rowspan,xmlRow:tree[i].xmlRow,xmlCol:tree[i].xmlCol,width:tree[i].width,parent:tree[i].parent,lastHeadNum:tree[i].lastHeadNum,index:tree[i].index,visible:visible,"body-mapping-index":tree[i]["body-mapping-index"]});if(tree[i].children.length!=0){this.recursiveTreeToTable(tree[i].children,index+tree[i].rowspan,result)}}},getTableHeaderInfoByTree:function(){var result=[];if(!this.headerInfoArray){return}for(var i=0;i<this.headerInfoArray.length;i++){if(this.headerInfoArray[i]["parent"]!==null){continue}result.push(this.recursiveTableToTree(i))}return result},__detached:function(){this.detachTooltip();this.showedCheckboxes=null;this.checkboxes=null;this.childs=null;this.rowItemArray=null;document.removeEventListener("mouseup",this._destroy)},__updateOnScrollend:function(){this.__addEventByAttr("scrollend")},__updateOnRowclick:function(){this.__addEventByAttr("rowclick")},__updateOnRowdblclick:function(){this.__addEventByAttr("rowdblclick")},__updateOnRowcontextmenu:function(){this.__addEventByAttr("rowcontextmenu")},__updateOnCellclick:function(){this.__addEventByAttr("cellclick")},__updateOnCelldblclick:function(){this.__addEventByAttr("celldblclick")},__updateOnCellcontextmenu:function(){this.__addEventByAttr("cellcontextmenu")},__updateOnRowcheck:function(){this.__addEventByAttr("rowcheck")},__updateOnHeadercheck:function(){this.__addEventByAttr("headercheck")},__updateOnNodata:function(){this.__addEventByAttr("nodata")},__updateOnPagechange:function(){this.__addEventByAttr("pagechange")},__updateOnLengthchange:function(){this.__addEventByAttr("lengthchange")},__updateOnUpdate:function(){this.__addEventByAttr("update")},__updateOnEdit:function(){this.__addEventByAttr("edit")},__updateOnHeaderclick:function(){this.__addEventByAttr("headerclick")},__updateOnHeaderdbclick:function(){this.__addEventByAttr("headerdbclick")},__getColumnResizeValue:function(str){if(str=="true"||str==true||str=="auto"){return"auto"}else if(str=="false"||str==false){return false}else if(str=="fixed"){return"fixed"}return"auto"},__updateColumnResize:function(){this.columnResize=this.__getColumnResizeValue(this.columnResize);if(this.columnResize){this.makeColResizer()}else{var gripsElement=this.getElementsByClassName("top-tableview-grips")[0];if(gripsElement){gripsElement.parentNode.removeChild(gripsElement)}}},__updateItemClicktype:function(){},__loadI18nForTable:function(){var allCells=this.querySelectorAll(".head-cell, .body-cell");var prevValue;for(var i=0;i<allCells.length;i++){if(allCells[i].getAttribute("data-i18n")){var newValue=eval(allCells[i].getAttribute("data-i18n"));if(allCells[i].children[0]&&allCells[i].children[0].classList.contains("dataTables_sizing")){prevValue=allCells[i].children[0].innerText;allCells[i].children[0].innerText=newValue}else{prevValue=allCells[i].innerText;allCells[i].innerText=newValue}allCells[i].setAttribute("value",newValue);allCells[i].columnName=newValue;var ariaLabel=allCells[i].getAttribute("aria-label");if(ariaLabel){allCells[i].setAttribute("aria-label",ariaLabel.replace(prevValue,newValue))}}}},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){var div=this.querySelector("div");if(value){div.style[key]=value;this.topstyle=div.style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle},getHeaders:function(){var headarr=this.querySelectorAll("table thead tr");if(headarr==null){return[]}else{var ret=[];for(var i=0;i<headarr.length;i++){for(var j=0;j<headarr[i].children.length;j++){ret.push(headarr[i].children[j])}}return ret}},virtualtable01_splitdata:function(){this.heightarray={};this.heightarray2={};var itemhead;var itembody;var itemfooter;for(var k=0;k<this.itemLayoutDom.length;k++){var tempdom=this.itemLayoutDom[k];if(tempdom.tagName=="TOP-TABLEHEADER"){itemhead=tempdom;var hasHeaderRows=true;var headlength=itemhead.children.length}else if(tempdom.tagName=="TOP-TABLEITEM"){itembody=tempdom;var itemlength=itembody.children.length}else if(tempdom.tagName=="TOP-TABLEFOOTER"){itemfooter=tempdom}}if(this.hh===undefined||this.ih===undefined){if(true){if(headlength>1&&hasHeaderRows===true&&itemhead.children[1].tagName=="TOP-HEADERROW"){this.hh=0;for(var i=0;i<headlength;i++){if(itemhead.children[i].attributes["layout-height"]){var headh=Number(itemhead.children[i].attributes["layout-height"].value.split("px")[0]);this.hh+=headh;this.heightarray[i]=headh}else{this.hh+=39;this.heightarray[i]=39}}}else{this.hh=itemhead.children[0].attributes["layout-height"]?Number(itemhead.children[0].attributes["layout-height"].value.split("px")[0])||39:39}this.ih=0;if(itemlength>1){for(var q=0;q<itemlength;q++){if(itembody.children[q].attributes["layout-height"]){var bodyh=Number(itembody.children[q].attributes["layout-height"].value.split("px")[0]);this.ih+=bodyh;this.heightarray2[q]=bodyh}else{this.ih+=35;this.heightarray2[q]=35}}}else{this.ih=itembody.children[0].attributes["layout-height"]?Number(itembody.children[0].attributes["layout-height"].value.split("px")[0])||35:35}}else{this.hh=39;this.ih=35}}if(this.hh==0){this.hh=39}if(this.ih==0){this.ih=35}var vheight=500;if(this.layoutHeight=="match_parent"){vheight=this.parentNode.offsetHeight}else if(this.layoutHeight==""||this.layoutHeight==undefined||this.layoutHeight=="auto"||this.layoutHeight=="wrap_content"){var dataLength=this.data.length===0?1:this.data.length;var plength=this.pageLength>0&&this.pageLength<dataLength?parseInt(this.pageLength):dataLength;vheight=this.ih*plength+this.hh+25;if(this.paginate){vheight=vheight+42}if(this.sequence){vheight=vheight+20}if(plength==0){vheight=500}}else if(this.layoutHeight.includes("%")){var perc=this.layoutHeight.split("%")[0];vheight=this.offsetHeight}else{vheight=this.layoutHeight.split("px")[0];this.style.height=parseInt(this.layoutHeight)+parseInt(this.borderTopWidth)+parseInt(this.borderBottomWidth)+"px"}if(this.sequence){vheight-=20}if(this.paginate){vheight=vheight-42;this.pagestartnum=0}this.viewport_height=vheight-this.hh;if(this.getAttribute("scroll-body-height")&&this.getAttribute("scroll-body-height").includes("px")){this.viewport_height=Number(this.getAttribute("scroll-body-height").split("px")[0])}this.rownum=parseInt(this.viewport_height/this.ih);if(this.rownum*this.ih+12>this.viewport_height&&this.rownum>1){this.rownum--}this.viewport_height=this.rownum*this.ih+15;if(this.pageLength>0&&this.pageLength<this.rownum){this.rownum=parseInt(this.pageLength)}if(this.rownum<=0){this.rownum=0}if(typeof this.items==="string"&&this.items!=""){this.datapointer=Top.Util.namespace(this.items,this)}else if(typeof this.items==="object"){this.datapointer=this.items}else{this.datapointer=[]}this.startRowNum=0;var statusArray=[];for(var i=0;i<this.datapointer.length;i++){var curStatus="R";if(this.checkIndexInfo&&this.datapointer.length==this.checkIndexInfo.length){if(this.checkIndexInfo[i]&&this.checkIndexInfo[i].status){curStatus=this.checkIndexInfo[i].status}}statusArray.push(curStatus)}this.checkIndexInfo=[];for(var i=0;i<this.datapointer.length;i++){this.checkIndexInfo.push({checkbool:false,status:statusArray[i],selected:false,checkDisabled:false,open:false,linkidx:i})}this.backupdata=this.datapointer;this.data=null;this.data=this.datapointer.slice(0,this.rownum)},virtualtable02_makeviewport:function(){var _this=this;this.childRoot.style.overflow="hidden";this.childRoot.style.height="auto";var multiheader=top$(this.querySelector(".top-tableview.multiple-header.no-footer"));multiheader.css({});var singleheader=top$(this.querySelector(".top-tableview-scrollHeadInner"));singleheader.css({});var header=top$(this.querySelector(".top-tableview-scrollHead"));header.css({overflowX:"hidden"});var content=top$(this.querySelector(".top-tableview-scrollBody"));var viewport=top$(this.querySelector(".top-tableview-scrollBody-border"));var scrollHead=top$(this.querySelector(".top-tableview-scrollHead"));var tablebody=top$(content.children()[0]);this.viewport=viewport;this.scrollHead=scrollHead;tablebody.css({});if(tablebody[0].offsetWidth>0){content.css({})}content.css({});if(this.horizontalScroll){this.viewScrollX="auto"}else{this.viewScrollX="hidden"}if(false){viewport.css({overflowX:this.viewScrollX,overflowY:"hidden"})}else{viewport.css({overflowX:this.viewScrollX,overflowY:"hidden",height:this.viewport_height})}scrollHead.css({});var scrollstr='<div id="innerframe_'+this.id+'" class="viframe">                  <div id="upbtn_'+this.id+'" class="viupbtn"></div>                  <div id="bar_'+this.id+'" class="vibar">                      <div id="scroll_'+this.id+'" class="draggable ui-widget-content viscroll"></div>                  </div>                  <div id="downbtn_'+this.id+'" class="vidownbtn"></div>                  </div>';if(this.querySelector(".viframe")==null){top$(this.querySelector(".top-tableview-scroll")).append(scrollstr)}var upbtn=top$("#upbtn_"+this.id);var downbtn=top$("#downbtn_"+this.id);var scroll=top$("#scroll_"+this.id);var innerframe=top$("#innerframe_"+this.id);var bar=top$("#bar_"+this.id);this.upbtn=upbtn;this.downbtn=downbtn;this.scroll=scroll;this.innerframe=innerframe;this.bar=bar;var timeoutId=0;var timeoutId_2=0;upbtn.on("mousedown",function(event){timeoutId=setInterval(function(){upscroll(event)},80)}).on("mouseup mouseleave",function(){clearTimeout(timeoutId)});downbtn.on("mousedown",function(event){timeoutId=setInterval(function(){downscroll(event)},80)}).on("mouseup mouseleave",function(){clearTimeout(timeoutId)});bar.on("click",function(e){if(!e.target.className.includes("bar")){return}movepoint(e)});function movepoint(e){var pointy=e.offsetY;var bh=parseFloat(bar.height());var sh=parseFloat(scroll.height());var posScroll=Number(scroll.css("top").split("px")[0]);var posy=posScroll+sh;if(pointy<posy){scroll.css("top",pointy)}else if(pointy>posy){scroll.css("top",pointy-sh)}else{return}dragfunc(e)}var ctrlDown=false;innerframe.css("width","15");if(top$("#"+this.id+" .top-tableview-scroll")[0]===undefined)return;this.scrollbar_height();var updateTimer;scroll.off().draggable({axis:"y",containment:"parent",scroll:false,start:function(){},drag:function(e){dragfunc(e)},stop:function(){}});function dragfunc(e){var posy=Number(scroll.css("top").split("px")[0]);if(posy<0){return}var bary=bar.height()-scroll.height();var rate=(posy/bary).toFixed(8);var newrownum=Math.round(rate*_this.Dlegnth);if(_this.startRowNum==newrownum){return}_this.startRowNum=newrownum;if(_this.paginate){_this.startRowNum=_this.startRowNum+_this.pagestartnum}_this.startrownum=_this.startRowNum;if(!updateTimer){updateTimer=setTimeout(function(){updateTimer=null;_this.onScroll(e,true)},100)}}top$(_this).off().on("mousewheel DOMMouseScroll","#scroll_"+this.id+",#"+this.id+",.top-tableview",function(e){if(e.target.classList.contains("top-selectbox-option")){return}else{Top.App.closeOpenedSelectBox()}if(_this.innerframe.css("visibility")!="hidden"){e.stopPropagation();e.preventDefault()}if(_this.posi==_this.startRowNum){_this.posi=-1;return}_this.posi=_this.startRowNum;var EE=e.originalEvent;if(EE.wheelDelta>0){upscroll(e)}else{downscroll(e)}});top$(_this.querySelectorAll("table .body")).off("keydown").on("keydown",function(e){if(e.target.tagName==="TD"&&e.key==="Tab"){}else if(e.target.tagName==="INPUT"&&_this.checkable&&top$(e.target).closest("td.body-cell")[0].classList.contains("checkable")){var parentTd=top$(e.target).closest("td.body-cell")[0];if(e.keyCode==39)parentTd.nextSibling.focus();else if(e.keyCode==40&&parentTd.parentNode.nextSibling)parentTd.parentNode.nextSibling.firstChild.querySelector(".top-checkbox-check").focus();else if(e.keyCode==38&&parentTd.parentNode.previousSibling)parentTd.parentNode.previousSibling.firstChild.querySelector(".top-checkbox-check").focus();else if(e.keyCode==13)parentTd.nextSibling.focus()}else if(e.target.tagName!=="TD"&&(e.key==="Enter"||e.key==="Escape")){var parentTd=top$(e.target).closest("td.body-cell")[0];if(!parentTd){return}var colnum=parentTd.pos.col;var colLength=_this.headerColumnArray.length;if(colnum===colLength-1){parentTd.focus()}else{var rownum=parentTd.pos.row;var targetTd=_this.querySelector("tr.row_"+rownum+">td.column_"+(colnum+1));targetTd.focus()}}else if((e.key==="Enter"||e.key===" ")&&e.target.firstElementChild&&e.target.firstElementChild.tagName.startsWith("TOP")){var topwidget=e.target.firstElementChild;if(topwidget.tagName==="TOP-SELECTBOX"){topwidget.querySelector("span.top-selectbox-container").click();topwidget.focus()}else if(topwidget.tagName==="TOP-DATEPICKER"){topwidget.querySelector("input.top-datepicker-input").focus()}else if(topwidget.tagName==="TOP-TEXTFIELD"){topwidget.focus()}else if(topwidget.tagName==="TOP-CHECKBOX"){topwidget.querySelector("input.top-checkbox-check").click()}else if(topwidget.tagName==="TOP-BUTTON"){topwidget.querySelector("button.top-button-root").click()}}else if(e.target.tagName==="TD"&&e.keyCode>=37&&e.keyCode<=40){var selectedTd=top$(e.target).closest("td")[0];var colnum=selectedTd.pos.col;var colLength=_this.headerColumnArray.length;var rownum=selectedTd.pos.row;var rowLength=Math.min(_this.RowCount(),_this.rownum);var targetTd;if(e.keyCode==38&&rownum===0){upscroll()}else if(e.keyCode==38&&rownum>0){targetTd=_this.querySelector("tr.row_"+(rownum-1)+">td.column_"+colnum);targetTd.focus()}else if(e.keyCode==40&&rownum===rowLength-1){downscroll()}else if(e.keyCode==40&&rownum<rowLength-1){targetTd=_this.querySelector("tr.row_"+(rownum+1)+">td.column_"+colnum);targetTd.focus()}else if(e.keyCode==37&&colnum>0){targetTd=_this.querySelector("tr.row_"+rownum+">td.column_"+(colnum-1));targetTd.focus()}else if(e.keyCode==37&&colnum===0&&_this.checkable){selectedTd.previousSibling.querySelector(".top-checkbox-check").focus()}else if(e.keyCode==39&&colnum<colLength-1){targetTd=_this.querySelector("tr.row_"+rownum+">td.column_"+(colnum+1));targetTd.focus()}}else if(e.keyCode==17){ctrlDown=true}else if(e.keyCode==67&&ctrlDown==true&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"){var tempTextarea=document.createElement("textarea");var selectType=_this.getAttribute("select-type");if(selectType==="cell"){var selectedCells=_this.querySelectorAll(".body-cell.selected");document.body.appendChild(tempTextarea);var appendStr;for(var i=0,leng=selectedCells.length;i<leng;i++){var value=selectedCells[i].getAttribute("value");var innerText=selectedCells[i].innerText;if(value!=null&&value!==""){appendStr=value}else if(innerText!=null&&innerText!==""){appendStr=innerText}if(selectedCells.length>1){tempTextarea.value+=appendStr+"\t"}else{tempTextarea.value+=appendStr}}}else{var selectedTrs=_this.querySelectorAll(".body-row.selected");var appendStr;var dataFieldRegExp=new RegExp("([-\\w]+)=[\"|']({[\\w.]+})[\"|']","g");document.body.appendChild(tempTextarea);for(var i=0;i<selectedTrs.length;i++){var selectedRowIndex=Number(selectedTrs[i].getAttribute("class").split("row_")[1].split(" ")[0]);for(var col=0;col<_this.lastHeader.length;col++){if(_this.lastHeader[col].type!=="normal"&&_this.lastHeader[col].type!=="required"||_this.lastHeader[col]["header-control"]!=="none")continue;if(_this.lastHeader[col].visible==="none"){var value=_this.rowItemArray[_this.lastHeader[col].lastHeadNum].outerHTML.match(dataFieldRegExp);if(value!==null){var keys=new Array;for(var prop=0;prop<value.length;prop++){var parseValue=value[prop].split("=");var attributeName=parseValue[0];var fieldName=parseValue[1];fieldName=fieldName.substring(2,fieldName.indexOf("}"));if(keys.indexOf(fieldName)===-1){keys.push(fieldName)}}for(var j=0;j<keys.length;j++){appendStr=_this.data[selectedRowIndex][keys[j]];if(appendStr===undefined||appendStr===null){appendStr=""}tempTextarea.value+=appendStr+"\t"}}else{var currentCell=_this.rowItemArray[_this.lastHeader[col].lastHeadNum];if(currentCell.tagName!==undefined&&currentCell.tagName=="TOP-COLUMNITEM"){appendStr=currentCell.getAttribute("text");if(appendStr!==undefined||appendStr!==null){tempTextarea.value+=appendStr+"\t"}else{throw new TypeError("currentCell text attribute is undefined or null")}}else{throw new TypeError("currentCell tageName is not TOP-COLUMNITEM")}}}else{var currentCell=_this.bindingarray[selectedRowIndex][_this.lastHeader[col].lastHeadNum];if(currentCell.tagName!==undefined&&currentCell.tagName=="TD"){appendStr=currentCell.textContent}else{if(currentCell.template.dataBoundproperties!==undefined){appendStr=currentCell.getProperties(currentCell.template.dataBoundproperties)}else{appendStr=""}}if(currentCell.tagName==="TD"&&Number(currentCell.getAttribute("col"))<Object.keys(_this.bindingarray[selectedRowIndex]).length-1){tempTextarea.value+=appendStr+"\t"}else{tempTextarea.value+=appendStr}}}if(selectedRowIndex!==_this.bindingarray.length-1){tempTextarea.value+="\n"}}}tempTextarea.value=tempTextarea.value.replace(/\n$/gm,"");tempTextarea.select();document.execCommand("Copy");document.body.removeChild(tempTextarea)}else if(e.keyCode==86&&ctrlDown==true&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"){var selectType=_this.getAttribute("select-type");var selectData=_this.querySelectorAll(".body-"+selectType+".selected");var lastSelectedIndex=selectData[selectData.length-1].dataIndex;var dataFieldRegExp=new RegExp("([-\\w]+)=[\"|']({[\\w.]+})[\"|']","g");var keys=new Array;for(var col=0;col<_this.lastHeader.length;col++){if(_this.lastHeader[col].type!=="normal"&&_this.lastHeader[col].type!=="required"||_this.lastHeader[col].visible==="none"){continue}else{var value=_this.rowItemArray[_this.lastHeader[col].lastHeadNum].outerHTML.match(dataFieldRegExp);if(value!==null){for(var prop=0;prop<value.length;prop++){var parseValue=value[prop].split("=");var attributeName=parseValue[0];var fieldName=parseValue[1];fieldName=fieldName.substring(2,fieldName.indexOf("}"));if(keys.indexOf(fieldName)===-1){keys.push(fieldName)}}}else{continue}}}var pastedData;document.addEventListener("paste",function(ev){var clipboardData;ev.stopPropagation();ev.preventDefault();clipboardData=ev.clipboardData||window.clipboardData;pastedData=clipboardData.getData("Text");var tempArr=new Array;var rows=pastedData.split("\n");for(var rowNum=0,length=rows.length-1;rowNum<length;rowNum++){var tempObj=new Object;var rowData=rows[rowNum].split("\t");for(var keyNum=0,leng=keys.length;keyNum<leng;keyNum++){tempObj[keys[keyNum]]=rowData[keyNum]}tempArr.push(tempObj)}Top.Dom.selectById(_this.id).addRows(tempArr,lastSelectedIndex+1);Top.Dom.selectById(_this.id).update();this.removeEventListener("paste",arguments.callee)})}});top$(_this.querySelector(".top-tableview-scroll")).off("keyup").on("keyup",function(e){if(e.keyCode==17){ctrlDown=false}});top$(_this.querySelector("tbody")).off("mousedown").on("mousedown",function(e){var clickPosition=e.clientY;var onWheelClick=function(){_this.wheelState=true;top$("body").off("mousemove").on("mousemove",function(event){var currentPosition=event.clientY;if(clickPosition>currentPosition){upscroll(event)}else{downscroll(event)}})};var offWheelClick=function(){_this.wheelState=false;top$("body").off("mousemove")};if(e.which==2){_this.wheelState?offWheelClick():onWheelClick();e.stopPropagation()}else{offWheelClick()}});top$("body").on("mousedown",function(){_this.wheelState=false;top$("body").off("mousemove")});function upscroll(event){var posy=Number(scroll.css("top").split("px")[0]);if(posy<=0){return}_this.startRowNum--;_this.startrownum--;if(_this.startRowNum<0){_this.startRowNum=0;_this.startrownum=0;return}var bary=Number(bar.height()-scroll.height());posy=posy-Number((bary/_this.Dlegnth).toFixed(8));scroll.animate({top:posy},{duration:0,complete:_this.onScroll(event,true)})}function downscroll(event){var bary=parseFloat(bar.height())-parseFloat(scroll[0].style.height);var barb=parseFloat(scroll.css("top"));if(bary-barb<=.01||scroll.height()==0){return}if(_this.paginate){if(_this.startRowNum+_this.rownum>=_this.pageInfo.end+1){return}}_this.startRowNum++;_this.startrownum++;if(_this.startRowNum>_this.backupdata.length-_this.rownum){_this.startRowNum--;_this.startrownum--;return}var posy=Number(scroll.css("top").split("px")[0]);var bary=Number(bar.height()-scroll.height());posy=posy+Number((bary/_this.Dlegnth).toFixed(8));scroll.animate({top:posy},{duration:0,complete:_this.onScroll(event,true)})}function __onScrollEnd(){if(this.originScrollLeft===undefined)this.originScrollLeft=0;var scrollLeft=this.querySelector(".top-tableview-scrollBody-border").scrollLeft;var resizers=this.querySelectorAll(".top-tableview-resizer");this.deltaScrollLeft=this.originScrollLeft-scrollLeft;for(var i=0,len=resizers.length;i<len;i++){resizers[i].style.left=parseInt(resizers[i].style.left)+this.deltaScrollLeft+"px"}this.originScrollLeft=scrollLeft}},resizer_reposition:function(){var _this=this;var headsetting=Array.from(_this.querySelectorAll("th.last-head:not(.ui-draggable-dragging)")).sort(_this.sortByHeadIndex);if(headsetting.length<1){return}var thirdheads=_this.querySelectorAll(".top-tableview-resizer");if(thirdheads.length<1){return}var hcolgroup=_this.querySelector(".head_colgroup");var bcolgroup=_this.querySelector(".body_colgroup");var resizerHeight=headsetting[0].offsetHeight+"px";for(var j=0;j<headsetting.length-1;j++){if(headsetting[j].getAttribute("colspan")==="1"){var headCellLeft=headsetting[j+1].offsetLeft-5+"px";thirdheads[j].style.left=headCellLeft;thirdheads[j].style.height=resizerHeight}}},__adjustByParentVisible:function(){this.scrollbar_height();this.resizer_reposition();if(this.layoutWidth=="match_parent"){var parentwidth=this.parentElement.offsetWidth;top$(this).width(parentwidth)}},__adjustBytablayout:function(){var _this=this;if(this.layoutWidth=="match_parent"){this.style.width=this.parentElement.offsetWidth+"px"}this.scrollbar_height();this.resizer_reposition()},scrollbar_height:function(){if(this.innerframe===undefined)return;var _this=this;var scroll=top$("#scroll_"+this.id);var bar=top$("#bar_"+this.id);var index_inpage=_this.startRowNum;var tbody=this.querySelector(".top-tableview-scrollBody tbody");this.innerframe.css("height",tbody.offsetHeight);this.bar.css("height",tbody.offsetHeight-30);var offsetTop=top$("#"+this.id+" .top-tableview-scroll")[0]!==undefined?top$("#"+this.id+" .top-tableview-scroll")[0].offsetTop:0;var scrollpos=top$("#"+this.id+" .incapable_header").height();this.innerframe.css("margin-top",scrollpos+2);if(_this.backupdata.length===0||!_this.items){_this.pagestartnum=0}_this.Dlegnth=0;if(_this.paginate&&_this.pageLength<_this.datapointer.length){index_inpage=index_inpage-_this.pagestartnum;if(_this.pageLength>0){if(_this.pagerange<=_this.rownum){_this.Dlegnth=0}else if(_this.pagerange<_this.pageLength){_this.Dlegnth=this.pagerange}else{_this.Dlegnth=_this.pageLength}}else{_this.Dlegnth=_this.rownum}}else{_this.Dlegnth=this.datapointer.length}var scrollh=0;if(_this.Dlegnth<=this.rownum){scrollh=0;_this.startRowNum=_this.pagestartnum;_this.startrownum=_this.startRowNum}else{scrollh=bar.height()/(_this.Dlegnth/this.rownum);if(scrollh<6){scrollh=6}if(this.bar.height()<8){this.bar.css("height","8px")}}if(_this.Dlegnth>=_this.rownum){_this.Dlegnth=_this.Dlegnth-_this.rownum}if(scrollh==0){this.innerframe.css("visibility","hidden");var fixwidth=this.querySelector(".top-tableview").offsetWidth;this.viewport[0].style.width="calc(100%)";this.scrollHead[0].style.width="calc(100%)"}else{this.innerframe.css("visibility","visible")}scroll.css("height",scrollh);var bary=bar.height()-scroll.height();if(_this.Dlegnth!=0){var posy=Number(Number(index_inpage/_this.Dlegnth)*bary)}scroll.css("top",posy);if(this.Dlegnth<index_inpage){index_inpage=this.Dlegnth;scroll.css("top",bary)}},openAllNode:function(openORclose){var open=true;if(openORclose==false){open=false}for(var k=0;k<this.checkIndexInfo.length;k++){if(this.checkIndexInfo[k]["open"]!="leaf"){this.checkIndexInfo[k]["open"]=open}}this.onScroll()},manageLeaf:function(){for(var k=0;k<this.backupdata.length;k++){if(k>=this.backupdata.length-1){this.checkIndexInfo[k]["open"]="leaf";return}if(this.backupdata[k][this.levelbind]>=this.backupdata[k+1][this.levelbind]){this.checkIndexInfo[k]["open"]="leaf"}else{if(this.checkIndexInfo[k]["open"]=="leaf"){this.checkIndexInfo[k]["open"]=true}}}},openNode:function(index,level,open){if(index>=this.backupdata.length){return}if(this.backupdata[index][this.levelbind]==1){var curlevel=1;open=true;this.backup=[]}else if(level<this.backupdata[index][this.levelbind]){this.backup[level]=open;curlevel=this.backupdata[index][this.levelbind]}else{curlevel=this.backupdata[index][this.levelbind];if(this.backup[curlevel-1]!=undefined){open=this.backup[curlevel-1]}else{open=this.checkIndexInfo[index]["open"]}}if(open==true){this.datapointer.push(this.backupdata.slice(index,index+1)[0]);this.checkIndexpointer.push(this.checkIndexInfo.slice(index,index+1)[0]);open=this.checkIndexInfo[index]["open"];return this.openNode(index+1,curlevel,open)}else{return this.openNode(index+1,curlevel,open)}},isLeafNode:function(index){if(this.checkIndexInfo[index]["open"]!="leaf"){return false}else{return true}},removeNode:function(index,movePage,cascade){if(this.isLeafNode(index)==false){
alert("LEAF 노드만 삭제 가능합니다."+"ROW:"+index);return}else{var nodefam=this.getNodefamilyIndex(index);this.virtualremoveRows(nodefam,movePage)}},addNode:function(object,index,movePage,make_RootNode){var obj=JSON.parse(JSON.stringify(object));if(make_RootNode){if(this.backupdata.length!=0&&this.backupdata[index][this.levelbind]!=1){index=0;obj[this.levelbind]=1;this.virtualaddRows(obj,index,movePage)}else{obj[this.levelbind]=1;this.virtualaddRows(obj,index,movePage)}return}if(index>=this.backupdata.length){index=this.backupdata.length;var parentlevel=1}else{var parentlevel=parseInt(this.backupdata[index][this.levelbind]);index++}if(this.backupdata[index-1][this.levelbind]>=1){this.checkIndexInfo[index-1]["open"]=true}obj[this.levelbind]=parentlevel+1+"";this.virtualaddRows(obj,index,movePage)},are_you_myBroNode:function(index,operation){if(!operation){var operation="+"}var mylevel=this.backupdata[index][this.levelbind];if(operation=="-"){index--;while(index>=0){var brolevel=this.backupdata[index][this.levelbind];if(brolevel<=mylevel){break}index--}}else{index++;while(index<this.backupdata.length){var brolevel=this.backupdata[index][this.levelbind];if(brolevel<=mylevel){break}index++}}if(mylevel==brolevel){return index}else{return-1}},changeNodelevel:function(index,operation,count){if(!operation){var operation="+"}if(index>0&&operation=="+"){if(this.backupdata[index][this.levelbind]-this.backupdata[index-1][this.levelbind]>=1){return}}var nodes=this.getNodefamily(index);if(operation=="+"){for(var i=0;i<nodes.length;i++){nodes[i][this.levelbind]++}}else{if(nodes[0][this.levelbind]<=1){return}for(var i=0;i<nodes.length;i++){nodes[i][this.levelbind]--}}this.onScroll()},changeNodePos:function(startIndex,endIndex,type){var _this=this;var startIndex=parseInt(startIndex);var endIndex=parseInt(endIndex);if(startIndex==endIndex){return}if(endIndex==-1){var target_operater="-";var startfamily=_this.getNodefamily(startIndex);var targetidx=0}else{var startlevel=_this.backupdata[startIndex][_this.levelbind];var endlevel=_this.backupdata[endIndex][_this.levelbind];if(endIndex<startIndex){var operater="-"}else{var operater="+"}if(operater=="+"){var nextnode=_this.getNodefamilyIndex(startIndex).pop();if(endIndex<=nextnode){return}}var startfamily=_this.getNodefamily(startIndex);var origin_parent_level=startfamily[0][this.levelbind];if(type=="super"){var adjustlevel=endlevel+1;var targetidx=endIndex+1}else{var adjustlevel=endlevel;var targetidx=_this.getNodefamilyIndex(endIndex).pop()+1}var level_gap=adjustlevel-origin_parent_level;for(var i=0;i<startfamily.length;i++){startfamily[i][this.levelbind]=startfamily[i][this.levelbind]+level_gap}if(targetidx<startIndex){var target_operater="-"}else{var target_operater="+"}}var c_i_nodes=_this.getNodefamily_checkinfo(startIndex);if(target_operater=="-"){for(var i=startfamily.length-1;i>=0;i--){this.backupdata.splice(targetidx,0,startfamily[i]);this.checkIndexInfo.splice(targetidx,0,c_i_nodes[i])}for(var i=0;i<startfamily.length;i++){this.backupdata.splice(startIndex+startfamily.length,1);this.checkIndexInfo.splice(startIndex+startfamily.length,1)}}else{for(var i=startfamily.length-1;i>=0;i--){this.backupdata.splice(targetidx,0,startfamily[i]);this.checkIndexInfo.splice(targetidx,0,c_i_nodes[i])}for(var i=0;i<startfamily.length;i++){this.backupdata.splice(startIndex,1);this.checkIndexInfo.splice(startIndex,1)}}for(var j=0;j<this.checkIndexInfo.length;j++){this.checkIndexInfo[j]["linkidx"]=j}},changeNodeIndex:function(index,operation,count){var _this=this;if(operation=="+"||operation=="-"){if(!count){count=1}var broidx=index;while(true){if(count==0){break}broidx=_this.are_you_myBroNode(broidx,operation);count--}if(broidx<0){console.log("해당위치로 node 이동불가");return}}else{if(index==operation){return}var startIndex=parseInt(index);var broidx=parseInt(operation);var startlevel=_this.backupdata[startIndex][_this.levelbind];var endlevel=_this.backupdata[broidx][_this.levelbind];if(broidx<startIndex){operation="-"}else{operation="+"}if(operation=="-"){if(startlevel==endlevel){if(_this.are_you_myBroNode(broidx,"+")!=-1){broidx=_this.are_you_myBroNode(broidx,"+")}}else if(startlevel-1==endlevel){broidx++}else if(startlevel!=endlevel){if(_this.getNodeParentIndex(broidx)){broidx=_this.getNodeParentIndex(broidx)}else{return}while(true){endlevel=_this.backupdata[broidx][_this.levelbind];if(startlevel==endlevel){break}if(startIndex==broidx){return}broidx++}}}else{var nextnode=_this.are_you_myBroNode(startIndex,"+");if(broidx<nextnode){return}if(startlevel-1>endlevel){return}}}if(index==null||!this.levelbind||!this.backupdata[index]){return}var nodeidxs=_this.getNodefamilyIndex(index);var nodes=_this.getNodefamily(index);var c_i_nodes=_this.getNodefamily_checkinfo(index);if(operation=="-"){var targetidx=broidx;for(var i=nodes.length-1;i>=0;i--){this.backupdata.splice(targetidx,0,nodes[i]);this.checkIndexInfo.splice(targetidx,0,c_i_nodes[i])}for(var i=0;i<nodes.length;i++){this.backupdata.splice(index+nodes.length,1);this.checkIndexInfo.splice(index+nodes.length,1)}}else{var targetidx=broidx+_this.getNodefamilyIndex(broidx).length;for(var i=nodes.length-1;i>=0;i--){this.backupdata.splice(targetidx,0,nodes[i]);this.checkIndexInfo.splice(targetidx,0,c_i_nodes[i])}for(var i=0;i<nodes.length;i++){this.backupdata.splice(index,1);this.checkIndexInfo.splice(index,1)}}for(var j=0;j<this.checkIndexInfo.length;j++){this.checkIndexInfo[j]["linkidx"]=j}this.onScroll()},getNodeParentIndex:function(index){if(index<=0||!this.levelbind||!this.backupdata[index]){return null}var level=this.backupdata[index][this.levelbind];if(level<=1){return null}index--;while(true){if(index<0||level>this.backupdata[index][this.levelbind]){return index}else{index--}}},getNodefamilyIndex:function(index){if(index<0||!this.levelbind||!this.backupdata[index]){return[]}var familynodes=[];var level=this.backupdata[index][this.levelbind];familynodes.push(index);index++;while(true){if(index>=this.backupdata.length||level>=this.backupdata[index][this.levelbind]){break}else{familynodes.push(index);index++}}return familynodes},getNodefamily:function(index){var nodearray=[];var indexs=this.getNodefamilyIndex(index);for(var k=0;k<indexs.length;k++){nodearray.push(this.backupdata[indexs[k]])}return nodearray},getNodefamily_checkinfo:function(index){var nodearray2=[];var indexs=this.getNodefamilyIndex(index);for(var k=0;k<indexs.length;k++){nodearray2.push(this.checkIndexInfo[indexs[k]])}return nodearray2},maketreebtn:function(cell,rowIndex,level,openValue){var _this=this;var levelpad=0;for(var j=0;j<level-1;j++){levelpad+=1}var icon_open=this.treeicon["open"];var icon_close=this.treeicon["close"];var icon_leaf=this.treeicon["leaf"];var treecolumn=cell;var treebtnhandler=function(event){var trigger=event.target;if(!event.target.className.includes("TOP_tree")){return}if(trigger.className.includes("open")==true){var linkidx=parseInt(_this.startRowNum)+parseInt(trigger.getAttribute("rowidx"));_this.checkIndexpointer[linkidx]["open"]=false}else if(trigger.className.includes("open")=="leaf"){}else{var linkidx=parseInt(_this.startRowNum)+parseInt(trigger.getAttribute("rowidx"));_this.checkIndexpointer[linkidx]["open"]=true}event.stopPropagation();_this.onScroll()};if(cell.querySelector(".TOP_tree")){var trigger=cell.querySelector("div");if(openValue==true){trigger.className="TOP_tree open "+icon_open}else if(openValue=="leaf"){trigger.className="TOP_tree leaf "+icon_leaf}else{trigger.className="TOP_tree close "+icon_close}top$(triggerbox).click(treebtnhandler)}else{var triggerbox=document.createElement("div");var trigger=document.createElement("i");triggerbox.setAttribute("style","position:relative; cursor:pointer; float:left; margin-right:10px; margin-left:"+levelpad*this.levelweight+"px");trigger.setAttribute("rowidx",rowIndex);if(openValue==true){trigger.className="TOP_tree open "+icon_open}else if(openValue=="leaf"){trigger.className="TOP_tree leaf "+icon_leaf}else{trigger.className="TOP_tree close "+icon_close}treecolumn.classList.add("column_tree");top$(triggerbox).append(trigger);top$(treecolumn).prepend(triggerbox);top$(triggerbox).click(treebtnhandler)}},model_sync:function(widget,bindtarget,k){var _this=this;var dld="";var vld="";var _vld="";var bindtext="";var bindvalue="";if(widget.tagName=="TD"){vld=widget.getAttribute("value-field");dld=widget.getAttribute("data-field");if(vld){if(vld.includes("js::")){var _vld=vld.split("::")[1];if(_vld=="open"){var open_close=_this.checkIndexpointer[k+_this.startRowNum][_vld]}else{}}}if(dld){if(dld.includes("js::")){var _vld=dld.split("::")[1];if(_vld=="status"){var bindtext=_this.checkIndexpointer[k+_this.startRowNum][_vld]}else if(_vld=="open"){var bindtext=_this.datapointer[k+_this.startRowNum][_this.textbind]}else if(_vld=="index"){var bindtext=_this.checkIndexpointer[k+_this.startRowNum]["linkidx"]+1}else if(_vld=="index_r"){var bindtext=_this.checkIndexInfo.length-_this.checkIndexpointer[k+_this.startRowNum]["linkidx"]}}}if(_this.data[k][dld]!=null||_this.data[k][dld]!=undefined){var bindtext=_this.data[k][dld]}if(_this.data[k][vld]!=null||_this.data[k][vld]!=undefined){var bindvalue=_this.data[k][vld]}if(dld){widget.textContent=bindtext}if(vld){widget.setAttribute("value",bindvalue)}if(_vld=="open"){var level=_this.datapointer[k+_this.startRowNum][_this.levelbind];this.maketreebtn(widget,k,level,open_close)}else if(_vld=="status"){widget.textContent=bindtext}return}if(!bindtarget.boundProperties)return;var bound="";var field="";switch(bindtarget.tagName){case"TOP-CHECKBOX":var prop={};for(var i=0,len=bindtarget.boundProperties.length;i<len;i++){bound=bindtarget.boundProperties[i];field=bindtarget.fieldProperties[i];prop[bound]=_this.data[k][field]==undefined?"":_this.data[k][field]}if(bindtarget.getAttribute("checked")=="js::check"){var bool=_this.checkIndexpointer[k+_this.startRowNum]["checkbool"];prop["checked"]=bool;prop["on-click"]=function(event,widget){var row=parseInt(widget.template.getAttribute("row"));var __checked=widget.getChecked();if(_this.singlecheck){_this.checkAll(false);widget.setProperties({checked:__checked})}_this.checkIndexpointer[row+_this.startRowNum]["checkbool"]=__checked;if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("rowcheck"))}else{_this.__dispatchEvent(new Event("rowcheck"))}_this.checkCallback()}}widget.setProperties(prop);break;case"TOP-RADIOBUTTON":case"TOP-TEXTFIELD":case"TOP-BUTTON":case"TOP-COLORPICKER":case"TOP-DATEPICKER":case"TOP-SPINNER":case"TOP-TEXTVIEW":case"TOP-SELECTBOX":var prop={};for(var i=0,len=bindtarget.boundProperties.length;i<len;i++){bound=bindtarget.boundProperties[i];field=bindtarget.fieldProperties[i];prop[bound]=_this.data[k][field]==undefined?"":_this.data[k][field]}widget.setProperties(prop);break;default:var prop={};for(var i=0,len=bindtarget.boundProperties.length;i<len;i++){bound=bindtarget.boundProperties[i];field=bindtarget.fieldProperties[i];prop[bound]=_this.data[k][field]==undefined?"":_this.data[k][field]}widget.setProperties(prop);break}},onScroll:function(e,scrolled){var _this=this;var startrownum=_this.startRowNum;var bodyRoot=_this.querySelector(".top-tableview-scrollBody .body");_this.rowsync=true;var appendRow=_this.rownum;if(_this.pageInfo&&_this.pageInfo.length!=-1&&_this.rownum>_this.pageInfo.length){appendRow=_this.pageInfo.length}_this.data=[];if(_this.treetable&&_this.levelbind){if(!this.connect){_this.datapointer=[];_this.checkIndexpointer=[];_this.backup=[];_this.manageLeaf();_this.openNode(0,1,false)}if(_this.startRowNum+appendRow>_this.datapointer.length){_this.startRowNum=_this.datapointer.length-appendRow}_this.scrollbar_height();_this.data=_this.datapointer.slice(_this.startRowNum,_this.startRowNum+appendRow)}else{if(_this.startRowNum+appendRow>_this.datapointer.length){_this.startRowNum=_this.datapointer.length-appendRow}_this.scrollbar_height();_this.data=_this.datapointer.slice(_this.startRowNum,_this.startRowNum+appendRow);if(!this.connect){_this.checkIndexpointer=_this.checkIndexInfo}}if(!this.items||this.datapointer.length==0){top$(_this.querySelectorAll(".body-row")).remove();_this.bindingarray.length=0;_this.checknodata();return}if(this.testmerge){_this.rowsync=false}if(_this.data.length!=_this.bindingarray.length){_this.rowsync=false}if(!_this.rowsync){top$(_this.querySelectorAll(".body-row")).remove();var bufBody=_this.__makeTBodyTag(_this.data,undefined,bodyRoot,true);_this.scrollbar_height()}for(var k=0;k<this.data.length;k++){for(var i=0;i<this.lastHeader.length;i++){if(!_this.bindingarray[k][i]){continue}var widget=undefined;var bindtarget=undefined;widget=_this.bindingarray[k][i];bindtarget=_this.bindingarray[k][i].template;if(widget instanceof Array){var mw;var mt;for(var p=0;p<widget.length;p++){mw=widget[p];mt=mw.template;_this.model_sync(mw,mt,k)}}else{_this.model_sync(widget,bindtarget,k)}}}if(this.testmerge){var timer=null;clearTimeout(timer);timer=setTimeout(_this.mergefunc.bind(_this),1e3)}var allTds=_this.querySelectorAll(".body-row .body-cell:not(.checkable)");if(_this.checkable){_this.checkboolsync()}_this.rowsync=true;_this.__postBodyAppend(allTds,_this.data,0);if(scrolled===true){if(_this.scrolltimer){clearTimeout(_this.scrolltimer)}_this.scrolltimer=setTimeout(function(){_this.__dispatchEvent(new CustomEvent("scrollend",{detail:{current_pos:e.target.offsetTop,startIndex:startrownum,current_data:_this.data,target:_this}}))},300)}top=undefined;bodyRoot=undefined;if(this.indexable)this.__renderIndex();this.bindEvent();if(_this.sequence){_this.updatesequence()}},checkboolsync:function(){var _this=this;var startrownum=_this.startRowNum;var checkableTd=_this.childRoot.querySelectorAll(".checkable.body-cell");var bodyrow=_this.childRoot.querySelectorAll(".body-row");for(var i=0;i<checkableTd.length;i++){if(!_this.rowsync){var checkableCheckbox=Top.Widget.create("top-checkbox").template;checkableCheckbox.classList.add("checkable-body");checkableTd[i].appendChild(checkableCheckbox);TopRuntime._callCallback(checkableCheckbox,"attached")}else{var checkableCheckbox=checkableTd[i].querySelector("top-checkbox")}checkableCheckbox.givenidx=startrownum+i;if(_this.connect){var TorF=_this.datapointer[i+startrownum]["temp"].checkbool}else if(_this.treetable){var TorF=_this.checkIndexpointer[i+startrownum].checkbool}else{var TorF=this.checkIndexInfo.length>this.startRowNum+i?this.checkIndexInfo[this.startRowNum+i].checkbool:false}checkableCheckbox.checked=TorF;var disabled=this.checkIndexInfo.length>this.startRowNum+i?this.checkIndexInfo[this.startRowNum+i].checkDisabled:false;Top.Dom.__selectImpl(checkableCheckbox).setDisabled(disabled);checkableCheckbox.__updateProperties("checked")}},mergefunc:function(){console.log("merge!!");for(var i=0;i<Object.keys(this.bindingarray[0]).length;i++){var count=1;var until=0;var removeTD=[];for(var k=0;k<this.data.length;k++){if(this.getCellValue(k,i)===this.getCellValue(k+1,i)){removeTD.push(k+1);count++;this.querySelectorAll(".column_"+i)[k-until].rowSpan=count;until++}else{count=1;until=0}}for(var j=removeTD.length-1;j>=0;j--){this.getElementsByClassName("column_"+i)[removeTD[j]].remove()}removeTD=[]}},virtualgoToPage:function(page,pageInfo){var _this=this;if(!_this.querySelector("top-pagination")||_this.data.length===0||!_this.items){return}if(page==null)return;this.scroll.css("top",0);var dataLength=this.datapointer.length;var len=this.pageLength;var start=len===-1?0:len*page;var end=len===-1||len*(page+1)>dataLength?dataLength-1:len*(page+1)-1;_this.pagerange=end-start+1;_this.pagestartnum=start;_this.startRowNum=start;this.onScroll();this.scrollbar_height();this.setPageInfo({start:start,end:end,page:page+1});var pager=this.childRoot.querySelector("top-pagination");pager.setAttribute("page",page+1);pager.page=page+1;this.pagerType==="input"?pager.renderInput():pager.renderBasic()},virtualmakePage:function(){var thisTable=this;var dataLength=this.datapointer!==undefined?this.datapointer.length:this.datapointer.length;var pagelength=this.pageLength;thisTable.currentPage=0;var total=pagelength===-1?1:Math.ceil(dataLength/pagelength);if(total==0){total=1}thisTable.total=total;var pageInfo={page:thisTable.currentPage,length:total,recordsTotal:""};if(pageInfo.length===-1)pageInfo.length=pageInfo.recordsTotal;var pagerType=this.pagerType;var pagerMaxVisible=this.pagerMaxVisible;var root=this.childRoot;var pagerContainer=root.querySelector(".auto-pagination");var nTable=this.scrollTable?root.querySelector(".top-tableview-scrollBody > .top-tableview"):root.querySelector(".top-tableview");var pagerDiv=root.querySelector(".top-tableview-pager");var beforepage;if(pagerContainer==null){return;var pagerContainer=document.createElement("div");pagerContainer.className="auto-pager";top$(root.querySelector("div.top-tableview-root")).append(pagerDiv)}if(pagerDiv==null){pagerDiv=document.createElement("div");pagerDiv.className="top-tableview-pager";top$(pagerContainer).append(pagerDiv)}var paginationWidget=pagerContainer.querySelector("top-pagination");if(paginationWidget==null){paginationWidget=Top.Widget.create("top-pagination").template;pagerDiv.appendChild(paginationWidget);TopRuntime._callCallback(paginationWidget,"attached")}var editProperties={type:pagerType,total:total,page:1};if(pagerMaxVisible)editProperties["max-visible"]=pagerMaxVisible;if(editProperties){var keys=Object.keys(editProperties);var len=keys.length;for(var j=0;j<len;j++){paginationWidget.setAttribute(keys[j],editProperties[keys[j]])}Top.Widget.create("top-pagination",undefined,paginationWidget).setProperties(editProperties)}if(this.showresult){if(root.querySelector(".top-tableview-result")==null){top$(pagerContainer).prepend('<div class="top-tableview-result"><span class="number">'+dataLength+"</span><span> Results</span></div>")}else{root.querySelector(".top-tableview-result").innerHTML='<span class="number">'+dataLength+"</span><span> Results</span>"}}switch(this.pagerLocation){case"tl":case"bl":{top$(pagerContainer).css("text-align","left");break}case"tc":case"bc":{top$(pagerContainer).css("text-align","center");break}case"tr":case"br":{top$(pagerContainer).css("text-align","right");break}}var curPage=this.currentPage>0?this.currentPage:pageInfo.page;beforepage=this.getPageInfo()==undefined?1:this.getPageInfo().page;this.setPageInfo({beforepage:beforepage,pages:total,items:dataLength,length:this.pageLength,page:curPage+1,start:this.pageLength===-1?0:this.pageLength*curPage,end:this.pageLength===-1||this.pageLength*(curPage+1)>dataLength?dataLength-1:this.pageLength*(curPage+1)-1});var pagination=root.querySelector("top-pagination");pagination.page=this.getPageInfo().page;paginationWidget.setAttribute("page",this.getPageInfo().page);Top.Widget.create("top-pagination",undefined,paginationWidget).setProperties({page:this.getPageInfo().page});if(pagination!==null){pagination.setPageEvent(function(page){var beforepage=thisTable.currentPage+1;pageInfo.page=page-1;thisTable.currentPage=page-1;thisTable.virtualgoToPage(page-1,thisTable.getPageInfo());var start=thisTable.pageLength===-1?0:thisTable.pageLength*(page-1);var end=thisTable.pageLength===-1||thisTable.pageLength*page>dataLength?dataLength-1:thisTable.pageLength*page-1;var len=thisTable.pageLength;thisTable.setPageInfo({beforepage:beforepage,length:len,start:start,end:end,page:page});if(beforepage!==page){thisTable.__dispatchEvent(new CustomEvent("pagechange",{detail:thisTable.getPageInfo()}))}thisTable.checkCallback();thisTable.__renderDummyView()});pagination.__bindEvent()}if(this.lengthChange){var lengthMenu=this.lengthMenu;if(typeof this.lengthMenu==="string"){if(lengthMenu.includes("[")==true){lengthMenu=lengthMenu.replace("[","").replace("]","").replace(/(\s*)/g,"").split(",").map(String)}else{lengthMenu=Top.Util.namespace(this.lengthMenu,this)}}var lengthChangeProp={nodes:lengthMenu,selectedText:this.pageLength};if(this.querySelector("#table-length-menu")){var selectedValue=Top.Dom.selectById("table-length-menu").getProperties("selectedIndex");if(selectedValue!==undefined)lengthChangeProp={nodes:lengthMenu,selectedIndex:String(selectedValue)};this.querySelector("#table-length-menu").remove()}else{}var lengthChangeWidget=Top.Widget.create("top-selectbox",lengthChangeProp).template;lengthChangeWidget.id="table-length-menu";pagerDiv.appendChild(lengthChangeWidget);lengthChangeWidget.onclick=function(e){var prevLen=thisTable.pageLength;var page=thisTable.getPageInfo().page;var selectedValue=String(this.value).toUpperCase()==-1||String(this.value).toUpperCase()=="ALL"?dataLength:this.value;thisTable.pageLength=parseInt(selectedValue);pageInfo=thisTable.getPageInfo();if(thisTable.pageLength==0){thisTable.pageLength=1}var total=thisTable.pageLength===-1?1:Math.ceil(pageInfo.items/thisTable.pageLength);var start=thisTable.pageLength===-1?0:thisTable.pageLength*(pageInfo.page-1);var end=thisTable.pageLength===-1||thisTable.pageLength*pageInfo.page>dataLength?dataLength-1:thisTable.pageLength*pageInfo.page-1;var len=thisTable.pageLength;pagination.setAttribute("total",total);pagination.total=total;pagerType==="input"?pagination.renderInput():pagination.renderBasic();var beforepage=thisTable.getPageInfo()==undefined?null:thisTable.getPageInfo().page;thisTable.setPageInfo({beforepage:beforepage,pages:total,start:start,end:end,length:len});var callbackData=thisTable.getPageInfo();callbackData.lengthSelected=!thisTable.__changedPageLength;thisTable.__dispatchEvent(new CustomEvent("lengthchange",{detail:callbackData}));thisTable.virtualgoToPage(0,thisTable.getPageInfo());thisTable.__changedPageLength=false}}},virtualaddRows:function(obj,index,movePage){var _this=this;if(typeof obj!=="object")return;if(!(obj instanceof Array))obj=[obj];if(index===undefined)index=this.backupdata.length;else if(index<0)index=0;if(movePage===undefined)movePage=1;for(var i=obj.length-1;i>=0;i--){this.backupdata.splice(index,0,obj[i]);this.checkIndexInfo.splice(index,0,{checkbool:false,status:"C",open:false,linkidx:i,checkDisabled:false})}for(var j=0;j<this.checkIndexInfo.length;j++){this.checkIndexInfo[j]["linkidx"]=j}if(this.paginate){this.virtualmakePage();this.virtualgoToPage(movePage-1,this.getPageInfo())}this.onScroll(event);this.scrollbar_height()},virtualremoveRows:function(index,movePage,flagonly){if(index===undefined){return}if(index>=this.checkIndexInfo.length){return}if(movePage===undefined)movePage=1;if(Top.Util.__isBooleanTrue(flagonly)){if(index instanceof Array){for(var i=0;i<index.length;i++){this.checkIndexInfo[index[i]]["status"]="D"}}else{this.checkIndexInfo[index]["status"]="D"}this.onScroll();return}if(index instanceof Array){for(var i=0;i<index.length;i++){this.backupdata.splice(index[i]-i,1);this.checkIndexInfo.splice(index[i]-i,1)}}else{this.backupdata.splice(index,1);this.checkIndexInfo.splice(index,1)}if(this.backupdata.length==0){this.data.length=0;this.datapointer.length=0}for(var j=0;j<this.checkIndexInfo.length;j++){this.checkIndexInfo[j]["linkidx"]=j}if(this.paginate){this.virtualmakePage()}this.onScroll(event);this.scrollbar_height()},treesortByKey:function(key){var _this=this;var level_ones=[];key[0]["key"]=this.textbind;for(var i=0;i<this.datapointer.length;i++){if(parseInt(this.datapointer[i][_this.levelbind])==1){level_ones.push(this.datapointer[i])}}this.rowidxconnecting();this.sortByKey(level_ones,key);var idxflag=-1;for(var k=0;k<level_ones.length;k++){var linkidx=this.getNodefamilyIndex(level_ones[k]["temp"]["linkidx"]);this.changeNodePos(linkidx,idxflag,"same");if(idxflag==-1){idxflag=0}idxflag=this.getNodefamilyIndex(idxflag).pop()+1}this.rowidxdisconnecting()},virtualsort:function(key){var _this=this;if(this.treetable){this.treesortByKey(key)}else{this.sortByKey(_this.datapointer,key)}this.onScroll()},index_reverse_sort:function(reverse){this.datapointer.reverse();this.checkIndexpointer.reverse();this.onScroll()},swap:function(index1,index2){var _this=this;this.rowidxconnecting();var swaparr=_this.backupdata;var tamp=null;temp=swaparr[index1];swaparr[index1]=swaparr[index2];swaparr[index2]=temp;_this.datapointer=null;_this.datapointer=swaparr;swaparr=null;this.rowidxdisconnecting();this.onScroll(event)},virtualfilter:function(word,colname,flag){var _this=this;_this.startRowNum=0;this.rowidxconnecting();var searcharr=_this.backupdata;var reg;if(word==""||word==undefined||_this.treetable||flag==true){reg=new RegExp(word)}else{reg=new RegExp("^"+word+"$")}if(colname!==undefined&&colname!==null&&colname!==""){var resultarr=searcharr.filter(function(searcharr){return reg.test(searcharr[colname])})}else{var resultarr=searcharr.filter(function(searcharr){for(var i=0;i<_this.itemKeys.length;i++){if(reg.test(searcharr[_this.itemKeys[i]])){return reg.test(searcharr[_this.itemKeys[i]])}}})}function searchnode(index,pivotindex){if(pivotindex>=resultarr.length){return}if(resultarr[index][_this.levelbind]<=1){pivotindex++;return searchnode(pivotindex,pivotindex)}else{var linkidx=resultarr[index]["temp"]["linkidx"];var nextindex=_this.getNodeParentIndex(linkidx);var nextdata=_this.backupdata[nextindex];resultarr.splice(index,0,nextdata);pivotindex++;return searchnode(index,pivotindex)}}if(_this.treetable){searchnode(0,0)}_this.datapointer=null;_this.datapointer=resultarr;_this.checkIndexpointer=[];for(var k=0;k<resultarr.length;k++){var linkidx=resultarr[k]["temp"]["linkidx"];_this.checkIndexpointer.push(_this.checkIndexInfo[linkidx])}if(word==""||word==undefined){this.rowidxdisconnecting();this.datapointer=this.backupdata;this.checkIndexpointer=this.checkIndexInfo}if(this.paginate){this.virtualmakePage()}this.onScroll();this.scrollbar_height();this.checkCallback()},sortByKey:function(array,keyObject){return array.sort(function(a,b){for(var i=0;i<keyObject.length;i++){var x=b[keyObject[i]["key"]]||"";var y=a[keyObject[i]["key"]]||"";var order=keyObject[i]["order"]===true||keyObject[i]["order"]==="asc"?-1:1;if(x==y){continue}var result=x>y;return order*(result?1:-1)}})},rowidxconnecting:function(){var _this=this;for(var i=0;i<_this.backupdata.length;i++){_this.backupdata[i]["temp"]=_this.checkIndexInfo[i]}_this.connect=true},rowidxdisconnecting:function(){var _this=this;if(!_this.connect){return}for(var i=0;i<_this.backupdata.length;i++){_this.checkIndexInfo[i]=_this.backupdata[i]["temp"];_this.backupdata[i]["temp"]=undefined;delete _this.backupdata[i].temp}_this.connect=false},getSelectionRows:function(){var selectedobj=this.querySelectorAll(".body-row.selected");var selectedindex=[];if(selectedobj.length>0){var extrow=Number(selectedobj[0].getAttribute("class").split("row_")[1].split(" ")[0])}else{return 0}return extrow+this.startRowNum},getSelectedIndex:function(){if(this.selectType=="row"){var selectedindex=[];for(var i=0;i<this.checkIndexInfo.length;i++){if(this.checkIndexInfo[i]["selected"]==true){selectedindex.push(i)}}if(selectedindex.length===1)return selectedindex[0]}else{var selectedobj=this.querySelectorAll(".body-cell.selected");var selectedindex=[];for(var i=0;i<selectedobj.length;i++){var extrow=Number(selectedobj[i].parentNode.dataIndex);var extcol=Number(selectedobj[i].getAttribute("col"));selectedindex.push({row:extrow,column:extcol})}}return selectedindex},getSelectedData:function(){var selecteddata=[];var selectedindex=this.getSelectedIndex();if(this.selectType=="row"){if(typeof selectedindex!="object")return this.backupdata[selectedindex];for(var i=0;i<selectedindex.length;i++){selecteddata.push(this.backupdata[selectedindex[i]])}}else{if(typeof selectedindex!="object")return;for(var i=0;i<selectedindex.length;i++){var row=selectedindex[i]["row"];var col=selectedindex[i]["column"];selecteddata.push(this.getCellValue(row,col))}}return selecteddata},getstatusdata:function(status){var _this=this;var sstr=status;var rdata=[];var info=_this.checkIndexInfo;for(var i=0;i<info.length;i++){if(info[i]["status"]==sstr){rdata.push(_this.backupdata[i])}}console.log(rdata)},getCellValue:function(Row,Col){var _this=this;var p_row=Row;var p_col=Col;var p_value;if(!_this.bindingarray[0]){return}if(isNaN(p_col)){if(p_col=="status"){p_value=_this.checkIndexInfo[p_row]["status"]}else{p_value=_this.backupdata[p_row][p_col]}}else{if(_this.bindingarray[0][p_col].tagName=="TD"){var dld=_this.bindingarray[0][p_col].getAttribute("data-field")}else{var dld=_this.bindingarray[0][p_col][0].template.fieldProperties[0]}if(dld){if(dld.includes("js::index")){p_value=_this.checkIndexInfo[p_row]["linkidx"]}else{p_value=_this.backupdata[p_row][dld]}}else{return null}}return p_value},setCellValue:function(Row,Col,Value){if(Value==null||Value==undefined||Value===""||Row==null||Row==undefined||Row===""||Col==null||Col==undefined||Col===""){return null}var _this=this;var s_row=Row;var view_row=Row-_this.startRowNum;var s_col=Col;var s_value=Value;if(isNaN(s_col)){if(s_col=="status"){this.checkIndexInfo[s_row]["status"]=s_value}else{_this.backupdata[s_row][s_col]=s_value;if(_this.checkIndexInfo[s_row]["status"]=="R"){_this.checkIndexInfo[s_row]["status"]="U"}}}else{if(_this.bindingarray[0][s_col].tagName=="TD"){var dld=_this.bindingarray[0][s_col].getAttribute("data-field")}else{var dld=_this.bindingarray[0][s_col].template.getAttribute("data-field")}if(dld){if(_this.backupdata[s_row][dld]==s_value){return null}_this.backupdata[s_row][dld]=s_value;if(_this.checkIndexInfo[s_row]["status"]=="R"){_this.checkIndexInfo[s_row]["status"]="U"}}else{return null}}_this.onScroll()},getRowValue:function(Row){return this.backupdata[Row]},setRowValue:function(Row,Value){},RowCount:function(status){var _this=this;var status_val=status;var rcount=0;if(status_val==undefined||status_val==null){rcount=_this.checkIndexInfo.length}else{for(var j=0;j<_this.checkIndexInfo.length;j++){if(status_val==_this.checkIndexInfo[j].status){rcount++}}}return rcount},setTableheaderByTree:function(nodes){var maxLevel=this.tableHeaderArray.length;var result=new Array(maxLevel);var newHeaderArray=new Array(maxLevel);for(var i=0;i<maxLevel;i++){result[i]=new Array;newHeaderArray[i]=new Array}this.recursiveTreeToTable(nodes,0,result);for(var i=0;i<result.length;i++){for(var j=0;j<result[i].length;j++){var rownum=parseInt(result[i][j].xmlRow);var colnum=parseInt(result[i][j].xmlCol);var lastHeadNum=result[i][j].lastHeadNum;newHeaderArray[i][j]=this.tableHeaderArray[rownum][colnum];newHeaderArray[i][j].setAttribute("text",result[i][j].text);newHeaderArray[i][j].setAttribute("layout-width",result[i][j].width);newHeaderArray[i][j].setAttribute("visible",result[i][j].visible);newHeaderArray[i][j].setAttribute("colspan",result[i][j].colspan);newHeaderArray[i][j].setAttribute("rowspan",result[i][j].rowspan);newHeaderArray[i][j].setAttribute("originColspan",result[i][j].originColspan);newHeaderArray[i][j].setAttribute("body-mapping-index",result[i][j]["body-mapping-index"]);if(lastHeadNum!=undefined&&result[i][j].visible!=null&&!isNaN(lastHeadNum)&&this.rowItemArray.length>0){this.rowItemArray[lastHeadNum].setAttribute("visible",result[i][j].visible)}}}this.tableHeaderArray=newHeaderArray.slice(0);this.headerInfoArray=null;this.headerChangeByTree=true},openDialogEditingHeader:function(fn){if(this.checkable||this.indexable){return}var _this=this;var tree_option={node:{checkable:true,editable:false,draggable:true},view:{expand:true},event:{onNodedrop:function(event,treeview,node,target){if(node.parent==null&&target==null){return true}if(target!=null&&node.parent==target.index){return true}console.log("target is not same parent");return false}}};Top.App.openDialog({id:_this.id+"_dialog",title:_this.id+"_dialog",class:"openDialog","layout-width":"70%",content:'<top-linearlayout id="tableHeaderDialogMain" layout-width="100%" layout-height="100%">'+'<top-linearlayout class="openDialogTreeWrapper"><top-treeview id="'+_this.id+'_tableHeaderTree" child-check="false" class="tableHeaderTree"></top-treeview></top-linearlayout>'+'<top-linearlayout class="openDialogBtnWrapper"><top-button id="tableHeaderSaveBtn"></top-button></top-linearlayout>'+"</top-linearlayout>",className:"popup_01",onOpen:function(event,widget){
var treeView=Top.Dom.selectById(_this.id+"_tableHeaderTree");var nodes=_this.getTableHeaderInfoByTree();var indexableIndex=0;var visibleNoneArray=[];var screenHeight=top$(window).height();top$(".openDialog").css("max-height",screenHeight-100);top$(".openDialog .top-dialog-content").css("max-height",screenHeight-143);top$("div#tableHeaderDialogMain").css("max-height",screenHeight-200);treeView.setProperties({nodes:nodes,option:tree_option});top$("#incapable_header.top-treeview-item").parent().css("display","none");if(_this.checkable){top$("#tableHeaderDialogMain ul.top-treeview-container").children()[0].style.display="none";indexableIndex++}if(_this.indexable){top$("#tableHeaderDialogMain ul.top-treeview-container").children()[indexableIndex].style.display="none"}var saveBtn=Top.Dom.selectById("tableHeaderSaveBtn");saveBtn.setProperties({id:"tableHeaderSaveBtn",text:"save header",onClick:function(){var newNodes=Top.Dom.selectById(_this.id+"_tableHeaderTree").getNodes();newNodes=reviseCheckedNode(newNodes);_this.__changedColumns=newNodes;Top.Dom.selectById(_this.id+"_dialog").close();if(_this.storeColumn){var name=_this.storeKey||_this.id;_this.setLocalStorage(name,newNodes)}_this.__reRender();if(fn)fn()}})}});var recursiveReviseCheckedNode=function(node){if(node.children.length==0){node.colspan=node.countColspan=node.checked==true?1:0;node.visible=node.checked==true?"visible":"none";return node}node.colspan=node.countColspan=0;for(var i=0;i<node.children.length;i++){var childNode=recursiveReviseCheckedNode(node.children[i]);node.children[i]=childNode;node.countColspan+=childNode.countColspan;node.colspan+=childNode.colspan;node.visible=node.countColspan>0?"visible":"none";node.checked=node.countColspan>0?true:false}return node};var reviseCheckedNode=function(nodes){var newNodes=[];for(var i=0;i<nodes.length;i++){var node=recursiveReviseCheckedNode(nodes[i]);newNodes.push(node)}return newNodes}},disableCheck:function(index,disabled){if(!this.checkable)return;if(this.disabledCheckAll===true)return;var checkbox=Top.Dom.__selectImpl(this.checkboxes[index-this.startRowNum]);if(checkbox){checkbox.setDisabled(disabled);this.checkCallback()}disabled=Top.Util.__isBooleanTrue(disabled);this.checkIndexInfo[index].checkDisabled=disabled;var headbool=false;if(disabled){headbool=true}else{for(var i=0;i<this.checkIndexInfo.length;i++){if(this.checkIndexInfo[i].checkDisabled==true){headbool=true;break}}}this.setcheckColumn({disabled:headbool})},disableCheckAll:function(disabled){if(!this.checkable)return;this.disabledCheckAll=!this.disabledCheckAll;this.setcheckColumn({disabled:disabled});for(var i=this.startRowNum;i<this.checkboxes.length+this.startRowNum;i++){var checkbox=Top.Dom.__selectImpl(this.checkboxes[i-this.startRowNum]);if(checkbox){checkbox.setDisabled(disabled)}}this.checkCallback();for(var i=0;i<this.checkIndexInfo.length;i++){this.checkIndexInfo[i].checkDisabled=disabled}},__getLastHeadNum:function(index){for(var i=0;i<this.lastHeader.length;i++){if(this.lastHeader[i]["lastHeadNum"]==index){return i}}return null},headAddClass:function(indexList,className){var _this=this;if(indexList instanceof Array){}else{indexList=[indexList]}for(var i=0;i<indexList.length;i++){var curIndex=_this.lastHeader[_this.__getLastHeadNum(indexList[i])];var row=curIndex["xmlRow"];var col=curIndex["xmlCol"];var curXml=_this.tableHeaderArray[row][col];var curDom=_this.querySelector("#"+curIndex["id"]);curXml.classList.add(className);curDom.classList.add(className);curIndex.class+=" "+className}},headRemoveClass:function(indexList,className){var _this=this;if(indexList instanceof Array){}else{indexList=[indexList]}for(var i=0;i<indexList.length;i++){var curIndex=_this.lastHeader[_this.__getLastHeadNum(indexList[i])];var row=curIndex["xmlRow"];var col=curIndex["xmlCol"];var curXml=_this.tableHeaderArray[row][col];var curDom=_this.querySelector("#"+curIndex["id"]);curXml.classList.remove(className);curDom.classList.remove(className);curIndex["class"]=curIndex["class"].replace(className,"")}},setcheckColumn:function(object){var _this=this;var prop=Object.keys(object);for(var i=0;i<prop.length;i++){if(prop[i]=="single"){var bool=Top.Util.__isBooleanTrue(object[prop[i]]);_this.checkAll(false);_this.singlecheck=bool;_this.checkableHeadCheckbox.setProperties({disabled:bool})}else if(prop[i]=="checkable-head"){var bool=Top.Util.__isBooleanTrue(object[prop[i]]);_this.checkableHeadCheckbox.setProperties({visible:bool})}else if(prop[i]=="disabled"){var bool=Top.Util.__isBooleanTrue(object[prop[i]]);_this.checkableHeadCheckbox.setProperties({disabled:bool})}}},__initHeaderSortState:function(){var headers=this.getElementsByClassName("head-cell");if(typeof this.sortStates==="object"){var indexes=Object.keys(this.sortStates);for(var i=0,len=indexes.length;i<len;i++){var header=headers[parseInt(indexes[i])+this.__getColumnIndexByLabel()];var state=this.sortStates[indexes[i]];this.__setHeaderSortState(header,state)}}},changeSortState:function(colIndex,state){if(!Number.isInteger(colIndex)&&typeof colIndex==="string"){var headers=this.getElementsByClassName("head-cell");for(var i=0,len=headers.length;i<len;i++){if(headers[i].getAttribute("value")===colIndex){colIndex=Number(headers[i].getAttribute("actualdx"));break}}}if(!Number.isInteger(colIndex))return;var header=this.getElementsByClassName("head-cell")[parseInt(colIndex)+this.__getColumnIndexByLabel()];if(this.sortStates===undefined)this.sortStates=new Object;this.sortStates[colIndex]=state;this.__setHeaderSortState(header,state)},resetSortState:function(){var headers=this.getElementsByClassName("head-cell");for(var i=0,len=headers.length;i<len;i++){if(headers[i].classList.contains("sorting_disable")){continue}if(headers[i].classList.contains("sorting_asc")||headers[i].classList.contains("sorting_desc")){var header=headers[parseInt(i)+this.__getColumnIndexByLabel()];this.__setHeaderSortState(header,"initial");if(this.sortStates!==undefined)this.sortStates=new Object}}},__setHeaderSortState:function(header,state){if(state==="asc"){header.classList.remove("sorting");header.classList.remove("sorting_desc");header.classList.add("sorting_asc")}else if(state==="desc"){header.classList.remove("sorting");header.classList.remove("sorting_asc");header.classList.add("sorting_desc")}else if(state==="initial"){header.classList.remove("sorting_asc");header.classList.remove("sorting_desc");header.classList.add("sorting")}},getFieldNames:function(){var fieldNames={};for(var i=0,len=this.rowItemArray.length;i<len;i++){var name=this.rowItemArray[i].getAttribute("value")||this.rowItemArray[i].getAttribute("text");if(name){name=name.replace("{","").replace("}","");fieldNames[name]=this.tHeadsColspanOne[i].getAttribute("value")||this.tHeadsColspanOne[i].getAttribute("text")}}return fieldNames},getColumnInfo:function(column_index){var colinfo=[];var colobj;if(column_index!=undefined){colobj={};var value=this.rowItemArray[column_index].getAttribute("value");if(value){colobj["value-field"]=value.replace("{","").replace("}","")}var text=this.rowItemArray[column_index].getAttribute("text");if(text){colobj["data-field"]=text.replace("{","").replace("}","")}colobj["class"]=this.rowItemArray[column_index].getAttribute("class");colobj["id"]=this.rowItemArray[column_index].getAttribute("id");colobj["header_info"]=this.lastHeader[column_index];colobj["inner_info"]=this.rowItemArray[column_index].children;colinfo.push(colobj);return colinfo}for(var i=0,len=this.rowItemArray.length;i<len;i++){colobj={};var value=this.rowItemArray[i].getAttribute("value");if(value){colobj["value-field"]=value.replace("{","").replace("}","")}var text=this.rowItemArray[i].getAttribute("text");if(text){colobj["data-field"]=text.replace("{","").replace("}","")}colobj["class"]=this.rowItemArray[i].getAttribute("class");colobj["id"]=this.rowItemArray[i].getAttribute("id");colobj["header_info"]=this.lastHeader[i];colobj["inner_info"]=this.rowItemArray[i].children;colinfo.push(colobj)}return colinfo},setScrollToIndex:function(rowIndex){var _this=this;_this.startRowNum=rowIndex;_this.onScroll();_this.scrollbar_height()},__updateCurrentPage:function(){var pager=this.childRoot.querySelector("top-pagination");if(!pager)return;this.setPageInfo({page:this.currentPage});pager.setAttribute("page",this.currentPage);pager.page=this.currentPage;if(this.pagerType==="input"){pager.renderInput()}else{pager.renderBasic()}},__updateDataLength:function(){this.setDataLength(this.dataLength)},__updatePaginate:function(){if(!this.paginate){this.pageLength=-1}this.__reRender()},__updatePageLength:function(){this.virtualmakePage()},__updatePagerLocation:function(){if(this.paginate){this.__reRender()}},__updatePagerType:function(){if(this.paginate){this.virtualmakePage()}},__updatePagerMaxVisible:function(){if(this.paginate){this.virtualmakePage()}}};Top.Widget.Container.Tableview=function(){Tableview.prototype=Object.create(Top.Widget.Container.prototype);Tableview.prototype.constructor=Tableview;function Tableview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-tableview");this.template.innerHTML='<div class="top-tableview"></div>'}this.id=this.template.id}Tableview.create=function(element){return new Tableview(element)};Tableview.prototype.sync=function(){this.template.sync()};Tableview.prototype.update=function(){if(this.template.dataModel){var dataName=Top.Util.getDataName(this.template.dataModel.items,this.template);var dataModel=Top.Util.namespace(dataName,this.template);var path=this.template.dataModel.items.replace(dataName+".","");path=path.split("+")[0];if(dataModel){var data=dataModel.getValue(path);this.template.items=data}}this.template.resetSortState();this.template.__updateItems()};Tableview.prototype.addRows=function(obj,index,movePage){if(!this.template.timer){this.template.virtualaddRows(obj,index,movePage)}else{var _this=this;this.template.__onRenderLayout(function(){setTimeout(function(){_this.template.virtualaddRows(obj,index,movePage)})})}};Tableview.prototype.sort=function(key){if(!Array.isArray(key)){key=[key]}this.template.virtualsort(key)};Tableview.prototype.changeSortState=function(columnIndex,sortState){this.template.changeSortState(columnIndex,sortState)};Tableview.prototype.resetSortState=function(){this.template.resetSortState()};Tableview.prototype.virtualfilter=function(word,columnName,flag){this.template.virtualfilter(word,columnName,flag)};Tableview.prototype.removeRows=function(index,movePage,flagonly){if(!this.template.timer){this.template.virtualremoveRows(index,movePage,flagonly)}else{var _this=this;this.template.__onRenderLayout(function(){setTimeout(function(){_this.template.virtualremoveRows(index,movePage,flagonly)})})}};Tableview.prototype.removeAllRows=function(){var indexes=[];var len=this.getPageInfo().items;for(var i=0;i<len;i++){indexes[i]=i}this.removeRows(indexes)};Tableview.prototype.getSelectedIndex=function(){return this.template.getSelectedIndex()};Tableview.prototype.getSelectedData=function(){return this.template.getSelectedData()};Tableview.prototype.getRowStatus=function(){return this.template.checkIndexInfo};Tableview.prototype.getCheckedIndex=function(){if(!this.template.timer){return this.template.getCheckedIndex()}else{var _this=this;this.template.__onRenderLayout(function(){return _this.template.getCheckedIndex()})}};Tableview.prototype.getCheckedData=function(){if(!this.template.timer){return this.template.getCheckedData()}else{var _this=this;this.template.__onRenderLayout(function(){return _this.template.getCheckedData()})}};Tableview.prototype.getClickedIndex=function(){return this.template.getClickedIndex()};Tableview.prototype.getClickedData=function(){return this.template.getClickedData()};Tableview.prototype.goToPage=function(page){var _this=this;if(!this.template.timer){this.template.virtualgoToPage(page-1)}else{var _this=this;this.template.__onRenderLayout(function(){_this.template.virtualgoToPage(page-1)})}};Tableview.prototype.adjustColumns=function(){this.template._colwidthsync();this.template._adjustcolumn();this.template.resizer_reposition()};Tableview.prototype.swap=function(index1,index2){this.template.swap(index1,index2)};Tableview.prototype.check=function(index,checked){this.template.check(index,checked)};Tableview.prototype.checkAll=function(checked,paginate){if(!this.template.timer){this.template.checkAll(checked,paginate)}else{var _this=this;this.template.__onRenderLayout(function(){_this.template.checkAll(checked,paginate)})}};Tableview.prototype.setOnCheck=function(func){this.template.setOnCheck(func)};Tableview.prototype.getstatusdata=function(status){return this.template.getstatusdata(status)};Tableview.prototype.getHeaderChecked=function(){return Top.Dom.__selectImpl(this.template.querySelector(".checkable-head")).getProperties("checked")};Tableview.prototype.selectCells=function(row,column){this.template.selectCells(row,column)};Tableview.prototype.Cells=function(row,column){return this.template.Cells(row,column)};Tableview.prototype.selectData=function(index){if(!this.template.timer){this.template.selectData(index)}else{var _this=this;this.template.__onRenderLayout(function(){setTimeout(function(){_this.selectData(index)})})}};Tableview.prototype.deselectData=function(index){this.template.deselectData(index)};Tableview.prototype.getPageInfo=function(){return this.template.getPageInfo()};Tableview.prototype.filterColumns=function(columnObj){this.template.filterColumns(columnObj)};Tableview.prototype.src=function(htmlFile){this.template.src(htmlFile)};Tableview.prototype.html=function(htmlString){this.template.html(htmlString)};Tableview.prototype.setColumnsVisible=function(columnIndex,visible){var _this=this;if(visible==false||visible=="false"||visible=="none"){visible="none"}else{visible="visible"}if(columnIndex instanceof Array){}else{columnIndex=[columnIndex]}if(!_this.template.Columns_info){_this.template.Columns_info=[]}var cinfo=_this.template.Columns_info;var flag=true;for(var k=0;k<columnIndex.length;k++){for(var i=0;i<cinfo.length;i++){if(cinfo[i].index==columnIndex[k]){cinfo[i].visible=visible;flag=false;break}}if(flag){cinfo.push({index:columnIndex[k],visible:visible})}flag=true}if(this.template.timer){}else{_this.template.__reRender()}if(_this.template.storeColumn){_this.template.__storeCookieHeaderInfo()}};Tableview.prototype.__setTableHeaderStyle=function(obj){var tableHeaderElem=this.template.querySelector(".top-tableview .head-row");if(tableHeaderElem){for(var key in obj){if(key==="layoutHeight"&&!isNaN(parseFloat(obj[key]))){tableHeaderElem.style.height=obj[key]+"px"}}}};Tableview.prototype.__setHaderColumnStyle=function(obj){var id=obj["id"];for(var key in obj){var tableHeader=this.template.tableHeaderArray;for(var i=0;i<tableHeader.length;i++){for(var j=0;j<tableHeader[i].length;j++){if(tableheader[i][j].id===id){var value=isNaN(obj[key])?obj[key]:obj[key]+"px";tableheader[i][j].setAttribute(Top.Util.toDash(key),value)}}}}this.template.renderIDETableByItems()};Tableview.prototype.render=function(){this.template.__reRender()};Tableview.prototype.setRowLayout=function(rowIndex,layout){if(!this.template.timer){this.__setRowLayout(rowIndex,layout)}else{var _this=this;this.template.__onRenderLayout(function(){setTimeout(function(){_this.__setRowLayout(rowIndex,layout)})})}};Tableview.prototype.__setRowLayout=function(rowIndex,layout){this.template.setRowLayout(rowIndex,layout)};Tableview.prototype.setCellLayout=function(rowIndex,columnIndex,layout){this.template.setCellLayout(rowIndex,columnIndex,layout)};Tableview.prototype.complete=function(option){this.template.complete(option)};Tableview.prototype.setDataLength=function(dataLength){this.template.setDataLength(dataLength)};Tableview.prototype.setDragSelection=function(bool){this.template.setDragSelection(bool)};Tableview.prototype.getHeaders=function(){return this.template.getHeaders()};Tableview.prototype.onRender=function(fn){if(!this.template.timer){fn()}else{this.template.__onRenderLayout(function(){fn()})}};Tableview.prototype.getTableHeaderInfo=function(){return this.template.getTableHeaderInfo()};Tableview.prototype.setTableHeaderInfo=function(value){this.template.setTableHeaderInfo(value)};Tableview.prototype.getLastHeaderInfo=function(){return this.template.lastHeader};Tableview.prototype.openDialogEditingHeader=function(fn){this.template.openDialogEditingHeader(fn)};Tableview.prototype.setTableheaderByTree=function(nodes){this.template.setTableheaderByTree(nodes)};Tableview.prototype.getCellValue=function(Row,Col){return this.template.getCellValue(Row,Col)};Tableview.prototype.setCellValue=function(Row,Col,Value){this.template.setCellValue(Row,Col,Value)};Tableview.prototype.RowCount=function(status){return this.template.RowCount(status)};Tableview.prototype.getRowValue=function(Row){return this.template.getRowValue(Row)};Tableview.prototype.setRowValue=function(Row,Value){this.template.setRowValue(Row,Value)};Tableview.prototype.getStartRowNum=function(){return this.template.startRowNum};Tableview.prototype.setScrollToIndex=function(index){this.template.setScrollToIndex(index)};Tableview.prototype.disableCheck=function(index,disabled){this.template.disableCheck(index,disabled)};Tableview.prototype.disableCheckAll=function(disabled){this.template.disableCheckAll(disabled)};Tableview.prototype.headAddClass=function(indexList,className){this.template.headAddClass(indexList,className)};Tableview.prototype.setcheckColumn=function(object){this.template.setcheckColumn(object)};Tableview.prototype.headRemoveClass=function(indexList,className){this.template.headRemoveClass(indexList,className)};Tableview.prototype.reset=function(){this.template.reset()};Tableview.prototype.setDummyRowToBody=function(){};Tableview.prototype.getFieldNames=function(){return this.template.getFieldNames()};Tableview.prototype.getColumnInfo=function(column_index){return this.template.getColumnInfo(column_index)};Tableview.prototype.changeNodeIndex=function(index,operation,count){if(Number(operation)){operation=parseInt(operation)-1}return this.template.changeNodeIndex(index,operation,count)};Tableview.prototype.changeNodelevel=function(index,operation,count){return this.template.changeNodelevel(index,operation,count)};Tableview.prototype.addNode=function(obj,index,movePage,make_RootNode){return this.template.addNode(obj,index,movePage,make_RootNode)};Tableview.prototype.removeNode=function(index,movePage,cascade){return this.template.removeNode(index,movePage,cascade)};Tableview.prototype.isLeafNode=function(index){return this.template.isLeafNode(index)};Tableview.prototype.openAllNode=function(bool){return this.template.openAllNode(bool)};Tableview.prototype.getNodeParentIndex=function(index){return this.template.getNodeParentIndex(index)};Tableview.prototype.getNodefamilyIndex=function(index){return this.template.getNodefamilyIndex(index)};Tableview.prototype.getNodefamily=function(index){return this.template.getNodefamily(index)};Top.Widget.prototype.setCellValue=function(index,column,data){var _this=this.template.roottable;if(this.template.edited!=null){var index=this.template.edited["index"];var column=this.template.edited["column"]}if(index==undefined){var widx=parseInt(this.template.getAttribute("row"))+_this.startRowNum;var index=_this.checkIndexpointer[widx]["linkidx"]}if(column==undefined){var column=this.template.getAttribute("col")}if(data==undefined){var bounds=this.template.boundProperties;var fields=this.template.fieldProperties;for(var i=0,len=bounds.length;i<len;i++){var data="";var field="";data=this.getProperties(bounds[i]);field=fields[i];_this.backupdata[index][field]=data}if(_this.checkIndexInfo[index]["status"]=="R"){_this.checkIndexInfo[index]["status"]="U"}_this.onScroll();return}_this.setCellValue(index,column,data)};Top.Widget.prototype.getDataIndex=function(){var _this=this.template.roottable;return parseInt(this.template.getAttribute("row"))+_this.startRowNum};Top.Widget.prototype.getViewIndex=function(){var _this=this.template.roottable;return parseInt(this.template.getAttribute("row"))};HTMLTableCellElement.prototype.addClass=function(clsNAME){top$(this).addClass(clsNAME)};HTMLTableCellElement.prototype.getClass=function(){return this.getAttribute("class")};HTMLTableCellElement.prototype.removeClass=function(clsNAME){top$(this).removeClass(clsNAME)};HTMLTableCellElement.prototype.setStyle=function(style){this.setAttribute("style",style)};HTMLTableCellElement.prototype.getStyle=function(){return this.getAttribute("style")};HTMLTableRowElement.prototype.addClass=function(clsNAME){top$(this).addClass(clsNAME)};HTMLTableRowElement.prototype.getClass=function(){return this.getAttribute("class")};HTMLTableRowElement.prototype.removeClass=function(clsNAME){top$(this).removeClass(clsNAME)};HTMLTableRowElement.prototype.setStyle=function(style){this.setAttribute("style",style)};HTMLTableRowElement.prototype.getStyle=function(){return this.getAttribute("style")};return Tableview}();TopTextarea={is:"top-textarea",behaviors:[TopWidgetBehavior,TopTextBehavior,TopMaskBehavior],properties:{hint:String,rows:{type:String,value:"5"},cols:{type:String,value:"100"},maxLength:Number,maxBytes:Number,readonly:String,highlight:String,highlightConfig:String,tabIndex:{type:String,value:"0"},autosize:String,imeMode:String},__ready:function(){this.__updateId();this.__updateAutoComplete();this.__updateDisabled();this.__updateMaxLength();this.__updateMaxBytes();this.__updateReadonly();this.__updateHighlight();this.__updateTextSize();this.__controlTabKey();this.__initBindingEvent();this.__updateRows();this.__updateCols();this.__updateHint();this.__updateName();this.__updateText();this.__updateTabIndex();this.__updateAutosize();this.__updateImeMode()},appendTemplate:function(){this.innerHTML='<textarea class="top-textarea-root" spellcheck="false"></textarea>'},shadowText:function(){return this.querySelector("textarea")},__eventBindingList:function(){var shadowTextarea=this.querySelector("textarea");return{__eventMouseClick:function(func){shadowTextarea.onclick=func},__eventMousePressed:function(func){shadowTextarea.onmousedown=func},__eventMouseReleased:function(func){shadowTextarea.onmouseup=func},__eventMouseDblclick:function(func){shadowTextarea.ondblclick=func},__eventKeyPressed:function(func){shadowTextarea.onkeydown=func},__eventKeyTyped:function(func){shadowTextarea.onkeypress=func},__eventKeyReleased:function(func){shadowTextarea.onkeyup=func},__eventMouseEnter:function(func){shadowTextarea.onmouseenter=func},__eventMouseExit:function(func){shadowTextarea.onmouseleave=func},__eventMouseMove:function(func){shadowTextarea.onmousemove=func},__eventSecondaryClick:function(func){shadowTextarea.oncontextmenu=func},__eventFocused:function(func){shadowTextarea.onfocus=func},__eventLostFocused:function(func){shadowTextarea.onblur=func}}},__updateId:function(){if(this.id){var shadowInput=this.querySelector("textarea");shadowInput.id=this.id}},__controlTabKey:function(){var textarea=this.querySelector("textarea");top$(textarea).keydown(function(e){if(e.keyCode===9){if(this.value.length<this.maxLength){var start=this.selectionStart;var end=this.selectionEnd;var $this=top$(this);var value=$this.val();$this.val(value.substring(0,start)+"\t"+value.substring(end));$this.val().length;this.selectionStart=this.selectionEnd=start+1;e.preventDefault()}}})},__initBindingEvent:function(){var _this=this;var textarea=this.querySelector("textarea");this.__addEventFnByCore("eventKeyReleased",function(){_this.text=textarea.value;_this.setAttribute("text",textarea.value);_this.updateData("text");_this.updateDevice("text")});this.__addEventFnByCore("eventLostFocused",function(){_this.text=textarea.value;_this.setAttribute("text",textarea.value);_this.updateData("text");_this.updateDevice("text")})},__updateDisabled:function(){var shadowInput=this.querySelector("textarea");this.__setDisabled(shadowInput)},__updateMaxLength:function(){if(this.maxLength!=null){var textarea=this.querySelector("textarea");textarea.setAttribute("maxlength",this.maxLength)}},__updateMaxBytes:function(){if(this.maxBytes===undefined){return}var _this=this;this.__removeEventListener("keyup",__onKeyup);this.__addEventListener("keyup",__onKeyup);this.__removeEventListener("blur",__onKeyup);this.__addEventListener("blur",__onKeyup);function __onKeyup(){var utf8Str=_this.__getUTF8StrWithMaxBytes(this.value,_this.maxBytes);if(this.value!==utf8Str)this.value=utf8Str;_this.text=this.value}function __getUTF8StrWithMaxBytes(str,maxBytes){var utf8Length=0;var utf8String="";for(var i=0,len=str.length;i<len;i++){var c=str.charCodeAt(i);if(c<128){utf8Length++}else if(c>127&&c<2048){utf8Length+=2}else{utf8Length+=3}if(utf8Length>maxBytes){break}}utf8String=str.substring(0,i);return utf8String}},__updateReadonly:function(){var textarea=this.querySelector("textarea");if(this.readonly=="true"||this.readonly==true){textarea.setAttribute("readonly","")}else{textarea.removeAttribute("readonly")}},__updateHighlight:function(){if(this.highlight=="true"||this.highlight==true){this.__initHighlight()}else{this.__destroyHighlight()}},__initHighlight:function(){this.__updateHighlightConfig()},__updateHighlightConfig:function(){var textarea=this.querySelector("textarea");if(typeof this.highlightConfig=="string"){this.highlightConfigData=Top.Util.namespace(this.highlightConfig,this)}else if(typeof this.highlightConfig=="object"||typeof this.highlightConfig=="function"){this.highlightConfigData=this.highlightConfig}else{return}top$(textarea).highlightWithinTextarea({highlight:this.highlightConfigData});this.__styleHighlight()},__styleHighlight:function(){this.__addHighlightClass();this.__adjustHighlightWidth();this.__adjustHighlightHeight();this.__adjustHighlightPadding();this.__adjustHighlightMargin();this.__adjustHighlightTextSize();this.__updateBackgroundColor()},__addHighlightClass:function(){var hwtH=this.querySelector(".hwt-highlights");var hwtB=this.querySelector(".hwt-background");if(hwtH){hwtH.classList.add("top-textarea-root")}if(hwtB){hwtB.classList.add("top-textarea-root")}},__adjustHighlightWidth:function(){var borderRightWidth=this.borderRightWidth||0;var borderLeftWidth=this.borderLeftWidth||0;var layoutWidth=this.layoutWidth;var hwtInput=this.querySelector(".hwt-input");var hwt=this.querySelector(".hwt-container");if(this.layoutWidth==="match_parent"){layoutWidth="100%";hwtInput.style.width="100%"}if(this.tagName!=="TOP-CHART"&&this.layoutWidth&&this.layoutWidth.endsWith("%")){layoutWidth="calc("+this.layoutWidth+" - "+(parseInt(this.marginRight)+parseInt(this.marginLeft)+parseInt(this.paddingRight)+parseInt(this.paddingLeft)+parseInt(borderRightWidth)+parseInt(borderLeftWidth))+"px)"}if(hwt){hwt.style.width=layoutWidth}},__adjustHighlightHeight:function(){if(!this.layoutHeight){return}var layoutHeight=this.layoutHeight;var hwt=this.querySelector(".hwt-container");if(layoutHeight.indexOf("%")!==-1){if(this.parentNode&&this.parentNode.nodeName==="DIV"&&this.layoutParent&&this.layoutParent.nodeName==="TOP-LINEARLAYOUT"&&this.layoutParent.orientation==="vertical"){this.parentNode.style.height=this.layoutHeight;layoutHeight="100%"}else if(this.layoutParent===undefined&&this.parentNode&&this.parentNode.nodeName==="DIV"&&this.parentNode.parentNode&&this.parentNode.parentNode.nodeName==="DIV"){var parent=this.parentNode;while(Top.Util.__isTopWidget(parent.tagName)){parent=parent.parentNode}if(parent.nodeName==="TOP-LINEARLAYOUT"&&parent.getAttribute("orientation")==="vertical"){this.parentNode.style.height=this.layoutHeight;layoutHeight="100%"}}}if(this.tagName!=="TOP-CHART"&&layoutHeight&&layoutHeight.endsWith("%")){var boxing=parseInt(this.marginTop)+parseInt(this.marginBottom)+parseInt(this.paddingTop)+parseInt(this.paddingBottom)+parseInt(this.borderTopWidth)+parseInt(this.borderBottomWidth);if(boxing>0){layoutHeight="calc("+this.layoutHeight+" - "+boxing+"px)"}}if(hwt){hwt.style.height=layoutHeight}},__adjustHighlightPadding:function(){var hwt=this.querySelectorAll(".hwt-content");if(hwt===undefined){return}for(var i=0;i<hwt.length;i++){hwt[i].style.padding=this.padding}},__adjustHighlightMargin:function(){var hwtContainer=this.querySelector(".hwt-container");var hwtInput=this.querySelector(".hwt-input");if(hwtContainer&&hwtInput){hwtContainer.style.margin=this.margin;this.marginBackup=this.margin;hwtInput.style.margin=""}},__adjustHighlightTextSize:function(){var hwtH=this.querySelector(".hwt-highlights");var hwtB=this.querySelector(".hwt-background");if(hwtH){hwtH.style.fontSize=this.textSize}if(hwtB){hwtB.style.fontSize=this.textSize}},__updateBackgroundColor:function(){var hwtContainer=this.querySelector(".hwt-container");if(hwtContainer&&(this.highlight=="true"||this.highlight==true)){hwtContainer.style.backgroundColor=this.backgroundColor}},__destroyHighlight:function(){var hwt=this.querySelector(".hwt-container");var textarea=this.querySelector("textarea");if(hwt){top$(textarea).highlightWithinTextarea("destroy");textarea.classList.remove("hwt-content");textarea.style.margin=this.marginBackup||this.margin}},__updateTextSize:function(){var textarea=this.querySelector("textarea");textarea.style.fontSize=this.textSize;if(this.highlight=="true"||this.highlight==true){this.__adjustHighlightTextSize()}},__updateText:function(){if(this.text||this.text===false||this.text===""||this.text===0){var shadowInput=this.querySelector("textarea");if(shadowInput)shadowInput.value=this.__i18n(this.text);if(this.highlight=="true"||this.highlight==true){top$(shadowInput).highlightWithinTextarea("update")}if(this.autosize=="true"||this.autosize==true){this.__updateAutosize()}}},__updateRows:function(){if(this.rows!==undefined&&this.rows!==null){var shadowInput=this.querySelector("textarea");shadowInput.setAttribute("rows",this.rows)}},__updateCols:function(){if(this.cols!==undefined&&this.cols!==null){var shadowInput=this.querySelector("textarea");shadowInput.setAttribute("cols",this.cols)}},__updateHint:function(){if(this.hint){var shadowInput=this.querySelector("textarea");shadowInput.setAttribute("placeholder",this.__i18n(this.hint))}},__updateName:function(){if(this.name){var shadowInput=this.querySelector("textarea");shadowInput.setAttribute("name",this.name)}},__updateTabIndex:function(){if(this.tabIndex){var shadowInput=this.querySelector("textarea");shadowInput.setAttribute("tabindex",this.tabIndex)}},__updateImeMode:function(){var shadowInput=this.querySelector("textarea");shadowInput.style.imeMode=this.imeMode?this.imeMode:""},__updateAutosize:function(){var textarea=this.querySelector("textarea");var _this=this;if(this.autosize=="true"||this.autosize==true){if(!this.text){this.rows=1;this.__updateRows()}else{__setAutosize()}top$(this).keydown(__setAutosize);top$(this).keyup(__setAutosize)}else{__removeAutosize()}function __setAutosize(){textarea.style.height="1px";textarea.style.height=textarea.scrollHeight+3+"px"}function __removeAutosize(){top$(_this).unbind("keydown",__setAutosize);top$(_this).unbind("keyup",__setAutosize);textarea.style.removeProperty("height");_this.rows=5;_this.__updateRows()}},setError:function(){var shadowInput=this.querySelector("textarea");if(this.prevBorderColor===undefined){this.prevBorderColor=shadowInput.style.borderColor}if(this.prevColor===undefined){this.prevColor=shadowInput.style.color}shadowInput.style.borderColor="#e25750";shadowInput.style.color="#e31b23";if(!top$(this).hasClass("error"))top$(this).addClass("error")},removeError:function(){var shadowInput=this.querySelector("textarea");shadowInput.style.borderColor=this.prevBorderColor;shadowInput.style.color=this.prevColor;top$(this).removeClass("error")},focus:function(){this.querySelector(".top-textarea-root").focus()},blur:function(){this.querySelector(".top-textarea-root").blur()},getTopStyle:function(){this.topstyle=this.querySelector(".top-textarea-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(!value){
return}this.querySelector(".top-textarea-root").style[key]=value;this.topstyle=this.querySelector(".top-textarea-root").style.cssText},setAllTopStyle:function(){this.querySelector(".top-textarea-root").style.cssText=this.topstyle}};Top.Widget.Textarea=function(){Textarea.prototype=Object.create(Top.Widget.prototype);Textarea.prototype.constructor=Textarea;function Textarea(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-textarea");this.template.innerHTML='<textarea class="top-textarea-root" spellcheck="false"></textarea>'}this.id=this.template.id}Textarea.create=function(element){return new Textarea(element)};Textarea.prototype.openAutoComplete=function(){this.template.openAutoComplete()};Textarea.prototype.closeAutoComplete=function(){this.template.closeAutoComplete()};Textarea.prototype.getUnmaskedText=function(){return this.template.getUnmaskedText()};Textarea.prototype.getSelectionStart=function(){return this.template.querySelector(".top-textarea-root").selectionStart};Textarea.prototype.getSelectionEnd=function(){return this.template.querySelector(".top-textarea-root").selectionEnd};Textarea.prototype.setSelectionStart=function(value){this.template.querySelector(".top-textarea-root").selectionStart=value};Textarea.prototype.setSelectionEnd=function(value){this.template.querySelector(".top-textarea-root").selectionEnd=value};Textarea.prototype.scrollToBottom=function(){var textarea=this.template.querySelector(".top-textarea-root");textarea.scrollTop=textarea.scrollHeight};return Textarea}();TopTextfield={is:"top-textfield",behaviors:[TopWidgetBehavior,TopTextBehavior,TopMaskBehavior],properties:{password:String,hint:String,title:String,visible:String,maxLength:Number,readonly:String,icon:String,iconBackUp:String,iconPosition:{type:String,value:"right"},onIconclick:String,clear:String,required:String,backgroundColor:String,tabIndex:{type:String,value:"0"},imeMode:String,onClear:String,titleWidth:String},created:function(){this.__initBindingEvent()},__ready:function(){this.__updateId();this.__updatePassword();this.__updateAutoComplete();this.__updateBackgroundColor();this.__updateDisabled();this.__updateMaxLength();this.__updateVisible();this.__updateIcon();this.__updateClear();this.__updateReadonly();this.__initialClassname();this.__initI18n("hint");this.__initI18n("text");this.__initI18n("title");this.__updateText();this.__updateTitle();this.__updateHint();this.__updateName();this.__updateRequired();this.__updateHorizontalAlignment();this.__updateVerticalAlignment();this.__updateTabIndex();this.__updateImeMode();this.__updateTitleWidth()},appendTemplate:function(){this.innerHTML='<div class="top-textfield-root"><form autocomplete="off" onsubmit="return false;"><input class="top-textfield-text" type="text"><span class="top-textfield-icon" style="display:none;"></span></form></div>'},__attached2:function(){this.setTitlePosition();this.setIconPosition();this.setClearPosition();if(this.classList.contains("error")){this.setError()}},shadowText:function(){return this.querySelector("input")},__eventBindingList:function(){var input=this.querySelector("input");var div=this.querySelector("div");return{__eventLostFocused:function(func){input.onblur=func},__eventMouseClick:function(func){div.onclick=func},__eventMouseEnter:function(func){div.onmouseenter=func},__eventMouseExit:function(func){div.onmouseleave=func},__eventMouseMove:function(func){div.onmousemove=func},__eventMousePressed:function(func){div.onmousedown=func},__eventMouseReleased:function(func){div.onmouseup=func},__eventMouseDblclick:function(func){div.ondblclick=func},__eventKeyTyped:function(func){input.onkeypress=func},__eventKeyReleased:function(func){input.onkeyup=func},__eventFocused:function(func){input.onfocus=func},__eventSecondaryClick:function(func){input.oncontextmenu=func}}},__initBindingEvent:function(){var _this=this;var shadowInput=this.querySelector("div input");this.__addEventFnByCore("eventKeyReleased",function(){_this.text=shadowInput.value;_this.setAttribute("text",shadowInput.value);_this.updateData("text");_this.updateDevice("text")});this.__addEventFnByCore("eventLostFocused",function(){_this.text=shadowInput.value;_this.setAttribute("text",shadowInput.value);_this.updateData("text");_this.updateDevice("text")})},__updateId:function(){if(this.id){var shadowInput=this.querySelector("input");shadowInput.id=this.id}},__updateDisabled:function(){var shadowInput=this.querySelector("div input");var shadowLabel=this.querySelector("div .top-textfield-title");this.__setDisabled(shadowInput);this.__setDisabled(shadowLabel)},__updateBackgroundColor:function(){if(this.backgroundColor){var shadowInput=this.querySelector("div input");shadowInput.style.backgroundColor=this.backgroundColor}},__updateMaxLength:function(){if(this.maxLength!=null){var shadowInput=this.querySelector("div input");shadowInput.setAttribute("maxlength",this.maxLength)}},__updatePassword:function(){var shadowInput=this.querySelector("div input");var type=this.password=="true"||this.password==true?"password":"text";shadowInput.setAttribute("type",type)},__updateReadonly:function(){var shadowInput=this.querySelector("div input");if(this.readonly=="true"||this.readonly==true){shadowInput.setAttribute("readonly","")}else{shadowInput.removeAttribute("readonly")}},__updateTitle:function(){var shadowInput=this.querySelector("div input");var shadowLabel=this.querySelector("div .top-textfield-title");this.originTitle=this.title.replace(/\n/gi,"");if(shadowLabel){if(this.originTitle===""||this.originTitle===undefined||this.originTitle===null){shadowLabel.remove();if(shadowInput){shadowInput.style.paddingLeft=""}}else{shadowLabel.innerText=this.__i18n(this.originTitle)}}else if(this.originTitle&&shadowInput){shadowInput.insertAdjacentHTML("beforebegin","<label class='top-textfield-title'>"+this.__i18n(this.originTitle)+"</label>")}this.setTitlePosition();this.setInputPosition();if(this.getAttribute("title")){this.setAttribute("title","")}},__updateVisible:function(){var checkVisibility=/visibility:[a-z]+;/g;var checkDisplay=/display:[a-z-]+;/g;var topstyle=this.topstyle;if(this.visible!=="none"){if(this.originTitle)this.setTitlePosition();this.setIconPosition()}topstyle=topstyle.replace(checkVisibility,"");topstyle=topstyle.replace(checkDisplay,"");this.topstyle=topstyle;if(this.display!=="none"){this.prevDisplay=this.display}if(this.visible=="none"){this.display="none"}else if(this.visible==="visible"&&this.display==="none"){this.display=this.prevDisplay}if(this.display==null){this.display="inline-block"}this.setTopStyle("visibility",this.visible);this.setTopStyle("display",this.display);__updateBorderWidth();function __updateBorderWidth(){if(this.borderWidth===undefined){return}var shadowInput=this.querySelector("div input");if(this.borderWidth){shadowInput.style.borderWidth=this.borderWidth}}},__updateIcon:function(){var shadowIcon=this.querySelector("div span");var shadowForm=this.querySelector("div form");if(this.icon!==null&&this.icon!==""&&this.icon!==undefined){this.__updateOnIconclick();top$(shadowIcon).removeClass(this.iconBackUp);top$(shadowIcon).addClass(this.__i18n(this.icon));this.setIconPosition()}else{top$(shadowIcon).removeClass(this.iconBackUp)}this.setInputPosition();this.iconBackUp=this.icon},__updateOnIconclick:function(){var _this=this;var shadowIcon=this.querySelector("div span");if(this.onIconclick&&typeof this.onIconclick==="string"){top$(shadowIcon).off("click").on("click",function(e){var fnIconClick=Top.Util.namespace(_this.onIconclick,_this);if(typeof fnIconClick==="function"){fnIconClick.call(_this.getController(),e,Top.Dom.selectById(_this.id))}})}if(this.onIconclick==""||this.onIconclick==false||this.onIconclick=="false"){top$(shadowIcon).off("click");top$(shadowIcon).css("cursor","")}else{top$(shadowIcon).css("cursor","pointer")}},__updateClear:function(){var _this=this;var shadowForm=this.querySelector("div form");var shadowInput=this.querySelector("div input");var clear=this.querySelector(".top-textfield-clear");if(clear)clear.remove();this.removeEventListener("keyup",isBlank);if(this.clear===true||this.clear==="true"){top$(shadowForm).append('<button class="top-textfield-clear" type="reset" tabindex="-1"></button>');var inputHeight=shadowInput.offsetHeight;var shadowClear=shadowForm.querySelector(".top-textfield-clear");top$(shadowClear).css("line-height",inputHeight+"px");top$(shadowClear).on("click",function(e){_this.text="";_this.validation();isBlank();shadowInput.setAttribute("value","");_this.setAttribute("text","");_this.updateData("text");_this.updateDevice("text");if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("clear"))}else{_this.__dispatchEvent(new Event("clear"))}});Top.App.onWidgetAttach(this.id,function(){this.addEventListener("keyup",isBlank);isBlank()})}else if(shadowForm.querySelector(".top-textfield-clear")){shadowForm.removeChild(shadowForm.querySelector(".top-textfield-clear"))}this.setInputPosition();function isBlank(){if(_this.text){if(_this.clear===true||_this.clear==="true"){shadowClear.style.display="inline-block";return true}}else{if(_this.clear===true||_this.clear==="true"){shadowClear.style.display="none";return false}}}},__updateText:function(){var shadowInput=this.querySelector("div input");this.text=this.__i18n(this.text);if(this.text!==undefined&&shadowInput){shadowInput.setAttribute("value",this.text);shadowInput.value=this.text}},__updateHint:function(){if(this.hint){var shadowInput=this.querySelector("div input");shadowInput.setAttribute("placeholder",this.hint)}},__updateName:function(){if(this.name){var shadowInput=this.querySelector("div input");shadowInput.setAttribute("name",this.name)}},__updateRequired:function(){var _this=this;var shadowInput=this.querySelector("input");var shadowIcon=this.querySelector("div .top-textfield-icon");this.removeEventListener("keyup",requiredTest);if(this.required==="true"||this.required===true){this.addEventListener("keyup",requiredTest);requiredTest()}if(shadowInput)top$(shadowIcon).css("vertical-align","baseline");function requiredTest(){_this.text?_this.removeError():_this.setError();return _this.text?true:false}},__updateHorizontalAlignment:function(){if(this.horizontalAlignment){var input=this.querySelector("div input");input.style.textAlign=this.horizontalAlignment}},__updateVerticalAlignment:function(){var input=this.querySelector("div input");var computedStyle=getComputedStyle(input);var padding=input.offsetHeight-parseFloat(computedStyle.fontSize)-parseFloat(computedStyle.paddingTop)-parseFloat(computedStyle.paddingBottom);if(!(this.layoutHeight==="wrap_content"||this.layoutHeight==="auto"||this.layoutHeight==="match_parent"||this.layoutHeight!==undefined&&this.layoutHeight!==null&&this.layoutHeight.includes("%"))){if(this.verticalAlignment==="top"){input.style.paddingBottom=padding+"px"}else if(this.verticalAlignment==="bottom"){input.style.paddingTop=padding+"px"}else{input.style.paddingTop="";input.style.paddingBottom=""}}else{input.style.paddingTop="";input.style.paddingBottom=""}},__setVerticalAlignment:function(){var input=this.querySelector("div input");var computedStyle=getComputedStyle(input);var padding=input.offsetHeight-parseFloat(computedStyle.fontSize)-parseFloat(computedStyle.paddingTop)-parseFloat(computedStyle.paddingBottom);if(this.layoutHeight==="match_parent"||this.layoutHeight!==undefined&&this.layoutHeight!==null&&this.layoutHeight.includes("%")){if(this.verticalAlignment==="top"){input.style.paddingBottom=padding+"px"}else if(this.verticalAlignment==="bottom"){input.style.paddingTop=padding+"px"}else{input.style.paddingTop="";input.style.paddingBottom=""}}},__updateTabIndex:function(){if(this.tabIndex){var shadowInput=this.querySelector("input");shadowInput.setAttribute("tabindex",this.tabIndex)}},__updateImeMode:function(){var shadowInput=this.querySelector("div input");shadowInput.style.imeMode=this.imeMode?this.imeMode:""},__updateTitleWidth:function(){var shadowLabel=this.querySelector("div .top-textfield-title");var titleWidth=this.titleWidth;if(shadowLabel&&titleWidth){shadowLabel.style.width=titleWidth}this.setTitlePosition()},__updateIconPosition:function(){this.setInputPosition()},setInputPosition:function(){var shadowInput=this.querySelector("div input");var shadowForm=this.querySelector("div form");var shadowClear=shadowForm.querySelector(".top-textfield-clear");var shadowIcon=this.querySelector("div span");var shadowRoot=this.querySelector(".top-textfield-root");var shadowLabel=this.querySelector("div .top-textfield-title");var cntLeft=0;var cntRight=0;if(this.icon!==null&&this.icon!==""&&this.icon!==undefined){if(this.iconPosition!==null&&this.iconPosition==="left"){cntLeft++;shadowIcon.classList.add("icon-left");if(shadowClear)shadowClear.classList.remove("icon-right")}else{shadowIcon.classList.remove("icon-left");cntRight++;if(shadowClear)shadowClear.classList.add("icon-right")}}if(shadowLabel)this.setTitlePosition();if(this.clear===true||this.clear==="true")cntRight++;if(this.classList.contains("error")||this.text&&!this.text.toString().match(this.pattern))cntRight++;shadowInput.classList.remove("pl-0","pl-1");shadowInput.classList.remove("pr-0","pr-1","pr-2");shadowInput.classList.add("pl-"+cntLeft);shadowInput.classList.add("pr-"+cntRight);if(shadowInput.offsetWidth!==0&&shadowInput.offsetWidth!==""&&shadowInput.offsetWidth!==undefined){top$(shadowRoot).css("width",shadowInput.offsetWidth);if(this.layoutWidth&&this.layoutWidth.includes("%")){top$(shadowRoot).css("width",this.layoutWidth)}}this.setIconPosition()},setError:function(){var shadowInput=this.querySelector("div input");var shadowIcon=this.querySelector("div span");var errorIcon=this.querySelector("div span");var inputHeight=shadowInput.offsetHeight;this.prevBorderColor=this.prevBorderColor||shadowInput.style.borderColor;this.prevColor=this.prevColor||shadowInput.style.color;shadowInput.style.borderColor="#e25750";shadowInput.style.color="#e31b23";if(!top$(this).hasClass("error"))top$(this).addClass("error");top$(errorIcon).addClass("top-textfield-alert");top$(errorIcon).css("display","inline");if(inputHeight!==0)top$(errorIcon).css("line-height",inputHeight+"px");this.setInputPosition()},removeError:function(){var errorIcon=this.querySelector("div span");var shadowInput=this.querySelector("div input");var inputHeight=shadowInput.offsetHeight;var shadowIcon=this.querySelector("div span");shadowInput.style.borderColor=this.prevBorderColor;shadowInput.style.color=this.prevColor;top$(this).removeClass("error");top$(shadowIcon).css("vertical-align","top");if(inputHeight!==0)top$(errorIcon).css("line-height",inputHeight+"px");this.setInputPosition()},setTitlePosition:function(){if(this.classList.contains("out_textfield")){return}var shadowLabel=this.querySelector("div .top-textfield-title");var shadowInput=this.querySelector("div input");var fontSize=shadowInput.style.fontSize;var inputHeight=shadowInput.offsetHeight;if(shadowLabel!=null){if(this.icon&&this.iconPosition=="left"){shadowLabel.style.paddingLeft="30px";shadowInput.style.paddingLeft=shadowLabel.clientWidth+10+"px"}else{shadowLabel.style.paddingLeft="";shadowInput.style.paddingLeft=shadowLabel.clientWidth+10+"px"}shadowLabel.style.fontSize=fontSize;shadowLabel.style.lineHeight=inputHeight-8+"px"}},setIconPosition:function(){var shadowIcon=this.querySelector("div span");if(this.icon!==null&&this.icon!==""&&this.icon!==undefined){shadowIcon.style.display="inline"}},setTimerPosition:function(){var input=this.getElementsByClassName("top-textfield-text")[0];var timer=this.getElementsByClassName("top-textfield-timer")[0];var inputHeight=input.offsetHeight;if(this.timer!==null&&this.timer!==""&&this.timer!==undefined){timer.style.lineHeight=inputHeight+"px";timer.style.display="inline"}},setClearPosition:function(){var shadowClear=this.querySelector("div .top-textfield-clear");var inputHeight=this.querySelector("div input").offsetHeight;if(this.clear!==null&&this.clear!==""&&this.clear!==undefined){top$(shadowClear).css("line-height",inputHeight+"px")}},focus:function(){this.querySelector(".top-textfield-text").focus()},blur:function(){this.querySelector(".top-textfield-text").blur()},getTopStyle:function(){this.topstyle=this.querySelector(".top-textfield-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(!value){return}var styleNode=this.querySelector(".top-textfield-root");if(key==="border-style"||key==="border-width"||key==="border-color"||key=="text-decoration"||key=="text-transform"){styleNode=this.querySelector(".top-textfield-text")}styleNode.style[key]=value;this.topstyle=styleNode.style.cssText},setAllTopStyle:function(){this.querySelector(".top-textfield-root").style.cssText=this.topstyle;var textInput=this.querySelector(".top-textfield-text");var styles=this.topstyle.split(";");if(!this.topstyle.includes("text-overflow: ellipsis"))return;for(var i=0;i<styles.length;i++){if(styles[i].includes("white-space")||styles[i].includes("text-overflow")||styles[i].includes("overflow")){textInput.style.cssText+=styles[i]+";"}}},__initTimer:function(settings){var span=this.getElementsByClassName("top-textfield-icon")[0];span.classList.remove(this.icon);span.classList.remove("top-textfield-icon");span.classList.add("top-textfield-timer");if(settings&&settings.textColor)span.style.color=settings.textColor;if(settings&&settings.textSize)span.style.fontSize=settings.textSize;this.timer=settings&&settings.timer?settings.timer:"05:00";this.__format=this.timer.replace(/[0-9]+/,"mm").replace(/[0-9]+/,"ss");this.onEndtimer=settings&&settings.onEndtimer?settings.onEndtimer:undefined;this.setTimerPosition();if(this.clear){this.clear=false;this.__updateClear()}span.innerText=this.timer},startTimer:function(){var span=this.getElementsByClassName("top-textfield-timer")[0];this.__setTimer(span)},stopTimer:function(){var span=this.getElementsByClassName("top-textfield-timer")[0];this.__stopTimer(span)},pauseTimer:function(){var span=this.getElementsByClassName("top-textfield-timer")[0];this.__pauseTimer(span)},resumeTimer:function(){var span=this.getElementsByClassName("top-textfield-timer")[0];this.__setTimer(span)},getText:function(){var shadowInput=this.querySelector("div input");if(shadowInput.inputmask){this.text=shadowInput.value;this.setAttribute("text",shadowInput.value);this.updateData("text");this.updateDevice("text")}return this.text}};Top.Widget.Textfield=function(){Textfield.prototype=Object.create(Top.Widget.prototype);Textfield.prototype.constructor=Textfield;function Textfield(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-textfield");this.template.innerHTML='<div class="top-textfield-root"><form autocomplete="off" onsubmit="return false;"><input class="top-textfield-text" type="text"><span class="top-textfield-icon" style="display:none;"></span></form></div>'}this.id=this.template.id}Textfield.create=function(element){return new Textfield(element)};Textfield.prototype.setError=function(){this.template.setError()};Textfield.prototype.removeError=function(){this.template.removeError()};Textfield.prototype.openAutoComplete=function(){this.template.openAutoComplete()};Textfield.prototype.closeAutoComplete=function(){this.template.closeAutoComplete()};Textfield.prototype.setTimer=function(settings){this.template.__initTimer(settings)};Textfield.prototype.startTimer=function(){this.template.startTimer()};Textfield.prototype.stopTimer=function(){this.template.stopTimer()};Textfield.prototype.pauseTimer=function(){this.template.pauseTimer()};Textfield.prototype.resumeTimer=function(){this.template.resumeTimer()};Textfield.prototype.getText=function(){return this.template.getText()};Textfield.prototype.getUnmaskedText=function(){return this.template.getUnmaskedText()};return Textfield}();TopTextview={is:"top-textview",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{url:String,ellipsis:{type:Boolean,value:false},multiLine:String,maxLine:String},__ready:function(){this.__updateUrl();this.__updateId();this.__updateText();this.__eventBindingList();this.__updateName();this.__updateTabIndex()},appendTemplate:function(){this.innerHTML='<span class="top-textview-root"><a class="top-textview-url"></a><div class="top-textview-aligner"></div></span>'},__eventBindingList:function(){var shadowSpan=this.querySelector("span");return{__eventMouseClick:function(func){shadowSpan.onclick=func},__eventMousePressed:function(func){shadowSpan.onmousedown=func},__eventMouseReleased:function(func){shadowSpan.onmouseup=func},__eventMouseDblclick:function(func){shadowSpan.ondblclick=func},__eventKeyPressed:function(func){shadowSpan.onkeydown=func},__eventKeyTyped:function(func){shadowSpan.onkeypress=func},__eventKeyReleased:function(func){shadowSpan.onkeyup=func},__eventMouseEnter:function(func){shadowSpan.onmouseenter=func},__eventMouseExit:function(func){shadowSpan.onmouseleave=func},__eventMouseMove:function(func){shadowSpan.onmousemove=func},__eventSecondaryClick:function(func){shadowSpan.oncontextmenu=func}}},__attached2:function(){this.__updateMultiLine();this.__updateVerticalAlignment();this.__initTooltip()},__updateId:function(){if(this.id){var shadowInput=this.querySelector("span");shadowInput.id=this.id}},__updateVerticalAlignment:function(){var aligner=this.querySelector(".top-textview-aligner");if(aligner===null)return;aligner.classList.remove("top","middle","bottom");aligner.classList.add(this.verticalAlignment)},__updateDisabled:function(){var shadowInput=this.querySelector(".top-textview-root");this.__setDisabled(shadowInput)},__updateMultiLine:function(){var root=this.querySelector(".top-textview-root");var url=this.querySelector(".top-textview-url");if(this.multiLine==="true"||this.multiLine===true){root.classList.add("multi-line");url.classList.add("multi-line");if(this.maxLine){if(Top.Util.Browser.isIE()){url.style.height=parseFloat(window.getComputedStyle(url).lineHeight)*this.maxLine+"px";url.style.textOverflow="ellipsis";url.style.display="block"}else{url.style.WebkitLineClamp=this.maxLine;url.style.WebkitBoxOrient="vertical";url.style.display="-webkit-box"}}}else{root.classList.remove("multi-line");url.classList.remove("multi-line")}},__updateText:function(){if(this.text||this.text===false||this.text===""||this.text===0){var url=this.querySelector(".top-textview-url");this.text=String(this.text);if(url){url.innerHTML=this.__i18n(this.text);if(this.text.includes("<sub>")||this.text.includes("<sup>")){url.classList.add("subscript")}else{url.classList.remove("subscript")}}}this.__initTooltip()},__updateUrl:function(){if(this.url){var url=this.querySelector(".top-textview-url");this.url=this.url.startsWith("/")?'javascript:Top.App.routeTo("'+this.url+'")':this.url;url.setAttribute("href",this.url)}},__updateName:function(){if(this.name){var shadowInput=this.querySelector("span");shadowInput.setAttribute("name",this.name)}},__updateMaxLine:function(){this.__updateMultiLine();this.__initTooltip()},getTopStyle:function(){this.topstyle=this.querySelector("span").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(!value){return}var styleNode=this.querySelector("span");styleNode.style[key]=value;this.topstyle=styleNode.style.cssText},setAllTopStyle:function(){this.querySelector("span").style.cssText=this.topstyle},__initTooltip:function(){var _this=this;if(!this.querySelector(".top-textview-root")){return}if(!this.tooltip||this.autoTooltip===true){top$(this).off("mouseenter").on("mouseenter",function(){_this.tooltip=_this.__isOverflown()?_this.text:"";_this.autoTooltip=true})}this.__updateTooltip()},__isOverflown:function(){var root=this.getElementsByClassName("top-textview-root")[0];var rootStyle=window.getComputedStyle(root);if(root.querySelector(".top-textview-url").children.length>=1){return false}var computedWidthPlusPadding=parseFloat(rootStyle.width);var text=root.textContent;if(text==undefined||text==""){return 0}var cont=top$("<div>"+text+"</div>").css("display",rootStyle.display).css("z-index","-50").css("position","absolute").css("padding-right",rootStyle.paddingRight).css("padding-left",rootStyle.paddingLeft).css("font-family",rootStyle.fontFamily).css("font-size",rootStyle.fontSize).css("white-space","nowrap").css("font-weight",rootStyle.fontWeight).appendTo("body");if(Top.Util.__isBooleanTrue(this.multiLine)){cont.css("width",computedWidthPlusPadding).css("white-space","pre-wrap");var computedHeight=Math.ceil(parseFloat(rootStyle.height)+parseFloat(rootStyle.paddingTop)+parseFloat(rootStyle.paddingBottom));var height=cont[0].getBoundingClientRect().height;cont.remove();return computedHeight<height?true:false}else{var width=cont[0].getBoundingClientRect().width;if(Top.Util.Browser.isChrome()){var url=this.querySelector(".top-textview-url");var urlStyle=window.getComputedStyle(url);width+=parseInt(urlStyle.paddingLeft)+parseInt(urlStyle.paddingRight)}cont.remove();return computedWidthPlusPadding<width?true:false}},detachTooltip:function(){var thisPageId=Top.App.getCurrentPage().id;var $tooltipText=top$("#"+thisPageId+" .top-tooltip-text");var $tooltipArrow=top$("#"+thisPageId+" .top-tooltip-arrow");$tooltipText.css("display","none");$tooltipArrow.css("display","none");if($tooltipArrow.hasClass("bottom"))$tooltipArrow.removeClass("bottom");else if($tooltipArrow.hasClass("top"))$tooltipArrow.removeClass("top")},__detached:function(){this.detachTooltip()},__updateTabIndex:function(){this.removeAttribute("tabindex");this.removeAttribute("tab-index")},__searchText:function(targetString,className){var url=this.querySelector(".top-textview-url");var texts=url.innerHTML;this.__clearSearched();texts=texts.replace(new RegExp(targetString,"ig"),(className?'<span class="'+className+' searched">':'<span class="searched" style="background-color:yellow;">')+"$&"+"</span>");url.innerHTML=texts},__clearSearched:function(){var url=this.querySelector(".top-textview-url");var span=url.getElementsByTagName("span");for(var i=0,length=span.length;i<length;i++){var searchedTextNode=document.createTextNode(span[0].textContent);url.replaceChild(searchedTextNode,span[0])}url.normalize()}};Top.Widget.Textview=function(){Textview.prototype=Object.create(Top.Widget.prototype);Textview.prototype.constructor=Textview;function Textview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-textview");this.template.innerHTML='<span class="top-textview-root"><a class="top-textview-url"></a><div class="top-textview-aligner"></div></span>'}this.id=this.template.id}Textview.create=function(element){return new Textview(element)};Textview.prototype.searchText=function(targetString,className){this.template.__searchText(targetString,className)};Textview.prototype.clearSearched=function(){this.template.__clearSearched()};Textview.prototype.setHTML=function(text){top$(this.template.querySelector("a")).text(text)};return Textview}();TopTimer={is:"top-timer",behaviors:[TopWidgetBehavior,TopTextBehavior],properties:{timer:String,onEndtimer:String},appendTemplate:function(){this.innerHTML='<span class="top-timer-root"></span>'},setAllTopStyle:function(){this.getElementsByClassName("top-timer-root")[0].style.cssText=this.topstyle},__attached2:function(){this.__initTimer()},__initTimer:function(){if(this.timer===undefined)this.timer="05:00";this.__format=this.timer.replace(/[0-9]+/,"mm").replace(/[0-9]+/,"ss");var span=this.getElementsByClassName("top-timer-root")[0];span.innerText=this.timer},__updateTimer:function(){this.__initTimer()},start:function(){var span=this.getElementsByClassName("top-timer-root")[0];this.__setTimer(span)},stop:function(){var span=this.getElementsByClassName("top-timer-root")[0];this.__stopTimer(span)},pause:function(){var span=this.getElementsByClassName("top-timer-root")[0];this.__pauseTimer(span)},resume:function(){var span=this.getElementsByClassName("top-timer-root")[0];this.__setTimer(span)}};Top.Widget.Timer=function(){Timer.prototype=Object.create(Top.Widget.prototype);Timer.prototype.constructor=Timer;function Timer(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-timer");this.template.innerHTML='<span class="top-timer-root"></span>'}this.id=this.template.id}Timer.create=function(element){return new Timer(element)};Timer.prototype.start=function(){this.template.start()};Timer.prototype.stop=function(){this.template.stop()};Timer.prototype.pause=function(){this.template.pause()};Timer.prototype.resume=function(){this.template.resume()};return Timer}();TopToggle={is:"top-toggle",behaviors:[TopWidgetBehavior,TopCheckBehavior],properties:{textOn:{type:String,value:"On"},textOff:{type:String,value:"Off"}},__ready:function(){this.__initI18n("textOn");this.__initI18n("textOff");this.__initialize()},appendTemplate:function(){this.innerHTML='<input type="checkbox"></input>'},__attached2:function(){this.__attachEvent()},__initialize:function(){this.__initTrueFalseValue();this.__initChecked();this.__updateId();var shadowInput=this.querySelector("input");top$(shadowInput).bootstrapToggle("destroy");if(this.disabled=="true"||this.disabled==true){top$(shadowInput).bootstrapToggle({on:this.textOn,off:this.textOff,width:this.layoutWidth,height:this.layoutHeight,topstyle:this.topstyle,style:"disabled"})}else{top$(shadowInput).bootstrapToggle({on:this.textOn,off:this.textOff,width:this.layoutWidth,height:this.layoutHeight,topstyle:this.topstyle})}this.__updateChecked()},__updateId:function(){if(this.id){var shadowInput=this.querySelector("input");shadowInput.id=this.id}},on:function(dataBound){var shadowInput=this.querySelector("input");shadowInput.checked=true;this.checked=this.trueValue;top$(shadowInput).bootstrapToggle("on");if(dataBound!==true){this.updateData("checked");this.updateDevice("checked")}if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("change"),this.checked)}else{this.__dispatchEvent(new Event("change"),this.checked)}},off:function(dataBound){var shadowInput=this.querySelector("input");shadowInput.checked=false;this.checked=this.falseValue;top$(shadowInput).bootstrapToggle("off");if(dataBound!==true){this.updateData("checked");this.updateDevice("checked")}if(Top.Util.Browser.isIE()){this.__dispatchEvent(new CustomEvent("change"),this.checked)}else{this.__dispatchEvent(new Event("change"),this.checked)}},toggle:function(){if(this.__isCheckedTrue()){this.off()}else{this.on()}},__attachEvent:function(){var _this=this;var container=this.querySelector(".top-toggle-root");container.addEventListener("click",function(event){_this.toggle()},true)},__updateChecked:function(dataBound){if(this.__isCheckedTrue()){this.on(dataBound)}else{this.off(dataBound)}},getTopStyle:function(){this.topstyle=this.querySelector("input").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector("input").style[key]=value;this.topstyle=this.querySelector("input").style.cssText}},setAllTopStyle:function(){this.querySelector("input").style.cssText=this.topstyle}};Top.Widget.Toggle=function(){Toggle.prototype=Object.create(Top.Widget.prototype);Toggle.prototype.constructor=Toggle;function Toggle(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-toggle");this.template.innerHTML='<input type="checkbox"></input>'}this.id=this.template.id}Toggle.create=function(element){return new Toggle(element)};Toggle.prototype.on=function(){this.template.on()};Toggle.prototype.off=function(){this.template.off()};Toggle.prototype.toggle=function(){this.template.toggle()};Toggle.prototype.getState=function(){return this.template.checked};return Toggle}();TopTreeview={is:"top-treeview",behaviors:[TopWidgetBehavior,TopGroupBehavior,TopContainerBehavior],properties:{eventNodeSelected:String,eventNodeHover:String,searchable:String,nodes:String,setting:{},
zTree:Object,checkable:String,onCheck:String,expand:String,relationsId:String,groupIcon:String,childIcon:String,groupImage:String,childImage:String,draggable:String,onNodeclick:String,onNodecheck:String,onNodehover:String,onNodedblclick:String,option:String,toggleClickCount:String,virtualScroll:{type:String,value:"false"},multiSelect:{type:String,value:"true"},onExpand:String,onCollapse:String,onScrollend:String},__ready:function(){this.__updateId();this.initialLayout();this.initItems();this.__initialize();this.__initialized=true},__updateId:function(){if(this.id){this.childRoot.id=this.id}},appendTemplate:function(){this.innerHTML='<div class="top-treeview-root">'+this.innerHTML+"</div>"},__eventBindingList:function(){var shadowRoot=this.querySelector(".top-treeview-root");return{__eventSecondaryClick:function(func){shadowRoot.oncontextmenu=func}}},attached:function(){if(this.querySelector(".top-treeview-container")&&this.virtualScroll==="false"){this.attachEventHandler()}},initializeChildRoot:function(){return this.querySelector(".top-treeview-root")},__initialize:function(){this.__initializeOption();if(this.relationsId){var path=this.relationsId.split(".");var data=Top.Util.namespace(path[0],this);var instanceId=data.getDataByRelations(path[1]);data.__addBoundWidget(instanceId,this.id,"items");this.items=path[0]+"."+instanceId}if(this.nodes){this.renderTreeViewByNodes()}else if(this.items||this.widgetItems){this.renderTreeview()}},__initEventInternal:function(){this.__initializeOption();this.__addEventByAttr("expand");this.__addEventByAttr("collapse")},__updateOnExpand:function(){this.__addEventByAttr("expand")},__updateOnCollpase:function(){this.__addEventByAttr("collapse")},__updateOnScrollend:function(){this.__addEventByAttr("scrollend")},__initializeOption:function(){this.defaultOption={node:{draggable:false,editable:false,deletable:false,checkable:false,checkInherit:true,checkInheritParent:true,checkDisabled:false,toggleClickCount:"2"},view:{showIcon:true,groupIcon:"icon-folder",childIcon:"icon-file",showImage:false,groupImage:null,childImage:null,language:{delete:"Delete",edit:"Edit"},expand:false,menu:{order:["edit","delete"]},layout:null,autoNodeWidth:true},event:{onNodeclick:null,onNodecheck:null,onNodehover:null,onNodedblclick:null,onNodedrag:null,onNodedrop:null,onNodedragstart:null,onNodedragend:null,onNodedragenter:null,onNodedragover:null,onNodedragleave:null,onNodeedit:null,onNodedelete:null,onExpand:null,onCollapse:null,onNodecontextmenu:null,onScrollend:null}};if(typeof this.option=="string"){this.option=Top.Util.namespace(this.option,this)}this.option=top$.extend(true,this.defaultOption,this.option);this.__matchOptionProperties()},__matchOptionProperties:function(){if(this.checkable){this.option.node.checkable=this.checkable}if(this.groupIcon){this.option.view.groupIcon=this.groupIcon}if(this.childIcon){this.option.view.childIcon=this.childIcon}if(this.groupImage){var groupImage=this.groupImage;if(groupImage.includes("@drawable")){groupImage=Top.DrawableManager.get(groupImage.replace("@drawable/",""))}this.option.view.groupImage=groupImage;this.option.view.showImage=true;this.option.view.showIcon=false}if(this.childImage){var childImage=this.childImage;if(childImage.includes("@drawable")){childImage=Top.DrawableManager.get(childImage.replace("@drawable/",""))}this.option.view.childImage=childImage;this.option.view.showImage=true;this.option.view.showIcon=false}if(this.expand){this.option.view.expand=this.expand==="true"||this.expand===true}if(this.toggleClickCount){this.option.node.toggleClickCount=this.toggleClickCount}if(this.eventNodeSelected||this.onNodeclick){this.option.event.onNodeclick=this.eventNodeSelected||this.onNodeclick}if(this.eventNodeHover||this.onNodehover){this.option.event.onNodehover=this.eventNodeHover||this.onNodehover}if(this.onCheck||this.onNodecheck){this.option.event.onNodecheck=this.onCheck||this.onNodecheck}if(this.onNodedblclick){this.option.event.onNodedblclick=this.onNodedblclick}if(this.option.event.onExpand){this.onExpand=this.option.event.onExpand;this.__addEventByAttr("expand")}if(this.option.event.onCollapse){this.onCollapse=this.option.event.onCollapse;this.__addEventByAttr("collapse")}if(this.option.event.onScrollend){this.onScrollend=this.option.event.onScrollend;this.__addEventByAttr("scrollend")}this.option.view.autoNodeWidth=this.option.view.autoNodeWidth==="true"||this.option.view.autoNodeWidth===true;if(this.option.view.autoNodeWidth&&(!this.layoutWidth||this.layoutWidth==="auto"))this.option.view.autoNodeWidth=false;if(typeof this.option.view.layout==="string")this.option.view.layout=Top.Util.namespace(this.option.view.layout,this);if(typeof this.option.event.onNodeclick==="string")this.option.event.onNodeclick=Top.Util.namespace(this.option.event.onNodeclick,this);if(typeof this.option.event.onNodehover==="string")this.option.event.onNodehover=Top.Util.namespace(this.option.event.onNodehover,this);if(typeof this.option.event.onNodecheck==="string")this.option.event.onNodecheck=Top.Util.namespace(this.option.event.onNodecheck,this);if(typeof this.option.event.onNodedblclick==="string")this.option.event.onNodedblclick=Top.Util.namespace(this.option.event.onNodedblclick,this);if(typeof this.option.event.onNodedrag==="string")this.option.event.onNodedrag=Top.Util.namespace(this.option.event.onNodedrag,this);if(typeof this.option.event.onNodedrop==="string")this.option.event.onNodedrop=Top.Util.namespace(this.option.event.onNodedrop,this);if(typeof this.option.event.onNodedragstart==="string")this.option.event.onNodedragstart=Top.Util.namespace(this.option.event.onNodedragstart,this);if(typeof this.option.event.onNodedragend==="string")this.option.event.onNodedragend=Top.Util.namespace(this.option.event.onNodedragend,this);if(typeof this.option.event.onNodedragenter==="string")this.option.event.onNodedragenter=Top.Util.namespace(this.option.event.onNodedragenter,this);if(typeof this.option.event.onNodedragover==="string")this.option.event.onNodedragover=Top.Util.namespace(this.option.event.onNodedragover,this);if(typeof this.option.event.onNodedragleave==="string")this.option.event.onNodedragleave=Top.Util.namespace(this.option.event.onNodedragleave,this);if(typeof this.option.event.onNodeedit==="string")this.option.event.onNodeedit=Top.Util.namespace(this.option.event.onNodeedit,this);if(typeof this.option.event.onNodedelete==="string")this.option.event.onNodedelete=Top.Util.namespace(this.option.event.onNodedelete,this);if(typeof this.onExpand==="string")this.onExpand=Top.Util.namespace(this.onExpand,this);if(typeof this.onCollapse==="string")this.onCollapse=Top.Util.namespace(this.onCollapse,this);if(typeof this.onScrollend==="string")this.onScrollend=Top.Util.namespace(this.onScrollend,this);if(typeof this.option.event.onNodecontextmenu==="string")this.option.event.onNodecontextmenu=Top.Util.namespace(this.option.event.onNodecontextmenu,this);if(typeof this.option.node.checkDisabled==="string")this.option.node.checkDisabled=Top.Util.namespace(this.option.node.checkDisabled,this)},__findNodeById:function(nodes,id){if(!nodes||!id)return;var selectedNode;for(var i=0,len=nodes.length;i<len;i++){if(nodes[i].id==id){return nodes[i]}if(typeof nodes[i].children==="object"&&nodes[i].children.length>0){selectedNode=this.__findNodeById(nodes[i].children,id);if(selectedNode){return selectedNode}}}return selectedNode},__findItemByField:function(items,field,value,index,calledByItself){if(!this._index)this._index=0;if(!items||!field||!value)return;index=parseInt(index);var selectedNode;if(items instanceof Array){for(var i=0,len=items.length;i<len;i++){selectedNode=this.__findItemByField(items[i],field,value,index,true);if(selectedNode)return selectedNode}}else if(items instanceof Object){if(index==this._index&&items[field]===value){this._index=0;return items}if(calledByItself)this._index++;for(var key in items){if(typeof items[key]==="object"&&items[key].length>0){selectedNode=this.__findItemByField(items[key],field,value,index,true);if(selectedNode)return selectedNode}}}return selectedNode},__setParentCheck:function(nodes,parentId){var totalChecked=0;for(var i=0;i<nodes.length;i++){var node=nodes[i];if(node.hasChild===true||node.hasChild==="true")this.__setParentCheck(node.children,node.id);if(node.depth===0)continue;if(node.checked===true||node.checked==="true"){totalChecked++}}if(totalChecked===nodes.length){this.__checkNode(parentId,true)}return nodes},renderTreeview:function(){var isStaticDataIncluded=false;var switchedItem=[];var subItems=[];var switchedModel=[];var changedItems=[];var modelIdObj={};this.option_layout=false;if(!this.items){for(var i=0;i<this.widgetItems.length;i++){if(this.widgetItems[i].attributes["data-model"]){break}if(!this.__initialized)this.widgetItems=this.childRoot.cloneNode(true).children;this.clearItems();this.renderTreeViewByNodes();return}}if(typeof this.items==="string"&&this.items.length>0){this.itemModel=Top.Util.namespace(Top.Util.getDataName(this.items),this);this.itemString=this.items.split(".");this.itemString=this.itemString[this.itemString.length-1];this.items=Top.Util.namespace(this.items,this);this.itemModelObj=this.itemModel.getModel()[this.itemString];this.itemData=this.items}else if(typeof this.items==="object"){this.itemData=this.items}else if(this.widgetItems){isStaticDataIncluded=true;this.items=[];this.itemModel=[];this.itemModelObj={};var tempArray=[];this.staticItemWithModel=[];this.itemString=[];for(var i=0;i<this.widgetItems.length;i++){if(this.widgetItems[i].attributes["data-model"]){var tempString=this.widgetItems[i].attributes["data-model"].value;tempArray.push(tempString.substring(tempString.indexOf('"',tempString.indexOf(":"))+1,tempString.lastIndexOf('"')));this.staticItemWithModel.push(this.widgetItems[i])}}for(var index=0;i<tempArray.length;index++){this.itemModel.push(Top.Util.namespace(Top.Util.getDataName(tempArray[index]),this));this.itemString.push(tempArray[index].split(".")[tempArray[index].split(".").length-1]);this.items.push(Top.Util.namespace(tempArray[index],this));this.itemModelObj["modelId"]=undefined;this.itemModelObj[this.itemString[index]]=this.itemModel[index].getModel()[this.itemString[index]]}this.itemData=this.items}else{console.warn("Treeview: item not defined");return}if(this.widgetItems&&this.widgetItems[0]&&this.widgetItems[0].firstElementChild&&this.widgetItems[0].firstElementChild.tagName.includes("LAYOUT")){if(!this.option_layout)this.widgetItems=[this.widgetItems[0].cloneNode(true)];this.option_layout=true}this.clearItems();var container_ul=document.createElement("ul");container_ul.classList.add("top-treeview-container");if(!Top.Util.__isBooleanTrue(this.getAttribute("horizontalScroll")))container_ul.classList.add("auto-width");this.childRoot.appendChild(container_ul);if(this.virtualScroll===true||this.virtualScroll==="true"){if(this.items.length>0){this.isExpanded=this.option.view.expand;if(this.isExpanded===undefined)this.isExpanded=true;this.items=this.__setExpand(this.items,this.isExpanded,0);this.__setPath(this.items,"");this.__setId(this.items,0);this.__setParentCheck(this.items,null);this.flatNodes=this.__makeFlatNode(new Array,this.items);this.__createViewport(this.flatNodes.length,this.flatNodes);var allNodeHasChecked=top$(this.querySelectorAll(".top-treeview-check:checked")).parent().find("> .top-treeview-item");this.checkedNode=[];for(var index=0;index<allNodeHasChecked.length;index++){var item=allNodeHasChecked[index];if(this.userNodes){if(item.dataObj!==undefined){this.checkedNode.push(item.dataObj)}else{this.checkedNode.push(this.__findNodeById(this.flatNodes,item.id))}}else if(this.items){this._index=0;this.checkedNode.push(this.__findItemByField(this.items,item.getAttribute("data-field"),item.innerText,item.getAttribute("data-index")))}}for(var k=0;k<this.checkedNode.length;k++){var item=this.checkedNode[k];item.checked=true}if(this.userNodes)this.__setVirtualDataObjToItem(this.flatNodes);this.createdItemWidgetAttachedCallback();this.__setOptions()}}else{var appendString=this.makeTreeItems(this.items,0);if(isStaticDataIncluded){for(var i=0;i<this.widgetItems.length;i++){if(isStaticItem(this.widgetItems[i])){changedItems[i]={};changedItems[i]["text"]=this.widgetItems[i].attributes["text"]?this.widgetItems[i].attributes["text"].value:"";var trigger=false;for(var j=0;j<this.staticItemWithModel.length;j++){if(this.widgetItems[i]===this.staticItemWithModel[j]){trigger=true;changedItems[i][this.itemString[j]]=this.items[j].slice()}}if(!trigger)changedItems[i]["children"]=makeChangedItems(this.widgetItems[i])}}this.getElementsByClassName("top-treeview-container")[0].innerHTML=appendString}else if(this.option_layout){var madeNodes=document.createElement("div");madeNodes.innerHTML=appendString;for(var k=0;k<madeNodes.children.length;k++){this.createHtmlObjects(madeNodes.children[k])}while(madeNodes.firstChild){this.getElementsByClassName("top-treeview-container")[0].appendChild(madeNodes.firstChild)}}else{this.getElementsByClassName("top-treeview-container")[0].innerHTML=appendString}if(this.headerItem.length>0){top$(this).prepend("<label class='top-treeview-header'></label>");if(this.headerItem[0].attributes["text"])this.querySelector(".top-treeview-header").innerText=this.headerItem[0].attributes.text.nodeValue;if(this.headerItem[0].childElementCount>0)this.querySelector(".top-treeview-header").innerHTML=this.headerItem[0].innerHTML}if(this.option.view.groupImage||this.option.view.childImage){this.option.view.showImage=true;if(this.option.view.groupImage){var parentItems=this.querySelectorAll("label.top-treeview-item");for(var i=0;i<parentItems.length;i++){if(parentItems[i].getElementsByClassName("top-treeview-image")[0]&&parentItems[i].getElementsByClassName("top-treeview-image")[0].length===0){var image_span=document.createElement("span");image_span.classList.add("top-treeview-image");image_span.style.background="url("+this.option.view.groupImage+") 0 0 no-repeat";image_span.style.backgroundSize="contain";image_span.setAttribute("i-type","union");parentItems.insertBefore(image_span,parentItems.firstChild)}}}if(this.option.view.childImage){var childItems=this.querySelectorAll("a.top-treeview-item");for(var i=0;i<childItems.length;i++){if(childItems[i].getElementsByClassName("top-treeview-image")[0]&&childItems[i].getElementsByClassName("top-treeview-image")[0].length===0){var image_span=document.createElement("span");image_span.classList.add("top-treeview-image");image_span.style.background="url("+this.option.view.groupImage+") 0 0 no-repeat";image_span.style.backgroundSize="contain";image_span.setAttribute("i-type","union");childItems.insertBefore(image_span,childItems.firstChild)}}}}this.__setOptions();this.attachEventHandler();function makeChangedItems(item){var len=item.childNodes.length;var ret=[];for(var i=0;i<len;i++){ret[i]={};ret[i]["text"]=item.childNodes[i].attributes["text"].value;if(item.childNodes[i].children){ret[i]["children"]=makeChangedItems(item.childNodes[i])}}return ret.length===0?undefined:ret}function isStaticItem(item){if(item.attributes["text"]&&item.attributes["text"].value.startsWith("{"))return false;else if(item.attributes["data-model"]||item.attributes["text"])return true;else return false}}},getTreeItem:function(instance,modelId,modelFieldName){var _this=this;var defaultItem;var rightItem;var switchedWidgetItems=this.widgetItems;for(var i=0;i<this.widgetItems.length;i++){if(isStaticItem(this.widgetItems[i])){var modelFieldinItem=this.widgetItems[i].getAttribute("data-model");if(modelFieldinItem){modelFieldinItem=modelFieldinItem.substring(modelFieldinItem.lastIndexOf(".")+1,modelFieldinItem.lastIndexOf('"'));if(modelFieldinItem==modelFieldName){switchedWidgetItems=[];switchedWidgetItems=[this.widgetItems[i]]}}}}for(var i=0;i<switchedWidgetItems.length;i++){var widgetItems;var treeItem;if(isStaticItem(switchedWidgetItems[i])){if(switchedWidgetItems[i].getAttribute("item-switch-logic")){this.itemSwitchLogic=switchedWidgetItems[i].getAttribute("item-switch-logic");if(switchedWidgetItems[i].attributes["item-switch-logic"].value.startsWith("{")){this.itemSwitchField=switchedWidgetItems[i].attributes["item-switch-logic"].value.substring(1,switchedWidgetItems[i].attributes["item-switch-logic"].value.indexOf("}"))}else this.itemSwitchFunc=Top.Util.namespace(switchedWidgetItems[i].attributes["item-switch-logic"].value,this)}widgetItems=Array.prototype.slice.call(top$(switchedWidgetItems[i]).children("top-widgetitem"));for(var j=0;j<widgetItems.length;j++){treeItem=widgetItems[j];if(!treeItem.getAttribute("model-id")){if(treeItem.getAttribute("item-switch-case")){if(isRightItem(treeItem))defaultItem=treeItem}else defaultItem=treeItem}else if(treeItem.getAttribute("model-id")===modelId){if(!treeItem.getAttribute("item-switch-case"))defaultItem=treeItem;if(isRightItem(treeItem))rightItem=treeItem}}}else{treeItem=switchedWidgetItems[i];if(!treeItem.getAttribute("model-id")){if(treeItem.getAttribute("item-switch-case")){if(isRightItem(treeItem))defaultItem=treeItem}else defaultItem=treeItem}else if(treeItem.getAttribute("model-id")===modelId){if(!treeItem.getAttribute("item-switch-case"))defaultItem=treeItem;if(isRightItem(treeItem))rightItem=treeItem}}}if(!rightItem&&modelId)rightItem=defaultItem;return rightItem;function isStaticItem(item){if(item.attributes["text"]&&item.attributes["text"].value.startsWith("{"))return false;else if(item.attributes["data-model"]||item.attributes["text"])return true;else return false}function isRightItem(item,type){if(_this.itemSwitchLogic&&item.getAttribute("item-switch-case")){return itemSwitchLogicCall(item)}else return true}function itemSwitchLogicCall(item){var regex1=/^.*\>+.*|.*\<+.*|.*\=+.*$/;var regex2=/^[-+.]?[0-9,]*[.]?[0-9]+$/;if(_this.itemSwitchField){var itemCase;var fieldValue;var fieldArray=_this.itemSwitchField.split(".");if(fieldArray.length>1){var fieldModel=fieldArray[0];var fieldName=fieldArray[1]}else{var fieldName=fieldArray[0]}if(fieldModel&&fieldModel!==modelId){return false}fieldValue=instance[fieldName];var bool=regex2.test(fieldValue);var caseValue=item.attributes["item-switch-case"].value;if(bool===true||typeof fieldValue==="number"){if(caseValue.startsWith("lt"))caseValue=caseValue.replace("lt","<");if(caseValue.startsWith("gt"))caseValue=caseValue.replace("gt",">");if(caseValue.startsWith("le"))caseValue=caseValue.replace("le","<=");if(caseValue.startsWith("ge"))caseValue=caseValue.replace("ge",">=");if(caseValue.startsWith("eq"))caseValue=caseValue.replace("eq","==");if(caseValue.startsWith("ne"))caseValue=caseValue.replace("ne","!=");itemCase=fieldValue+caseValue}else if(bool===false){if(caseValue.startsWith("ne")){caseValue=caseValue.replace("ne ","").replace("ne","");itemCase='"'+caseValue+'"';itemCase+=' != "'+fieldValue+'"'}else{caseValue=caseValue.replace("eq ","").replace("eq","");itemCase='"'+caseValue+'"';itemCase+=' == "'+fieldValue+'"'}}if(eval(itemCase))return true;else return false}else if(_this.itemSwitchFunc){if(typeof _this.itemSwitchFunc==="function")var ret=_this.itemSwitchFunc(instance);var caseValue=item.attributes["item-switch-case"].value;if(caseValue==ret)return true;else return false}}},makeTreeItems:function(treeObj,level,thisModelIdObj,modelFieldName){var len=treeObj.length;var ret="";var isArray=false;var checkable=this.option.node.checkable;var checkString="";var checked=false;var imageString="";var innerElement="";var field="";var modelIdObj=!thisModelIdObj?this.itemModelObj:thisModelIdObj;var modelId=modelIdObj["modelId"];var isExpanded=this.option.view.expand;var iString="";if(len>0){for(var i=0;i<len;i++){innerElement="";imageString="";iString="";var keys=Object.keys(treeObj[i]);var arrayKey=[];ret+="<li tabindex='-1' class='top-treeview-list level"+level;var id=treeObj[i]["id"]!==null&&treeObj[i]["id"]!==undefined&&treeObj[i]["id"].toString()||treeObj[i]["value"]||treeObj[i]["text"];for(var j=0;j<keys.length;j++){if(treeObj[i][keys[j]]instanceof Array&&treeObj[i][keys[j]].length>0){isArray=true;arrayKey.push(keys[j])}}if(treeObj[i]["checked"]==="true"||treeObj[i]["checked"]===true){checked=true}if(checkable==="true"||checkable===true){checkString="<input type='checkbox' id='"+this.id+"_check_"+i+"' class='top-treeview-check' "+(checked?"checked":"")+"><label for='"+this.id+"_check_"+i+"'></label>"}var treeitem=this.getTreeItem(treeObj[i],modelId,modelFieldName);if(treeitem){if(treeitem.attributes["text"]){var modelField=treeitem.attributes["text"].value;modelField=modelField.substring(1,modelField.indexOf("}"));var innerElement=treeObj[i][modelField];field=modelField}else{treeitem=treeitem.cloneNode(true);var topWidget=/^TOP-[a-zA-Z]*/;var treeChildren=treeitem.querySelectorAll("*");var topWidgets=[];for(var j=0;j<treeChildren.length;j++)if(topWidget.test(treeChildren[j].tagName))topWidgets.push(treeChildren[j]);for(var j=0;j<topWidgets.length;j++){if(topWidgets[j].tagName==="TOP-TEXTVIEW")topWidgets[j].innerHTML="";var attr=topWidgets[j].attributes;for(var k=0;k<attr.length;k++){if(attr[k].value&&attr[k].value.startsWith("{")&&attr[k].value.endsWith("}")){var bind_key=attr[k].value.slice(1,-1);if(treeObj[i][bind_key]){topWidgets[j].setAttribute(attr[k].name,treeObj[i][bind_key])}}}}innerElement=treeitem.children[0].outerHTML}var imageSrc=treeitem.getAttribute("image");if(imageSrc){if(imageSrc.startsWith("{")){imageSrc=imageSrc.replace("{","").replace("}","");imageSrc=treeObj[i][imageSrc]}if(imageSrc.startsWith("@drawable")){imageSrc=Top.DrawableManager.get(imageSrc.replace("@drawable/",""))}if(imageSrc.startsWith("icon-")){iString="<span class='top-treeview-icon "+imageSrc+"'></span>"}else{imageString=treeitem.attributes["image"]?"<span class='top-treeview-image' style=' background:url("+imageSrc+") 0 0 no-repeat; background-size:contain;'></span>":""}}else if(treeObj[i]["icon"]){iString="<span class='top-treeview-icon "+treeObj[i]["icon"]+"'></span>"}}else{if(typeof treeObj[i].text==="string"){innerElement+=treeObj[i].text;field="text"}if(treeObj[i]["icon"]){iString="<span class='top-treeview-icon "+treeObj[i]["icon"]+"'></span>"}}if(isArray){ret+=" parent "+(isExpanded?"expand":"collapse")+"'><input type='checkbox' class='top-treeview-button'"+(isExpanded?"":"checked")+"><i></i>"+checkString+"<label id='"+id+"' class='top-treeview-item' data-field='"+field+"'>"+iString+imageString+innerElement+"</label><ul class='top-treeview-children_nav' style='display:"+(isExpanded?"block":"none")+";'>";for(var j=0;j<arrayKey.length;j++){if(modelId){ret+=this.makeTreeItems(treeObj[i][arrayKey[j]],level+1,modelIdObj[arrayKey[j]],modelFieldName)}else{ret+=this.makeTreeItems(treeObj[i][arrayKey[j]],level+1,modelIdObj[arrayKey[j]],arrayKey[j])}}ret+="</ul>"}else{ret+=" child'>"+checkString+"<a id='"+id+"'class='top-treeview-item' data-field='"+field+"'>"+iString+imageString+innerElement+"</a>"}ret+="</li>";checked=false}}else{var keys=Object.keys(treeObj);var arrayKey=[];var id=treeObj["id"]!==null&&treeObj["id"]!==undefined&&treeObj["id"].toString()||treeObj["value"]||treeObj["text"];innerElement="";imageString="";ret+="<li tabindex='-1' class='top-treeview-list level"+level;for(var j=0;j<keys.length;j++){if(treeObj[keys[j]]instanceof Array){isArray=true;arrayKey.push(keys[j])}}if(treeObj["checked"]==="true"||treeObj["checked"]===true){checked=true}if(checkable==="true"||checkable===true){checkString="<input type='checkbox' id='"+this.id+"_check_"+i+"' class='top-treeview-check' "+(checked?"checked":"")+"><label for='"+this.id+"_check_"+i+"'></label>"}var treeitem=this.getTreeItem(treeObj,modelId,modelFieldName);if(treeitem){if(treeitem.attributes["text"]){var modelField=treeitem.attributes["text"].value;modelField=modelField.substring(1,modelField.indexOf("}"));var innerElement=treeObj[modelField];field=modelField}else{var topWidget=/^TOP-[a-zA-Z]*/;var treeChildren=treeitem.querySelectorAll("*");var topWidgets=[];for(var j=0;j<treeChildren.length;j++)if(topWidget.test(treeChildren[j].tagName))topWidgets.push(treeChildren[j]);for(var index=0;index<topWidgets.length;index++){var attr=topWidgets[index].attributes;for(var j=0;j<attr.length;j++){for(var l=0;l<treeObj.length;l++){var key=treeObj[l];if(attr[j].value==="{"+key+"}"){innerElement=treeitem.children[0].outerHTML.replace(new RegExp(attr[j].nodeName+'="'+attr[j].nodeValue+'" | '+attr[j].nodeName+"='"+attr[j].nodeValue+"'"),attr[j].nodeName+'="'+treeObj[key]+'" ');field=key}}}}}var imageSrc=treeitem.getAttribute("image");if(imageSrc){if(imageSrc.startsWith("{")){imageSrc=imageSrc.replace("{","").replace("}","");imageSrc=treeObj[imageSrc]}if(imageSrc.startsWith("@drawable")){imageSrc=Top.DrawableManager.get(imageSrc.replace("@drawable/",""))}}imageString=treeitem.attributes["image"]?"<span class='top-treeview-image' style=' background:url("+imageSrc+") 0 0 no-repeat; background-size:contain;'></span>":""}else{for(var key in treeObj){if(typeof treeObj[key]==="string"){innerElement+=treeObj[key];field=key}}}if(isArray){ret+=" parent "+(isExpanded?"expand":"collapse")+"'><input type='checkbox' class='top-treeview-button'"+(isExpanded?"":"checked")+"><i></i>"+checkString+"<label id='"+id+"' class='top-treeview-item' data-field='"+field+"'>"+imageString+innerElement+"</label><ul class='top-treeview-children_nav' style='display:"+(isExpanded?"block":"none")+";'>";for(var j=0;j<arrayKey.length;j++){if(modelId){ret+=this.makeTreeItems(treeObj[arrayKey[j]],level+1,modelIdObj[arrayKey[j]],modelFieldName)}else{ret+=this.makeTreeItems(treeObj[arrayKey[j]],level+1,modelIdObj[arrayKey[j]],arrayKey[j])}}ret+="</ul>"}else{ret+=" child'>"+checkString+"<a id='"+id+"'class='top-treeview-item' data-field='"+field+"'>"+imageString+innerElement+"</a>"}checked=false}return ret},appendItems:function(treeObj,level,index){if(treeObj instanceof Array){var len=treeObj.length;if(index){if(typeof index==="number")var itemTag=this.querySelectorAll(".level"+level+" > .top-treeview-item")[index];else{var parentElem=index instanceof NodeList?index[0].parentNode:index.parentNode;var itemTag=parentElem.querySelectorAll(".level"+level+" > .top-treeview-item")}}else var itemTag=this.querySelectorAll(".level"+level+" > .top-treeview-item");var availableTag=[];for(var i=0;i<itemTag.length;i++){if(itemTag[i].childNodes.length===0||itemTag.childNodes&&itemTag.childNodes[0].tagName==="SPAN")availableTag.push(itemTag[i])}for(var i=0;i<len;i++){for(var j=0;j<treeObj[i].length;j++){var key=treeObj[i][j];if(treeObj[i][key]instanceof Array){this.appendItems(treeObj[i][key],level+1)}else{if(key==="includedIcon"){var image_span=document.createElement("span");image_span.classList.add("top-treeview-image");image_span.style.background="url("+treeObj[i].includedIcon+") 0 0 no-repeat";image_span.style.backgroundSize="contain";availableTag[i].insertBefore(image_span,availableTag[i].firstChild)}if(treeObj[i].includedLayout){var cloneNode=treeObj[i].includedLayout.cloneNode(true);if(availableTag[i].childNodes.length===0||availableTag[i].childElementCount==="1"&&availableTag[i].childNodes[0].tagName==="SPAN"){availableTag[i].appendChild(cloneNode)}var topWidget=/^TOP-[a-zA-Z]*/;var treeChildren=availableTag[i].querySelectorAll("*");var topWidgets=[];for(var j=0;j<treeChildren.length;j++)if(topWidget.test(treeChildren[j].tagName))topWidgets.push(treeChildren[j]);top$.each(topWidgets,function(index){var attr=topWidgets[index].attributes;for(var j=0;j<attr.length;j++){if(attr[j].value==="{"+key+"}"){topWidgets[index].setAttribute(attr[j].name,treeObj[i][key]);topWidgets[index].__updateProperties(attr[j].name)}}})}else if(key!=="includedIcon"){availableTag[i].appendChild(treeObj[i][key])}}}}}else{if(index!==null||index!==undefined){if(typeof index==="number"){var itemTag=this.querySelectorAll(".level"+level+" > .top-treeview-item")[index]}else{var parentElem=index instanceof NodeList?index[0].parentNode:index.parentNode;var itemTag=parentElem.querySelectorAll(".level"+level+" > .top-treeview-item")}}else var itemTag=this.querySelectorAll(".level"+level+" > .top-treeview-item");for(var k=0;k<treeObj.length;k++){var key=treeObj[k];if(treeObj[key]instanceof Array){this.appendItems(treeObj[key],level+1,itemTag)}else{if(key==="includedIcon"){var image_span=document.createElement("span");image_span.classList.add("top-treeview-image");image_span.style.background="url("+treeObj.includedIcon+") 0 0 no-repeat";image_span.style.backgroundSize="contain";itemTag.insertBefore(image_span,itemTag.firstChild)}if(treeObj.includedLayout){var cloneNode=treeObj.includedLayout.cloneNode(true);if(itemTag.childNodes.length===0||itemTag.childElementCount==="1"&&itemTag.childNodes[0].tagName==="SPAN"){itemTag.appendChild(cloneNode)}var topWidget=/^TOP-[a-zA-Z]*/;var treeChildren=itemTag.querySelectorAll("*");var topWidgets=[];for(var j=0;j<treeChildren.length;j++)if(topWidget.test(treeChildren[j].tagName))topWidgets.push(treeChildren[j]);top$.each(topWidgets,function(index){var attr=topWidgets[index].attributes;for(var j=0;j<attr.length;j++){if(attr[j].value==="{"+key+"}"){topWidgets[index].setAttribute(attr[j].name,treeObj[key]);topWidgets[index].__updateProperties(attr[j].name)}}})}else if(key!=="includedIcon"){itemTag.appendChild(treeObj[key])}}}}},attachEventHandler:function(){var _this=this;var fnNodeSelected=this.option.event.onNodeclick;var fnNodeHover=this.option.event.onNodehover;var fnNodeCheck=this.option.event.onNodecheck;var fnNodeDblclick=this.option.event.onNodedblclick;top$(this).find(" .top-treeview-container .top-treeview-button").off("change").on("change",function(e){var parent_li=this.parentNode;var thisItem=parent_li.getElementsByClassName("top-treeview-item")[0];var children_ul=thisItem.nextSibling;var thisNodeData=thisItem.dataObj;this.setAttribute("checked",this.checked);if(this.checked){children_ul.style.display="none";children_ul.classList.add("collapse");children_ul.classList.remove("expand");_this.__dispatchEvent(new CustomEvent("collapse",{detail:{data:thisNodeData}}))}else{children_ul.style.display="block";children_ul.classList.add("expand");children_ul.classList.remove("collapse");_this.__dispatchEvent(new CustomEvent("expand",{detail:{data:thisNodeData}}))}e.preventDefault()});top$(this).find(" .top-treeview-container .top-treeview-button+i").off("click").on("click",function(e){if(this.previousSibling.checked){this.previousSibling.checked=false}else{this.previousSibling.checked=true}top$(this.previousSibling).change();e.preventDefault()});var isDblclickAction;top$(this).find(" .top-treeview-container .top-treeview-item").off("dblclick").on("dblclick",function(e){_this.clickedItemIndex=this.getAttribute("data-index");if(_this.userNodes){_this.dblclickedNode=this.dataObj;if(typeof fnNodeDblclick==="function"){fnNodeDblclick(e.originalEvent,Top.Dom.selectById(_this.id),_this.dblclickedNode)}}else if(_this.items){_this._index=0;_this.dblclickedNode=_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,_this.clickedItemIndex);if(typeof fnNodeDblclick==="function")fnNodeDblclick(event,Top.Dom.selectById(_this.id))}if(this.parentNode&&this.parentNode.classList.contains("parent")&&(_this.option.node.toggleClickCount===2||_this.option.node.toggleClickCount==="2")){var button_input=this.parentNode.getElementsByClassName("top-treeview-button")[0];if(button_input.checked)button_input.checked=false;else button_input.checked=true;top$(button_input).change()}e.preventDefault()});var lastClickedIndex,lastClickedType,firstClickedIndex;top$(this).find(" .top-treeview-container .top-treeview-item").off("click").on("click",function(e){var thisClickedIndex=this.getAttribute("data-index");if(_this.itemClicktype==="select"){if(Top.Util.__isBooleanTrue(_this.multiSelect)&&(e.shiftKey||e.ctrlKey)){if(e.shiftKey){if(!lastClickedIndex)lastClickedIndex=0;if(!firstClickedIndex)firstClickedIndex=0;if(lastClickedType=="ctrl"||parseInt(lastClickedIndex)>parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)<parseInt(firstClickedIndex)||parseInt(lastClickedIndex)<parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)>parseInt(firstClickedIndex)){
var selectedList=_this.querySelectorAll(".top-treeview-list.selected");for(var tmp=0;tmp<selectedList.length;tmp++){selectedList[tmp].classList.remove("selected")}var selectedItem=_this.querySelectorAll(".top-treeview-item.selected");for(var tmp=0;tmp<selectedItem.length;tmp++){selectedItem[tmp].classList.remove("selected")}lastClickedIndex=firstClickedIndex}var selectedElement=_this.querySelector(".top-treeview-item[data-index='"+lastClickedIndex+"']");if(thisClickedIndex!==lastClickedIndex){var dataIndex=lastClickedIndex;while(true){if(selectedElement!==undefined&&selectedElement!==null){selectedElement.parentNode.classList.add("selected");selectedElement.classList.add("selected")}if(selectedElement.getAttribute("data-index")===thisClickedIndex)break;if(parseInt(thisClickedIndex)>parseInt(lastClickedIndex)){dataIndex++;selectedElement=_this.querySelector(".top-treeview-item[data-index='"+dataIndex+"']")}else{dataIndex--;selectedElement=_this.querySelector(".top-treeview-item[data-index='"+dataIndex+"']")}}}else if(thisClickedIndex===lastClickedIndex){if(selectedElement!==undefined&&selectedElement!==null){selectedElement.parentNode.classList.add("selected");selectedElement.classList.add("selected")}}lastClickedType="shift"}else if(e.ctrlKey){this.parentNode.classList.toggle("selected");this.classList.toggle("selected");lastClickedType="ctrl";firstClickedIndex=thisClickedIndex}var allNodeHasSelected=_this.querySelectorAll(".top-treeview-item.selected");_this.selectedNode=[];for(var l=0;l<allNodeHasSelected.length;l++){var item=allNodeHasSelected[l];if(_this.userNodes){_this.selectedNode.push(item.dataObj)}else if(_this.items){_this._index=0;_this.selectedNode.push(_this.__findItemByField(_this.items,item.getAttribute("data-field"),item.innerText,item.getAttribute("data-index")))}}lastClickedIndex=thisClickedIndex}else{var treeviewList=_this.querySelectorAll(".top-treeview-list.selected");for(var l=0;l<treeviewList.length;l++){if(treeviewList[l]!==null&&treeviewList[l]!==undefined)treeviewList[l].classList.remove("selected")}var treeviewItem=_this.querySelectorAll(".top-treeview-item.selected");for(var l=0;l<treeviewItem.length;l++){if(treeviewItem[l]!==null&&treeviewItem[l]!==undefined)treeviewItem[l].classList.remove("selected")}this.parentNode.classList.add("selected");this.classList.add("selected");_this._index=0;_this.selectedNode=this.dataObj||_this.__findItemByField(_this.itemData,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"));lastClickedIndex=thisClickedIndex;lastClickedType="";firstClickedIndex=thisClickedIndex}_this.selectedItemIndex=lastClickedIndex}else if(_this.itemClicktype==="click"){_this.clickedItemIndex=this.getAttribute("data-index");_this._index=0;_this.clickedNode=this.dataObj||_this.__findItemByField(_this.itemData,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"))}if(_this.userNodes){if(typeof fnNodeSelected==="function"){if(_this.itemClicktype==="select"){fnNodeSelected(e.originalEvent,Top.Dom.selectById(_this.id),_this.selectedNode)}else if(_this.itemClicktype==="click"){fnNodeSelected(e.originalEvent,Top.Dom.selectById(_this.id),_this.clickedNode)}}}else if(_this.items){if(typeof fnNodeSelected==="function")fnNodeSelected(event,Top.Dom.selectById(_this.id));else if(typeof _this.option.event.onNodeclick==="function")_this.option.event.onNodeclick(event,Top.Dom.selectById(_this.id));else if(typeof _this.onNodeclick==="string"&&_this.onNodeclick.length>0)Top.Util.namespace(_this.onNodeclick,_this)(event,Top.Dom.selectById(_this.id))}if(this.parentNode){if(this.parentNode.classList.contains("parent")&&(_this.option.node.toggleClickCount===1||_this.option.node.toggleClickCount==="1")){var button_input=this.parentNode.querySelector(".top-treeview-button");if(button_input.checked)button_input.checked=false;else button_input.checked=true;top$(button_input).change()}}if(_this.option_layout&&this.tagName==="LABEL")e.preventDefault()});var tooltip=document.querySelector("#"+Top.App.getCurrentPage().id+" .top-tooltip-text");top$(this).find(" .top-treeview-container .top-treeview-item").off("mouseenter").on("mouseenter",function(e){if(!Top.Util.__isBooleanTrue(_this.getAttribute("horizontal-scroll"))&&top$(this).hasOverflown()){tooltip.innerText=this.textContent;tooltip.style.display="inline-block";tooltip.style.left=e.clientX+10+"px";tooltip.style.top=e.clientY+10+"px"}if(this.querySelector(".top-treeview-edit_btn")){this.querySelector(".top-treeview-edit_btn").style.visibility="visible"}_this._index=0;_this.hoverNode=this.dataObj||_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"));if(typeof fnNodeHover==="function")fnNodeHover(e.originalEvent,Top.Dom.selectById(_this.id),_this.hoverNode);e.preventDefault()});top$(this).find(" .top-treeview-container .top-treeview-item").off("mouseleave").on("mouseleave",function(e){if(tooltip)tooltip.style.display="none";if(this.getElementsByClassName("top-treeview-edit_btn")[0]&&this.querySelector(".top-treeview-edit_btn .top-treeview-edit_nav").style.display!=="block"){this.getElementsByClassName("top-treeview-edit_btn")[0].style.visibility="hidden";this.getElementsByClassName("top-treeview-edit_btn")[0].classList.remove("selected");this.querySelector(".top-treeview-edit_btn .top-treeview-edit_nav").style.display="none"}e.preventDefault()});if(this.option.event.onNodecontextmenu){top$(this).find(" .top-treeview-container .top-treeview-item").off("contextmenu").on("contextmenu",function(e){var result=true;if(typeof _this.option.event.onNodecontextmenu==="function"){result=_this.option.event.onNodecontextmenu(e.originalEvent,Top.Dom.selectById(_this.id),this.dataObj)}if(result===false){e.preventDefault()}})}var allNodeHasChecked=top$(_this.querySelectorAll(".top-treeview-check:checked")).parent().find("> .top-treeview-item");_this.checkedNode=[];for(var index=0;index<allNodeHasChecked.length;index++){var item=allNodeHasChecked[index];if(_this.userNodes){if(item.dataObj!==undefined){_this.checkedNode.push(item.dataObj)}else{_this.checkedNode.push(_this.__findNodeById(_this.nodes,item.id))}}else if(_this.items){_this._index=0;_this.checkedNode.push(_this.__findItemByField(_this.itemData,item.getAttribute("data-field"),item.innerText,item.getAttribute("data-index")))}}for(var k=0;k<_this.checkedNode.length;k++){var item=_this.checkedNode[k];item.checked=true}top$(this).find(" .top-treeview-list .top-treeview-check:not([disabled])").off("change").on("change",function(e){if(_this.option.node.checkInherit){var parent_list=this.parentNode;if(parent_list.classList.contains("parent")){var children_check=parent_list.querySelectorAll("ul.top-treeview-children_nav .top-treeview-check:not([disabled])");for(var i=0;i<children_check.length;i++){if(children_check[i].parentNode.parentNode.parentNode.querySelector(".top-treeview-check").getAttribute("disabled")==null){if(this.checked){top$(children_check[i]).prop("checked",true)}else{top$(children_check[i]).prop("checked",false)}}var checkedNode=children_check[i].nextSibling.nextSibling.dataObj;if(checkedNode)checkedNode.checked=this.checked}}if(!parent_list.classList.contains("level0")&&_this.option.node.checkInheritParent){var parents_list=top$(this).parents("li.top-treeview-list.parent");if(this.checked){for(var i=0;i<parents_list.length;i++){var level=parents_list[i].className.match(/[0-9]+/g)[0];level=parseInt(level);var sibling_check=parents_list[i].querySelectorAll("ul.top-treeview-children_nav > li.level"+(level+1)+"> .top-treeview-check");for(var j=0;j<sibling_check.length;j++){if(sibling_check[j].checked)continue;else break}if(j===sibling_check.length){var parent_check=top$(parents_list[i]).find("> .top-treeview-check:not([disabled])")[0];if(parent_check&&!parent_check.checked){parent_check.checked=true;var checkedNode=parent_check.nextSibling.nextSibling.id.dataObj;if(checkedNode)checkedNode.checked=true}}}}else{for(var i=0;i<parents_list.length;i++){var parent_check=top$(parents_list[i]).find("> .top-treeview-check:not([disabled])")[0];if(parent_check&&parent_check.checked){parent_check.checked=false;var checkedNode=parent_check.nextSibling.nextSibling.dataObj;if(checkedNode)checkedNode.checked=false}}}}}var allNodeHasChecked=top$(_this.querySelectorAll(".top-treeview-check:checked")).parent().find("> .top-treeview-item");_this.checkedNode=[];for(var index=0;index<allNodeHasChecked.length;index++){var item=allNodeHasChecked[index];if(_this.userNodes){_this.checkedNode.push(item.dataObj)}else if(_this.items){_this._index=0;_this.checkedNode.push(_this.__findItemByField(_this.itemData,item.getAttribute("data-field"),item.innerText,item.getAttribute("data-index")))}}var thisCheckedNode=this.nextSibling.nextSibling.dataObj;if(thisCheckedNode)thisCheckedNode.checked=this.checked;if(typeof fnNodeCheck==="function")fnNodeCheck(e.originalEvent,Top.Dom.selectById(_this.id),thisCheckedNode);e.preventDefault()});top$(this).find(" .top-treeview-item .top-treeview-edit_btn").off("mouseenter").on("mouseenter",function(e){e.stopPropagation()});top$(this).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-edit_nav").off("mouseenter").on("mouseenter",function(e){e.stopPropagation()});top$(this).find(" .top-treeview-item .top-treeview-edit_btn").off("click").on("click",function(e){e.preventDefault();var navElem=this.querySelector(".top-treeview-edit_nav");if(this.classList.contains("selected")){this.classList.remove("selected");navElem.style.display="none";navElem.style.top="";navElem.style.left="";navElem.style.right=""}else{this.classList.add("selected");navElem.style.display="block";navElem.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height+"px";navElem.style.left=this.getBoundingClientRect().left+"px";var calcedRight=navElem.getBoundingClientRect().right-document.documentElement.width;if(calcedRight>0){calcedRight=Math.abs(this.getBoundingClientRect().right-document.documentElement.width);navElem.style.left="";navElem.style.right=calcedRight+"px"}}e.stopPropagation()});top$(this).find(" .top-treeview-item .top-treeview-edit_btn").off("dblclick").on("dblclick",function(e){e.stopPropagation()});top$(this).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-edit").off("click").on("click",function(e){e.preventDefault();if(_this.option.view.layout===null){var thisItem=this.parentNode.parentNode.parentNode;for(var i=0;i<thisItem.childNodes.length;i++){if(thisItem.childNodes[i].nodeName==="#text"){var thisItemText=thisItem.childNodes[i].nodeValue}}var editBtn=this.parentNode.parentNode;var textElement=editBtn.nextSibling;textElement.parentNode.removeChild(textElement);var itemInput=document.createElement("input");itemInput.classList.add("top-treeview-edit_input");itemInput.setAttribute("type","text");itemInput.setAttribute("value",thisItemText);thisItem.appendChild(itemInput);var $inputElement=top$(thisItem).find(".top-treeview-edit_input");var inputLength=$inputElement.val().length||5;$inputElement.attr("size",inputLength);$inputElement.focus();$inputElement.on("dblclick",function(e){e.stopPropagation()}).on("mousedown",function(e){e.stopPropagation()}).on("keypress",function(e){if(e.keyCode===13){_this.editNodeText(thisItem.id,top$(this).val())}}).on("focusout",function(e){_this.editNodeText(thisItem.id,top$(this).val())})}});if(_this.option.node.deletable===true||_this.option.node.deletable==="true")top$(this).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-delete").off("click").on("click",function(e){var thisItem=this.parentNode.parentNode.parentNode;var toBeRemovedData=thisItem.dataObj;var result=true;if(typeof _this.option.event.onNodedelete==="function"){result=_this.option.event.onNodedelete(Top.Dom.selectById(_this.id),toBeRemovedData)}if(result!==false){_this.removeNodes(thisItem.id)}});top$(this).find(" .top-treeview-item .top-treeview-edit_btn li:not(.top-treeview-delete):not(.top-treeview-edit)").off("click").on("click",function(e){var thisCustomMenuKey=this.className.replace("top-treeview-","");var nodeItem=top$(this).closest(".top-treeview-item")[0];var fnSelect=typeof _this.option.view.menu[thisCustomMenuKey]==="function"?_this.option.view.menu[thisCustomMenuKey]:Top.Util.namespace(_this.option.view.menu[thisCustomMenuKey],_this);if(typeof fnSelect==="function"){fnSelect(Top.Dom.selectById(_this.id),nodeItem.dataObj)}});if(this.option.node.draggable==="true"||this.option.node.draggable===true){var fnNodeDrag=this.option.event.onNodedrag;var fnNodeDrop=this.option.event.onNodedrop;var fnNodeDragstart=this.option.event.onNodedragstart;var fnNodeDragend=this.option.event.onNodedragend;var fnNodeDragenter=this.option.event.onNodedragenter;var fnNodeDragover=this.option.event.onNodedragover;var fnNodeDragleave=this.option.event.onNodedragleave;var selected=null;var coordinates=[],mousex,mousey;var droppedElement=null;var afterElement=null;var treeContainer=_this.querySelector(" .top-treeview-container");var shadowRoot=this.querySelector(".top-treeview-root");top$(document).on("dragover","#"+this.id+" *",function(e){if(e.originalEvent.preventDefault){e.originalEvent.preventDefault()}e.originalEvent.dataTransfer.dropEffect="move";if(typeof fnNodeDragover==="function")fnNodeDragover(e.originalEvent,Top.Dom.selectById(_this.id))});top$(document).off("dragleave","#"+this.id+" .top-treeview-list").on("dragleave","#"+this.id+" .top-treeview-list",function(e){if(e.originalEvent.preventDefault){e.originalEvent.preventDefault()}e.stopPropagation();if(typeof fnNodeDragleave==="function")fnNodeDragleave(e.originalEvent,Top.Dom.selectById(_this.id))});top$(document).off("dragenter","#"+this.id+" .top-treeview-list").on("dragenter","#"+this.id+" .top-treeview-list",function(e){if(e.originalEvent.preventDefault){e.originalEvent.preventDefault()}e.stopPropagation();if(typeof fnNodeDragenter==="function")fnNodeDragenter(e.originalEvent,Top.Dom.selectById(_this.id))});top$(document).off("dragstart","#"+this.id+" .top-treeview-list").on("dragstart","#"+this.id+" .top-treeview-list",function(e){this.ondrag=_moveElem;this.ondragend=_destroy;selected=this;top$(_this.querySelectorAll(" .top-treeview-item")).each(function(){var lefttop=top$(this).offset();coordinates.push({dom:top$(this),left:lefttop.left,top:lefttop.top,right:lefttop.left+top$(this).width(),bottom:lefttop.top+top$(this).height()})});var thisInnerHTML=this.querySelector(".top-treeview-item").innerHTML;var draggedNode_span=document.querySelector(".top-treeview-draggedNode");draggedNode_span.innerHTML=thisInnerHTML;draggedNode_span.style.width=this.querySelector(".top-treeview-item").offsetWidth+"px";if(!Top.Util.Browser.isIE())e.originalEvent.dataTransfer.setDragImage(draggedNode_span,0,0);e.originalEvent.dataTransfer.effectAllowed="move";e.stopPropagation();if(typeof fnNodeDragstart==="function"){var event=e.originalEvent;event.targetNode=this.querySelector(".top-treeview-item").dataObj;fnNodeDragstart(event,Top.Dom.selectById(_this.id),event.targetNode)}});function getItemOffset(elem,type){var offset=0;do{if(elem===shadowRoot)break;if(type==="top"){if(!isNaN(elem.offsetTop)){offset+=elem.offsetTop}}else if(type==="left"){if(!isNaN(elem.offsetLeft)){offset+=elem.offsetLeft}}}while(elem=elem.offsetParent);return offset}function _moveElem(e){if(selected==null)return;var draggedNode_span=document.querySelector(".top-treeview-draggedNode");var dropLine_span=_this.querySelector(" .top-treeview-dropline");if(Top.Util.Browser.isIE())draggedNode_span.style.display="none";else draggedNode_span.style.display="inline-block";draggedNode_span.style.top=e.pageY+5+"px";draggedNode_span.style.left=e.pageX+5+"px";for(var i=0;i<coordinates.length;i++){if(mousex>=coordinates[i].left&&mousex<=coordinates[i].right){if(mousey>=coordinates[i].top&&mousey<=coordinates[i].bottom-5){coordinates[i].dom.addClass("over");dropLine_span.style.display="none"}else{coordinates[i].dom.removeClass("over");if(mousey<coordinates[i].top){if(coordinates[i-1]&&coordinates[i-1].top===0){var parentBottom=coordinates[i-1].dom.parent().parent().parent().offset().top+coordinates[i-1].dom.parent().parent().parent().height();if(parentBottom<mousey){afterElement=coordinates[i].dom;dropLine_span.style.display="inline-block";dropLine_span.style.width=afterElement.width()+"px";dropLine_span.style.top=getItemOffset(coordinates[i].dom[0],"top")-2+"px";dropLine_span.style.left=getItemOffset(coordinates[i].dom[0],"left")+"px"}}else if(coordinates[i-1]&&mousey>coordinates[i-1].bottom-5){afterElement=coordinates[i].dom;dropLine_span.style.display="inline-block";dropLine_span.style.width=afterElement.width()+"px";dropLine_span.style.top=getItemOffset(coordinates[i].dom[0],"top")-2+"px";dropLine_span.style.left=getItemOffset(coordinates[i].dom[0],"left")+"px"}}}}if(coordinates[i].dom.hasClass("over")&&selected.querySelector(".top-treeview-item")!==coordinates[i].dom[0]){droppedElement=coordinates[i].dom}}var overItem=document.querySelector("#"+_this.id+" .top-treeview-item.over");if(overItem===null)droppedElement=null;if(droppedElement!==null)afterElement=null;mousex=e.pageX;mousey=e.pageY;if(typeof fnNodeDrag==="function")fnNodeDrag(e.originalEvent,Top.Dom.selectById(_this.id),this.querySelector(".top-treeview-item").dataObj);if(!Top.Util.Browser.isIE())e.preventDefault()}function _destroy(e){if(selected==null)return;var tempElement=null;for(var i=0;i<coordinates.length;i++){coordinates[i].dom.removeClass("over")}var selectedDataObj=selected.querySelector(".top-treeview-item").dataObj;var dropReturn;var targetNode=null;if(typeof fnNodeDrop==="function"){if(droppedElement){targetNode=droppedElement[0].dataObj}else if(afterElement){targetNode=afterElement.closest("ul").prev()[0]===undefined?null:afterElement.closest("ul").prev()[0].dataObj}dropReturn=fnNodeDrop(e,Top.Dom.selectById(_this.id),selectedDataObj,targetNode)}if(dropReturn===false||dropReturn==="false"){document.querySelector(".top-treeview-draggedNode").style.display="none";_this.querySelector(".top-treeview-dropline").style.display="none";return false}if(droppedElement!==null||afterElement!==null){var selectedChildrenItem=selected.querySelectorAll(".top-treeview-item");for(var i=0;i<selectedChildrenItem.length;i++){if(droppedElement&&selectedChildrenItem[i]===droppedElement[0]){droppedElement=null;break}if(afterElement&&selectedChildrenItem[i]===afterElement[0]){afterElement=null;break}}}if(droppedElement!==null){if(droppedElement.parent().hasClass("child")){var droppedElementDataobj=droppedElement[0].dataObj;droppedElement.parent().removeClass("child");droppedElement.parent().addClass("parent");droppedElement.parent().prepend('<input type="checkbox" class="top-treeview-button"><i></i>');droppedElement.parent().find("> .top-treeview-button").prop("checked",false);droppedElement.parent().append("<ul class='top-treeview-children_nav'></ul>");tempElement=droppedElement.parent();droppedElement.replaceWith("<label id='"+droppedElement.attr("id")+"' class='top-treeview-item'>"+droppedElement.html()+"</label>");droppedElement=tempElement.find("> .top-treeview-item");droppedElement[0].dataObj=droppedElementDataobj;var droppedIcon=droppedElement.find("> .top-treeview-icon");var droppedImage=droppedElement.find("> .top-treeview-image");if(droppedIcon&&droppedIcon.attr("i-type")==="union"){droppedIcon.removeClass(_this.option.view.childIcon).addClass(_this.option.view.groupIcon)}else if(droppedImage&&droppedImage.attr("i-type")==="union"){droppedImage[0].style="background:url("+_this.option.view.groupImage+") 0 0 no-repeat; background-size:contain;"}}if(selected.parentNode.childElementCount===1&&selected.parentNode.previousSibling!==droppedElement[0]){tempElement=selected.parentNode.parentNode;var tempElementDataobj=tempElement.querySelector(".top-treeview-item").dataObj;tempElement.classList.remove("parent");tempElement.classList.add("child");top$(tempElement).find("> .top-treeview-button").remove();top$(tempElement).find("> i").remove();top$(tempElement).find("> ul").remove();top$(tempElement).find("> .top-treeview-item").replaceWith("<a id='"+top$(tempElement).find("> .top-treeview-item").attr("id")+"' class='top-treeview-item'>"+top$(tempElement).find("> .top-treeview-item").html()+"</a>");tempElement.querySelector(".top-treeview-item").dataObj=tempElementDataobj;var tempIcon=top$(tempElement).find("> .top-treeview-item .top-treeview-icon");var tempImage=top$(tempElement).find("> .top-treeview-item .top-treeview-image");if(tempIcon&&tempIcon.attr("i-type")==="union"){tempIcon.removeClass(_this.option.view.groupIcon).addClass(_this.option.view.childIcon)}else if(tempImage&&tempImage.attr("i-type")==="union"){tempImage[0].style="background:url("+_this.option.view.childImage+") 0 0 no-repeat; background-size:contain;"}tempElement=null}var copySelected=selected.cloneNode(true);var selectedDataObj=selected.querySelector(".top-treeview-item").dataObj;selected.parentNode.removeChild(selected);var level=droppedElement.parent()[0].className.match(/[0-9]+/g)[0];level=parseInt(level)+1;copySelected.className=copySelected.className.replace(/[0-9]+/g,level);var childrenList=copySelected.querySelectorAll(".top-treeview-list");var realChildrenList=selected.querySelectorAll(".top-treeview-list");for(var k=0;k<childrenList.length;k++){level=childrenList[k].parentNode.parentNode.className.match(/[0-9]+/g)[0];level=parseInt(level)+1;childrenList[k].className=childrenList[k].className.replace(/[0-9]+/g,level);childrenList[k].querySelector(".top-treeview-item").dataObj=realChildrenList[k].querySelector(".top-treeview-item").dataObj}droppedElement.parent().find("> ul").append(copySelected);_this.__setNodeIndex();_this.attachEventHandler();top$(copySelected).find(".top-treeview-item").mouseleave();copySelected.querySelector(".top-treeview-item").dataObj=selectedDataObj;if(_this.nodes){var selectedId=copySelected.querySelector(".top-treeview-item").id;var parentId=droppedElement[0].id;_this.__changeNodesObjectByDragging(_this.nodes,selectedId,parentId,null);_this.updateData("nodes")}}else if(afterElement!==null){var isAfterElementChagned=false;if(selected.parentNode.childElementCount===1){tempElement=selected.parentNode.parentNode;var tempElementDataobj=tempElement.querySelector(".top-treeview-item").dataObj;if(tempElement===afterElement[0].parentNode){isAfterElementChagned=true}tempElement.classList.remove("parent");tempElement.classList.add("child");top$(tempElement).find("> .top-treeview-button").remove();top$(tempElement).find("> i").remove();top$(tempElement).find("> ul").remove();top$(tempElement).find("> .top-treeview-item").replaceWith("<a id='"+top$(tempElement).find("> .top-treeview-item").attr("id")+"' class='top-treeview-item'>"+top$(tempElement).find("> .top-treeview-item").html()+"</a>");tempElement.querySelector(".top-treeview-item").dataObj=tempElementDataobj;var tempIcon=top$(tempElement).find("> .top-treeview-item .top-treeview-icon");var tempImage=top$(tempElement).find("> .top-treeview-item .top-treeview-image");if(tempIcon&&tempIcon.attr("i-type")==="union"){tempIcon.removeClass(_this.option.view.groupIcon).addClass(_this.option.view.childIcon)}else if(tempImage&&tempImage.attr("i-type")==="union"){tempImage[0].style="background:url("+_this.option.view.childImage+") 0 0 no-repeat; background-size:contain;"}if(isAfterElementChagned)afterElement=top$(tempElement).find(" > .top-treeview-item");tempElement=null}var copySelected=selected.cloneNode(true);var selectedDataObj=selected.querySelector(".top-treeview-item").dataObj;var level=afterElement[0].parentNode.className.match(/[0-9]+/g)[0];copySelected.className=copySelected.className.replace(/[0-9]+/g,level);var childrenList=copySelected.querySelectorAll(".top-treeview-list");var realChildrenList=selected.querySelectorAll(".top-treeview-list");for(var k=0;k<childrenList.length;k++){level=childrenList[k].parentNode.parentNode.className.match(/[0-9]+/g)[0];level=parseInt(level)+1;childrenList[k].className=childrenList[k].className.replace(/[0-9]+/g,level);childrenList[k].querySelector(".top-treeview-item").dataObj=realChildrenList[k].querySelector(".top-treeview-item").dataObj}selected.parentNode.removeChild(selected);top$(copySelected).insertBefore(afterElement.parent());_this.__setNodeIndex();_this.attachEventHandler();top$(copySelected).find(".top-treeview-item").mouseleave();copySelected.querySelector(".top-treeview-item").dataObj=selectedDataObj;if(_this.nodes){var selectedId=copySelected.querySelector(".top-treeview-item").id;if(afterElement.parent().parent()[0].previousSibling)var parentId=afterElement.parent().parent()[0].previousSibling.id;var nextSId=afterElement[0].id;_this.__changeNodesObjectByDragging(_this.nodes,selectedId,parentId,nextSId);_this.updateData("nodes")}}selected=null;mousex=0;mousey=0;coordinates=[];droppedElement=null;tempElement=null;afterElement=null;document.querySelector(".top-treeview-draggedNode").style.display="none";_this.querySelector(".top-treeview-dropline").style.display="none";e.preventDefault()}}},__setOptions:function(){if(this.option.node.draggable==="true"||this.option.node.draggable===true){var allListItem=this.querySelectorAll(".top-treeview-list");for(var o=0;o<allListItem.length;o++){allListItem[o].draggable=true}var draggedNode_span=document.querySelector(".top-treeview-draggedNode");if(!draggedNode_span){var dragedNode=document.createElement("span");dragedNode.classList.add("top-treeview-draggedNode");document.body.appendChild(dragedNode)}var tmp_dropline=document.createElement("span");tmp_dropline.classList.add("top-treeview-dropline");this.childRoot.appendChild(tmp_dropline)}if(this.userNodes)this.__setDataObjToItem();this.__setNodeIndex()},__setDataObjToItem:function(parentNode,level,parentElement){if(!parentNode)parentNode=this.userNodes;if(!level)level=0;if(!parentElement)parentElement=this;var items=parentElement.querySelectorAll(".top-treeview-list.level"+level+" > .top-treeview-item");for(var i=0;i<items.length;i++){items[i].dataObj=this.__findNodeById(parentNode,items[i].id);if(parentNode[i]&&parentNode[i].children){this.__setDataObjToItem(parentNode[i].children,level+1,items[i].parentNode)}}},__changeNodesObjectByDragging:function(nodes,childId,parentId,nextSId){var selectedNode,parentNode,nextSIndex;selectedNode=findNodeById(nodes,childId,true);parentNode=findNodeById(nodes,parentId,false);nextSIndex=findIndexById(nodes,nextSId);if(parentNode&&selectedNode){setChildrenInParentNode(parentNode,selectedNode,nextSIndex);return}if(parentNode===undefined){setRootSiblingNode(selectedNode,nextSIndex)}function setRootSiblingNode(selectedNode,nextSIndex){nodes.splice(nextSIndex,0,selectedNode)}function findNodeById(obj,id,isFromChild){var node;for(var i=0,len=obj.length;i<len;i++){if(obj[i].id===id){node=obj[i];if(isFromChild){obj.splice(i,1)}return node}else if(!obj[i].id&&obj[i].value===id){node=obj[i];if(isFromChild){obj.splice(i,1)}return node}else if(!obj[i].id&&!obj[i].value&&obj[i].text===id){node=obj[i];if(isFromChild){obj.splice(i,1)}return node}else{if(obj[i].children){node=findNodeById(obj[i].children,id,isFromChild);if(node)return node}}}return node}function findIndexById(obj,id){var index=null;for(var i=0,len=obj.length;i<len;i++){if(obj[i].id===id){index=i;return index}else if(!obj[i].id&&obj[i].value===id){index=i;return index}else if(!obj[i].id&&!obj[i].value&&obj[i].text===id){index=i;return index}else{if(obj[i].children){index=findIndexById(obj[i].children,id);if(index!==null)return index}}}return index}function setChildrenInParentNode(parentNode,childNode,nextSIndex){if(parentNode.children===undefined)parentNode.children=[];if(nextSIndex!==null){parentNode.children.splice(nextSIndex,0,childNode)}else{parentNode.children.push(childNode)}if(childNode.path!==undefined){childNode.path=parentNode.path?parentNode.path+"."+parentNode.id:parentNode.id}}},__setNodeIndex:function(){var items=this.querySelectorAll(".top-treeview-item");var topWidget=/^TOP-[a-zA-Z]*/;for(var i=0;i<items.length;i++){items[i].setAttribute("data-index",i);var treeChildren=items[i].querySelectorAll("*");var topWidgets=[];for(var j=0;j<treeChildren.length;j++){if(topWidget.test(treeChildren[j].tagName))topWidgets.push(treeChildren[j])}for(var j=0;j<topWidgets.length;j++){var _item=topWidgets[j];_item.id=_item.id+"_"+i;if(_item.tagName==="TOP-RADIOBUTTON"){if(_item.getAttribute("group-id")){_item.setAttribute("group-id",_item.getAttribute("group-id")+"_"+i)}}}if(items[i].previousSibling&&items[i].previousSibling.tagName==="LABEL"){var checkIndexReg=new RegExp(i+"$","g");if(!checkIndexReg.test(items[i].previousSibling.getAttribute("for"))){items[i].previousSibling.previousSibling.setAttribute("id",this.id+"_check_"+i);items[i].previousSibling.setAttribute("for",this.id+"_check_"+i)}}}},__reRender:function(){if(this.__initialized!==true)return;this.__initialize();if(this.selectedNode instanceof Array&&this.checkedNode.length>0){var selectedNodeIdArray=[];for(var i=0;i<this.selectedNode.length;i++){selectedNodeIdArray.push(this.selectedNode[i].id)}this.__selectNode(selectedNodeIdArray)}else if(this.selectedNode&&this.checkedNode.id){this.__selectNode(this.selectedNode.id)}if(this.checkedNode instanceof Array&&this.checkedNode.length>0){var checkedNodeIdArray=[];for(var i=0;i<this.checkedNode.length;i++){checkedNodeIdArray.push(this.checkedNode[i].id)}this.__checkNode(checkedNodeIdArray)}else if(this.checkedNode&&this.checkedNode.id){this.__checkNode(this.checkedNode.id)}},__updateToggleClickCount:function(){this.option.node.toggleClickCount=this.toggleClickCount},expandNode:function(nodeId,notRender){if(this.virtualScroll===true||this.virtualScroll==="true"){findExpand(this.nodes);if(notRender!==true){this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}}else{var selectedNode=top$(this).find("#"+nodeId+".top-treeview-item")[0];if(selectedNode===undefined)return;var button_input=selectedNode.parentNode.querySelector(".top-treeview-button");var thisNodeData=selectedNode.dataObj;selectedNode.parentNode.classList.remove("collapse");selectedNode.parentNode.classList.add("expand");if(selectedNode.nextSibling)selectedNode.nextSibling.style.display="block";top$(button_input).prop("checked",false);this.__dispatchEvent(new CustomEvent("expand",{detail:{data:thisNodeData}}))}},collapseNode:function(nodeId,notRender){if(this.virtualScroll===true||this.virtualScroll==="true"){findCollapse(this.nodes);if(notRender!==true){this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}}else{var selectedNode=top$(this).find("#"+nodeId+".top-treeview-item")[0];if(selectedNode===undefined)return;var button_input=selectedNode.parentNode.querySelector(".top-treeview-button");var thisNodeData=selectedNode.dataObj;selectedNode.parentNode.classList.remove("expand");selectedNode.parentNode.classList.add("collapse");if(selectedNode.nextSibling)selectedNode.nextSibling.style.display="none";top$(button_input).prop("checked",true);this.__dispatchEvent(new CustomEvent("collapse",{detail:{data:thisNodeData}}))}function findCollapse(node){for(var i=0;i<node.length;i++){if(node[i].children!==undefined){findCollapse(node[i].children,nodeId)}if(node[i].id===nodeId){if(node[i].children!==undefined)setCollapse(node[i].children)}}}function setCollapse(node){for(var i=0;i<node.length;i++){node[i].isExpanded=false;if(node[i].children!==undefined)setCollapse(node[i].children)}}},expandAll:function(){if(this.virtualScroll===true||this.virtualScroll==="true"){expandVirtualNode(this.nodes);this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}else{top$(this.querySelectorAll(".top-treeview-list.parent")).removeClass("collapse");top$(this.querySelectorAll(".top-treeview-list.parent")).addClass("expand");top$(this.querySelectorAll(".top-treeview-list > ul")).css("display","block");
top$(this.querySelectorAll(".top-treeview-button")).prop("checked",false)}this.__dispatchEvent(new CustomEvent("expand",{detail:{data:this.userNodes}}));function expandVirtualNode(node){for(var i=0;i<node.length;i++){node[i].isExpanded=true;if(node[i].children!==undefined)expandVirtualNode(node[i].children)}}},collapseAll:function(){if(this.virtualScroll===true||this.virtualScroll==="true"){collapseVirtualNode(this.nodes,true);this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}else{top$(this.querySelectorAll(".top-treeview-list.parent")).removeClass("expand");top$(this.querySelectorAll(".top-treeview-list.parent")).addClass("collapse");top$(this.querySelectorAll(".top-treeview-list ul")).css("display","none");top$(this.querySelectorAll(".top-treeview-button")).prop("checked",true)}this.__dispatchEvent(new CustomEvent("collapse",{detail:{data:this.userNodes}}));function collapseVirtualNode(node,isRoot){for(var i=0;i<node.length;i++){if(isRoot===false)node[i].isExpanded=false;else node[i].isExpanded=true;if(node[i].children!==undefined)collapseVirtualNode(node[i].children,false)}}},getItemData:function(){return this.itemData},getClickedItemIndex:function(){return this.clickedItemIndex},getSelectedItemIndex:function(){return this.selectedItemIndex},addNodes:function(parentId,newNodes,index){var _this=this;if(parentId===undefined){console.error("parameters is not defined!");return-1}if(newNodes===undefined){console.error("new node is not defined!");return-2}if(this.virtualScroll!=="true"&&this.virtualScroll!==true){if(parentId!==null){var parentElem=top$(this).find("#"+parentId+".top-treeview-item")[0];var parentLevel=parseInt(parentElem.parentNode.className.match(/[0-9]+/g)[0]);var parentElemDataObj=parentElem.dataObj;var appenString="";if(newNodes instanceof Array)appendString=this.makeTreeNodes(newNodes,parentLevel+1);else{var nodesArray=[];nodesArray.push(newNodes);appendString=this.makeTreeNodes(nodesArray,parentLevel+1)}var madeNodes=document.createElement("div");madeNodes.innerHTML=appendString;for(var k=0;k<madeNodes.children.length;k++){this.createHtmlObjects(madeNodes.children[k])}parentElem.parentNode.classList.contains("parent");if(parentElem.parentNode.classList.contains("parent")){var parent_nav=parentElem.parentNode.querySelector("ul.top-treeview-children_nav");if(index!==undefined&&parseInt(index)>=parent_nav.childElementCount)index=undefined;if(index===undefined){while(madeNodes.firstChild){parent_nav.appendChild(madeNodes.firstChild)}}else{while(madeNodes.firstChild){parent_nav.insertBefore(madeNodes.firstChild,parent_nav.children[index])}}}else{index=undefined;if(parentElem.parentNode!==undefined||parentElem.parentNode!==null){parentElem.parentNode.classList.add("parent");parentElem.parentNode.classList.remove("child");var tmp_input=document.createElement("input");tmp_input.setAttribute("type","checkbox");tmp_input.classList.add("top-treeview-button");var tmp_i=document.createElement("i");tmp_input.appendChild(tmp_i);parentElem.parentNode.insertBefore(tmp_input,parentElem.parentNode.firstChild);top$(parentElem.parentNode).find("> .top-treeview-button").prop("checked",false);var tmp_ul=document.createElement("ul");tmp_ul.classList.add("top-treeview-children_nav");parentElem.parentNode.appendChild(tmp_ul);while(madeNodes.firstChild){tmp_ul.appendChild(madeNodes.firstChild)}}var tempElement=parentElem.parentNode;top$(parentElem).replaceWith("<label id='"+top$(parentElem).attr("id")+"' class='top-treeview-item'>"+top$(parentElem).html()+"</label>");parentElem=top$(tempElement).find("> .top-treeview-item")[0];parentElem.dataObj=parentElemDataObj;var parentElemIcon=top$(parentElem).find("> .top-treeview-icon");var parentElemImage=top$(parentElem).find("> .top-treeview-image");if(parentElemIcon&&parentElemIcon.attr("i-type")==="union"){parentElemIcon.removeClass(this.option.view.childIcon).addClass(this.option.view.groupIcon)}else if(parentElemImage&&parentElemImage.attr("i-type")==="union"){parentElemImage[0].style="background:url("+this.option.view.groupImage+") 0 0 no-repeat; background-size:contain;"}}this.createdItemWidgetAttachedCallback()}}if(this.nodes){if(parentId!==null)this.__changeNodesObjectByAdding(this.nodes,newNodes,parentId,index);else this.nodes.push(newNodes);this.updateData("nodes");this.renderTreeViewByNodes()}if(this.userNodes&&this.virtualScroll!==true&&this.virtualScroll!=="true"){if(parentId!==null)setDataObjToNewNodes(newNodes,parentElemDataObj);function setDataObjToNewNodes(thisData,parentObj){if(thisData instanceof Array){for(var i=0;i<thisData.length;i++){setDataObjToNewNodes(thisData[i],parentObj)}}else{var parentElem=top$(_this).find("#"+parentId+".top-treeview-item")[0];var childrenNode=top$(parentElem.parentNode).find("#"+thisData.id)[0];if(!thisData.hasOwnProperty("path")){thisData.path=parentObj.path?parentObj.path+"."+parentObj.id:parentObj.id}childrenNode.dataObj=thisData;if(thisData.children){setDataObjToNewNodes(thisData.children,thisData)}}}}this.__setNodeIndex();this.__initialize();this.attachEventHandler()},removeNodes:function(nodeId){if(nodeId===undefined){console.error("node id is not defined!");return false}if(nodeId instanceof Array){for(var i=0;i<nodeId.length;i++){this.removeNodes(nodeId[i])}}else{var removedNode=top$(this).find("#"+nodeId+".top-treeview-item")[0];if(removedNode===undefined){console.warn("cannot found node("+nodeId+") in treeview");return false}if(removedNode.parentNode.parentNode.childElementCount===1){tempElement=removedNode.parentNode.parentNode.parentNode;var parentElemDataObj=tempElement.querySelector(".top-treeview-item").dataObj;top$(tempElement).removeClass("parent");top$(tempElement).addClass("child");top$(tempElement).find("> .top-treeview-button").remove();top$(tempElement).find("> i").remove();top$(tempElement).find("> ul").remove();top$(tempElement).find("> .top-treeview-item").replaceWith("<a id='"+top$(tempElement).find("> .top-treeview-item").attr("id")+"' class='top-treeview-item' data-field='"+top$(tempElement).find("> .top-treeview-item").attr("data-field")+"'>"+top$(tempElement).find("> .top-treeview-item").html()+"</a>");var parentElem=top$(tempElement).find("> .top-treeview-item")[0];if(parentElem)parentElem.dataObj=parentElemDataObj;var tempIcon=top$(tempElement).find("> .top-treeview-item .top-treeview-icon");var tempImage=top$(tempElement).find("> .top-treeview-item .top-treeview-image");if(tempIcon&&tempIcon.attr("i-type")==="union"){tempIcon.removeClass(this.option.view.groupIcon).addClass(this.option.view.childIcon)}else if(tempImage&&tempImage.attr("i-type")==="union"){tempImage[0].style="background:url("+this.option.view.childImage+") 0 0 no-repeat; background-size:contain;"}tempElement=null}removedNode.parentNode.parentNode.removeChild(removedNode.parentNode)}if(this.nodes){this.__changeNodesObjectByRemoving(this.nodes,nodeId);this.updateData("nodes")}this.__setNodeIndex();this.attachEventHandler();return true},editNodeText:function(nodeId,text){if(this.virtualScroll===true||this.virtualScroll==="true"){findNode(this.nodes);function findNode(node){for(var i=0;i<node.length;i++){if(node[i].children!==undefined){findNode(node[i].children)}if(node[i].id===nodeId){node[i].text=text}}}}else{var editedNode=top$(this).find("#"+nodeId+".top-treeview-item")[0];if(editedNode===undefined)return;for(var i=0;i<editedNode.childNodes.length;i++){if(editedNode.childNodes[i].nodeName==="#text"){editedNode.childNodes[i].nodeValue=text}else if(editedNode.childNodes[i].tagName==="INPUT"&&editedNode.childNodes[i].className==="top-treeview-edit_input"){top$(editedNode.childNodes[i]).remove();var newTextElement=document.createTextNode(text);editedNode.appendChild(newTextElement)}}if(this.nodes){this.__changeNodesObjectByEditing(this.nodes,nodeId,text,"text");this.updateData("nodes")}var editedData=editedNode.dataObj;if(editedData&&editedData.text)editedData.text=text;if(typeof this.option.event.onNodeedit==="function")this.option.event.onNodeedit(Top.Dom.selectById(this.id),editedData,"text")}},editNodeId:function(nodeId,newId){var editedNode=top$(this).find("#"+nodeId+".top-treeview-item")[0];if(editedNode){editedNode.id=newId}if(this.nodes){this.__changeNodesObjectByEditing(this.nodes,nodeId,newId,"id");this.updateData("nodes")}var editedData=editedNode.dataObj;if(editedData&&editedData.id)editedData.id=newId;if(typeof this.option.event.onNodeedit==="function")this.option.event.onNodeedit(Top.Dom.selectById(this.id),editedData,"id")},__changeNodesObjectByAdding:function(nodes,newNodes,parentId,addedIndex){for(var i=0,len=nodes.length;i<len;i++){if(nodes[i].id==parentId){if(nodes[i].children&&nodes[i].children.length>0){var path=nodes[i].children[0].path;newNodes.path=path;if(newNodes instanceof Array){for(var j=0;j<newNodes.length;j++){if(addedIndex===undefined)nodes[i].children.push(newNodes[j]);else nodes[i].children.splice(addedIndex,0,newNodes[j])}}else{if(addedIndex===undefined)nodes[i].children.push(newNodes);else nodes[i].children.splice(addedIndex,0,newNodes)}}else{nodes[i].children=[];var path=nodes[i].path?nodes[i].path+"."+nodes[i].id:nodes[i].id;newNodes.path=path;if(newNodes instanceof Array){for(var j=0;j<newNodes.length;j++){if(addedIndex===undefined)nodes[i].children.push(newNodes[j]);else nodes[i].children.splice(addedIndex,0,newNodes[j])}}else{if(addedIndex===undefined)nodes[i].children.push(newNodes);else nodes[i].children.splice(addedIndex,0,newNodes)}}}else{if(nodes[i].children){this.__changeNodesObjectByAdding(nodes[i].children,newNodes,parentId,addedIndex)}}}},__changeNodesObjectByRemoving:function(nodes,nodeId){for(var i=0,len=nodes.length;i<len;i++){if(nodes[i].id==nodeId){nodes.splice(i,1);return}else{if(nodes[i].children){this.__changeNodesObjectByRemoving(nodes[i].children,nodeId)}}}},__changeNodesObjectByEditing:function(nodes,nodeId,newValue,type){for(var i=0,len=nodes.length;i<len;i++){if(nodes[i].id==nodeId){if(type==="text"){nodes[i].text=newValue}else if(type==="id"){nodes[i].id=newValue}}else{if(nodes[i].children){this.__changeNodesObjectByEditing(nodes[i].children,nodeId,newValue,type)}}}},getNodesByFilter:function(filter,parentNodeId,nodes){var ret=[];if(parentNodeId){var parentObj=this.__findNodeById(this.nodes,parentNodeId);if(parentObj&&!nodes){var nodes=parentObj.children}}else{if(!nodes)var nodes=this.nodes}if(nodes===undefined)return ret;if(typeof filter==="function"){for(var i=0;i<nodes.length;i++){if(filter(nodes[i])){ret.push(nodes[i])}if(nodes[i].children){var tempRet;tempRet=this.getNodesByFilter(filter,parentNodeId,nodes[i].children);if(tempRet&&tempRet.length>0){ret=ret.concat(tempRet)}}}}return ret},getItemsByFilter:function(filter,items){var ret=[];if(!items)var items=typeof this.items==="string"?Top.Util.namespace(this.items,this):this.items;if(typeof filter==="function"){if(items instanceof Array){for(var i=0,len=items.length;i<len;i++){if(filter(items[i])){ret.push(items[i])}for(var key in items[i]){if(typeof items[i][key]==="object"&&items[i][key].length>0){var tempRet;tempRet=this.getItemsByFilter(filter,items[i][key]);if(tempRet&&tempRet.length>0){ret=ret.concat(tempRet)}}}}}else if(items instanceof Object){if(filter(items)){ret.push(items)}for(var key in items){if(typeof items[key]==="object"&&items[key].length>0){var tempRet;tempRet=this.getItemsByFilter(filter,items[key]);if(tempRet&&tempRet.length>0){ret=ret.concat(tempRet)}}}}}return ret},__getNode:function(nodeId){var selectedNode;if(typeof nodeId==="string"){selectedNode=top$(this).find("#"+nodeId+".top-treeview-item")[0]}else if(typeof nodeId==="number"){selectedNode=this.querySelector(".top-treeview-item[data-index='"+nodeId+"']")}return selectedNode},__selectNode:function(node){var selectedNode;if(node instanceof Array){for(var i=0;i<node.length;i++){if(typeof node[i]==="string"){if(this.virtualScroll===true||this.virtualScroll==="true"){selectedNode=this.__findselectedId(this.nodes,node[i],null,"select");this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}else{selectedNode=top$(this).find("#"+node[i]+".top-treeview-item")[0]}}else if(typeof node[i]==="number"){selectedNode=this.querySelector(".top-treeview-item[data-index='"+node[i]+"']")}if(this.virtualScroll!==true&&this.virtualScroll!=="true")top$(selectedNode).trigger(top$.Event("click",{ctrlKey:true}))}}else{if(typeof node==="string"){if(this.virtualScroll===true||this.virtualScroll==="true"){selectedNode=this.__findselectedId(this.nodes,node,null,"select");this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes)}else{selectedNode=top$(this).find("#"+node+".top-treeview-item")[0]}}else if(typeof node==="number"){selectedNode=this.querySelector(".top-treeview-item[data-index='"+node+"']")}if(this.virtualScroll!==true&&this.virtualScroll!=="true"){top$(selectedNode).click()}}return selectedNode},__deselectNode:function(node){var _this=this;var selectedNode;if(node===undefined){var treeviewList=_this.querySelectorAll(".top-treeview-list.selected");for(var l=0;l<treeviewList.length;l++){if(treeviewList[l]!==null&&treeviewList[l]!==undefined)treeviewList[l].classList.remove("selected")}var treeviewItem=_this.querySelectorAll(".top-treeview-item.selected");for(var l=0;l<treeviewItem.length;l++){if(treeviewItem[l]!==null&&treeviewItem[l]!==undefined)treeviewItem[l].classList.remove("selected")}if(_this.selectedNode){_this.selectedNode=[]}}else{if(node instanceof Array){for(var i=0;i<node.length;i++){if(typeof node[i]==="string"){selectedNode=top$(this).find("#"+node[i]+".top-treeview-item.selected")[0]}else if(typeof node[i]==="number"){selectedNode=this.querySelector(".top-treeview-item.selected[data-index='"+node[i]+"']")}if(selectedNode){selectedNode.classList.remove("selected");selectedNode.parentNode.classList.remove("selected");if(_this.selectedNode){if(_this.selectedNode instanceof Array){for(var j=0;j<_this.selectedNode.length;j++){if(_this.selectedNode[j]===selectedNode.dataObj){_this.selectedNode.splice(j,1)}}}else{_this.selectedNode=[]}}}}}else{if(typeof node==="string"){selectedNode=top$(this).find("#"+node+".top-treeview-item.selected")[0]}else if(typeof node==="number"){selectedNode=this.querySelector(".top-treeview-item.selected[data-index='"+node+"']")}if(selectedNode){selectedNode.classList.remove("selected");selectedNode.parentNode.classList.remove("selected");if(_this.selectedNode){if(_this.selectedNode instanceof Array){for(var j=0;j<_this.selectedNode.length;j++){if(_this.selectedNode[j]===selectedNode.dataObj){_this.selectedNode.splice(j,1)}}}else{_this.selectedNode=[]}}}}}},__getCheckedNode:function(){if(this.virtualScroll==="true"||this.virtualScroll===true){var checkNodes=new Array;childGetCheckNode(this.nodes||this.itemData);return checkNodes;function childGetCheckNode(node){for(var i=0;i<node.length;i++){if(node[i].checked===true||node[i].checked==="true")checkNodes.push(node[i]);if(node[i].children!==undefined&&node[i].children.length>0)childGetCheckNode(node[i].children)}}}else{return this.checkedNode}},__checkAll:function(checked){var nodes=top$(this).find(".top-treeview-item");for(var i=0;i<nodes.length;i++){var node=nodes[i];checkElement=node.parentNode.querySelector(".top-treeview-check");if(checked!==checkElement.checked){top$(checkElement).click()}}},__checkNode:function(nodeId,checked){if(checked===undefined)checked=true;if(nodeId===undefined)return;var _this=this;var toBeCheckedNode,checkElement,checkStatus;if(nodeId instanceof Array){for(var i=0;i<nodeId.length;i++){if(typeof nodeId[i]==="string"){toBeCheckedNode=top$(this).find("#"+nodeId[i]+".top-treeview-item")[0]}else if(typeof nodeId[i]==="number"){toBeCheckedNode=this.querySelector(".top-treeview-item[data-index='"+nodeId[i]+"']")}checkElement=toBeCheckedNode.parentNode.querySelector(".top-treeview-check");checkStatus=checkElement.checked;if(checked!==checkStatus)top$(checkElement).click()}}else{if(typeof nodeId==="string"){if(this.virtualScroll==="true"||this.virtualScroll===true){findId(this.nodes||this.itemData,nodeId,checked);this.flatNodes=this.__makeFlatNode(new Array,this.nodes||this.itemData);this.__createViewport(this.flatNodes.length,this.flatNodes)}else toBeCheckedNode=top$(this).find("#"+nodeId+".top-treeview-item")[0]}else if(typeof nodeId==="number"){toBeCheckedNode=this.querySelector(".top-treeview-item[data-index='"+nodeId+"']")}if(this.virtualScroll!==true&&this.virtualScroll!=="true"){checkElement=toBeCheckedNode.parentNode.querySelector(".top-treeview-check");checkStatus=checkElement.checked;if(checked!==checkStatus)top$(checkElement).click()}}function findId(node,nodeId,checked){for(var i=0;i<node.length;i++){if(node[i].id===nodeId)childCheck(node[i],checked);else{if(node[i].children!==undefined&&node[i].children.length>0)findId(node[i].children,nodeId,checked)}}}function childCheck(node,checked){if(node.checked!==checked){var fnNodeCheck=_this.option.event.onNodecheck;node.checked=checked;if(typeof fnNodeCheck==="function")fnNodeCheck(null,Top.Dom.selectById(_this.id),node)}if(node.children!==undefined&&node.children.length>0){for(var i=0;i<node.children.length;i++){node.children[i].checked=checked;childCheck(node.children[i],checked)}}}},__selectItem:function(p1,value){var selectedItem;switch(this.__selectItem.caller.name){case"selectItemByIndex":{var index=p1;if(index instanceof Array){for(var i=0;i<index.length;i++){selectedItem=this.querySelector(".top-treeview-item[data-index='"+index[i]+"']");top$(selectedItem).trigger(top$.Event("click",{ctrlKey:true}))}}else{selectedItem=this.querySelector(".top-treeview-item[data-index='"+index+"']");top$(selectedItem).click()}break}case"selectItemByField":{var field=p1;break}}},__setItemField:function(field,index){var _this=this;if(index){var item=this.querySelector(".top-treeview-item[data-index='"+index+"']");var selectedItem=this.__findItemByField(this.items,item.getAttribute("data-field"),item.innerText,index);var value=selectedItem[field];item.setAttribute("data-field",field);item.innerText=value||""}else{var allItems=Array.prototype.slice.call(this.querySelectorAll(".top-treeview-item"));for(var i=0;i<allItems.length;i++){var _item=allItems[i];var items=typeof _this.items==="string"?Top.Util.namespace(_this.items):_this.items;var selectedItem=_this.__findItemByField(items,_item.getAttribute("data-field"),_item.innerText,_item.getAttribute("data-index"));if(selectedItem!==undefined){var value=selectedItem[field];_item.setAttribute("data-field",field);_item.innerText=value||""}}}},__addItems:function(parentIndex,newItems,toField){var parentElem=this.querySelector(".top-treeview-item[data-index='"+parentIndex+"']");var parentLevel=parseInt(parentElem.parentNode.className.match(/[0-9]+/g)[0]);var appenString="";var field=parentElem.getAttribute("data-field");var value=parentElem.innerText;var isParentGroup=false;appendString=this.makeTreeItems(newItems,parentLevel+1);if(parentElem.parentNode.classList.contains("parent")){isParentGroup=true;top$(parentElem.parentNode.querySelector("ul.top-treeview-children_nav")).append(appendString)}else{parentElem.parentNode.classList.add("parent");parentElem.parentNode.classList.remove("child");var button_checkbox=document.createElement("input");button_checkbox.setAttribute("type","checkbox");button_checkbox.classList.add("top-treeview-button");top$(parentElem.parentNode).prepend('<input type="checkbox" class="top-treeview-button"><i></i>');top$(parentElem.parentNode).find("> .top-treeview-button").prop("checked",false);top$(parentElem.parentNode).append("<ul class='top-treeview-children_nav'>"+appendString+"</ul>");var tempElement=parentElem.parentNode;top$(parentElem).replaceWith("<label id='"+top$(parentElem).attr("id")+"' class='top-treeview-item' data-field='"+field+"'>"+top$(parentElem).html()+"</label>");parentElem=top$(tempElement).find("> .top-treeview-item")[0];var parentElemIcon=top$(parentElem).find("> .top-treeview-icon");var parentElemImage=top$(parentElem).find("> .top-treeview-image");if(parentElemIcon&&parentElemIcon.attr("i-type")==="union"){parentElemIcon.removeClass(this.childIcon).addClass(this.groupIcon)}else if(parentElemImage&&parentElemImage.attr("i-type")==="union"){parentElemImage[0].style="background:url("+this.groupImage+") 0 0 no-repeat; background-size:contain;"}}if(this.items){var items=typeof this.items==="string"?Top.Util.namespace(this.items,this):this.items;this._index=0;var parentObj=this.__findItemByField(items,field,value,parentIndex);var newField=toField;if(isParentGroup){for(var key in parentObj){if(parentObj[key]instanceof Array){if(!toField)newField=key}}}else{if(!toField)newField="top_tempFieldName"}if(!parentObj[newField])parentObj[newField]=[];parentObj[newField].push(newItems);this.updateData("items")}this.__setNodeIndex();this.attachEventHandler()},__removeItems:function(itemIndex){if(itemIndex instanceof Array){for(var i=0;i<itemIndex.length;i++){this.__removeItems(itemIndex[i])}}else{var removedNode=this.querySelector(".top-treeview-item[data-index='"+itemIndex+"']");if(removedNode===null)return;var field=removedNode.getAttribute("data-field");var value=removedNode.innerText;if(removedNode.parentNode.parentNode.childElementCount===1){tempElement=removedNode.parentNode.parentNode.parentNode;top$(tempElement).removeClass("parent");top$(tempElement).addClass("child");top$(tempElement).find("> .top-treeview-button").remove();top$(tempElement).find("> i").remove();top$(tempElement).find("> ul").remove();top$(tempElement).find("> .top-treeview-item").replaceWith("<a id='"+top$(tempElement).find("> .top-treeview-item").attr("id")+"' class='top-treeview-item' data-field='"+top$(tempElement).find("> .top-treeview-item").attr("data-field")+"'>"+top$(tempElement).find("> .top-treeview-item").html()+"</a>");var tempIcon=top$(tempElement).find("> .top-treeview-item .top-treeview-icon");var tempImage=top$(tempElement).find("> .top-treeview-item .top-treeview-image");if(tempIcon&&tempIcon.attr("i-type")==="union"){tempIcon.removeClass(_this.option.view.groupIcon).addClass(_this.option.view.childIcon)}else if(tempImage&&tempImage.attr("i-type")==="union"){tempImage[0].style="background:url("+_this.option.view.childImage+") 0 0 no-repeat; background-size:contain;"}tempElement=null}removedNode.parentNode.parentNode.removeChild(removedNode.parentNode)}if(this.items){var items=typeof this.items==="string"?Top.Util.namespace(this.items,this):this.items;this._index=0;this.__changeItemsToThis({items:items,field:field,value:value,index:itemIndex,changedData:undefined});if(itemIndex!==0)this.updateData("items")}this.__setNodeIndex();this.attachEventHandler()},__editItemValue:function(itemIndex,newValue){var editedNode=this.querySelector(".top-treeview-item[data-index='"+itemIndex+"']");var field=editedNode.getAttribute("data-field");var value=editedNode.innerText;top$(editedNode).contents().last().replaceWith(newValue);if(this.items){var items=typeof this.items==="string"?Top.Util.namespace(this.items,this):this.items;this._index=0;this.__changeItemsToThis({items:items,field:field,value:value,index:itemIndex,changedData:newValue});this.updateData("items")}},__changeItemsToThis:function(parameter){var items=parameter["items"];var field=parameter["field"];var value=parameter["value"];var index=parseInt(parameter["index"]);var changedData=parameter["changedData"];var parent=parameter["parent"];var parentIndex=parameter["parentIndex"];if(!this._index)this._index=0;if(!items)return;var calledByItself=false;if(this.__changeItemsToThis.caller.name==="__changeItemsToThis")calledByItself=true;if(items instanceof Array){for(var i=0,len=items.length;i<len;i++){if(calledByItself)this._index++;if(!parent)parent=items;if(!parentIndex)parentIndex=i;this.__changeItemsToThis({items:items[i],field:field,value:value,index:index,changedData:changedData,parent:parent,parentIndex:parentIndex})}}else if(items instanceof Object){if(index==this._index&&items[field]===value){if(!parent){parent=this.itemModel;parentIndex=this.itemString}if(changedData){items[field]=changedData}else{if(parent instanceof Array){parent.splice(parentIndex,1)}else{parent[parentIndex]=undefined;if(parent==this.itemModel)this.items=undefined}}this._index=0;return}for(var key in items){if(typeof items[key]==="object"&&items[key].length>0){this.__changeItemsToThis({items:items[key],field:field,value:value,index:index,changedData:changedData})}}}},__setPath:function(nodes,path){if(nodes.length!==undefined){for(var i=0;i<nodes.length;i++){nodes[i].path=path;if(nodes[i].children!==undefined){if(path==="")this.__setPath(nodes[i].children,nodes[i].id);else this.__setPath(nodes[i].children,path+"."+nodes[i].id)}}}else{nodes.path="";if(nodes.children!==undefined){if(path==="")this.__setPath(nodes[i].children,nodes[i].id);else this.__setPath(nodes[i].children,path+"."+nodes[i].id)}}},__setId:function(nodes,len){if(nodes.length===undefined){if(nodes.children!==undefined){for(var j=0;j<nodes.children.length;j++){if(nodes.children[j].id===undefined||nodes.children[j].id===null){nodes.children[j].id=len.toString();len+=1;len=this.__setId(nodes.children[j],len)}}}}else{for(var i=0;i<nodes.length;i++){if(nodes[i].id===undefined||nodes[i].id===null){nodes[i].id=len.toString();len+=1}if(nodes.children!==undefined){for(var j=0;j<nodes[i].children.length;j++){if(nodes[i].children[j].id===undefined||nodes[i].children[j].id===null){nodes[i].children[j].id=len.toString();len+=1;len=this.__setId(nodes[i].children[j],len)}}}}}return len},__makeFlatNode:function(tmpNodes,nodes){for(var i=0;i<nodes.length;i++){if(nodes[i].isExpanded===true||nodes[i].isExpanded==="true")tmpNodes.push(nodes[i]);if(nodes[i].children!==undefined){tmpNodes=this.__makeFlatNode(tmpNodes,nodes[i].children)}}return tmpNodes},__getIndex:function(id){var ret=0;for(var i=0;i<this.flatNodes.length;i++){if(this.flatNodes[i].isExpanded===true||flatNodes[i].isExpanded==="true")ret++;if(this.flatNodes[i].id===id)return ret}return ret},__createViewport:function(len,flatNodes){var _this=this;var viewport,content;viewport=top$(this.querySelector(".top-treeview-root"));content=top$(this.querySelector(".top-treeview-container"));var paddingTop=parseInt(top$(content).css("padding-top"));var scrollendFlag=arguments.length>2?true:false;if(_this.rh!==undefined||_this.rh!==null){var sample=_this.makeVirtualNodes(flatNodes[0],0);var tmpDiv=document.createElement("div");tmpDiv.innerHTML=sample;content.append(tmpDiv);_this.rh=parseInt(top$(tmpDiv).css("height"))}if(_this.rh===0){_this.rh=33}content.empty();var h=_this.rh*len;var vp=parseInt(this.layoutHeight);var rows={};content.css("height",h);onScroll();viewport.unbind("scroll");viewport.scroll(top$.throttle(200,false,onScroll));function onScroll(){if(viewport.scrollLeft()>0)return;content.empty();var scrollTop=viewport.scrollTop();var top=Math.floor(scrollTop/_this.rh);var bottom=Math.ceil((scrollTop+vp)/_this.rh);if(bottom>len)bottom=len;for(var i=top;i<bottom;i++){rows[i]=renderRow(i)}if(bottom>flatNodes.length)bottom=flatNodes.length;var tmp=[];for(var i=top,child=content[0].children[i-top];i<bottom;i++,child=content[0].children[i-top]){if(flatNodes[i].isExpanded===true||flatNodes[i].isExpanded==="true"){child.innerHTML=_this.makeVirtualNodes(flatNodes[i],i);for(var k=0;k<child.children.length;k++){_this.createHtmlObjects(child.children[k])}child.style.paddingLeft=flatNodes[i].depth*15+"px";child.id="_"+flatNodes[i].id;tmp.push(flatNodes[i])}}_this.__setVirtualDataObjToItem(tmp);_this.attachVirtualEventHandler();if(typeof _this.onScrollend==="function"&&scrollendFlag!==true)_this.onScrollend();if(scrollendFlag===true)scrollendFlag=false}function renderRow(row){return top$("<div class='row' />").css({top:row*_this.rh+paddingTop,height:_this.rh,width:"100%",border:"0px",backgroundColor:"transparent",position:"absolute"}).appendTo(content)}},attachVirtualEventHandler:function(){var _this=this;var fnNodeSelected=this.option.event.onNodeclick;var fnNodeHover=this.option.event.onNodehover;var fnNodeCheck=this.option.event.onNodecheck;var fnNodeDblclick=this.option.event.onNodedblclick;top$(this).find(" .top-treeview-container .top-treeview-button").off("change").on("change",function(e){var parent_li=this.parentNode;var thisItem=parent_li.getElementsByClassName("top-treeview-item")[0].parentNode.parentNode;var children_ul=thisItem.nextSibling;var thisNodeData=thisItem.dataObj;_this.__findselectedId(_this.nodes||_this.itemData,thisNodeData.id,null,"expand");_this.flatNodes=_this.__makeFlatNode(new Array,_this.nodes||_this.itemData);_this.__createViewport(_this.flatNodes.length,_this.flatNodes);if(thisNodeData.children[0].isExpanded===true){_this.__dispatchEvent(new CustomEvent("expand",{detail:{data:thisNodeData}}))}else{_this.__dispatchEvent(new CustomEvent("collapse",{detail:{data:thisNodeData}}))}e.preventDefault()});top$(this.childRoot).find(" .top-treeview-container .top-treeview-button+i").off("click").on("click",function(e){top$(this.previousSibling).change();e.preventDefault()});top$(this).find(" .top-treeview-container .top-treeview-item").off("click").on("click",function(e){var thisClickedIndex=this.getAttribute("data-index");if(_this.itemClicktype==="select"){if(Top.Util.__isBooleanTrue(_this.multiSelect)&&(e.shiftKey||e.ctrlKey)){if(e.shiftKey){if(!lastClickedIndex)lastClickedIndex=0;if(!firstClickedIndex)firstClickedIndex=0;if(lastClickedType=="ctrl"||parseInt(lastClickedIndex)>parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)<parseInt(firstClickedIndex)||parseInt(lastClickedIndex)<parseInt(firstClickedIndex)&&parseInt(thisClickedIndex)>parseInt(firstClickedIndex)){var selectedList=_this.querySelectorAll(".top-treeview-list.selected");for(var tmp=0;tmp<selectedList.length;tmp++){selectedList[tmp].classList.remove("selected")}var selectedItem=_this.querySelectorAll(".top-treeview-item.selected");for(var tmp=0;tmp<selectedItem.length;tmp++){selectedItem[tmp].classList.remove("selected")}lastClickedIndex=firstClickedIndex}var selectedElement=_this.querySelector(".top-treeview-item[data-index='"+lastClickedIndex+"']");if(thisClickedIndex!==lastClickedIndex){var dataIndex=lastClickedIndex;while(true){if(selectedElement!==undefined&&selectedElement!==null){selectedElement.parentNode.classList.add("selected");selectedElement.classList.add("selected")}if(selectedElement.getAttribute("data-index")===thisClickedIndex)break;if(parseInt(thisClickedIndex)>parseInt(lastClickedIndex)){dataIndex++;selectedElement=_this.querySelector(".top-treeview-item[data-index='"+dataIndex+"']")}else{dataIndex--;selectedElement=_this.querySelector(".top-treeview-item[data-index='"+dataIndex+"']")}}}else if(thisClickedIndex===lastClickedIndex){if(selectedElement!==undefined&&selectedElement!==null){selectedElement.parentNode.classList.add("selected");selectedElement.classList.add("selected")}}lastClickedType="shift"}else if(e.ctrlKey){this.parentNode.classList.toggle("selected");this.classList.toggle("selected");lastClickedType="ctrl";firstClickedIndex=thisClickedIndex}var allNodeHasSelected=_this.querySelectorAll(".top-treeview-item.selected");_this.selectedNode=[];for(var l=0;l<allNodeHasSelected.length;l++){var item=allNodeHasSelected[l];if(_this.userNodes){_this.selectedNode.push(item.parentNode.parentNode.dataObj)}else if(_this.items){_this._index=0;_this.selectedNode.push(_this.__findItemByField(_this.items,item.getAttribute("data-field"),item.innerText,item.getAttribute("data-index")))}}lastClickedIndex=thisClickedIndex}else{var treeviewList=_this.querySelectorAll(".top-treeview-list.selected");for(var l=0;l<treeviewList.length;l++){if(treeviewList[l]!==null&&treeviewList[l]!==undefined)treeviewList[l].classList.remove("selected")}var treeviewItem=_this.querySelectorAll(".top-treeview-item.selected");for(var l=0;l<treeviewItem.length;l++){if(treeviewItem[l]!==null&&treeviewItem[l]!==undefined)treeviewItem[l].classList.remove("selected");
}this.parentNode.classList.add("selected");this.classList.add("selected");_this._index=0;_this.selectedNode=this.parentNode.parentNode.dataObj||_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"));lastClickedIndex=thisClickedIndex;lastClickedType="";firstClickedIndex=thisClickedIndex}_this.selectedItemIndex=lastClickedIndex}else if(_this.itemClicktype==="click"){_this.clickedItemIndex=this.getAttribute("data-index");_this._index=0;_this.clickedNode=this.parentNode.parentNode.dataObj||_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"))}if(_this.userNodes){if(typeof fnNodeSelected==="function"){if(_this.itemClicktype==="select"){fnNodeSelected(e.originalEvent,Top.Dom.selectById(_this.id),_this.selectedNode)}else if(_this.itemClicktype==="click"){fnNodeSelected(e.originalEvent,Top.Dom.selectById(_this.id),_this.clickedNode)}}}else if(_this.items){if(typeof fnNodeSelected==="function")fnNodeSelected(event,Top.Dom.selectById(_this.id));else if(typeof _this.option.event.onNodeclick==="function")_this.option.event.onNodeclick(event,Top.Dom.selectById(_this.id));else if(typeof _this.onNodeclick==="string"&&_this.onNodeclick.length>0)Top.Util.namespace(_this.onNodeclick,_this)(event,Top.Dom.selectById(_this.id))}if(this.parentNode.classList.contains("parent")&&(_this.option.node.toggleClickCount===1||_this.option.node.toggleClickCount==="1")){var button_input=this.parentNode.querySelector(".top-treeview-button");if(button_input.checked)button_input.checked=false;else button_input.checked=true;top$(button_input).change()}});top$(this).find(" .top-treeview-container .top-treeview-item").off("dblclick").on("dblclick",function(e){_this.clickedItemIndex=this.getAttribute("data-index");if(_this.userNodes){_this.dblclickedNode=this.dataObj;_this.dblclickedNode=this.parentNode.parentNode.dataObj;_this.selectedNode=_this.dblclickedNode;if(typeof fnNodeDblclick==="function"){fnNodeDblclick(e.originalEvent,Top.Dom.selectById(_this.id),_this.dblclickedNode)}}else if(_this.items){_this._index=0;_this.dblclickedNode=_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,_this.clickedItemIndex);if(typeof fnNodeDblclick==="function")fnNodeDblclick(event,Top.Dom.selectById(_this.id))}if(this.parentNode.classList.contains("parent")&&(_this.option.node.toggleClickCount===2||_this.option.node.toggleClickCount==="2")){var button_input=this.parentNode.getElementsByClassName("top-treeview-button")[0];if(button_input.checked)button_input.checked=false;else button_input.checked=true;top$(button_input).change()}e.preventDefault()});top$(this).find(" .top-treeview-container .top-treeview-button+i").off("click").on("click",function(e){if(this.previousSibling.checked){this.previousSibling.checked=false}else{this.previousSibling.checked=true}top$(this.previousSibling).change();e.preventDefault()});top$(this.childRoot).find(" .top-treeview-container .top-treeview-item").off("mouseenter").on("mouseenter",function(e){if(this.querySelector(".top-treeview-edit_btn")){this.querySelector(".top-treeview-edit_btn").style.visibility="visible";top$(this).parents("li.top-treeview-list").css("z-index","2")}_this._index=0;_this.hoverNode=this.dataObj||_this.__findItemByField(_this.items,this.getAttribute("data-field"),this.innerText,this.getAttribute("data-index"));if(typeof fnNodeHover==="function")fnNodeHover(e.originalEvent,Top.Dom.selectById(_this.id),_this.hoverNode);e.preventDefault()});top$(this.childRoot).find(" .top-treeview-container .top-treeview-item").off("mouseleave").on("mouseleave",function(e){if(this.querySelector(".top-treeview-edit_btn")){this.querySelector(".top-treeview-edit_btn").style.visibility="hidden";top$(this.querySelector(".top-treeview-edit_btn")).removeClass("selected");this.querySelector(".top-treeview-edit_btn .top-treeview-edit_nav").style.display="none";top$(this).parents("li.top-treeview-list").css("z-index","")}e.preventDefault()});if(this.option.event.onNodecontextmenu){top$(this.childRoot).find(" .top-treeview-container .top-treeview-item").off("contextmenu").on("contextmenu",function(e){var result=true;if(typeof _this.option.event.onNodecontextmenu==="function"){result=_this.option.event.onNodecontextmenu(e.originalEvent,Top.Dom.selectById(_this.id),this.parentNode.parentNode.dataObj)}if(result===false){e.preventDefault()}})}top$(this.childRoot).find(" .top-treeview-list .top-treeview-check:not([disabled])").off("change").on("change",function(e){if(_this.option.node.checkInherit){var parent_list=this.parentNode;var thisItem=this.parentNode.parentNode;var thisNodeData=thisItem.dataObj;findNode(_this.nodes||_this.itemData,thisNodeData.id);_this.flatNodes=_this.__makeFlatNode(new Array,_this.nodes||_this.itemData);_this.__createViewport(_this.flatNodes.length,_this.flatNodes)}_this.checkedNode=[];_this.checkedNode=getVirtualCheckedNode(_this.nodes||_this.itemData,_this.checkedNode);var thisCheckedNode=this.parentNode.parentNode.dataObj;if(thisCheckedNode)thisCheckedNode.checked=this.checked;if(typeof fnNodeCheck==="function")fnNodeCheck(e.originalEvent,Top.Dom.selectById(_this.id),thisCheckedNode);e.preventDefault();function findNode(node,nodeId){for(var i=0;i<node.length;i++){if(node[i].id===nodeId){node[i].checked=!node[i].checked;if(node[i].children!==undefined)childCheck(node[i].children,node[i].checked);if(node[i].parentId!==undefined)parentCheck(_this.nodes,node[i].parentId,node[i].checked)}else{if(node[i].children!==undefined)findNode(node[i].children,nodeId)}}}function childCheck(node,flag){for(var i=0;i<node.length;i++){node[i].checked=flag;if(node[i].children!==undefined)childCheck(node[i].children,flag)}}function parentCheck(node,nodeId,flag){for(var i=0;i<node.length;i++){if(node[i].id===nodeId){if(flag===false)node[i].checked=flag;else{var tmp_flag=false;for(var j=0;j<node[i].children.length;j++){if(node[i].children[j].checked===false||node[i].children[j].checked===undefined){tmp_flag=true;break}}if(tmp_flag===false)node[i].checked=flag}if(node[i].parentId!==undefined)parentCheck(_this.nodes,node[i].parentId,node[i].checked);break}else if(node[i].children!==undefined){parentCheck(node[i].children,nodeId,flag)}}}function getVirtualCheckedNode(nodes,array){for(var i=0;i<nodes.length;i++){if(nodes[i].isChecked===true)array.push(nodes[i]);if(nodes[i].children!==undefined)getVirtualCheckedNode(nodes[i].children,array)}return array}});top$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn").off("mouseenter").on("mouseenter",function(e){e.stopPropagation()});top$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-edit_nav").off("mouseenter").on("mouseenter",function(e){e.stopPropagation()});top$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn").off("click").on("click",function(e){var navElem=this.querySelector(".top-treeview-edit_nav");if(top$(this).hasClass("selected")){top$(this).removeClass("selected");navElem.style.display="none";navElem.style.top="";navElem.style.left="";navElem.style.right=""}else{top$(this).addClass("selected");navElem.style.display="block";navElem.style.top=this.getBoundingClientRect().top+this.getBoundingClientRect().height+"px";navElem.style.left=this.getBoundingClientRect().left+"px";var calcedRight=navElem.getBoundingClientRect().right-top$(document).width();if(calcedRight>0){calcedRight=Math.abs(this.getBoundingClientRect().right-top$(document).width());navElem.style.left="";navElem.style.right=calcedRight+"px"}}e.stopPropagation()});top$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn").off("dblclick").on("dblclick",function(e){e.stopPropagation()});top$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-edit").off("click").on("click",function(e){var thisItem=this.parentNode.parentNode.parentNode;for(var i=0;i<thisItem.childNodes.length;i++){if(thisItem.childNodes[i].nodeName==="#text"){var thisItemText=thisItem.childNodes[i].nodeValue}}var editBtn=this.parentNode.parentNode;var textElement=editBtn.nextSibling;top$(textElement).remove();top$(thisItem).append("<input class='top-treeview-edit_input' type='text' value='"+thisItemText+"'/>");var $inputElement=top$(thisItem).find(".top-treeview-edit_input");var inputLength=$inputElement.val().length||5;$inputElement.attr("size",inputLength);$inputElement.focus();$inputElement.on("dblclick",function(e){e.stopPropagation()}).on("mousedown",function(e){e.stopPropagation()}).on("keypress",function(e){if(e.keyCode===13){_this.editNodeText(thisItem.id,top$(this).val())}}).on("focusout",function(e){_this.editNodeText(thisItem.id,top$(this).val())})});if(_this.option.node.deletable===true||this.option.node.deletable==="true"){top$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn .top-treeview-delete").off("click").on("click",function(e){var thisItem=this.parentNode.parentNode.parentNode;var toBeRemovedData=thisItem.dataObj;var result=true;if(typeof _this.option.event.onNodedelete==="function"){result=_this.option.event.onNodedelete(Top.Dom.selectById(_this.id),toBeRemovedData)}if(result!==false){_this.removeNodes(thisItem.id)}})}top$(this.childRoot).find(" .top-treeview-item .top-treeview-edit_btn li:not(.top-treeview-delete):not(.top-treeview-edit)").off("click").on("click",function(e){var thisCustomMenuKey=this.className.replace("top-treeview-","");var nodeItem=top$(this).closest(".top-treeview-item")[0];var fnSelect=typeof _this.option.view.menu[thisCustomMenuKey]==="function"?_this.option.view.menu[thisCustomMenuKey]:Top.Util.namespace(_this.option.view.menu[thisCustomMenuKey],_this);if(typeof fnSelect==="function"){fnSelect(Top.Dom.selectById(_this.id),nodeItem.dataObj)}})},makeVirtualNodes:function(treeObj,i){var _this=this;var icon,iconClass,image;var iString="";var isSetUnionI=false;var checkable=this.option.node.checkable;var editable=this.option.node.editable;var deletable=this.option.node.deletable;var checked=false;var isCheckDisabled=false;var checkString="";var editMenuString="";var isIncludedCustomMenu=false;var customMenuList={};var innerElement="";var level=treeObj["depth"];var isExpanded=treeObj["isExpanded"];var isSelected=treeObj["isSelected"];var isFocused=treeObj["isFocused"];var isSearched=treeObj["isSearched"];var modelField="";for(var key in this.option.view.menu){if(key!=="order"){isIncludedCustomMenu=true;var fnSelect=typeof this.option.view.menu[key]==="function"?this.option.view.menu[key]:Top.Util.namespace(this.option.view.menu[key],this);customMenuList[key]=fnSelect;if(this.option.view.menu.order.indexOf(key)<0){this.option.view.menu.order.push(key)}}}var childExpanded=false;if(treeObj.children instanceof Array&&treeObj.children.length>0&&treeObj.children[0].isExpanded===true){childExpanded=true}var ret="";ret+="<li tabindex='-1' class='top-treeview-list level"+level+" virtual";var id=treeObj["id"]!==null&&treeObj["id"]!==undefined&&treeObj["id"].toString()||treeObj["value"]||treeObj["text"];icon=treeObj["icon"];iconClass=treeObj["iconClass"];image=treeObj["image"];if(treeObj["checkable"]!==undefined&&treeObj["checkable"]!==null){checkable=treeObj["checkable"]}if(treeObj["editable"]!==undefined&&treeObj["editable"]!==null){editable=treeObj["editable"]}if(treeObj["deletable"]!==undefined&&treeObj["deletable"]!==null){deletable=treeObj["deletable"]}for(var key in customMenuList){if(treeObj[key]!==undefined&&treeObj[key]!==null){customMenuList[key]=treeObj[key]}}customMenuList["edit"]=editable;customMenuList["delete"]=deletable;if(treeObj["checked"]==="true"||treeObj["checked"]===true){checked=true}if(treeObj["checked"]==="false"||treeObj["checked"]===false){checked=false}if(_this.items){var treeitem=this.getTreeItem(treeObj,this.itemModelObj["modelId"]);if(treeitem&&treeitem.attributes["text"]){modelField=treeitem.attributes["text"].value;modelField=modelField.substring(1,modelField.indexOf("}"))}}if(this.option.node.checkDisabled!==false){if(typeof this.option.node.checkDisabled==="function"){isCheckDisabled=this.option.node.checkDisabled(treeObj)}else if(this.option.node.checkDisabled instanceof Array){for(var z=0;z<this.option.node.checkDisabled.length;z++){if(id===this.option.node.checkDisabled[z])isCheckDisabled=true}}else if(this.option.node.checkDisabled==="true"||this.option.node.checkDisabled===true){isCheckDisabled=true}}if(this.option.view.showIcon||this.option.view.showImage){if(!icon&&!image){if(this.option.view.showIcon)icon=treeObj["hasChild"]?this.option.view.groupIcon:this.option.view.childIcon;else if(this.option.view.showImage)image=treeObj["hasChild"]?this.option.view.groupImage:this.option.view.childImage;isSetUnionI=true}if(isSetUnionI){iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"' i-type='union'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;' i-type='union'></span>"}else{iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;'></span>"}}if(checkable==="true"||checkable===true){checkString="<input type='checkbox' id='"+this.id+"_check_"+i+"' class='top-treeview-check' "+(checked?"checked":"")+(isCheckDisabled?" disabled":"")+"><label for='"+this.id+"_check_"+i+"'></label>"}if(editable==="true"||editable===true||deletable==="true"||deletable===true||isIncludedCustomMenu===true){editMenuString="<span class='top-treeview-edit_btn' style='visibility:hidden;'><ul class='top-treeview-edit_nav'>";for(var index=0;index<this.option.view.menu.order.length;index++){var item=this.option.view.menu.order[index];if(customMenuList[item]!==false&&customMenuList[item]!=="false"){var language=_this.__i18n(_this.option.view.language[item]);if(item!=="edit"&&item!=="delete"){editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}else{editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}}}editMenuString+="</ul></span>"}if(typeof this.option.view.layout==="function"){innerElement=this.option.view.layout(treeObj)}else if(modelField){innerElement=treeObj[modelField]}else if(treeObj["text"]){innerElement=treeObj["text"]}if(treeObj["hasChild"]===true){ret+=" parent "+(isExpanded?"expand":"collapse")+"'><input type='checkbox' class='top-treeview-button' "+(childExpanded?"":"checked")+"><i></i>"+checkString+"<label  id='"+id+"' class='top-treeview-item "+(isSelected?"selected":"")+" "+(isFocused?"focused":"")+" "+(isSearched?"searched":"")+"' data-index='"+i+"' data-field='"+modelField+"'>"+iString+editMenuString+innerElement+"</label>"}else{ret+=" child'>"+checkString+"<a id='"+id+"' class='top-treeview-item"+(isSelected?"selected":"")+" "+(isFocused?"focused":"")+" "+(isSearched?"searched":"")+"' data-index='"+i+"' data-field='"+modelField+"'>"+iString+editMenuString+innerElement+"</a>"}checkable=this.option.node.checkable;editable=this.option.node.editable;deletable=this.option.node.deletable;checked=false;isCheckDisabled=false;checkString="";editMenuString="";ret+="</li>";return ret},renderTreeViewByNodes:function(){if(this.nodes){this.clearItems();if(typeof this.nodes=="string"){this.nodes=Top.Util.namespace(this.nodes,this)}var nodes=this.makeNodesByObject(this.nodes);this.userNodes=this.nodes}else if(this.widgetItems){var nodes=this.makeNodes(this.widgetItems);this.userNodes=this.widgetItems}if(this.childRoot.getElementsByClassName("top-treeview-container")[0]){this.childRoot.getElementsByClassName("top-treeview-container")[0].remove()}var container_ul=document.createElement("ul");container_ul.classList.add("top-treeview-container");if(this.option.view.autoNodeWidth)container_ul.classList.add("auto-width");this.childRoot.appendChild(container_ul);if(this.virtualScroll===true||this.virtualScroll==="true"){if(nodes.length>0){this.isExpanded=this.option.view.expand;if(this.isExpanded===undefined)this.isExpanded=true;this.nodes=this.__setExpand(nodes,this.isExpanded,0);this.__setPath(this.nodes,"");this.__setId(this.nodes,0);this.__setParentCheck(this.nodes,null);this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes);var allNodeHasChecked=top$(this.querySelectorAll(".top-treeview-check:checked")).parent().find("> .top-treeview-item");this.checkedNode=[];for(var index=0;index<allNodeHasChecked.length;index++){var item=allNodeHasChecked[index];if(this.userNodes){if(item.dataObj!==undefined){this.checkedNode.push(item.dataObj)}else{this.checkedNode.push(this.__findNodeById(this.flatNodes,item.id))}}else if(this.items){this._index=0;this.checkedNode.push(this.__findItemByField(this.items,item.getAttribute("data-field"),item.innerText,item.getAttribute("data-index")))}}for(var k=0;k<this.checkedNode.length;k++){var item=this.checkedNode[k];item.checked=true}if(this.userNodes)this.__setVirtualDataObjToItem(this.flatNodes);this.createdItemWidgetAttachedCallback();this.__setOptions()}}else{var appendString="";appendString=this.makeTreeNodes(nodes,0);var madeNodes=document.createElement("div");madeNodes.innerHTML=appendString;for(var k=0;k<madeNodes.children.length;k++){this.createHtmlObjects(madeNodes.children[k])}while(madeNodes.firstChild){this.getElementsByClassName("top-treeview-container")[0].appendChild(madeNodes.firstChild)}this.createdItemWidgetAttachedCallback();this.__setOptions();this.attachEventHandler();if(this.widgetItems){var widgetItemList=this.querySelectorAll("top-widgetitem");for(var i=0;i<widgetItemList.length;i++){var tmp=widgetItemList[i];top$(tmp).remove()}}}if(nodes)Top.i18n.__onUpdate(this.id,"__reRender")},makeNodesByObject:function(parent){if(parent===undefined){console.error("nodes not defined");return}var _this=this;if(this.__nodePath===undefined)this.__nodePath=[];var len=parent.length;var node=[];for(var i=0;i<len;i++){var obj={};for(var key in parent[i]){obj[key]=parent[i][key];if(key==="children"&&parent[i][key].length>0){this.__nodePath.push(parent[i].id);obj[key]=this.makeNodesByObject(parent[i].children);if(_this.childCheck!==false&&_this.childCheck!=="false"){if(obj["checked"]===true||obj["checked"]==="true"){for(var j=0;j<obj["children"].length;j++){obj["children"][j]["checked"]=obj["checked"]}}}}}node[i]=obj;parent[i].path=this.__nodePath.join(".")}this.__nodePath.pop();return node},makeTreeNodes:function(treeObj,level){var len=treeObj.length;var _this=this;var ret="";var isParent=false;var icon,iconClass,image;var iString="";var isSetUnionI=false;var checkable=this.option.node.checkable;var editable=this.option.node.editable;var deletable=this.option.node.deletable;var checked=false;var isCheckDisabled=false;var checkString="";var editMenuString="";var isIncludedCustomMenu=false;var customMenuList={};var innerElement="";var isExpanded=this.option.view.expand;for(var i=0;i<len;i++){treeObj[i]["text"]=this.__i18n(treeObj[i]["text"])}for(var key in this.option.view.menu){if(key!=="order"){isIncludedCustomMenu=true;var fnSelect=typeof this.option.view.menu[key]==="function"?this.option.view.menu[key]:Top.Util.namespace(this.option.view.menu[key],this);customMenuList[key]=fnSelect;if(this.option.view.menu.order.indexOf(key)<0){this.option.view.menu.order.push(key)}}}for(var i=0;i<len;i++){ret+="<li tabindex='-1' class='top-treeview-list level"+level;if(treeObj[i]["children"]!==undefined&&treeObj[i]["children"].length>0){isParent=true}var id=treeObj[i]["id"]!==null&&treeObj[i]["id"]!==undefined&&treeObj[i]["id"].toString()||treeObj[i]["value"]||treeObj[i]["text"];icon=treeObj[i]["icon"];iconClass=treeObj[i]["iconClass"];image=treeObj[i]["image"];if(treeObj[i]["checkable"]!==undefined&&treeObj[i]["checkable"]!==null){checkable=treeObj[i]["checkable"]}if(treeObj[i]["editable"]!==undefined&&treeObj[i]["editable"]!==null){editable=treeObj[i]["editable"]}if(treeObj[i]["deletable"]!==undefined&&treeObj[i]["deletable"]!==null){deletable=treeObj[i]["deletable"]}for(var key in customMenuList){if(treeObj[i][key]!==undefined&&treeObj[i][key]!==null){customMenuList[key]=treeObj[i][key]}}customMenuList["edit"]=editable;customMenuList["delete"]=deletable;if(treeObj[i]["checked"]==="true"||treeObj[i]["checked"]===true){checked=true}if(this.option.node.checkDisabled!==false){if(typeof this.option.node.checkDisabled==="function"){isCheckDisabled=this.option.node.checkDisabled(treeObj[i])}else if(this.option.node.checkDisabled instanceof Array){for(var z=0;z<this.option.node.checkDisabled.length;z++){if(id===this.option.node.checkDisabled[z])isCheckDisabled=true}}else if(this.option.node.checkDisabled==="true"||this.option.node.checkDisabled===true){isCheckDisabled=true}}if(isParent){if(this.option.view.showIcon||this.option.view.showImage){if(!icon&&!image){if(this.option.view.showIcon)icon=this.option.view.groupIcon;else if(this.option.view.showImage)image=this.option.view.groupImage;isSetUnionI=true}if(isSetUnionI){iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"' i-type='union'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;' i-type='union'></span>"}else{iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;'></span>"}}if(checkable==="true"||checkable===true){checkString="<input type='checkbox' id='"+this.id+"_check_"+i+"' class='top-treeview-check' "+(checked?"checked":"")+(isCheckDisabled?" disabled":"")+"><label for='"+this.id+"_check_"+i+"'></label>"}if(typeof this.option.view.layout==="function")editable=false;if(editable==="true"||editable===true||deletable==="true"||deletable===true||isIncludedCustomMenu===true){editMenuString="<span class='top-treeview-edit_btn' style='visibility:hidden;'><ul class='top-treeview-edit_nav'>";for(var index=0;index<this.option.view.menu.order.length;index++){var item=this.option.view.menu.order[index];if(customMenuList[item]!==false&&customMenuList[item]!=="false"){var language=_this.__i18n(_this.option.view.language[item]);if(item!=="edit"&&item!=="delete"){editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}else if(item==="edit"&&typeof this.option.view.layout==="function"){}else{editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}}}editMenuString+="</ul></span>"}if(typeof this.option.view.layout==="function"){innerElement=this.option.view.layout(treeObj[i])}else innerElement=treeObj[i]["text"];if(innerElement==="")innerElement=" ";ret+=" parent "+(isExpanded?"expand":"collapse")+"'><input type='checkbox' class='top-treeview-button' "+(isExpanded?"":"checked")+"><i></i>"+checkString+"<label  id='"+id+"' class='top-treeview-item'>"+iString+editMenuString+innerElement+"</label><ul class='top-treeview-children_nav' style='display:"+(isExpanded?"block":"none")+";'>";ret+=this.makeTreeNodes(treeObj[i]["children"],level+1);ret+="</ul>";checkable=this.option.node.checkable;editable=this.option.node.editable;deletable=this.option.node.deletable;checked=false;isCheckDisabled=false;checkString="";editMenuString=""}else{if(this.option.view.showIcon||this.option.view.showImage){if(!icon&&!image){if(this.option.view.showIcon)icon=this.option.view.childIcon;else if(this.option.view.showImage)image=this.option.view.childImage;isSetUnionI=true}if(isSetUnionI){iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"' i-type='union'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;' i-type='union'></span>"}else{iString=icon?"<span class='top-treeview-icon "+icon+" "+iconClass+"'></span>":"<span class='top-treeview-image' style=' background:url("+image+") 0 0 no-repeat; background-size:contain;'></span>"}}if(checkable==="true"||checkable===true){checkString="<input type='checkbox' id='"+this.id+"_check_"+i+"' class='top-treeview-check' "+(checked?"checked":"")+(isCheckDisabled?" disabled":"")+" ><label for='"+this.id+"_check_"+i+"'></label>"}if(editable==="true"||editable===true||deletable==="true"||deletable===true||isIncludedCustomMenu===true){editMenuString="<span class='top-treeview-edit_btn'  style='visibility:hidden;'><ul class='top-treeview-edit_nav'>";for(var index=0;index<this.option.view.menu.order.length;index++){var item=this.option.view.menu.order[index];if(customMenuList[item]!==false&&customMenuList[item]!=="false"){var language=_this.__i18n(_this.option.view.language[item]);if(item!=="edit"&&item!=="delete"){editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}else{editMenuString+='<li class="top-treeview-'+item+'">'+language+"</li>"}}}editMenuString+="</ul></span>"}if(typeof this.option.view.layout==="function"){innerElement=this.option.view.layout(treeObj[i])}else innerElement=treeObj[i]["text"];if(innerElement==="")innerElement=" ";ret+=" child'>"+checkString+"<a id='"+id+"' class='top-treeview-item'>"+iString+editMenuString+innerElement+"</a>";checkable=this.option.node.checkable;editable=this.option.node.editable;deletable=this.option.node.deletable;checked=false;isCheckDisabled=false;checkString="";editMenuString=""}ret+="</li>";isParent=false}return ret},makeNodes:function(parent){var len=parent.length;var node=[];for(var i=0;i<len;i++){var obj={};obj["id"]=parent[i].getAttribute("id");obj["text"]=this.__i18n(parent[i].getAttribute("text"));obj["value"]=parent[i].getAttribute("value");obj["image"]=parent[i].getAttribute("image");obj["icon"]=parent[i].getAttribute("icon");obj["editable"]=parent[i].getAttribute("editable");obj["deletable"]=parent[i].getAttribute("deletable");obj["checkable"]=parent[i].getAttribute("checkable");obj["checked"]=parent[i].getAttribute("checked");if(parent[i].children&&parent[i].children.length>0){obj["children"]=this.makeNodes(parent[i].children);if(obj["checked"]===true||obj["checked"]==="true"){for(var j=0;j<obj["children"].length;j++){obj["children"][j]=obj["checked"]}}}node[i]=obj}return node},__setExpand:function(nodes,isExpanded,depth,id){for(var i=0;i<nodes.length;i++){if(id!==undefined)nodes[i].parentId=id;if(depth===0)nodes[i].isExpanded=true;else nodes[i].isExpanded=isExpanded;nodes[i].depth=depth;if(nodes[i].children&&nodes[i].children.length>0){nodes[i].hasChild=true;this.__setExpand(nodes[i].children,isExpanded,depth+1,nodes[i].id)}else{nodes[i].hasChild=false}}return nodes},__findselectedId:function(nodes,id,flag,expand,ret){for(var i=0;i<nodes.length;i++){if(nodes[i].id===id){ret=nodes[i];if(expand==="checked"){if(nodes[i].checked===undefined||nodes[i].checked===false){nodes[i].checked=true}else nodes[i].checked=false}else if(expand==="select"){nodes[i].isSelected=true}if(nodes[i].children!==undefined){if(expand==="expand")this.__setFlag(nodes[i].children,flag);else if(expand==="checked")this.__setChecked(nodes[i].children,nodes[i].isChecked);else ret=this.__findselectedId(nodes[i].children,id,flag,expand,ret)}}else{if(expand==="select")nodes[i].isSelected=false;if(nodes[i].children!==undefined)ret=this.__findselectedId(nodes[i].children,id,flag,expand,ret)}}return ret},__setFlag:function(nodes,flag){for(var i=0;i<nodes.length;i++){if(nodes[i].children!==undefined&&nodes[i].children.length>0){if(nodes[i].children[0].isExpanded!==undefined&&nodes[i].children[0].isExpanded===true)this.__setFlag(nodes[i].children,false)}if(flag===false)nodes[i].isExpanded=false;else nodes[i].isExpanded=!nodes[i].isExpanded}return true},__setChecked:function(nodes,flag){for(var i=0;i<nodes.length;i++){if(nodes[i].children!==undefined){this.__setChecked(nodes[i].children,flag)}if(flag===false)nodes[i].checked=false;else nodes[i].checked=true}return true},__setVirtualDataObjToItem:function(flatNodes){var items=this.querySelector(".top-treeview-container");var labels=this.getElement(".top-treeview-item");for(var i=0;i<items.children.length;i++){labels[i].dataObj=this.__findNodeById(flatNodes,labels[i].id);items.children[i].dataObj=this.__findNodeById(flatNodes,items.children[i].id.substring(1,items.children[i].id.length))}},getTopStyle:function(){this.topstyle=this.querySelector("div").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector("div").style[key]=value;this.topstyle=this.querySelector("div").style.cssText}},setAllTopStyle:function(){this.querySelector("div").style.cssText=this.topstyle},__searchNode:function(id){var viewport=top$(this.querySelector(".top-treeview-root"));for(var i=0;i<this.flatNodes.length;i++){if(id===this.flatNodes[i].id){viewport.scrollTop(this.rh*i-100);viewport.scroll();return}}},__virtualScrollRerender:function(){if(!this.nodes)return;this.flatNodes=this.__makeFlatNode(new Array,this.nodes);this.__createViewport(this.flatNodes.length,this.flatNodes,true);return true},__getNodes:function(ul,new_nodes){for(var i=0;i<ul.children.length;i++){var li=ul.children[i];var this_node=li.querySelector(".top-treeview-item").dataObj;if(this_node.children!==undefined){this_node.children=[];for(var j=0;j<li.children.length;j++){if(li.children[j].tagName==="UL"){this.__getNodes(li.children[j],this_node.children)}}}new_nodes.push(this_node)}return new_nodes},moveNode:function(updown,id){if(/^\d/.test(id))return;if(id){var selected_elem=this.querySelector("#"+id)}else if(this.selectedNode){var selected_elem=this.querySelector("#"+this.selectedNode.id)}else return;if(!selected_elem)return;if(selected_elem.getAttribute("data-index")===0){return}var li=selected_elem.parentNode;var ul=li.parentNode;if(selected_elem.tagName!=="A"&&selected_elem.tagName!=="LABEL")return;if(updown!=="up"&&updown!=="down")return;if(updown==="up"){if(!li.previousSibling)return;var prev_li=li.previousSibling;ul.insertBefore(li,prev_li)}else if(updown==="down"){if(!li.nextSibling)return;var next_li=li.nextSibling;ul.insertBefore(next_li,li)}this.__setNodeIndex();if(this.nodes){if(updown==="up"){this.nodes=__moveNode("up",this.nodes,selected_elem.id)}else if(updown==="down"){this.nodes=__moveNode("down",this.nodes,selected_elem.id)}this.updateData("nodes")}function __moveNode(updown,nodes,id){if(!nodes||!id)return;for(var i=0,len=nodes.length;i<len;i++){if(nodes[i].id===id){if(updown==="up"&&i>0){var temp=nodes[i-1];nodes[i-1]=nodes[i];nodes[i]=temp}else if(updown==="down"&&i<nodes.length-1){var temp=nodes[i+1];nodes[i+1]=nodes[i];nodes[i]=temp}return nodes}if(typeof nodes[i].children==="object"&&nodes[i].children.length>0){nodes[i].children=__moveNode(updown,nodes[i].children,id)}}return nodes}},__updateMultiSelect:function(){}};Top.Widget.Group.Treeview=function(){Treeview.prototype=Object.create(Top.Widget.Group.prototype);Treeview.prototype.constructor=Treeview;function Treeview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-treeview");this.template.innerHTML='<div class="top-treeview-root"></div>'}this.id=this.template.id}Treeview.create=function(element){return new Treeview(element)};Treeview.prototype.getNodes=function(){var new_nodes=new Array;var ul=this.template.querySelector(".top-treeview-container");return this.template.__getNodes(ul,new_nodes)};Treeview.prototype.expandNode=function(nodeId,notRender){this.template.expandNode(nodeId,notRender)};Treeview.prototype.collapseNode=function(nodeId,notRender){this.template.collapseNode(nodeId,notRender)};Treeview.prototype.expandAll=function(){this.template.expandAll()};Treeview.prototype.collapseAll=function(){this.template.collapseAll()};Treeview.prototype.getSelectedNode=function(){return this.template.selectedNode};Treeview.prototype.getClickedNode=function(){return this.template.clickedNode};Treeview.prototype.getHoveredNode=function(){return this.template.hoverNode};Treeview.prototype.getCheckedNode=function(){return this.template.__getCheckedNode()};Treeview.prototype.getNode=function(nodeId){return this.template.__getNode(nodeId)};Treeview.prototype.getDblclickedNode=function(){
return this.template.dblclickedNode};Treeview.prototype.addNodes=function(parentNodeId,newNodes,index){return this.template.addNodes(parentNodeId,newNodes,index)};Treeview.prototype.removeNodes=function(nodeId){return this.template.removeNodes(nodeId)};Treeview.prototype.editNodeText=function(nodeId,newText){return this.template.editNodeText(nodeId,newText)};Treeview.prototype.editNodeId=function(nodeId,newId){return this.template.editNodeId(nodeId,newId)};Treeview.prototype.getNodesByFilter=function(filter,parentNodeId){return this.template.getNodesByFilter(filter,parentNodeId)};Treeview.prototype.getItemsByFilter=function(filter){return this.template.getItemsByFilter(filter)};Treeview.prototype.selectNode=function(node){return this.template.__selectNode(node)};Treeview.prototype.deselectNode=function(node){this.template.__deselectNode(node)};Treeview.prototype.checkNode=function(nodeId,checked){this.template.__checkNode(nodeId,checked)};Treeview.prototype.checkAll=function(checked){this.template.__checkAll(checked)};Treeview.prototype.searchNode=function(id){this.template.__searchNode(id)};Treeview.prototype.getVirtualIndex=function(id){return this.template.__getIndex(id)};Treeview.prototype.getClickedIndex=function(){return this.template.getClickedItemIndex()};Treeview.prototype.getSelectedIndex=function(){return this.template.getSelectedItemIndex()};Treeview.prototype.selectItemByIndex=function selectItemByIndex(index){this.template.__selectItem(index)};Treeview.prototype.selectItemByField=function selectItemByField(field,value){this.template.__selectItem(field,value)};Treeview.prototype.setToggleClickCount=function(count){this.template.toggleClickCount=count;this.template.__updateToggleClickCount()};Treeview.prototype.setItemField=function(field,index){this.template.__setItemField(field,index)};Treeview.prototype.addItems=function(parentIndex,newItems,toField){this.template.__addItems(parentIndex,newItems,toField)};Treeview.prototype.removeItems=function(itemIndex){this.template.__removeItems(itemIndex)};Treeview.prototype.editItemValue=function(itemIndex,newValue){this.template.__editItemValue(itemIndex,newValue)};Treeview.prototype.virtualScrollRerender=function(){return this.template.__virtualScrollRerender()};Treeview.prototype.moveNodeUp=function(id){this.template.moveNode("up",id)};Treeview.prototype.moveNodeDown=function(id){this.template.moveNode("down",id)};return Treeview}();TopVideoview={is:"top-videoview",behaviors:[TopWidgetBehavior,TopResourceBehavior],properties:{autoPlay:{type:String,value:"false"},control:{type:String,value:"false"},loop:{type:String,value:"false"}},__ready:function(){this.updateStyle();this.__initialize();this.__updateId();this.__updateName();this.__updateAutoPlay();this.__updateSrc()},appendTemplate:function(){this.innerHTML='<video class="top-videoview-root" type="video/mp4"></video>'},__eventBindingList:function(){var shadowDiv=this.querySelector("video");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__initialize:function(){if(this.autoPlay==="true"){this.autoPlay=true}else{this.autoPlay=false}var shadowRoot=this.querySelector("video");if(this.control==="true"){shadowRoot.setAttribute("controls",true)}else{shadowRoot.removeAttribute("controls")}if(this.loop==="true"){shadowRoot.setAttribute("loop",true)}else{shadowRoot.removeAttribute("loop")}},__updateId:function(){if(this.id){var shadowInput=this.querySelector("video");shadowInput.id=this.id}},__updateName:function(){if(this.name){var shadowInput=this.querySelector("video");shadowInput.setAttribute("name",this.name)}},getPlayState:function(){var shadowVideo=this.querySelector("video");return!shadowVideo.paused},play:function(){var shadowVideo=this.querySelector("video");if(shadowVideo.paused){shadowVideo.play()}},stop:function(){var shadowVideo=this.querySelector("video");if(!shadowVideo.paused){shadowVideo.pause()}},__updateAutoPlay:function(){var shadowInput=this.querySelector("video");if(Top.Util.__isBooleanTrue(this.autoPlay)){this.autoPlay=true;shadowInput.setAttribute("autoplay","")}else{this.autoPlay=false;shadowInput.removeAttribute("autoplay")}},__updateSrc:function(){if(this.src){var shadowInput=this.querySelector("video");if(this.src.startsWith("@raw")){this.src=Top.RawManager.get(this.src.replace("@raw/",""))}shadowInput.setAttribute("src",this.src)}},__updateControl:function(){var shadowRoot=this.querySelector("video");if(Top.Util.__isBooleanTrue(this.control)){shadowRoot.setAttribute("controls",true)}else{shadowRoot.removeAttribute("controls")}},__updateLoop:function(){var shadowRoot=this.querySelector("video");if(Top.Util.__isBooleanTrue(this.loop)){shadowRoot.setAttribute("loop",true)}else{shadowRoot.removeAttribute("loop")}},getTopStyle:function(){this.topstyle=this.querySelector(".top-videoview-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-videoview-root").style[key]=value;this.topstyle=this.querySelector(".top-videoview-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-videoview-root").style.cssText=this.topstyle}};Top.Widget.Videoview=function(){Videoview.prototype=Object.create(Top.Widget.prototype);Videoview.prototype.constructor=Videoview;function Videoview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-videoview");this.template.innerHTML='<video class="top-videoview-root" type="video/mp4"></video>'}this.id=this.template.id}Videoview.create=function(element){return new Videoview(element)};Videoview.prototype.getPlayState=function(){return this.template.getPlayState()};Videoview.prototype.play=function(){this.template.play()};Videoview.prototype.stop=function(){this.template.stop()};return Videoview}();TopWebview={is:"top-webview",behaviors:[TopWidgetBehavior],properties:{url:String,onLoad:String},__ready:function(){this.updateStyle();this.__updateId();this.__updateName();this.__updateUrl()},__attached2:function(){this.__initBindingEvent()},__initEventInternal:function(){this.__addEventByAttr("load")},__initBindingEvent:function(){var _this=this;var iFrameElement=this.querySelector(".top-webview-root");iFrameElement.onLoad=function(){if(Top.Util.Browser.isIE()){_this.__dispatchEvent(new CustomEvent("load"))}else{_this.__dispatchEvent(new Event("load"))}}},appendTemplate:function(){this.innerHTML='<iframe class="top-webview-root" scrolling="yes"></iframe>'},__eventBindingList:function(){var shadowDiv=this.querySelector(".top-webview-root");return{__eventMouseClick:function(func){shadowDiv.onclick=func},__eventMousePressed:function(func){shadowDiv.onmousedown=func},__eventMouseReleased:function(func){shadowDiv.onmouseup=func},__eventMouseDblclick:function(func){shadowDiv.ondblclick=func},__eventKeyPressed:function(func){shadowDiv.onkeydown=func},__eventKeyTyped:function(func){shadowDiv.onkeypress=func},__eventKeyReleased:function(func){shadowDiv.onkeyup=func},__eventMouseEnter:function(func){shadowDiv.onmouseenter=func},__eventMouseExit:function(func){shadowDiv.onmouseleave=func},__eventMouseMove:function(func){shadowDiv.onmousemove=func},__eventFocused:function(func){shadowDiv.onfocus=func},__eventLostFocused:function(func){shadowDiv.onblur=func},__eventSecondaryClick:function(func){shadowDiv.oncontextmenu=func}}},__updateId:function(){if(this.id){var iFrameElement=this.querySelector(".top-webview-root");iFrameElement.id=this.id}},__updateUrl:function(){var iFrameElement=this.querySelector(".top-webview-root");iFrameElement.src=this.url},__updateName:function(){if(this.name){var iFrameElement=this.querySelector(".top-webview-root");iFrameElement.name=this.name;iFrameElement.alt=this.name}},getTopStyle:function(){this.topstyle=this.querySelector(".top-webview-root").style.cssText;return this.topstyle},setTopStyle:function(key,value){if(value){this.querySelector(".top-webview-root").style[key]=value;this.topstyle=this.querySelector(".top-webview-root").style.cssText}},setAllTopStyle:function(){this.querySelector(".top-webview-root").style.cssText=this.topstyle}};Top.Widget.Webview=function(){Webview.prototype=Object.create(Top.Widget.prototype);Webview.prototype.constructor=Webview;function Webview(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-webview");this.template.innerHTML='<iframe class="top-webview-root" scrolling="yes"></iframe>'}this.id=this.template.id}Webview.create=function(element){return new Webview(element)};return Webview}();TopWidgetitem={is:"top-widgetitem",behaviors:[TopWidgetBehavior,TopI18nBehavior],properties:{id:{type:String,reflectToAttribute:true},caption:String,src:{type:String,reflectToAttribute:true},text:{type:Object,reflectToAttribute:true},tooltip:String,href:{type:String,reflectToAttribute:true},subItems:[],parentWidget:Object,eventMouseClick:{type:Function,reflectToAttribute:true},value:String},appendTemplate:function(){},ready:function(){if(!this.id){this.id=Top.Util.guid()}this.parent=this.getParent();this.initSubItem();this.updateSubItem();this.__initI18n("text")},initSubItem:function(){this.subItems=top$(this).children();for(var i=0;i<this.subItems.length;i++){this.subItems[i].parentWidget=this.parentWidget}},getSubItem:function(){return this.subItems},clearSubItem:function(){var myNode=this;while(myNode.firstChild){myNode.removeChild(myNode.firstChild)}},updateSubItem:function(){this.clearSubItem();this.childText="";for(var i=0;i<this.subItems.length;i++){this.appendChild(this.subItems[i])}},__initText:function(){if(typeof this.text==="string"){var matches=this.text.match(/\{\{(.*?)\}\}/);if(matches){var _this=this;if(Top.i18n.isLoaded()){_this.text=eval(matches[1])}else{Top.i18n.onLoad(function(){_this.text=eval(matches[1])})}}}},__updateText:function(){if(this.parent&&this.parent.localName==="top-selectbox"){this.parent.__updateNodes()}},getTopStyle:function(){return this.topstyle},setTopStyle:function(key,value){if(value){this.topstyle+=key+":"+value+";"}},setAllTopStyle:function(){},__detached:function(){this.parentWidget=null}};Top.Widget.Group.Widgetitem=function(){Widgetitem.prototype=Object.create(Top.Widget.Group.prototype);Widgetitem.prototype.constructor=Widgetitem;function Widgetitem(element){if(element instanceof Element){this.template=element}else{this.template=document.createElement("top-widgetitem")}this.id=this.template.id}Widgetitem.create=function(element){return new Widgetitem(element)};Widgetitem.prototype.addItem=function(widget){this.template.subItems.push(widget.template)};Widgetitem.prototype.removeItem=function(widget){var childsArray=this.template.subItems;for(var i=0;i<childsArray.length;i++){if(widget.id==childsArray[i].id){this.template.childs.splice(i,1)}}};Widgetitem.prototype.complete=function(){this.template.updateSubItem()};return Widgetitem}();